<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="en" article-type="research-article"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmid">39661475</article-id><article-id pub-id-type="pmc">PMC11681940</article-id>
<article-id pub-id-type="doi">10.1093/bioinformatics/btae735</article-id><article-id pub-id-type="publisher-id">btae735</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Paper</subject><subj-group subj-group-type="category-toc-heading"><subject>Genome Analysis</subject></subj-group></subj-group><subj-group subj-group-type="category-taxonomy-collection"><subject>AcademicSubjects/SCI01060</subject></subj-group></article-categories><title-group><article-title>SCARAP: scalable cross-species comparative genomics of prokaryotes</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3913-5677</contrib-id><name><surname>Wittouck</surname><given-names>Stijn</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Conceptualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/conceptualization" degree-contribution="equal">Conceptualization</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Investigation" vocab-term-identifier="https://credit.niso.org/contributor-roles/investigation" degree-contribution="equal">Investigation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Methodology" vocab-term-identifier="https://credit.niso.org/contributor-roles/methodology" degree-contribution="equal">Methodology</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Software" vocab-term-identifier="https://credit.niso.org/contributor-roles/software" degree-contribution="equal">Software</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation" degree-contribution="equal">Validation</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="lead">Visualization</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - original draft" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-original-draft" degree-contribution="equal">Writing - original draft</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &#x00026; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &#x00026; editing</role><aff>
<institution>Lab of Applied Microbiology and Biotechnology, Department of Bioscience Engineering, University of Antwerp</institution>, Antwerpen 2020, <country country="BE">Belgium</country></aff><xref rid="btae735-cor1" ref-type="corresp"/><!--stijn.wittouck@uantwerpen.be--></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7509-2902</contrib-id><name><surname>Eilers</surname><given-names>Tom</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization" degree-contribution="supporting">Visualization</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &#x00026; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &#x00026; editing</role><aff>
<institution>Lab of Applied Microbiology and Biotechnology, Department of Bioscience Engineering, University of Antwerp</institution>, Antwerpen 2020, <country country="BE">Belgium</country></aff></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8436-6602</contrib-id><name><surname>van Noort</surname><given-names>Vera</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="supporting">Funding acquisition</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="supporting">Supervision</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &#x00026; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &#x00026; editing</role><aff>
<institution>Faculty of Bioscience Engineering, KU Leuven</institution>, Leuven 3001, <country country="BE">Belgium</country></aff><aff>
<institution>Institute of Biology Leiden, Leiden University</institution>, Leiden 2333 BE, <country country="NL">The Netherlands</country></aff></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9400-6918</contrib-id><name><surname>Lebeer</surname><given-names>Sarah</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Funding acquisition" vocab-term-identifier="https://credit.niso.org/contributor-roles/funding-acquisition" degree-contribution="lead">Funding acquisition</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision" degree-contribution="lead">Supervision</role><role vocab="credit" vocab-identifier="https://credit.niso.org" vocab-term="Writing - review &#x00026; editing" vocab-term-identifier="https://credit.niso.org/contributor-roles/writing-review-editing" degree-contribution="equal">Writing - review &#x00026; editing</role><aff>
<institution>Lab of Applied Microbiology and Biotechnology, Department of Bioscience Engineering, University of Antwerp</institution>, Antwerpen 2020, <country country="BE">Belgium</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Robinson</surname><given-names>Peter</given-names></name><role>Associate Editor</role></contrib></contrib-group><author-notes><corresp id="btae735-cor1">Corresponding author. Lab of Applied Microbiology and Biotechnology, Department of Bioscience Engineering, University of Antwerp, Groenenborgerlaan 171, Antwerpen 2020, Belgium. E-mail: <email>stijn.wittouck@uantwerpen.be</email></corresp></author-notes><pub-date pub-type="collection"><month>1</month><year>2025</year></pub-date><pub-date pub-type="epub" iso-8601-date="2024-12-11"><day>11</day><month>12</month><year>2024</year></pub-date><pub-date pub-type="pmc-release"><day>11</day><month>12</month><year>2024</year></pub-date><volume>41</volume><issue>1</issue><elocation-id>btae735</elocation-id><history><date date-type="received"><day>24</day><month>5</month><year>2024</year></date><date date-type="rev-recd"><day>31</day><month>10</month><year>2024</year></date><date date-type="editorial-decision"><day>30</day><month>11</month><year>2024</year></date><date date-type="accepted"><day>10</day><month>12</month><year>2024</year></date><date date-type="corrected-typeset"><day>28</day><month>12</month><year>2024</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2024. Published by Oxford University Press.</copyright-statement><copyright-year>2024</copyright-year><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="btae735.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Motivation</title><p>Much of prokaryotic comparative genomics currently relies on two critical computational tasks: pangenome inference and core genome inference. Pangenome inference involves clustering genes from a set of genomes into gene families, enabling genome-wide association studies and evolutionary history analysis. The core genome represents gene families present in nearly all genomes and is required to infer a high-quality phylogeny. For species-level datasets, fast pangenome inference tools have been developed. However, tools applicable to more diverse datasets are currently slow and scale poorly.</p></sec><sec id="s2"><title>Results</title><p>Here, we introduce SCARAP, a program containing three modules for comparative genomics analyses: a fast and scalable pangenome inference module, a direct core genome inference module, and a module for subsampling representative genomes. When benchmarked against existing tools, the SCARAP <monospace>pan</monospace> module proved up to an order of magnitude faster with comparable accuracy. The <monospace>core</monospace> module was validated by comparing its result against a core genome extracted from a full pangenome. The <monospace>sample</monospace> module demonstrated the rapid sampling of genomes with decreasing novelty. Applied to a dataset of over 31&#x02009;000 <italic toggle="yes">Lactobacillales</italic> genomes, SCARAP showcased its ability to derive a representative pangenome. Finally, we applied the novel concept of gene fixation frequency to this pangenome, showing that <italic toggle="yes">Lactobacillales</italic> genes that are prevalent but rarely fixate in species often encode bacteriophage functions.</p></sec><sec id="s3"><title>Availability and implementation</title><p>The SCARAP toolkit is publicly available at <ext-link xlink:href="https://github.com/swittouck/scarap" ext-link-type="uri">https://github.com/swittouck/scarap</ext-link>.</p></sec></abstract><funding-group><award-group award-type="grant"><funding-source>
<institution-wrap><institution>Foundation&#x02014;Flanders</institution></institution-wrap>
</funding-source></award-group><award-group award-type="grant"><funding-source>
<institution-wrap><institution>European Research Council</institution><institution-id institution-id-type="DOI">10.13039/100010663</institution-id></institution-wrap>
</funding-source><award-id>852600</award-id></award-group></funding-group><counts><page-count count="10"/></counts></article-meta></front><body><sec><title>1 Introduction</title><p>Comparative genomics helps us understand the functional diversity of prokaryotes. In addition, it allows us to reconstruct evolutionary history as well as the evolutionary process. Two computational tasks that are central to prokaryotic comparative genomics are pangenome inference and core genome inference. Pangenome inference entails the clustering of all (predicted) genes in a set of genomes into gene families, or orthogroups, with genes from the same gene family assumed to share a common function. The pangenome can be used to perform prokaryotic genome-wide association studies (GWAS), which examine whether one or more genes are associated with a phenotype or some other condition of interest (<xref rid="btae735-B13" ref-type="bibr">Falush 2016</xref>). The pangenome can also be used to infer functional associations between gene families (<xref rid="btae735-B40" ref-type="bibr">Whelan <italic toggle="yes">et al.</italic> 2020</xref>). Furthermore, the pangenome allows for the comprehensive study of the evolutionary history of a set of sequenced prokaryotic strains. For example, it can be used to infer a phylogenetic tree of the strains and to model gene gain and loss and horizontal transfers (<xref rid="btae735-B38" ref-type="bibr">Tria and Martin 2021</xref>). Finally, the pangenome can be used to calculate pairwise average nucleotide identity (ANI) values for a set of genomes since it informs us on which sequences are homologous and can therefore be compared.</p><p>Historically, pangenome inference has usually been implemented as a three-step process (<xref rid="btae735-B11" ref-type="bibr">Enright <italic toggle="yes">et al.</italic> 2002</xref>): (i) an all-versus-all comparison of all (predicted) genes in the genomes, (ii) the transformation of the resulting sequence comparison scores to correct for phylogenetic distance and other factors, and (iii) the application of a clustering algorithm on the transformed scores to obtain gene families. Because the all-versus-all gene comparison step scales quadratically with the total number of genes, this approach is very slow for larger datasets. For species-level datasets (i.e. sets of genomes belonging to the same species), faster and more scalable approaches have been developed (<xref rid="btae735-B25" ref-type="bibr">Page <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btae735-B36" ref-type="bibr">Tonkin-Hill <italic toggle="yes">et al.</italic> 2020</xref>). However, these tools are not applicable to genus-level datasets and higher taxonomic ranks.</p><p>The core genome is the fraction of the pangenome consisting of all gene families that are present in (almost) all genomes in the dataset in at least one copy. For some tasks in comparative genomics, the core genome is sufficient as input and the full pangenome is not needed; examples are the inference of a high-quality phylogeny (<xref rid="btae735-B28" ref-type="bibr">Parks <italic toggle="yes">et al.</italic> 2018</xref>) or population structure (<xref rid="btae735-B32" ref-type="bibr">Raj <italic toggle="yes">et al.</italic> 2014</xref>). In addition, the core genome can be leveraged for quality control of the genomes and more specifically, to calculate estimates of their completeness and contamination (<xref rid="btae735-B27" ref-type="bibr">Parks <italic toggle="yes">et al.</italic> 2015</xref>). It can also be used to calculate pairwise ANI values based on core genes only (cANI values), which has the advantage over traditional ANI values that all genome comparisons are based on the same set of genes (<xref rid="btae735-B42" ref-type="bibr">Wittouck <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae735-B43" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2020</xref>).</p><p>A core genome is usually determined in one of two approaches: either by inferring the full pangenome and then subsetting it to the core genes only (<xref rid="btae735-B4" ref-type="bibr">Coleman <italic toggle="yes">et al.</italic> 2021</xref>, <xref rid="btae735-B6" ref-type="bibr">de la Haba <italic toggle="yes">et al.</italic> 2023</xref>), or by searching the genomes with a set of sequences or profiles of pre-determined core genes (<xref rid="btae735-B28" ref-type="bibr">Parks <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btae735-B1" ref-type="bibr">Asnicar <italic toggle="yes">et al.</italic> 2020</xref>). Obviously, the former strategy suffers from the same scalability issues as full pangenome inference. The latter strategy is efficient, but it requires that core genes are known in advance and does not guarantee that the set of pre-determined core genes is complete. A tool for direct and <italic toggle="yes">de novo</italic> inference of the core genome is currently lacking.</p><p>A straightforward strategy to save computation time in comparative genomics analyses, is to apply the pipeline of interest to a representative subset of the genome dataset. While fast tools exist to dereplicate a genome dataset given a maximum genome similarity cutoff (<xref rid="btae735-B24" ref-type="bibr">Olm <italic toggle="yes">et al.</italic> 2017</xref>), a scalable approach for subsampling a given number of representative genomes does not exist yet, to the best of our knowledge. A way to perform such subsampling with currently available tools, would be to calculate a pairwise ANI matrix for the genomes, apply a clustering technique, and select one genome per cluster. The issue with this approach is that it again scales quadratically with the number of input genomes, due to the pairwise ANI calculation step. In addition to speeding up downstream analyses, representative subsampling can also help to reduce sampling bias in genome datasets, where particular species, lineages or even strains are often overrepresented.</p><p>In this work, we describe three tools aimed at enabling faster and more scalable comparative genomics of Bacteria and Archaea: first, a tool for fast and scalable full pangenome inference; second, a tool for direct and database-free core genome inference; and third, a tool for selecting a representative subset from a larger set of genomes. All tools work on datasets containing genomes from the same or from different species. The tools have been implemented in the SCARAP toolkit, which is publicly available at <ext-link xlink:href="https://github.com/swittouck/scarap" ext-link-type="uri">https://github.com/swittouck/scarap</ext-link>.</p></sec><sec><title>2 Materials and methods</title><sec><title>2.1 The SCARAP <monospace>pan</monospace> module</title><p>Given a set of proteomes, the SCARAP <monospace>pan</monospace> module infers a pangenome in two steps: a fast clustering of all amino acid sequences into &#x02018;superclusters,&#x02019; followed by the iterative binary splitting of each supercluster into orthogroups. The superclusters are created through two consecutive clustering operations using MMseqs2 (<xref rid="btae735-B34" ref-type="bibr">Steinegger and S&#x000f6;ding 2017</xref>, <xref rid="btae735-B35" ref-type="bibr">2018</xref>). The first clustering is the &#x02018;cascaded clustering&#x02019; procedure of MMseqs, as implemented in its <monospace>cluster</monospace> module. This results in what we call &#x02018;preclusters.&#x02019; A second, profile-based clustering step is then added for increased sensitivity. First, an alignment profile and a consensus sequence are created for each precluster. These are then compared in an all-versus-all fashion. Based on this comparison, the preclusters are clustered into superclusters.</p><p>The iterative binary splitting of a supercluster into orthogroups happens as follows. Each iteration starts with the selection of N (default: 32) representative sequences through our FICLIN algorithm (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Text S1</xref>). If the number of sequences is smaller than M (default: 512), all sequences are selected as representatives. Next, the representatives are aligned with MAFFT, a distance matrix is created from the alignment, and average-linkage hierarchical clustering is performed. The two top-level clusters are then determined and re-inflated with the full set of sequences by assigning sequences to the cluster of their closest representative. Finally, an assessment is made of the proposed binary split of the cluster. If the two subclusters are present in the same genome at least as often as under a null model where the division into subclusters is random, the split is accepted and the splitting process continues for each of the subclusters. If the two subclusters are less often present in the same genome than expected under the null model, the split is rejected and the cluster becomes a single orthogroup (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Text S1</xref> for a detailed description of the <monospace>pan</monospace> module).</p></sec><sec><title>2.2 The SCARAP core module</title><p>The SCARAP <monospace>core</monospace> module infers a core genome for a set of proteomes by first inferring the full pangenome of a random set of &#x0201c;seed genomes&#x0201d;. Specifically, the module follows four steps. The first step is the selection of a random subset of 100 seed genomes and the inference of their full pangenome using the <monospace>pan</monospace> module. The second step consists of the identification of candidate core genes as all gene families present in a single copy in at least 90% of the seed genomes, the creation of a multiple sequence alignment of these candidate core genes with MAFFT (<xref rid="btae735-B19" ref-type="bibr">Katoh and Standley 2013</xref>) and their conversion to alignment profiles with MMseqs2. In the third step, the profiles are searched against all seed genome amino acid sequences with MMseqs <monospace>search</monospace>. A score cutoff is then determined per profile as the mean of the scores of sequences belonging to the candidate core gene family and the scores of sequences not belonging to the gene family. The score cutoffs are then applied to re-determine which seed sequences belong to the candidate core genes. The final core genes are then selected as the candidate core genes with a single-copy presence in at least 95% of seed genomes. In the fourth and final step, the core gene profiles are searched against the non-seed genomes and the profile-specific score cutoffs are applied to identify their member sequences in these genomes.</p><p>The default values for the number of seed genomes, the minimum prevalence of candidate core genes, and the minimum prevalence of final core genes can all be changed by the user. In addition, an optional maximum number of final core genes can be requested.</p></sec><sec><title>2.3 The SCARAP sample module</title><p>Given a pre-identified core or pangenome for a set of input proteomes, the SCARAP <monospace>sample</monospace> module samples a requested number of genomes in a representative manner. Alternatively, the module can sample genomes until a requested maximum sequence identity between sampled genomes is reached. The sampling algorithm used is our FICLIN algorithm; the same algorithm that is used to select representative sequences during the splitting stage of the SCARAP <monospace>pan</monospace> module (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Text S1</xref>). Instead of using the sequence identity between individual sequences, as in the splitting stage of SCARAP pan, the algorithm here uses the ANI value between genomes, where different types of ANI values can be calculated. When the full pangenome of the genomes is supplied, the ANI between two genomes is calculated as the mean of the per-gene sequence identity values for all genes with a single copy in both the first and second genomes. When only the core genome is supplied, the resulting ANI will be a core-genome-ANI (cANI). Optionally, extreme per-gene identity values can be purged before calculating the mean. For example, setting the method argument to &#x02018;mean90&#x02019; will use only the middle 90% of per-gene sequence identity values to calculate the ANI.</p></sec><sec><title>2.4 Benchmarking of SCARAP</title><p>Six different datasets were used to benchmark and demonstrate the SCARAP <monospace>pan</monospace>, <monospace>core</monospace>, and <monospace>sample</monospace> modules. The SimPan dataset consisted of 100 genomes simulated <italic toggle="yes">de novo</italic> with the SimPan tool (<xref rid="btae735-B3" ref-type="bibr">Brown <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btae735-B44" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> 2020</xref>) using an nucleotide identity setting of 90% to represent a genus-level dataset. The Tonkin-Hill dataset was taken from <xref rid="btae735-B36" ref-type="bibr">Tonkin-Hill <italic toggle="yes">et al.</italic> (2020)</xref>; it was simulated using an <italic toggle="yes">Escherichia coli</italic> genome as a starting point and represents a sub-species-level population. The third dataset consisted of one representative genome per genus of the order <italic toggle="yes">Lactobacillales</italic> and was compiled as follows. From all public <italic toggle="yes">Lactobacillales</italic> genomes identified by the Genome Taxonomy Database (GTDB; <xref rid="btae735-B28" ref-type="bibr">Parks <italic toggle="yes">et al.</italic> 2018</xref>), release 207, the best-quality genome was selected for each genus. Here, quality was calculated as the estimated completeness minus estimated contamination value, as precalculated with the tool checkM (<xref rid="btae735-B27" ref-type="bibr">Parks <italic toggle="yes">et al.</italic> 2015</xref>) by the GTDB. These genomes were downloaded from GenBank (<xref rid="btae735-B33" ref-type="bibr">Sayers <italic toggle="yes">et al.</italic> 2022</xref>) and gene prediction and translation were performed with Prodigal (<xref rid="btae735-B17" ref-type="bibr">Hyatt <italic toggle="yes">et al.</italic> 2010</xref>).</p><p>The fourth dataset consisted of all publicly available genomes of the genus <italic toggle="yes">Lactiplantibacillus</italic>, again as defined by release 207 of the GTDB. Gene prediction was again performed with Prodigal. The fifth and sixth datasets were the OrthoBench dataset with 70 curated orthogroups from 12 eukaryotic genomes (<xref rid="btae735-B37" ref-type="bibr">Trachana <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btae735-B10" ref-type="bibr">Emms and Kelly 2020</xref>), and the paraBench dataset with 52 curated orthogroups from 17 eukaryotic genomes (<xref rid="btae735-B7" ref-type="bibr">Derelle <italic toggle="yes">et al.</italic> 2020</xref>).</p><p>The SCARAP <monospace>pan</monospace> module was benchmarked against four highly regarded pangenome tools: OrthoFinder (<xref rid="btae735-B8" ref-type="bibr">Emms and Kelly 2015</xref>, <xref rid="btae735-B9" ref-type="bibr">2019</xref>), SonicParanoid (<xref rid="btae735-B5" ref-type="bibr">Cosentino and Iwasaki 2019</xref>), Broccoli (<xref rid="btae735-B7" ref-type="bibr">Derelle <italic toggle="yes">et al.</italic> 2020</xref>), and PIRATE (<xref rid="btae735-B2" ref-type="bibr">Bayliss <italic toggle="yes">et al.</italic> 2019</xref>). OrthoFinder was tested both with BLAST and MMseqs2 as sequence search engines, while SonicParanoid was tested in its &#x02018;fast&#x02019; and &#x02018;sensitive&#x02019; modes. PIRATE can only be run on prokaryotic datasets so it was not applied to the OrthoBench and paraBench datasets. Tools were compared based on their speed and accuracy (precision, recall, and <italic toggle="yes">F</italic>-measure) on the SimPan, Tonkin-Hill, OrthoBench, and paraBench datasets and on their speed on the <italic toggle="yes">Lactobacillales</italic> dataset.</p><p>The SCARAP <monospace>core</monospace> module is meant to be a shortcut to the strategy of inferring the full pangenome and then subsetting it to core orthogroups only using an orthogroup prevalence threshold. Therefore, to assess the accuracy of the <monospace>core</monospace> module, we first ran the SCARAP <monospace>pan</monospace> module on the <italic toggle="yes">Lactiplantibacillus</italic> dataset. We then determined the reference core genome by applying a minimum single-copy prevalence of 95%. Next, we ran the SCARAP <monospace>core</monospace> module on the same dataset with the same threshold of 95% minimum single-copy prevalence. Finally, we compared this result against the reference core genome by calculating the precision, recall, and F-measure.</p><p>To demonstrate the SCARAP <monospace>sample</monospace> module, we ran it on the <italic toggle="yes">Lactiplantibacillus</italic> dataset using four types of ANI values: (i) the core genome ANI (cANI) using all core genes identified by the SCARAP <monospace>core</monospace> module, (ii) the cANI using a subset of 100 core genes, (iii) a trimmed cANI (tcANI) where the 5% genes with the lowest and highest sequence identity values for each genome comparison were removed, and (iv) the tcANI but using only 100 core genes. To assess the effect of using only 100 core genes, we calculated the Spearman correlations of cANI or tcANI values between the full core genome and the subset of 100 core genes.</p><p>We also explored the SCARAP genome sampling of the <italic toggle="yes">Lactiplantibacillus</italic> dataset in phylogenetic terms. First, we used the subset of 100 core orthogroups to create a nucleotide &#x02018;supermatrix&#x02019; with the SCARAP <monospace>concat</monospace> module. This module removes all gene copies from genomes with more than one copy of a core gene, aligns the core genes on the amino acid level with MAFFT, replaces the amino acid sequences with the corresponding nucleotide sequences in the alignments, and concatenates the nucleotide alignments together horizontally. We then inferred a maximum likelihood phylogeny with IQ-TREE (<xref rid="btae735-B23" ref-type="bibr">Nguyen <italic toggle="yes">et al.</italic> 2015</xref>), with the general time reversible (GTR) nucleotide substitution model and with among-site rate heterogeneity modelled as a discretized gamma distribution with four rate categories (G4). We then explored the first ten genomes sampled using tcANI distances based on 100 core genes by inferring &#x02018;ancestor discoveries.&#x02019; Each sampled genome implies the discovery of the most recent common ancestor of the sampled genome and the most closely related genome already sampled. Intuitively, a good sampling process discovers older ancestors before more recent ones.</p></sec><sec><title>2.5 Creation of a pangenome database for <italic toggle="yes">Lactobacillales</italic></title><p>To demonstrate how the SCARAP modules can be combined to gain novel insights from a large-scale genome dataset, we inferred and explored a pangenome for the order <italic toggle="yes">Lactobacillales</italic>. First, all publicly available genomes of <italic toggle="yes">Lactobacillales</italic> were identified from release 207 of the GTDB. We noticed that some species had received an sp.-identifier from the GTDB (e.g. <italic toggle="yes">Streptococcus</italic> sp001937065) but had validly published species names (e.g. <italic toggle="yes">Streptococcus caviae</italic>); we replaced these sp-identifiers with the published species names by cross-referencing the strain names of these genomes with the LPSN list of type strains, version 2023-03-23 (<xref rid="btae735-B12" ref-type="bibr">Euz&#x000e9;by 1997</xref>, <xref rid="btae735-B29" ref-type="bibr">Parte <italic toggle="yes">et al.</italic> 2020</xref>). Next, we downloaded all genomes from GenBank and performed gene prediction with Prodigal.</p><p>We then aimed to representatively subset these genomes. We first selected the GTDB representative genome from each species and inferred their pangenome with SCARAP <monospace>pan</monospace>. Next, we created multiple sequence alignments for 100 (largely) single-copy core genes from this pangenome with the SCARAP <monospace>build</monospace> module and identified these genes in all genomes with the SCARAP <monospace>search</monospace> module. We then used these core genes to run the SCARAP <monospace>sample</monospace> module on each species, for all genomes with an overall quality score of at least 90%. We sampled genomes in such a way that (i) all sampled genomes had a tcANI of maximum 99.99% to each other and (ii) maximum 100 genomes were sampled per species.</p><p>Finally, we inferred the full pangenome of the representative genomes with SCARAP <monospace>pan</monospace>. To estimate species-level core genes, we performed a joint maximum-likelihood optimization of orthogroup prevalence values and genome completeness values; see <xref rid="sup1" ref-type="supplementary-material">Supplementary Text S2</xref>.</p></sec><sec><title>2.6 Availability of code and data</title><p>SCARAP is available at <ext-link xlink:href="https://github.com/swittouck/scarap" ext-link-type="uri">https://github.com/swittouck/scarap</ext-link>. The SCARAP benchmarking code and results are available at <ext-link xlink:href="https://github.com/swittouck/benchmark-scarap" ext-link-type="uri">https://github.com/swittouck/benchmark-scarap</ext-link>. The code and data of the <italic toggle="yes">Lactobacillales</italic> representative pangenome are available at <ext-link xlink:href="https://github.com/swittouck/legen" ext-link-type="uri">https://github.com/swittouck/legen</ext-link>. Finally, the code for the creation of figures and tables in this work is available at <ext-link xlink:href="https://github.com/swittouck/pangenome-toolkit" ext-link-type="uri">https://github.com/swittouck/pangenome-toolkit</ext-link>.</p><p>An overview of all software used can be found in <xref rid="btae735-T1" ref-type="table">Table&#x000a0;1</xref>.</p><table-wrap position="float" id="btae735-T1"><label>Table 1.</label><caption><p>Overview of software used.</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1">Software</th><th rowspan="1" colspan="1">Version</th><th rowspan="1" colspan="1">Reference</th></tr></thead><tbody><tr><td colspan="3" rowspan="1">
<italic toggle="yes">Pangenome tools</italic>
</td></tr><tr><td rowspan="1" colspan="1">Broccoli</td><td rowspan="1" colspan="1">v1.1</td><td rowspan="1" colspan="1">
<xref rid="btae735-B7" ref-type="bibr">Derelle <italic toggle="yes">et al.</italic> (2020)</xref>
</td></tr><tr><td rowspan="1" colspan="1">OrthoFinder</td><td rowspan="1" colspan="1">v2.5.2</td><td rowspan="1" colspan="1">
<xref rid="btae735-B8" ref-type="bibr">Emms and Kelly (2015</xref>, <xref rid="btae735-B9" ref-type="bibr">2019</xref>)</td></tr><tr><td rowspan="1" colspan="1">PIRATE</td><td rowspan="1" colspan="1">v1.0.5</td><td rowspan="1" colspan="1">
<xref rid="btae735-B2" ref-type="bibr">Bayliss <italic toggle="yes">et al.</italic> (2019)</xref>
</td></tr><tr><td rowspan="1" colspan="1">SCARAP</td><td rowspan="1" colspan="1">v1.0.0</td><td rowspan="1" colspan="1">This work</td></tr><tr><td rowspan="1" colspan="1">SonicParanoid</td><td rowspan="1" colspan="1">v1.3.8</td><td rowspan="1" colspan="1">
<xref rid="btae735-B5" ref-type="bibr">Cosentino and Iwasaki (2019)</xref>
</td></tr><tr><td colspan="3" rowspan="1">
<italic toggle="yes">SCARAP dependencies</italic>
</td></tr><tr><td rowspan="1" colspan="1">Biopython</td><td rowspan="1" colspan="1">v1.79</td><td rowspan="1" colspan="1">biopython.org</td></tr><tr><td rowspan="1" colspan="1">ETE Toolkit</td><td rowspan="1" colspan="1">v3.1.3</td><td rowspan="1" colspan="1">
<xref rid="btae735-B16" ref-type="bibr">Huerta-Cepas <italic toggle="yes">et al.</italic> (2016)</xref>
</td></tr><tr><td rowspan="1" colspan="1">MAFFT</td><td rowspan="1" colspan="1">v7.525</td><td rowspan="1" colspan="1">
<xref rid="btae735-B19" ref-type="bibr">Katoh and Standley (2013)</xref>
</td></tr><tr><td rowspan="1" colspan="1">MMseqs2</td><td rowspan="1" colspan="1">release15</td><td rowspan="1" colspan="1">
<xref rid="btae735-B34" ref-type="bibr">Steinegger and S&#x000f6;ding (2017</xref>, <xref rid="btae735-B35" ref-type="bibr">2018</xref>)</td></tr><tr><td rowspan="1" colspan="1">Numpy</td><td rowspan="1" colspan="1">v1.20.2</td><td rowspan="1" colspan="1">
<xref rid="btae735-B15" ref-type="bibr">Harris <italic toggle="yes">et al.</italic> (2020)</xref>
</td></tr><tr><td rowspan="1" colspan="1">Pandas</td><td rowspan="1" colspan="1">v1.3.5</td><td rowspan="1" colspan="1">
<xref rid="btae735-B39" ref-type="bibr">Wes McKinney (2010)</xref>
</td></tr><tr><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">
<xref rid="btae735-B36" ref-type="bibr">The pandas&#x000a0;development team (2020)</xref>
</td></tr><tr><td rowspan="1" colspan="1">Python</td><td rowspan="1" colspan="1">v3.7.12</td><td rowspan="1" colspan="1">
<ext-link xlink:href="http://www.python.org" ext-link-type="uri">www.python.org</ext-link>
</td></tr><tr><td rowspan="1" colspan="1">SciPy</td><td rowspan="1" colspan="1">v1.7.3</td><td rowspan="1" colspan="1">
<ext-link xlink:href="http://www.scipy.org" ext-link-type="uri">www.scipy.org</ext-link>
</td></tr><tr><td colspan="3" rowspan="1">
<italic toggle="yes">Preparation of genome datasets</italic>
</td></tr><tr><td rowspan="1" colspan="1">GenomeTools</td><td rowspan="1" colspan="1">v1.6.2</td><td rowspan="1" colspan="1">
<xref rid="btae735-B14" ref-type="bibr">Gremme <italic toggle="yes">et al.</italic> (2013)</xref>
</td></tr><tr><td rowspan="1" colspan="1">Proclasp</td><td rowspan="1" colspan="1">v1.0</td><td rowspan="1" colspan="1">github.com/swittouck/proclasp</td></tr><tr><td rowspan="1" colspan="1">Prodigal</td><td rowspan="1" colspan="1">v2.6.3</td><td rowspan="1" colspan="1">
<xref rid="btae735-B17" ref-type="bibr">Hyatt <italic toggle="yes">et al.</italic> (2010)</xref>
</td></tr><tr><td rowspan="1" colspan="1">SimPan</td><td rowspan="1" colspan="1">v0.1</td><td rowspan="1" colspan="1">
<xref rid="btae735-B3" ref-type="bibr">Brown <italic toggle="yes">et al.</italic> (2016)</xref>, <xref rid="btae735-B44" ref-type="bibr">Zhou <italic toggle="yes">et al.</italic> (2020)</xref></td></tr><tr><td colspan="3" rowspan="1">
<italic toggle="yes">Demonstration of SCARAP core module</italic>
</td></tr><tr><td rowspan="1" colspan="1">IQ-TREE</td><td rowspan="1" colspan="1">v1.6.12</td><td rowspan="1" colspan="1">
<xref rid="btae735-B23" ref-type="bibr">Nguyen <italic toggle="yes">et al.</italic> (2015)</xref>
</td></tr><tr><td rowspan="1" colspan="1">iTol</td><td rowspan="1" colspan="1">v7</td><td rowspan="1" colspan="1">
<xref rid="btae735-B20" ref-type="bibr">Letunic and Bork (2021)</xref>
</td></tr><tr><td colspan="3" rowspan="1">
<italic toggle="yes">Table processing and visualization</italic>
</td></tr><tr><td rowspan="1" colspan="1">ggpubr</td><td rowspan="1" colspan="1">v0.4.0</td><td rowspan="1" colspan="1">
<xref rid="btae735-B18" ref-type="bibr">Kassambara (2023)</xref>
</td></tr><tr><td rowspan="1" colspan="1">R</td><td rowspan="1" colspan="1">v4.3.3</td><td rowspan="1" colspan="1">
<xref rid="btae735-B31" ref-type="bibr">R Core Team (2024)</xref>
</td></tr><tr><td rowspan="1" colspan="1">tidyverse</td><td rowspan="1" colspan="1">v2.0.0</td><td rowspan="1" colspan="1">
<xref rid="btae735-B41" ref-type="bibr">Wickham <italic toggle="yes">et al.</italic> (2019)</xref>
</td></tr></tbody></table></table-wrap></sec></sec><sec><title>3 Results and discussion</title><sec><title>3.1 The SCARAP pan module is fast and accurate</title><p>With the goal of making fast pangenome inference possible not only for the species and genus levels but also for more diverse prokaryotic datasets, we designed a computational tool that can handle up to thousands of genomes overnight on a modern computational system. This tool was implemented as the <monospace>pan</monospace> module of the SCARAP toolkit. The module was benchmarked against four other popular, user-friendly pangenome tools that are applicable on datasets above the genus level: OrthoFinder (<xref rid="btae735-B8" ref-type="bibr">Emms and Kelly 2015</xref>, <xref rid="btae735-B9" ref-type="bibr">2019</xref>), SonicParanoid (<xref rid="btae735-B5" ref-type="bibr">Cosentino and Iwasaki 2019</xref>), Brocolli (<xref rid="btae735-B7" ref-type="bibr">Derelle <italic toggle="yes">et al.</italic> 2020</xref>), and PIRATE (<xref rid="btae735-B2" ref-type="bibr">Bayliss <italic toggle="yes">et al.</italic> 2019</xref>).</p><p>The SCARAP <monospace>pan</monospace> parameters were optimized on a dataset with representative genomes of 1,083 <italic toggle="yes">Lactobacillales</italic> species (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1</xref> and <xref rid="sup1" ref-type="supplementary-material">S2</xref>). Based on these optimizations, 32 was chosen as the default number of representative sequences to use in iterative orthogroup splitting and 512 as the default maximum number of sequences to align. When this limit is exceeded, representatives are selected and aligned (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Text S1</xref>). Next, SCARAP was benchmarked on prokaryotic datasets of moderate size, to allow all tools to finish in reasonable time. All tools performed well on two simulated datasets (Simpan and Tonkin-Hill), with <italic toggle="yes">F</italic>-measures consistently above 99% (<xref rid="btae735-F1" ref-type="fig">Fig.&#x000a0;1A and C</xref>). SCARAP was the fastest tool, taking 10 times less time than the second fastest tool (PIRATE) for the SimPan dataset and two times less time on the Tonkin-Hill dataset (<xref rid="btae735-F1" ref-type="fig">Fig.&#x000a0;1B and D</xref>). It should be noted that the reported <italic toggle="yes">F</italic>-measures are likely overestimates compared to nonsimulated datasets: the correctness of a pangenome prediction depends not only on the inference process itself but also on upstream steps such as genome sequencing, genome assembly and gene prediction (<xref rid="btae735-B22" ref-type="bibr">Marin <italic toggle="yes">et al.</italic> 2024</xref>). The values reported here only serve the purpose of comparing different pangenome tools relative to one another.</p><fig position="float" id="btae735-F1"><label>Figure 1.</label><caption><p>Benchmark of the SCARAP pan module. (A) Accuracy on the SimPan dataset. (B) Speed on the SimPan dataset. (C) Accuracy on the Tonkin-Hill dataset. (D) Speed on the Tonkin-Hill dataset. (E) Accuracy on the lacto-genusreps dataset. Abbreviation: SCO, single-copy core orthogroup. (F) Speed on the lacto-genusreps dataset.</p></caption><graphic xlink:href="btae735f1" position="float"/></fig><p>In order to test SCARAP <monospace>pan</monospace> on a nonsimulated, diverse datset, we selected one publicly available genome per genus of the order <italic toggle="yes">Lactobacillales</italic>, for a total of 97 genomes. Lacking a reference pangenome to compare results to, we used the number of recovered single-copy core orthogroups (SCOs) as a rough estimate of pangenome quality. With 347 SCOs, SCARAP performed similarly to most other tools, with only PIRATE standing out on the low end with only 211 SCOs (<xref rid="btae735-F1" ref-type="fig">Fig.&#x000a0;1E</xref>). In terms of speed, SCARAP was 10 times faster than the second fastest tool, SonicParanoid in fast mode (<xref rid="btae735-F1" ref-type="fig">Fig.&#x000a0;1F</xref>).</p><p>To the best of our knowledge, no non-simulated prokaryotic dataset exists with a known reference pangenome. However, two such datasets do exist for eukaryotic genomes. On the OrthoBench dataset (<xref rid="btae735-B37" ref-type="bibr">Trachana <italic toggle="yes">et al.</italic> 2011</xref>, <xref rid="btae735-B10" ref-type="bibr">Emms and Kelly 2020</xref>), SCARAP was the fastest but had a slightly lower <italic toggle="yes">F</italic>-measure than the other tools (60% versus 67%&#x02013;73%, respectively, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3A</xref> and <xref rid="sup1" ref-type="supplementary-material">B</xref>). On the paraBench dataset (<xref rid="btae735-B7" ref-type="bibr">Derelle <italic toggle="yes">et al.</italic> 2020</xref>), SCARAP achieved the second most accurate result with an <italic toggle="yes">F</italic>-measure of 80%, being tied for speed with SonicParanoid in fast mode (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3C</xref> and <xref rid="sup1" ref-type="supplementary-material">D</xref>).</p><p>In conclusion, primarily on prokaryotic datasets, SCARAP <monospace>pan</monospace> achieves similar accuracy to alternative pangenome tools while running significantly faster, especially for datasets spanning multiple species.</p></sec><sec><title>3.2 The SCARAP core module rapidly identifies core genes</title><p>We implemented a direct core genome inference strategy, circumventing full pangenome inference, in the <monospace>core</monospace> module of SCARAP. To test this module, we ran it on a dataset of 720 genomes of the genus <italic toggle="yes">Lactiplantibacillus</italic>, using the default single-copy core prevalence threshold of 95%. This resulted in the identification of 2093 core genes in 11&#x02009;min.</p><p>To verify the accuracy of the <monospace>core</monospace> module, we ran the SCARAP <monospace>pan</monospace> module on the same genome dataset, which took 67&#x02009;min. We next identified core genes in the resulting pangenome by applying the same 95% single-copy prevalence threshold as used by the <monospace>core</monospace> module. We then mapped the core orthogroups inferred by both modules to one another: if orthogroups from the two modules shared at least one gene copy in at least 95% of genomes, we considered them &#x02018;the same orthogroup. This mapping allowed us to calculate precision and recall measures of the <monospace>core</monospace> module, by considering the core orthogroups identified by the <monospace>pan</monospace> module as a reference. The precision and recall values were 91.8% and 95.8%, respectively (<xref rid="btae735-T2" ref-type="table">Table&#x000a0;2</xref>). Thus, the <monospace>core</monospace> module proved to be a fast shortcut that can be used to obtain a set of single-copy core genes that is very similar to the one that would be obtained from the <monospace>pan</monospace> module.</p><table-wrap position="float" id="btae735-T2"><label>Table 2.</label><caption><p>Benchmark of the SCARAP core module<xref rid="tblfn1" ref-type="table-fn"><sup>a</sup></xref></p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="center" span="1"/></colgroup><tbody><tr><td rowspan="1" colspan="1">SCOs from core module</td><td rowspan="1" colspan="1">2093</td></tr><tr><td rowspan="1" colspan="1">SCOs from pan module</td><td rowspan="1" colspan="1">2006</td></tr><tr><td rowspan="1" colspan="1">SCOs from both modules</td><td rowspan="1" colspan="1">1921</td></tr><tr><td rowspan="1" colspan="1">Precision of core module</td><td rowspan="1" colspan="1">91.8%</td></tr><tr><td rowspan="1" colspan="1">Recall of core module</td><td rowspan="1" colspan="1">95.8%</td></tr><tr><td rowspan="1" colspan="1">
<italic toggle="yes">F</italic>-measure of core module</td><td rowspan="1" colspan="1">93.7%</td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><label>a</label><p>Comparison of the SCARAP core module output to the core genome determined by taking the single-copy core genes from the output of the pan module. Abbreviation: SCO, single-copy core orthogroup.</p></fn></table-wrap-foot></table-wrap></sec><sec><title>3.3 The SCARAP sample module subsamples genomes in linear time</title><p>For pangenome inference on the largest datasets, even the SCARAP <monospace>pan</monospace> module may take too much time. We therefore also developed the SCARAP <monospace>sample</monospace> module: a tool that can rapidly subsample genomes from a larger dataset in a representative manner, given a predetermined set of core genes. The subsampling algorithm we implemented has linear time complexity, as a function of the number of genomes to sample if the total number of genomes remains constant, or vice versa. This means that the <monospace>sample</monospace> module will be very fast for small subsample sizes (e.g. sampling 100 representative genomes from a dataset with 10&#x02002;000 genomes), but slow for subsample sizes that approach the total size of the genome dataset. To test the SCARAP <monospace>sample</monospace> module, we ran it on the 720 <italic toggle="yes">Lactiplantibacillus</italic> genomes, using their core genome inferred by the SCARAP <monospace>core</monospace> module. This took 3&#x02009;h and 13&#x02009;min, or approximately 16&#x02009;s per sampled genome. It is important to point out here that we sampled all genomes for demonstration purposes but in practical applications, the <monospace>sample</monospace> module will be used to sample a given number of genomes. On our dataset, subsampling the first 10 <italic toggle="yes">Lactiplantibacillus</italic> genomes took 160&#x02009;s.</p><p>To visualize the sampling process, we plotted the &#x02018;novelty curve&#x0201d; of the sampled genomes. We define novelty as the distance (one minus the cANI) of a genome to the closest genome that was already sampled. The higher this distance, the more novel the sampled genome compared to genomes already in the sample. As expected, the novelty of sampled genomes is strictly decreasing during the sampling process (<xref rid="btae735-F2" ref-type="fig">Fig.&#x000a0;2A</xref>, top left). SCARAP allows the user to set the number of genomes to sample, or to set an ANI threshold at which to stop sampling.</p><fig position="float" id="btae735-F2"><label>Figure 2.</label><caption><p>Demonstration of the SCARAP sample module. (A) Novelty curves of sampling genomes using all single-copy core genes (SCOs) versus a subset of 100 SCOs, without trimming genes with the smallest and largest identity values (cANI) and with trimming of such genes (tcANI). (B) Correlation between the cANI calculated from the full core genome and from 100 core genes and the same correlation but for tcANI. In (B), each point represents an independent comparison between two genomes.</p></caption><graphic xlink:href="btae735f2" position="float"/></fig><p>To test whether the sampling can be made even faster, we also ran the sampling process using only a subset of 100 core genes. With this reduced core gene set, it took 12&#x02009;min and 20&#x02009;s to sample all genomes, or 1.03&#x02009;s per genome. This increased speed came at the cost of some loss in resolution, whereas the cANI values based on the full core genome yielded 43 genomes with a novelty of zero (i.e. genomes whose core gene sequences are identical to those of genomes already sampled), the cANI values based on 100 core genes (cANIsub values) led to 248 genomes (34.4%) with a novelty of zero (<xref rid="btae735-F2" ref-type="fig">Fig.&#x000a0;2A</xref>, top right, points at the very bottom of the plot). This reveals that the use of a smaller number of core genes comes at the cost of reduced resolution: very closely related genomes can no longer be distinguished.</p><p>The cANIsub should be strongly correlated to the full cANI in order to be useful. Therefore, we assessed the correlation between the cANI and cANIsub by computing both measures for a set of independent genome comparisons. The result showed a clear correlation between the two, but it was not as strong as expected (<xref rid="btae735-F2" ref-type="fig">Fig.&#x000a0;2B</xref>, left side; Spearman correlation of 93.1%). We hypothesized that this lack of a stronger correlation was caused by &#x02018;outlier genes&#x02019;: genes with a much lower gene-specific ANI than most of the other core genes. Such outlier genes would have a strong impact on the cANI value but would not necessarily be sampled for the cANIsub computation.</p><p>To test our outlier gene hypothesis, we computed a trimmed version of the cANI measure (tcANI), where 5% of the genes with the lowest and highest ANI values are removed before cANI computation, effectively removing any outlier genes that are present. For the tcANI, the correlation between its value calculated from the full core genome and from 100 core genes was much stronger (<xref rid="btae735-F2" ref-type="fig">Fig.&#x000a0;2B</xref>, right side; Spearman correlation of 97.9%). This confirmed our hypothesis that outlier genes have a strong impact on the classical ANI measure and that the tcANI is a way to reduce this impact. We therefore recommend the use of this trimming procedure in ANI calculations, with the only disadvantage being a slight reduction in resolution (<xref rid="btae735-F2" ref-type="fig">Fig.&#x000a0;2A</xref>, bottom left and right).</p><p>The strength of the <monospace>sample</monospace> module is that it can be used for very rapid sampling of a (small) subset of the total number of genomes. To illustrate this sampling process in phylogenetic terms, we plotted the sampling order of the first 10 sampled genomes of <italic toggle="yes">Lactiplantibacillus</italic> next to a phylogenomic tree of these genomes. In a phylogenetically representative sampling process, older ancestors (internal nodes) are discovered before more recent ancestors. For our sampling, this was the case for eight out of the nine &#x0201c;ancestor discoveries&#x0201d; implied by the sampling order of the first ten genomes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). This shows that the <monospace>sample</monospace> module can be used to obtain a sample of genomes that is close to a phylogenetically representative sample, without the need to actually construct a phylogeny.</p></sec><sec><title>3.4 Application of SCARAP on a large dataset of <italic toggle="yes">Lactobacillales</italic> genomes</title><p>The SCARAP <monospace>pan</monospace> module was benchmarked on a relatively small dataset to allow other pangenome tools to finish in a realistic timeframe. However, the main aim of SCARAP is to allow pangenome analysis for datasets that are taxonomically diverse but also very large. To demonstrate how the SCARAP modules can be combined to process such datasets, we applied the <monospace>core</monospace>, <monospace>sample</monospace>, and <monospace>pan</monospace> modules to infer a representative pangenome for over 31&#x02002;000 genomes of the order <italic toggle="yes">Lactobacillales</italic>. First, we downloaded all 31 801 high-quality genome assemblies that represent strains of <italic toggle="yes">Lactobacillales</italic> according to the Genome Taxonomy Database (<xref rid="btae735-B28" ref-type="bibr">Parks <italic toggle="yes">et al.</italic> 2018</xref>), belonging to 1 040 different species. Next, we extracted 100 core genes from these assemblies and used them to representatively subsample a maximum of 100 genomes per species. In the subsampling process, we also applied a threshold of maximum 99.99% tcANI between sampled genomes, ensuring no two sampled genomes were more similar than this threshold. The result was a set of 6 715 representative genomes. Finally, we inferred the pangenome of the subsampled genome dataset. The resulting pangenome consisted of 93 512 orthogroups.</p><p>Our <italic toggle="yes">Lactobacillales</italic> pangenome contained genomes from different species, and in many cases multiple genomes belonging to the same species. This feature of the dataset allows the exploration of some unique aspects of pangenome structure. One illustration is an investigation of the orthogroup fixation frequency, which we define as the proportion of species where the orthogroup is part of the species-level core genome relative to the number of species where the orthogroup is part of the species-level pangenome (i.e. present in at least one genome of the species). A fixation frequency of 100% indicates that an orthogroup is &#x02018;core&#x02019; in all species where it is present (<xref rid="btae735-F3" ref-type="fig">Fig.&#x000a0;3A and B</xref>). However, it does not necessarily mean that the orthogroup is present in all of the species; only that it is either part of the core genome of a species or fully absent.</p><fig position="float" id="btae735-F3"><label>Figure 3.</label><caption><p>Exploration of the pangenome of <italic toggle="yes">Lactobacillales</italic>. (A) Schematic illustration of an orthogroup with a fixation frequency of 100%. (B) Schematic illustration of an orthogroup with a fixation frequency of 0%. (C) Histogram of fixation frequencies. Fill color represents the number of species where an orthogroup is present in at least one genome.</p></caption><graphic xlink:href="btae735f3" position="float"/></fig><p>To study the fixation frequency of <italic toggle="yes">Lactobacillales</italic> orthogroups, we first subsetted the pangenome to the 119 species with at least 10 genomes available and to the 8903 orthogroups present in the pangenome of at least 10 such species. We then calculated the fixation frequency of each orthogroup. This analysis revealed a bimodal distribution of the fixation frequency of orthogroups. On one end of the distribution, 11.4% of orthogroups had a fixation frequency of at least 95% (<xref rid="btae735-F3" ref-type="fig">Fig.&#x000a0;3C</xref>). This is not surprising; these are the genes that are conserved because of their essential function. However, 32.6% of orthogroups had a fixation frequency lower than 5%. This is striking, given that we considered only orthogroups present in at least 10 species.</p><p>We see three possible explanations for why so many orthogroups would have a low fixation frequency. A first explanation could be frequent between-species horizontal gene transfer. This process would generate an abundance of recently gained genes within genomes that have not yet had the time to be purged from or fixated in their species. Second, many orthogroups could be under negative frequency-dependent selection, meaning that they confer a larger fitness advantage when they are rare (<xref rid="btae735-B21" ref-type="bibr">Levin <italic toggle="yes">et al.</italic> 1988</xref>). A known example is restriction&#x02013;modification systems that confer immunity against phages; the rarer the system, the smaller the chance that it encounters phages that have evolved to evade the system. Finally, orthogroups could be part of the machinery of mobile elements like prophages and conjugative elements. Such genes spread because of the transfer mechanisms they encode, but there is no selection pressure for them to be retained in their prokaryotic host and thus become part of the core genome.</p><p>We hypothesized that the most extreme examples of low-fixation-frequency orthogroups would encode mobility machinery components. To test our hypothesis, we selected the top 10 orthogroups in the <italic toggle="yes">Lactobacillales</italic> pangenome that had a fixation frequency below 5% and were present in the largest number of species (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). We determined the potential functions of these orthogroups by searching them on the InterPro database (<xref rid="btae735-B30" ref-type="bibr">Paysan-Lafosse <italic toggle="yes">et al.</italic> 2023</xref>) using representative sequences. For seven of these orthogroups, we found a match with an InterPro gene family. Six of these were gene families known to be bacteriophage specific, providing some support for the idea that the most extreme nonfixating orthogroups are related to mobile genetic elements.</p></sec></sec><sec><title>4 Conclusions</title><p>In this work, we demonstrated that the SCARAP toolkit enables rapid core- and pangenome analysis of large, multi-species prokaryotic datasets with reliable results. In addition, we illustrated that the toolkit can be leveraged to gain novel evolutionary insights from multi-species datasets. Specifically, an exploration of the fixation frequency of <italic toggle="yes">Lactobacillales</italic> orthogroups revealed a surprisingly large number of orthogroups with a fixation frequency close to zero, with the most extreme cases often being associated with phage-related functions.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="sup1" position="float" content-type="local-data"><label>btae735_Supplementary_Data</label><media xlink:href="btae735_supplementary_data.zip"/></supplementary-material></sec></body><back><ack id="ack1"><title>Acknowledgements</title><p>The authors acknowledge the kind support of Tim Van Rillaer, who contributed user-friendliness and efficiency updates to SCARAP.</p></ack><sec><title>Supplementary data</title><p>
<xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p><p>Conflict of interest: None declared.</p></sec><sec><title>Funding</title><p>The authors acknowledge the following funding agencies and institutions: the Research Foundation&#x02014;Flanders (FWO), which currently supports S.W. as postdoctoral fellow fundamental research (file number 12AZ624N); the University of Antwerp (UAntwerp), which recently supported S.W. as postdoctoral fellow (project ID 48145); the Inter-University Special Research Fund of Flanders (iBOF), which also recently supported S.W. as postdoctoral fellow (POSSIBL project) and the European Research Council (ERC), which supports S.L. as principal investigator and supports T.E. (starting grant Lacto-Be, grant ID 852600).</p></sec><ref-list id="ref1"><title>References</title><ref id="btae735-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Asnicar</surname>
<given-names>F</given-names>
</string-name>, <string-name><surname>Thomas</surname><given-names>AM</given-names></string-name>, <string-name><surname>Beghini</surname><given-names>F</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Precise phylogenetic analysis of microbial isolates and genomes from metagenomes using PhyloPhlAn 3.0</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>2500</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-020-16366-7</pub-id><pub-id pub-id-type="pmid">32427907</pub-id>
</mixed-citation></ref><ref id="btae735-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Bayliss</surname>
<given-names>SC</given-names>
</string-name>, <string-name><surname>Thorpe</surname><given-names>HA</given-names></string-name>, <string-name><surname>Coyle</surname><given-names>NM</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>PIRATE: a fast and scalable pangenomics toolbox for clustering diverged orthologues in bacteria</article-title>. <source>Gigascience</source><year>2019</year>;<volume>8</volume>:<fpage>giz119</fpage>. <pub-id pub-id-type="doi">10.1093/gigascience/giz119</pub-id>.<pub-id pub-id-type="pmid">31598686</pub-id>
</mixed-citation></ref><ref id="btae735-B3"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Brown</surname>
<given-names>T</given-names>
</string-name>, <string-name><surname>Didelot</surname><given-names>X</given-names></string-name>, <string-name><surname>Wilson</surname><given-names>DJ</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>SimBac: simulation of whole bacterial genomes with homologous recombination</article-title>. <source>Microb Genom</source><year>2016</year>;<volume>2</volume>:<fpage>e000044</fpage>. <pub-id pub-id-type="doi">10.1099/mgen.0.000044</pub-id>.<pub-id pub-id-type="pmid">27713837</pub-id>
</mixed-citation></ref><ref id="btae735-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Coleman</surname>
<given-names>GA</given-names>
</string-name>, <string-name><surname>Dav&#x000ed;n</surname><given-names>AA</given-names></string-name>, <string-name><surname>Mahendrarajah</surname><given-names>TA</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>A rooted phylogeny resolves early bacterial evolution</article-title>. <source>Science</source><year>2021</year>;<volume>372</volume>:<fpage>eabe0511</fpage>. <pub-id pub-id-type="doi">10.1126/science.abe0511</pub-id><pub-id pub-id-type="pmid">33958449</pub-id>
</mixed-citation></ref><ref id="btae735-B5"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Cosentino</surname>
<given-names>S</given-names>
</string-name>, <string-name><surname>Iwasaki</surname><given-names>W.</given-names></string-name></person-group>
<article-title>SonicParanoid: fast, accurate and easy orthology inference</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>149</fpage>&#x02013;<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty631</pub-id><pub-id pub-id-type="pmid">30032301</pub-id>
</mixed-citation></ref><ref id="btae735-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>de la Haba</surname>
<given-names>RR</given-names>
</string-name>, <string-name><surname>Arahal</surname><given-names>DR</given-names></string-name>, <string-name><surname>S&#x000e1;nchez-Porro</surname><given-names>C</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>A long-awaited taxogenomic investigation of the family halomonadaceae</article-title>. <source>Front Microbiol</source><year>2023</year>;<volume>14</volume>:<fpage>1293707</fpage>. <pub-id pub-id-type="doi">10.3389/fmicb.2023.1293707</pub-id><pub-id pub-id-type="pmid">38045027</pub-id>
</mixed-citation></ref><ref id="btae735-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Derelle</surname>
<given-names>R</given-names>
</string-name>, <string-name><surname>Philippe</surname><given-names>H</given-names></string-name>, <string-name><surname>Colbourne</surname><given-names>JK.</given-names></string-name></person-group>
<article-title>Broccoli: combining phylogenetic and network analyses for orthology assignment</article-title>. <source>Mol Biol Evol</source><year>2020</year>;<volume>37</volume>:<fpage>3389</fpage>&#x02013;<lpage>96</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msaa159</pub-id><pub-id pub-id-type="pmid">32602888</pub-id>
</mixed-citation></ref><ref id="btae735-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Emms</surname>
<given-names>DM</given-names>
</string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group>
<article-title>OrthoFinder: solving fundamental biases in whole genome comparisons dramatically improves orthogroup inference accuracy</article-title>. <source>Genome Biol</source><year>2015</year>;<volume>16</volume>:<fpage>157</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-015-0721-2</pub-id><pub-id pub-id-type="pmid">26243257</pub-id>
</mixed-citation></ref><ref id="btae735-B9"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Emms</surname>
<given-names>DM</given-names>
</string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group>
<article-title>OrthoFinder: phylogenetic orthology inference for comparative genomics</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>238</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-019-1832-y</pub-id><pub-id pub-id-type="pmid">31727128</pub-id>
</mixed-citation></ref><ref id="btae735-B10"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Emms</surname>
<given-names>DM</given-names>
</string-name>, <string-name><surname>Kelly</surname><given-names>S.</given-names></string-name></person-group>
<article-title>Benchmarking orthogroup inference accuracy: revisiting orthobench</article-title>. <source>Genome Biol Evol</source><year>2020</year>;<volume>12</volume>:<fpage>2258</fpage>&#x02013;<lpage>66</lpage>. <pub-id pub-id-type="doi">10.1093/gbe/evaa211</pub-id><pub-id pub-id-type="pmid">33022036</pub-id>
</mixed-citation></ref><ref id="btae735-B11"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Enright</surname>
<given-names>AJ</given-names>
</string-name>, <string-name><surname>Van Dongen</surname><given-names>S</given-names></string-name>, <string-name><surname>Ouzounis</surname><given-names>CA.</given-names></string-name></person-group>
<article-title>An efficient algorithm for large-scale detection of protein families</article-title>. <source>Nucleic Acids Res</source><year>2002</year>;<volume>30</volume>:<fpage>1575</fpage>&#x02013;<lpage>84</lpage>. <pub-id pub-id-type="doi">10.1093/nar/30.7.1575</pub-id><pub-id pub-id-type="pmid">11917018</pub-id>
</mixed-citation></ref><ref id="btae735-B12"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Euz&#x000e9;by</surname>
<given-names>JP.</given-names>
</string-name>
</person-group>
<article-title>List of bacterial names with standing in nomenclature: a folder available on the internet</article-title>. <source>Int J Syst Bacteriol</source><year>1997</year>;<volume>47</volume>:<fpage>590</fpage>&#x02013;<lpage>2</lpage>. <pub-id pub-id-type="doi">10.1099/00207713-47-2-590</pub-id><pub-id pub-id-type="pmid">9103655</pub-id>
</mixed-citation></ref><ref id="btae735-B13"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Falush</surname>
<given-names>D.</given-names>
</string-name>
</person-group>
<article-title>Bacterial genomics: microbial GWAS coming of age</article-title>. <source>Nat Microbiol</source><year>2016</year>;<volume>1</volume>:<fpage>16059</fpage>. <pub-id pub-id-type="doi">10.1038/nmicrobiol.2016.59</pub-id><pub-id pub-id-type="pmid">27572652</pub-id>
</mixed-citation></ref><ref id="btae735-B14"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Gremme</surname>
<given-names>G</given-names>
</string-name>, <string-name><surname>Steinbiss</surname><given-names>S</given-names></string-name>, <string-name><surname>Kurtz</surname><given-names>S.</given-names></string-name></person-group>
<article-title>GenomeTools: a comprehensive software library for efficient processing of structured genome annotations</article-title>. <source>IEEE/ACM Trans Comput Biol Bioinform</source><year>2013</year>;<volume>10</volume>:<fpage>645</fpage>&#x02013;<lpage>56</lpage>. <pub-id pub-id-type="doi">10.1109/TCBB.2013.68</pub-id><pub-id pub-id-type="pmid">24091398</pub-id>
</mixed-citation></ref><ref id="btae735-B15"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Harris</surname>
<given-names>CR</given-names>
</string-name>, <string-name><surname>Millman</surname><given-names>KJ</given-names></string-name>, <string-name><surname>van der Walt</surname><given-names>SJ</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Array programming with NumPy</article-title>. <source>Nature</source><year>2020</year>;<volume>585</volume>:<fpage>357</fpage>&#x02013;<lpage>62</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id><pub-id pub-id-type="pmid">32939066</pub-id>
</mixed-citation></ref><ref id="btae735-B16"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Huerta-Cepas</surname>
<given-names>J</given-names>
</string-name>, <string-name><surname>Serra</surname><given-names>F</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group>
<article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title>. <source>Mol Biol Evol</source><year>2016</year>;<volume>33</volume>:<fpage>1635</fpage>&#x02013;<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msw046</pub-id><pub-id pub-id-type="pmid">26921390</pub-id>
</mixed-citation></ref><ref id="btae735-B17"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Hyatt</surname>
<given-names>D</given-names>
</string-name>, <string-name><surname>Chen</surname><given-names>G-L</given-names></string-name>, <string-name><surname>LoCascio</surname><given-names>PF</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>. <source>BMC Bioinform</source><year>2010</year>;<volume>11</volume>:<fpage>119</fpage>. <pub-id pub-id-type="doi">10.1186/1471-2105-11-119</pub-id></mixed-citation></ref><ref id="btae735-B18"><mixed-citation publication-type="other">
<person-group person-group-type="author">
<string-name>
<surname>Kassambara</surname>
<given-names>A.</given-names>
</string-name>
</person-group>
<italic toggle="yes">ggpubr: &#x02018;ggplot2&#x02019; based publication ready plots</italic>. R package version 0.6.0. <year>2023</year>. <pub-id pub-id-type="doi">10.32614/CRAN.package.ggpubr</pub-id></mixed-citation></ref><ref id="btae735-B19"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Katoh</surname>
<given-names>K</given-names>
</string-name>, <string-name><surname>Standley</surname><given-names>DM.</given-names></string-name></person-group>
<article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source><year>2013</year>;<volume>30</volume>:<fpage>772</fpage>&#x02013;<lpage>80</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id><pub-id pub-id-type="pmid">23329690</pub-id>
</mixed-citation></ref><ref id="btae735-B20"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Letunic</surname>
<given-names>I</given-names>
</string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group>
<article-title>Interactive tree of life (iTOL) v5: an online tool for phylogenetic tree display and annotation</article-title>. <source>Nucleic Acids Res</source><year>2021</year>;<volume>49</volume>:<fpage>W293</fpage>&#x02013;<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkab301</pub-id><pub-id pub-id-type="pmid">33885785</pub-id>
</mixed-citation></ref><ref id="btae735-B21"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Levin</surname>
<given-names>BR</given-names>
</string-name>, <string-name><surname>Antonovics</surname><given-names>J</given-names></string-name>, <string-name><surname>Sharma</surname><given-names>H</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Frequency-dependent selection in bacterial populations</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source><year>1988</year>;<volume>319</volume>:<fpage>459</fpage>&#x02013;<lpage>72</lpage>. <pub-id pub-id-type="doi">10.1098/rstb.1988.0059</pub-id><pub-id pub-id-type="pmid">2905487</pub-id>
</mixed-citation></ref><ref id="btae735-B22"><mixed-citation publication-type="other">
<person-group person-group-type="author">
<string-name>
<surname>Marin</surname>
<given-names>MG</given-names>
</string-name>, <string-name><surname>Wippel</surname><given-names>C</given-names></string-name>, <string-name><surname>Quinones-Olvera</surname><given-names>N</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Analysis of the limited <italic toggle="yes">M. tuberculosis</italic> accessory genome reveals potential pitfalls of pan-genome analysis approaches</article-title>. bioRxiv, <pub-id pub-id-type="doi">10.1101/2024.03.21.586149</pub-id>, <year>2024</year>, preprint: not peer reviewed.</mixed-citation></ref><ref id="btae735-B23"><mixed-citation publication-type="other">
<person-group person-group-type="author">
<string-name>
<surname>McKinney</surname>
<given-names>W.</given-names>
</string-name>
</person-group> Data structures for statistical computing in Python. In: van der Walt S, Millman J (eds.), <italic toggle="yes">Proceedings of the 9th Python in Science Conference</italic>, Austin, TX. pp. <fpage>56</fpage>&#x02013;<lpage>61</lpage>, <year>2010</year>. <pub-id pub-id-type="doi">10.25080/Majora-92bf1922-00a</pub-id></mixed-citation></ref><ref id="btae735-B24"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Nguyen</surname>
<given-names>L-T</given-names>
</string-name>, <string-name><surname>Schmidt</surname><given-names>HA</given-names></string-name>, <string-name><surname>von Haeseler</surname><given-names>A</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>IQ-TREE: a fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</article-title>. <source>Mol Biol Evol</source><year>2015</year>;<volume>32</volume>:<fpage>268</fpage>&#x02013;<lpage>74</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msu300</pub-id><pub-id pub-id-type="pmid">25371430</pub-id>
</mixed-citation></ref><ref id="btae735-B25"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Olm</surname>
<given-names>MR</given-names>
</string-name>, <string-name><surname>Brown</surname><given-names>CT</given-names></string-name>, <string-name><surname>Brooks</surname><given-names>B</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>DRep: a tool for fast and accurate genomic comparisons that enables improved genome recovery from metagenomes through de-replication</article-title>. <source>ISME J</source><year>2017</year>;<volume>11</volume>:<fpage>2864</fpage>&#x02013;<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1038/ismej.2017.126</pub-id><pub-id pub-id-type="pmid">28742071</pub-id>
</mixed-citation></ref><ref id="btae735-B26"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Page</surname>
<given-names>AJ</given-names>
</string-name>, <string-name><surname>Cummins</surname><given-names>CA</given-names></string-name>, <string-name><surname>Hunt</surname><given-names>M</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Roary: rapid large-scale prokaryote pan genome analysis</article-title>. <source>Bioinformatics</source><year>2015</year>;<volume>31</volume>:<fpage>3691</fpage>&#x02013;<lpage>3</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv421</pub-id><pub-id pub-id-type="pmid">26198102</pub-id>
</mixed-citation></ref><ref id="btae735-B27"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Parks</surname>
<given-names>DH</given-names>
</string-name>, <string-name><surname>Imelfort</surname><given-names>M</given-names></string-name>, <string-name><surname>Skennerton</surname><given-names>CT</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>CheckM: assessing the quality of microbial genomes recovered from isolates, single cells, and metagenomes</article-title>. <source>Genome Res</source><year>2015</year>;<volume>25</volume>:<fpage>1043</fpage>&#x02013;<lpage>55</lpage>. <pub-id pub-id-type="doi">10.1101/gr.186072.114</pub-id><pub-id pub-id-type="pmid">25977477</pub-id>
</mixed-citation></ref><ref id="btae735-B28"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Parks</surname>
<given-names>DH</given-names>
</string-name>, <string-name><surname>Chuvochina</surname><given-names>M</given-names></string-name>, <string-name><surname>Waite</surname><given-names>DW</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>:<fpage>996</fpage>&#x02013;<lpage>1004</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.4229</pub-id><pub-id pub-id-type="pmid">30148503</pub-id>
</mixed-citation></ref><ref id="btae735-B29"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Parte</surname>
<given-names>AC</given-names>
</string-name>, <string-name><surname>Sard&#x000e0; Carbasse</surname><given-names>J</given-names></string-name>, <string-name><surname>Meier-Kolthoff</surname><given-names>JP</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>List of prokaryotic names with standing in nomenclature (LPSN) moves to the DSMZ</article-title>. <source>Int J Syst Evol Microbiol</source><year>2020</year>;<volume>70</volume>:<fpage>5607</fpage>&#x02013;<lpage>12</lpage>. <pub-id pub-id-type="doi">10.1099/ijsem.0.004332</pub-id><pub-id pub-id-type="pmid">32701423</pub-id>
</mixed-citation></ref><ref id="btae735-B30"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Paysan-Lafosse</surname>
<given-names>T</given-names>
</string-name>, <string-name><surname>Blum</surname><given-names>M</given-names></string-name>, <string-name><surname>Chuguransky</surname><given-names>S</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>InterPro in 2022</article-title>. <source>Nucleic Acids Res</source><year>2023</year>;<volume>51</volume>:<fpage>D418</fpage>&#x02013;<lpage>27</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkac993</pub-id><pub-id pub-id-type="pmid">36350672</pub-id>
</mixed-citation></ref><ref id="btae735-B31"><mixed-citation publication-type="other">
<collab>R Core Team</collab>. <italic toggle="yes">R: A Language and Environment for Statistical Computing</italic>. Vienna, Austria: R Foundation for Statistical Computing, <year>2024</year>.</mixed-citation></ref><ref id="btae735-B32"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Raj</surname>
<given-names>A</given-names>
</string-name>, <string-name><surname>Stephens</surname><given-names>M</given-names></string-name>, <string-name><surname>Pritchard</surname><given-names>JK.</given-names></string-name></person-group>
<article-title>FastSTRUCTURE: variational inference of population structure in large SNP data sets</article-title>. <source>Genetics</source><year>2014</year>;<volume>197</volume>:<fpage>573</fpage>&#x02013;<lpage>89</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.114.164350</pub-id><pub-id pub-id-type="pmid">24700103</pub-id>
</mixed-citation></ref><ref id="btae735-B33"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Sayers</surname>
<given-names>EW</given-names>
</string-name>, <string-name><surname>Bolton</surname><given-names>EE</given-names></string-name>, <string-name><surname>Brister</surname><given-names>JR</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Database resources of the national center for biotechnology information</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>D20</fpage>&#x02013;<lpage>6</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkab1112</pub-id><pub-id pub-id-type="pmid">34850941</pub-id>
</mixed-citation></ref><ref id="btae735-B34"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Steinegger</surname>
<given-names>M</given-names>
</string-name>, <string-name><surname>S&#x000f6;ding</surname><given-names>J.</given-names></string-name></person-group>
<article-title>MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets</article-title>. <source>Nat Biotechnol</source><year>2017</year>;<volume>35</volume>:<fpage>1026</fpage>&#x02013;<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1038/nbt.3988</pub-id><pub-id pub-id-type="pmid">29035372</pub-id>
</mixed-citation></ref><ref id="btae735-B35"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Steinegger</surname>
<given-names>M</given-names>
</string-name>, <string-name><surname>S&#x000f6;ding</surname><given-names>J.</given-names></string-name></person-group>
<article-title>Clustering huge protein sequence sets in linear time</article-title>. <source>Nat Commun</source><year>2018</year>;<volume>9</volume>:<fpage>2542</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-018-04964-5</pub-id><pub-id pub-id-type="pmid">29959318</pub-id>
</mixed-citation></ref><ref id="btae735-B36"><mixed-citation publication-type="book">
<collab>The pandas development team</collab>. pandas-dev/pandas: Pandas, February <year>2020</year>. 10.5281/zenodo.3509134</mixed-citation></ref><ref id="btae735-B37"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Tonkin-Hill</surname>
<given-names>G</given-names>
</string-name>, <string-name><surname>MacAlasdair</surname><given-names>N</given-names></string-name>, <string-name><surname>Ruis</surname><given-names>C</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Producing polished prokaryotic pangenomes with the Panaroo pipeline</article-title>. <source>Genome Biol</source><year>2020</year>;<volume>21</volume>:<fpage>180</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-020-02090-4</pub-id><pub-id pub-id-type="pmid">32698896</pub-id>
</mixed-citation></ref><ref id="btae735-B38"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Trachana</surname>
<given-names>K</given-names>
</string-name>, <string-name><surname>Larsson</surname><given-names>TA</given-names></string-name>, <string-name><surname>Powell</surname><given-names>S</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Orthology prediction methods: a quality assessment using curated protein families</article-title>. <source>Bioessays</source><year>2011</year>;<volume>33</volume>:<fpage>769</fpage>&#x02013;<lpage>80</lpage>. <pub-id pub-id-type="doi">10.1002/bies.201100062</pub-id><pub-id pub-id-type="pmid">21853451</pub-id>
</mixed-citation></ref><ref id="btae735-B39"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Tria</surname>
<given-names>FDK</given-names>
</string-name>, <string-name><surname>Martin</surname><given-names>WF.</given-names></string-name></person-group>
<article-title>Gene duplications are at least 50 times less frequent than gene transfers in prokaryotic genomes</article-title>. <source>Genome Biol Evol</source><year>2021</year>;<volume>13</volume>:<fpage>evab224</fpage>. <pub-id pub-id-type="doi">10.1093/gbe/evab224</pub-id>.<pub-id pub-id-type="pmid">34599337</pub-id>
</mixed-citation></ref><ref id="btae735-B40"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Whelan</surname>
<given-names>FJ</given-names>
</string-name>, <string-name><surname>Rusilowicz</surname><given-names>M</given-names></string-name>, <string-name><surname>McInerney</surname><given-names>JO.</given-names></string-name></person-group>
<article-title>Coinfinder: detecting significant associations and dissociations in pangenomes</article-title>. <source>Microb Genom</source><year>2020</year>;<volume>6</volume>:<fpage>e000338</fpage>. <pub-id pub-id-type="doi">10.1099/mgen.0.000338</pub-id><pub-id pub-id-type="pmid">32100706</pub-id>
</mixed-citation></ref><ref id="btae735-B41"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Wickham</surname>
<given-names>H</given-names>
</string-name>, <string-name><surname>Averick</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryan</surname><given-names>J</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Welcome to the tidyverse</article-title>. <source>JOSS</source><year>2019</year>;<volume>4</volume>:<fpage>1686</fpage>. <pub-id pub-id-type="doi">10.21105/joss.01686</pub-id></mixed-citation></ref><ref id="btae735-B42"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Wittouck</surname>
<given-names>S</given-names>
</string-name>, <string-name><surname>Wuyts</surname><given-names>S</given-names></string-name>, <string-name><surname>Meehan</surname><given-names>CJ</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>A genome-based species taxonomy of the <italic toggle="yes">Lactobacillus</italic> genus complex</article-title>. <source>mSystems</source><year>2019</year>;<volume>4</volume>:<fpage>e00264-19</fpage>. <pub-id pub-id-type="doi">10.1128/mSystems.00264-19</pub-id></mixed-citation></ref><ref id="btae735-B43"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Zheng</surname>
<given-names>J</given-names>
</string-name>, <string-name><surname>Wittouck</surname><given-names>S</given-names></string-name>, <string-name><surname>Salvetti</surname><given-names>E</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>A taxonomic note on the genus <italic toggle="yes">Lactobacillus</italic>: description of 23 novel genera, emended description of the genus <italic toggle="yes">Lactobacillus beijerinck</italic> 1901, and union of <italic toggle="yes">Lactobacillaceae</italic> and <italic toggle="yes">Leuconostocaceae</italic></article-title>. <source>Int J Syst Evol Microbiol</source><year>2020</year>;<volume>70</volume>:<fpage>2782</fpage>&#x02013;<lpage>858</lpage>. <pub-id pub-id-type="doi">10.1099/ijsem.0.004107</pub-id><pub-id pub-id-type="pmid">32293557</pub-id>
</mixed-citation></ref><ref id="btae735-B44"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Zhou</surname>
<given-names>Z</given-names>
</string-name>, <string-name><surname>Charlesworth</surname><given-names>J</given-names></string-name>, <string-name><surname>Achtman</surname><given-names>M.</given-names></string-name></person-group>
<article-title>Accurate reconstruction of bacterial pan- and core genomes with PEPPAN</article-title>. <source>Genome Res</source><year>2020</year>;<volume>30</volume>:<fpage>1667</fpage>&#x02013;<lpage>79</lpage>. <pub-id pub-id-type="doi">10.1101/gr.260828.120</pub-id><pub-id pub-id-type="pmid">33055096</pub-id>
</mixed-citation></ref></ref-list></back></article>