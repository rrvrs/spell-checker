<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="en" article-type="research-article"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS One</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-title-group><journal-title>PLOS One</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmid">40408423</article-id><article-id pub-id-type="pmc">PMC12101645</article-id><article-id pub-id-type="doi">10.1371/journal.pone.0324868</article-id><article-id pub-id-type="publisher-id">PONE-D-25-03811</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Physiological Parameters</subject><subj-group><subject>Body Weight</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Neural Networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural Networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied Mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Machine Learning Algorithms</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Simulation and Modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Machine Learning Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Artificial Intelligence</subject><subj-group><subject>Machine Learning</subject><subj-group><subject>Machine Learning Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Amniotes</subject><subj-group><subject>Reptiles</subject><subj-group><subject>Iguanas</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Zoology</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Amniotes</subject><subj-group><subject>Reptiles</subject><subj-group><subject>Iguanas</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Artificial Intelligence</subject><subj-group><subject>Machine Learning</subject><subj-group><subject>Support Vector Machines</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Population Biology</subject><subj-group><subject>Population Metrics</subject><subj-group><subject>Population Size</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Science Policy</subject><subj-group><subject>Open Science</subject><subj-group><subject>Open Data</subject></subj-group></subj-group></subj-group></article-categories><title-group><article-title>A lithium-ion batteries SOH estimation method based on extracting new features during the constant voltage charging stage and improving BPNN</article-title><alt-title alt-title-type="running-head">SOH estimation method based on feature extraction during the CV charging stage and improved BPNN</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Xian</surname><given-names>Yanhua</given-names></name><role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role><role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role><role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing &#x02013; original draft</role><xref rid="aff001" ref-type="aff">
<sup>1</sup>
</xref><xref rid="aff002" ref-type="aff">
<sup>2</sup>
</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0009-0002-2189-8406</contrib-id><name><surname>Li</surname><given-names>Mingyang</given-names></name><role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role><role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role><role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing &#x02013; original draft</role><role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing &#x02013; review &#x00026; editing</role><xref rid="aff001" ref-type="aff">
<sup>1</sup>
</xref><xref rid="aff002" ref-type="aff">
<sup>2</sup>
</xref><xref rid="cor001" ref-type="corresp">*</xref></contrib><contrib contrib-type="author"><name><surname>Huang</surname><given-names>Jiayin</given-names></name><role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role><role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role><xref rid="aff001" ref-type="aff">
<sup>1</sup>
</xref><xref rid="aff002" ref-type="aff">
<sup>2</sup>
</xref></contrib></contrib-group><aff id="aff001"><label>1</label>
<addr-line>Guangxi Key Laboratory of Brain-inspired Computing and Intelligent Chips, School of Electronic and Information Engineering, Guangxi Normal University, Guilin, China</addr-line></aff><aff id="aff002"><label>2</label>
<addr-line>Key Laboratory of Nonlinear Circuits and Optical Communications (Guangxi Normal University), Education Department of Guangxi Zhuang Autonomous Region, Guilin, China</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Zhao</surname><given-names>Zhibin</given-names></name><role>Editor</role><xref rid="edit1" ref-type="aff"/></contrib></contrib-group><aff id="edit1">
<addr-line>Xi'an Jiaotong University, CHINA</addr-line>
</aff><author-notes><fn fn-type="COI-statement" id="coi001"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><corresp id="cor001">* E-mail: <email>2498406037@qq.com</email></corresp></author-notes><pub-date pub-type="epub"><day>23</day><month>5</month><year>2025</year></pub-date><pub-date pub-type="collection"><year>2025</year></pub-date><volume>20</volume><issue>5</issue><elocation-id>e0324868</elocation-id><history><date date-type="received"><day>22</day><month>1</month><year>2025</year></date><date date-type="accepted"><day>1</day><month>5</month><year>2025</year></date></history><permissions><copyright-statement>&#x000a9; 2025 Xian et al</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Xian et al</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0324868.pdf">
</self-uri><abstract><p>Existing state of health (SOH) estimation methods for lithium-ion batteries predominantly extract health features (HF) from constant current (CC) and constant voltage (CV) charging phases. Nevertheless, CC charging phase feature extraction is susceptible to the randomness of the initial charging stage. By contrast, data during the constant voltage (CV) charging stage are preserved intact. The complexity and noise interference of battery data make it difficult to accurately extract health features, and it is necessary to develop effective methods to process the data and extract representative features. In response to this issue, this paper proposes an SOH estimation method for extracting HF at the end of the CV charging stage and optimizes the Backpropagation Neural Network (BPNN). Firstly, the current curve during the CV charging stage was transformed into the differential current curve (dQ/dI curve), from which two HFs were extracted. Secondly, addressing the issue of weight and threshold initialization in BPNN, the Coati Optimization Algorithm (COA) was employed to optimize the network (COA-BPNN). Finally, validation was conducted using two publicly available datasets. The experimental results demonstrate that the proposed method exhibits high accuracy in estimating the SOH of batteries under various environmental temperatures and charging rate conditions. Compared with the traditional BPNN method, the COA-BPNN method reduces the maximum root mean square error and average absolute error of the estimated results to 0.22% and 0.16%, respectively.</p></abstract><funding-group><award-group id="award001"><funding-source>
<institution-wrap><institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001809</institution-id><institution>National Natural Science Foundation of China</institution></institution-wrap>
</funding-source><award-id>6197022931</award-id><principal-award-recipient>
<name><surname>Xian</surname><given-names>Yanhua</given-names></name>
</principal-award-recipient></award-group><funding-statement>National Natural Science Foundation, China (6197022931). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><fig-count count="5"/><table-count count="3"/><page-count count="15"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>All relevant data are within the paper and its <xref rid="sec017" ref-type="sec">Supporting Information</xref> files.</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>All relevant data are within the paper and its <xref rid="sec017" ref-type="sec">Supporting Information</xref> files.</p></notes></front><body><sec sec-type="intro" id="sec001"><title>Introduction</title><p>Lithium-ion batteries require a Battery Management System (BMS) with functions such as fault diagnosis, power management control, safety, and health status estimation to fully utilize their performance characteristics [<xref rid="pone.0324868.ref001" ref-type="bibr">1</xref>,<xref rid="pone.0324868.ref002" ref-type="bibr">2</xref>]. SOH is a critical parameter for lifecycle faults and safety warnings of lithium-ion batteries, reflecting the degree of battery aging and performance degradation [<xref rid="pone.0324868.ref003" ref-type="bibr">3</xref>]. The more precise the estimation of battery SOH, the more assured the safe and reliable operation of lithium-ion batteries [<xref rid="pone.0324868.ref004" ref-type="bibr">4</xref>].</p><p>In recent years, two main approaches to predicting battery SOH have emerged: model-based and data-driven methods. Significant progress has been made in improving the accuracy and stability of predictions using these approaches. Model-based approaches primarily represent battery physical and chemical structures using mathematical equations [<xref rid="pone.0324868.ref005" ref-type="bibr">5</xref>,<xref rid="pone.0324868.ref006" ref-type="bibr">6</xref>]. Tran et al. [<xref rid="pone.0324868.ref007" ref-type="bibr">7</xref>] proposed a comprehensive equivalent circuit model (ECM) that considers the influence of battery SOH, state of charge, and temperature on model parameters. Once the ECM&#x02019;s parameters are determined, they can be combined with filtering algorithms to achieve accurate SOH estimation. Ning et al. [<xref rid="pone.0324868.ref008" ref-type="bibr">8</xref>] constructed an adaptive battery model that accurately reflects the actual characteristics of batteries under various operating conditions. Model-based approaches have some limitations, including the complexity of model selection and the high dependency on the accuracy of model parameters.</p><p>In contrast, data-driven methods can evaluate battery SOH based on available external input parameters without relying on precise mechanistic models. Therefore, previous studies have widely adopted a variety of typical machine learning algorithms, including support vector machine (SVM) [<xref rid="pone.0324868.ref009" ref-type="bibr">9</xref>], relevance vector regression [<xref rid="pone.0324868.ref010" ref-type="bibr">10</xref>], and Gaussian process regression [<xref rid="pone.0324868.ref011" ref-type="bibr">11</xref>]. Additionally, various neural network models have been widely applied to battery SOH estimation, such as BPNN [<xref rid="pone.0324868.ref012" ref-type="bibr">12</xref>], long short-term memory neural networks [<xref rid="pone.0324868.ref013" ref-type="bibr">13</xref>] and convolutional neural networks [<xref rid="pone.0324868.ref014" ref-type="bibr">14</xref>] have also been utilized for battery SOH estimation. BPNN is a nonlinear model-based method that can exploit a system&#x02019;s underlying correlations through small-sample training when information about the nonlinear system is unknown. However, it also encounters issues regarding parameter initialization [<xref rid="pone.0324868.ref015" ref-type="bibr">15</xref>]. Guo et al. [<xref rid="pone.0324868.ref016" ref-type="bibr">16</xref>] proposed a method for obtaining the weights and thresholds of BPNN using the Sparrow Search Algorithm (SSA). Zhang et al. [<xref rid="pone.0324868.ref017" ref-type="bibr">17</xref>] optimized the weights and thresholds of BPNN by combining the Firefly Algorithm and applied the model&#x02019;s predicted outputs to the K-means algorithm for clustering. However, integrating multiple algorithms may lead to relatively complex models, which could increase the demand for computational resources. In the recent rise of Physical Information Neural Network (PINN) research, scholars have devoted themselves to combining physical laws with neural networks, providing new ideas and methods for battery health state estimation. PINN incorporates physical equations as soft constraints into the loss function of neural networks, allowing the network to not only learn statistical laws of data during training, but also follow physical laws, thereby improving the accuracy and generalization ability of the model. Relevant scholars have achieved significant research results in this field [<xref rid="pone.0324868.ref018" ref-type="bibr">18</xref>].</p><p>To ensure the accuracy of battery SOH estimation, selecting appropriate HFs and employing rational machine learning or deep learning algorithms is equally important. In recent years, numerous researchers have focused on extracting HFs at different stages of battery charging, such as constant-current (CC) charging, constant-voltage (CV) charging, and constant-current discharging. Due to road conditions and car driving&#x02019;s power demand-side response, battery discharge process data is uncertain [<xref rid="pone.0324868.ref013" ref-type="bibr">13</xref>], so HFs are usually extracted from the charging process. Features extractable during the CC charging stage include CC charging duration [<xref rid="pone.0324868.ref019" ref-type="bibr">19</xref>,<xref rid="pone.0324868.ref020" ref-type="bibr">20</xref>], geometric characteristics of the voltage curve [<xref rid="pone.0324868.ref021" ref-type="bibr">21</xref>,<xref rid="pone.0324868.ref022" ref-type="bibr">22</xref>], and charging capacity within voltage intervals [<xref rid="pone.0324868.ref023" ref-type="bibr">23</xref>]. Features extractable during the CV charging stage include CV charging duration [<xref rid="pone.0324868.ref024" ref-type="bibr">24</xref>], charging capacity [<xref rid="pone.0324868.ref025" ref-type="bibr">25</xref>], as well as charging current and differential current [<xref rid="pone.0324868.ref026" ref-type="bibr">26</xref>,<xref rid="pone.0324868.ref027" ref-type="bibr">27</xref>].</p><p>Although the estimation above methods based on HFs can yield relatively ideal battery SOH estimation results, they are hardly applicable in practical situations due to various influencing factors, such as the requirement for complete discharge or charge of the battery, which is almost impractical. Most users tend to charge the battery before it is fully depleted, resulting in a strong randomness in the initial charging stage [<xref rid="pone.0324868.ref028" ref-type="bibr">28</xref>]. Therefore, HFs extracted during the CC charging stage may lead to inaccurate estimation of battery SOH. In contrast, charging data during the CV charging stage are fully preserved and remain unaffected by the randomness of the initial charging stage. Wang et al. [<xref rid="pone.0324868.ref029" ref-type="bibr">29</xref>] proposed a novel HF based on the CV charging stage to estimate battery SOH under incomplete charging cycle conditions, but it requires the construction of complex equivalent circuit models. Ko et al. [<xref rid="pone.0324868.ref030" ref-type="bibr">30</xref>] introduced the differential current curve (dQ/dI curve) during the CV charging stage and utilized it to reflect the battery&#x02019;s health status. However, the investigation into battery SOH estimation in this study remains limited. Due to the varied charging habits among users, it is often difficult to precisely determine the initial stage of the charging process. However, most users tend to charge the battery to a State of Charge (SOC) of 100% [<xref rid="pone.0324868.ref029" ref-type="bibr">29</xref>]. With the rapid development of the electric vehicle industry, significant progress has been made in fast charging technology for lithium-ion batteries. This technology reduces the time required to charge the battery to full capacity and thereby enhances the user charging experience [<xref rid="pone.0324868.ref031" ref-type="bibr">31</xref>,<xref rid="pone.0324868.ref032" ref-type="bibr">32</xref>].</p><p>To address the issues above, this study proposes a lithium-ion batteries SOH extraction method by extracting HF at the end of the CV charging stage and improving BPNN. It aims to ensure the stability of the HF extraction process and the accuracy of the estimation results. The main contributions of this paper are as follows:</p><list list-type="simple"><list-item><p>(1) This study pioneers a novel method for lithium-ion battery health feature extraction within the 200mA threshold during the terminal phase of CV charging;</p></list-item><list-item><p>(2) The initialization of weights and thresholds of BPNN is optimized using COA to enhance the stability of the network;</p></list-item><list-item><p>(3) Two publicly available datasets are used for validation, and the universality of SOH estimation is discussed. Experimental results demonstrate that the proposed method performs well on batteries at different temperatures and charging rates.</p></list-item></list></sec><sec id="sec002"><title>Data analysis and feature extraction</title><sec id="sec003"><title>Battery datasets</title><p>This study validates the effectiveness of the proposed methods using the commercial 18650 battery datasets NCM and NCA provided in reference [<xref rid="pone.0324868.ref033" ref-type="bibr">33</xref>]. The battery is represented as CYX-Y/Z#N, where X represents temperature, Y represents charge C-rate, Z represents discharge C-rate, and N is the battery label. The study focuses on utilizing the following battery label from the datasets: CY35-0.5/1#1, CY35-0.5/1#2, CY45-0.5/1#9, CY45-0.5/1#10 from the NCM dataset, and CY25-0.25/1#1, CY25-0.25/1#2 from the NCA dataset. The batteries in the NCM dataset are charged at a constant current rate of 0.5C until the cut-off voltage of 4.2V is reached. Subsequently, they are maintained at a constant voltage of 4.2V until the current reaches 0.05C. The distinction lies in the ambient temperatures: batteries #1 and #2 operate at 35&#x000b0;C, while batteries #9 and #10 operate at 45&#x000b0;C. The NCA dataset batteries are charged at a constant current rate of 0.25C, with an ambient temperature of 25&#x000b0;C. The current sampling rate during the constant voltage charging stage for these batteries is 10s.</p></sec><sec id="sec004"><title>dQ/dI curve</title><p><xref rid="pone.0324868.g001" ref-type="fig">Fig 1a</xref> illustrates the current variation curve of lithium-ion batteries during the constant voltage charging stage at different cycle counts. It is observed that with an increase in cycle counts, the required time gradually prolongs, indicating a significant correlation between the current during the constant voltage charging stage and the battery&#x02019;s SOH. This study employs analysis using the dQ/dI curve to more accurately extract the battery&#x02019;s aging characteristics. According to <xref rid="pone.0324868.e001" ref-type="disp-formula">Eq. 1</xref>, I/(dI/dt) (or dQ/dI) represents the ratio of the charging current to its decay rate. Ref. [<xref rid="pone.0324868.ref030" ref-type="bibr">30</xref>] assigned a clear physical meaning to this curve through an equivalent circuit model, further establishing its effectiveness and rationality in battery aging analysis.</p><fig position="float" id="pone.0324868.g001"><object-id pub-id-type="doi">10.1371/journal.pone.0324868.g001</object-id><label>Fig 1</label><caption><title>Analysis of raw current data and dQ/dI curve.</title><p>(a) Current variation curves of battery CY45-0.5/1#9 in different cycles (b) dQ/dI curve of battery CY45-0.5/1#9 in different cycles.</p></caption><graphic xlink:href="pone.0324868.g001" position="float"/></fig><disp-formula id="pone.0324868.e001">
<alternatives><graphic xlink:href="pone.0324868.e001.jpg" id="pone.0324868.e001g" position="anchor"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">Q</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">Q</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">I</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mo>/</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives>
<label>(1)</label>
</disp-formula><p>Transforming the original current curve of the constant voltage charging stage into the dQ/dI curve mainly involves the following three steps:</p><p>Step 1: According to the current integration <xref rid="pone.0324868.e002" ref-type="disp-formula">Eq. 2</xref>, convert the current-time relationship in the original constant voltage charging stage into a capacity-time relationship;</p><disp-formula id="pone.0324868.e002">
<alternatives><graphic xlink:href="pone.0324868.e002.jpg" id="pone.0324868.e002g" position="anchor"/><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0222b;</mml:mo><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:mi>I</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(2)</label>
</disp-formula><p>Step 2: By taking the current values during the constant voltage charging phase as the new independent variable, the original capacity-time relationship can be transformed into a capacity-current relationship, thus transforming the independent variable from time to current.</p><p>Step 3: In the capacity-current relationship, by taking the first derivative of the capacity values, the dQ/dI curve can be obtained, as shown in <xref rid="pone.0324868.g001" ref-type="fig">Fig 1b</xref>. Some noise issues may arise during the generation process of the dQ/dI curve. This study employs the wavelet transform method for processing to reduce noise and smooth the curve, thereby improving the data&#x02019;s signal-to-noise ratio and the analysis&#x02019;s accuracy [<xref rid="pone.0324868.ref034" ref-type="bibr">34</xref>].</p></sec><sec id="sec005"><title>Feature extraction</title><p>Variations in external battery parameters, such as voltage, current, and temperature, can reflect the change in SOH of lithium-ion batteries. These parameter changes provide the theoretical basis for extracting features from battery charge-discharge data and estimating SOH. The CC and CV charging curves contain a wealth of information regarding the battery&#x02019;s health status [<xref rid="pone.0324868.ref027" ref-type="bibr">27</xref>]. Due to variations in users&#x02019; charging habits, it is often difficult to determine the initial stage of the charging process in daily life. This may lead to inaccuracies in extracting battery HFs during the CC charging stage. The HFs extracted from the CV charging stage can effectively mitigate the influence of randomness in the initial charging phase. This is because, during the constant voltage charging stage, the charging data of the battery are fully preserved, unaffected by the randomness at the beginning of charging. Therefore, extracting HFs during the CV stage allows for a more accurate estimation of the battery&#x02019;s SOH. As shown in <xref rid="pone.0324868.g001" ref-type="fig">Fig 1a</xref>, with the increase in battery cycle count, the current curve at the end of the CV charging stage exhibits a specific regular shift. Although users have varying charging habits, typically charge to a 100% SOC [<xref rid="pone.0324868.ref029" ref-type="bibr">29</xref>]. Therefore, this study selected a portion of the data from the end of the CV charging stage to estimate the battery SOH, making the HF extraction process more stable. As shown in <xref rid="pone.0324868.g001" ref-type="fig">Fig 1b</xref>, to more accurately capture the aging information of the battery, this study converted the current curve of the CV charging stage into a dQ/dI curve and extracted two HFs from it:</p><list list-type="simple"><list-item><p>(1) The sum of dQ/dI data points (<italic toggle="yes">SQI</italic>) at the end of the constant voltage charging stage:</p></list-item></list><disp-formula id="pone.0324868.e003">
<alternatives><graphic xlink:href="pone.0324868.e003.jpg" id="pone.0324868.e003g" position="anchor"/><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mi>Q</mml:mi><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>Q</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(3)</label>
</disp-formula><p>where <italic toggle="yes">i</italic> represents the cycle period, <italic toggle="yes">N</italic> is the total number of data points from the current value <italic toggle="yes">I</italic><sub><italic toggle="yes">si</italic></sub> at the end of the CV charging stage to the current value <italic toggle="yes">I</italic><sub><italic toggle="yes">ei</italic></sub> at 200mA before the end of the CV charging stage. Due to the discrete nature of the data, <italic toggle="yes">I</italic><sub><italic toggle="yes">ei</italic></sub> can only be approximated.</p><list list-type="simple"><list-item><p>(2) Integration of dQ/dI data points with respect to current (<italic toggle="yes">&#x02206;Q</italic>) at the end of the constant voltage charging stage:</p></list-item></list><disp-formula id="pone.0324868.e004">
<alternatives><graphic xlink:href="pone.0324868.e004.jpg" id="pone.0324868.e004g" position="anchor"/><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>d</mml:mi><mml:mi>Q</mml:mi><mml:mo>/</mml:mo><mml:mi>d</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(4)</label>
</disp-formula></sec><sec id="sec006"><title>Correlation analysis</title><p><xref rid="pone.0324868.g002" ref-type="fig">Fig 2</xref> illustrates the relationship between HFs and capacity with cycle periods. Both HFs exhibit significant linear correlations with cycle periods: <italic toggle="yes">SQI</italic> decreases with increasing cycle numbers, while <italic toggle="yes">&#x02206;Q</italic> increases.</p><fig position="float" id="pone.0324868.g002"><object-id pub-id-type="doi">10.1371/journal.pone.0324868.g002</object-id><label>Fig 2</label><caption><title>HFs and capacity.</title><p>(a) The relationship between the HFs of battery CY45-0.5/1#9 and the cycle periods (b) the relationship between the capacity of battery CY45-0.5/1#9 and the cycle periods.</p></caption><graphic xlink:href="pone.0324868.g002" position="float"/></fig><p>This study employed Pearson correlation coefficient analysis [<xref rid="pone.0324868.ref021" ref-type="bibr">21</xref>] to validate the effectiveness of the extracted HFs. The correlation coefficient ranges from [&#x02212;1, 1], with values closer to the absolute value of 1, indicating a stronger linear correlation between the HFs and battery capacity.</p><p><xref rid="pone.0324868.t001" ref-type="table">Table 1</xref> presents the specific values of the correlation coefficients. The data in the table reveal a strong correlation between the extracted HFs and the actual SOH values, with the absolute values of the correlation coefficients all exceeding 0.94. Therefore, the extracted HFs can be used as input parameters for constructing predictive models.</p><table-wrap position="float" id="pone.0324868.t001"><object-id pub-id-type="doi">10.1371/journal.pone.0324868.t001</object-id><label>Table 1</label><caption><title>Pearson correlation coefficient of the extracted health features.</title></caption><alternatives><graphic xlink:href="pone.0324868.t001" id="pone.0324868.t001g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="2" colspan="1">Datasets</th><th align="left" rowspan="2" colspan="1">Battery label</th><th align="left" colspan="2" rowspan="1">Pearson correlation coefficient</th></tr><tr><th align="left" rowspan="1" colspan="1">
<italic toggle="yes">SQI</italic>
</th><th align="left" rowspan="1" colspan="1">
<italic toggle="yes">&#x02206;Q</italic>
</th></tr></thead><tbody><tr><td align="left" rowspan="4" colspan="1">NCM</td><td align="left" rowspan="1" colspan="1">#1</td><td align="left" rowspan="1" colspan="1">0.9547</td><td align="left" rowspan="1" colspan="1">&#x02212;0.9746</td></tr><tr><td align="left" rowspan="1" colspan="1">#2</td><td align="left" rowspan="1" colspan="1">0.9578</td><td align="left" rowspan="1" colspan="1">&#x02212;0.9820</td></tr><tr><td align="left" rowspan="1" colspan="1">#9</td><td align="left" rowspan="1" colspan="1">0.9433</td><td align="left" rowspan="1" colspan="1">&#x02212;0.9626</td></tr><tr><td align="left" rowspan="1" colspan="1">#10</td><td align="left" rowspan="1" colspan="1">0.9405</td><td align="left" rowspan="1" colspan="1">&#x02212;0.9596</td></tr><tr><td align="left" rowspan="2" colspan="1">NCA</td><td align="left" rowspan="1" colspan="1">#1</td><td align="left" rowspan="1" colspan="1">0.9687</td><td align="left" rowspan="1" colspan="1">&#x02212;0.9835</td></tr><tr><td align="left" rowspan="1" colspan="1">#2</td><td align="left" rowspan="1" colspan="1">0.9631</td><td align="left" rowspan="1" colspan="1">&#x02212;0.9649</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="sec007"><title>Improved BPNN model</title><p>BPNN has strong generalization capabilities and robustness, and it typically performs well when dealing with noise and outliers in the data. However, when using BPNN, the initial parameters of the network are set randomly, which may cause the gradient descent algorithm to become trapped in local minima rather than global minima, thereby affecting the network&#x02019;s performance [<xref rid="pone.0324868.ref015" ref-type="bibr">15</xref>]. To address this issue, this study employs COA to initialize the weight and threshold parameters of BPNN, thereby improving the accuracy and robustness of the prediction results. The overall framework diagram is depicted in <xref rid="pone.0324868.g003" ref-type="fig">Fig 3</xref>.</p><fig position="float" id="pone.0324868.g003"><object-id pub-id-type="doi">10.1371/journal.pone.0324868.g003</object-id><label>Fig 3</label><caption><title>Overall framework diagram.</title></caption><graphic xlink:href="pone.0324868.g003" position="float"/></fig></sec><sec id="sec008"><title>Principle of BPNN algorithm</title><p>BPNN is a shallow feedforward neural network model based on supervised learning. It minimizes the error between network predictions and actual values by adjusting the weights and thresholds within the network. BPNN employs gradient descent as its learning rule. A 3-layer BPNN can meet design accuracy requirements and achieve approximation of arbitrary nonlinear functions [<xref rid="pone.0324868.ref017" ref-type="bibr">17</xref>]. Therefore, this study chooses a 3-layer BPNN for predicting the SOH of lithium-ion batteries. In BPNN, the forward propagation of information first occurs from the input layer to the hidden layer, and then continues from the hidden layer to the output layer. As shown in <xref rid="pone.0324868.g003" ref-type="fig">Fig 3</xref>, the output of the hidden layer is denoted as <italic toggle="yes">Y</italic><sub><italic toggle="yes">j</italic></sub>, the threshold of the hidden layer is denoted as <italic toggle="yes">&#x003b8;</italic><sub><italic toggle="yes">j</italic></sub>, the threshold of the output layer is denoted as <italic toggle="yes">&#x003b8;</italic><sub><italic toggle="yes">k</italic></sub>, the weights from the input layer to the hidden layer are denoted as <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">ij</italic></sub>, and the weights from the hidden layer to the output layer are denoted as <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">jk</italic></sub>. The error function in BPNN is used to measure the discrepancy between the network&#x02019;s predicted values and the actual values, denoted by <italic toggle="yes">e</italic>:</p><disp-formula id="pone.0324868.e005">
<alternatives><graphic xlink:href="pone.0324868.e005.jpg" id="pone.0324868.e005g" position="anchor"/><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(5)</label>
</disp-formula><p>where <italic toggle="yes">N</italic> is the number of samples, <italic toggle="yes">T</italic><sub><italic toggle="yes">k</italic></sub> is the expected output, and <italic toggle="yes">Y</italic><sub><italic toggle="yes">k</italic></sub> is the network&#x02019;s output.</p></sec><sec id="sec009"><title>COA principle</title><p>The COA method is a population-based metaheuristic algorithm, where coatis are regarded as population members [<xref rid="pone.0324868.ref035" ref-type="bibr">35</xref>]. The basic inspiration for the COA method comes from the strategies coatis employ when attacking iguanas and their behavior simulations when facing and evading predators in nature. The algorithm demonstrates significant advantages over most intelligent optimization algorithms in balancing global exploration and local exploitation, rendering it more competitive. For example, SSA may require more iterations to converge, especially when optimizing high-dimensional complex problems, which may affect its convergence speed [<xref rid="pone.0324868.ref016" ref-type="bibr">16</xref>]. Due to its unique search strategy and adaptive parameter adjustment mechanism, COA usually has a faster convergence speed in the optimization process. It can find high-quality solutions in a short number of iterations, which is particularly important for BPNN parameter optimization problems that require a large amount of computation and iteration. In the COA algorithm, the position of each coati in the search space corresponds to a set of values for the decision variables. Therefore, the position of coatis represents a candidate solution to the problem. The COA principle mainly consists of three parts: (1) population initialization; (2) Hunting and attacking strategy on iguana (exploration phase); (3) The process of escaping from predators (exploitation phase).</p></sec><sec id="sec010"><title>COA-BPNN</title><p>As shown in <xref rid="pone.0324868.g003" ref-type="fig">Fig 3</xref>, inputting the COA-optimized weights and threshold parameters into BPNN can mitigate the influence of the randomness of the network&#x02019;s initial parameters. Given that the BPNN has 3 layers, with 2 neurons in the input layer, 7 neurons in the hidden layer, and 1 neuron in the output layer. Hence, the total number of parameters in the BPNN network, including <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">ij</italic></sub>, <italic toggle="yes">&#x003c9;</italic><sub><italic toggle="yes">jk</italic></sub>, <italic toggle="yes">&#x003b8;</italic><sub><italic toggle="yes">j</italic></sub>, and <italic toggle="yes">&#x003b8;</italic><sub><italic toggle="yes">k</italic></sub>, is 29. The specific optimization steps are as follows:</p><p>Step 1: Input the parameters of the optimization problem, including the population size, number of iterations, total parameters of the BPNN network, upper and lower bounds for the network weights and thresholds, and the objective function to be optimized.</p><p>Step 2: Set the population size <italic toggle="yes">N</italic> and the maximum number of iterations <italic toggle="yes">T</italic>.</p><p>Step 3: Initialize the population and evaluate the objective function, which involves computing the fitness values of coatis. Through <italic toggle="yes">T</italic> iterations, identify the current best candidate solution. Here, the objective function is determined by the error value of the BPNN estimation results, as dictated by <xref rid="pone.0324868.e005" ref-type="disp-formula">Eq. 5</xref>.</p><p>Step 4: Utilize <italic toggle="yes">N</italic>/2 of the population for the exploration phase. Calculate the new position of the <italic toggle="yes">i</italic>th coati according to <xref rid="pone.0324868.e006" ref-type="disp-formula">Eq. 6</xref>, ensuring that the new position remains within the predefined bounds.</p><disp-formula id="pone.0324868.e006">
<alternatives><graphic xlink:href="pone.0324868.e006.jpg" id="pone.0324868.e006g" position="anchor"/><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>:</mml:mi><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>&#x000b7;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>I</mml:mi><mml:mi>&#x000b7;</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>;</mml:mi><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></alternatives>
<label>(6)</label>
</disp-formula><p>where <inline-formula id="pone.0324868.e007"><alternatives><graphic xlink:href="pone.0324868.e007.jpg" id="pone.0324868.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> represents the new position of the <italic toggle="yes">i</italic>th coati, <inline-formula id="pone.0324868.e008"><alternatives><graphic xlink:href="pone.0324868.e008.jpg" id="pone.0324868.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> represents its value in the <italic toggle="yes">j</italic>th dimension, <inline-formula id="pone.0324868.e009"><alternatives><graphic xlink:href="pone.0324868.e009.jpg" id="pone.0324868.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003bc;</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represents the value of iguana in the <italic toggle="yes">j</italic>th dimension of the search space, <italic toggle="yes">I</italic> is a randomly selected integer from the set {1,2}, <italic toggle="yes">r</italic> is a random real number selected from the interval [0,1], <italic toggle="yes">x</italic><sub><italic toggle="yes">i,j</italic></sub> represents the value of the <italic toggle="yes">j</italic>th decision variable, <italic toggle="yes">N</italic> is the population size, <italic toggle="yes">m</italic> is the number of decision variables.</p><p>Then, according to <xref rid="pone.0324868.e010" ref-type="disp-formula">Eq. 7</xref>, compute the fitness value of the new position, and update the position of the <italic toggle="yes">i</italic>th coati based on the fitness value.</p><disp-formula id="pone.0324868.e010">
<alternatives><graphic xlink:href="pone.0324868.e010.jpg" id="pone.0324868.e010g" position="anchor"/><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo fence="true" form="postfix" stretchy="true"/><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives>
<label>(7)</label>
</disp-formula><p>where <italic toggle="yes">X</italic><sub><italic toggle="yes">i</italic></sub> is the position of the <italic toggle="yes">i</italic>th coati in the search space, <inline-formula id="pone.0324868.e011"><alternatives><graphic xlink:href="pone.0324868.e011.jpg" id="pone.0324868.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the value of its objective function.</p><p>Then, continue exploration with the other half of the population. Generate a random position for the iguana according to <xref rid="pone.0324868.e012" ref-type="disp-formula">Eq. 8</xref>. Next, compute the new position of the <italic toggle="yes">i</italic>th coati according to <xref rid="pone.0324868.e013" ref-type="disp-formula">Eq. 9</xref>, and update the position of the <italic toggle="yes">i</italic>th coati based on <xref rid="pone.0324868.e010" ref-type="disp-formula">Eq. 7</xref>.</p><disp-formula id="pone.0324868.e012">
<alternatives><graphic xlink:href="pone.0324868.e012.jpg" id="pone.0324868.e012g" position="anchor"/><mml:math id="M12" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi>&#x003bc;</mml:mi><mml:mi>G</mml:mi></mml:msup></mml:mrow><mml:mi>:</mml:mi><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>j</mml:mi><mml:mi>G</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>&#x000b7;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>l</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></alternatives>
<label>(8)</label>
</disp-formula><disp-formula id="pone.0324868.e013">
<alternatives><graphic xlink:href="pone.0324868.e013.jpg" id="pone.0324868.e013g" position="anchor"/><mml:math id="M13" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>:</mml:mi><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>&#x000b7;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>j</mml:mi><mml:mi>G</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>&#x000b7;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mi>j</mml:mi><mml:mi>G</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>I</mml:mi><mml:mi>&#x000b7;</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mrow><mml:msup><mml:mi>&#x003bc;</mml:mi><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mrow><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mi>N</mml:mi><mml:mi>;</mml:mi><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives>
<label>(9)</label>
</disp-formula><p>where <inline-formula id="pone.0324868.e014"><alternatives><graphic xlink:href="pone.0324868.e014.jpg" id="pone.0324868.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi>&#x003bc;</mml:mi><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represents a randomly generated position for the iguana after landing, <inline-formula id="pone.0324868.e015"><alternatives><graphic xlink:href="pone.0324868.e015.jpg" id="pone.0324868.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>&#x003bc;</mml:mi><mml:mi>j</mml:mi><mml:mi>G</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> represents its value in the <italic toggle="yes">j</italic>th dimension, <inline-formula id="pone.0324868.e016"><alternatives><graphic xlink:href="pone.0324868.e016.jpg" id="pone.0324868.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mrow><mml:msup><mml:mi>&#x003bc;</mml:mi><mml:mi>G</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represents the value of its objective function, <italic toggle="yes">ub</italic><sub><italic toggle="yes">j</italic></sub> and <italic toggle="yes">lb</italic><sub><italic toggle="yes">j</italic></sub> respectively represent the upper bound and lower bound of the <italic toggle="yes">j</italic>th decision variable.</p><p>Step 5: Utilize the population <italic toggle="yes">N</italic> for the exploitation phase, simulating the behavior of coatis escaping predators. Calculate the upper and lower bounds for local search and the new position of the <italic toggle="yes">i</italic>th coati according to <xref rid="pone.0324868.e017" ref-type="disp-formula">Eqs (10)</xref> and <xref rid="pone.0324868.e018" ref-type="disp-formula">(11)</xref>.</p><disp-formula id="pone.0324868.e017">
<alternatives><graphic xlink:href="pone.0324868.e017.jpg" id="pone.0324868.e017g" position="anchor"/><mml:math id="M17" display="block" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:msubsup><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>&#x003c6;</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:msubsup><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>&#x003c6;</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mi>u</mml:mi><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives>
<label>(10)</label>
</disp-formula><disp-formula id="pone.0324868.e018">
<alternatives><graphic xlink:href="pone.0324868.e018.jpg" id="pone.0324868.e018g" position="anchor"/><mml:math id="M18" display="block" overflow="scroll"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mi>:</mml:mi><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>&#x000b7;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>l</mml:mi><mml:msubsup><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>&#x003c6;</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>r</mml:mi><mml:mi>&#x000b7;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:msubsup><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>&#x003c6;</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:mi>l</mml:mi><mml:msubsup><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>&#x003c6;</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mi>;</mml:mi><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives>
<label>(11)</label>
</disp-formula><p>where <inline-formula id="pone.0324868.e019"><alternatives><graphic xlink:href="pone.0324868.e019.jpg" id="pone.0324868.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:msubsup><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>&#x003c6;</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0324868.e020"><alternatives><graphic xlink:href="pone.0324868.e020.jpg" id="pone.0324868.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:mi>u</mml:mi><mml:msubsup><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>&#x003c6;</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> respectively represent the local lower bound and local upper bound of the jth decision variable, <inline-formula id="pone.0324868.e021"><alternatives><graphic xlink:href="pone.0324868.e021.jpg" id="pone.0324868.e021g" position="anchor"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> represents the new position of the <italic toggle="yes">i</italic>th coati in the second phase, <inline-formula id="pone.0324868.e022"><alternatives><graphic xlink:href="pone.0324868.e022.jpg" id="pone.0324868.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> represents its value in the <italic toggle="yes">j</italic>th dimension.</p><p>Then, compute the fitness value of the new position according to <xref rid="pone.0324868.e023" ref-type="disp-formula">Eq. 12</xref>, and update the position of the <italic toggle="yes">i</italic>th coati based on the fitness value.</p><disp-formula id="pone.0324868.e023">
<alternatives><graphic xlink:href="pone.0324868.e023.jpg" id="pone.0324868.e023g" position="anchor"/><mml:math id="M23" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mi>X</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mo>&#x0003c;</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mrow><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives>
<label>(12)</label>
</disp-formula><p>where <inline-formula id="pone.0324868.e024"><alternatives><graphic xlink:href="pone.0324868.e024.jpg" id="pone.0324868.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>F</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the value of its objective function.</p><p>Step 6: Save the current best candidate solution found. If the iteration count has not reached <italic toggle="yes">T</italic>, return to Step 4 until the predetermined number of iterations is reached.</p><p>Step 7: Transmit the globally optimal position found by COA to the BPNN. Set the optimal parameters as the initial weights and thresholds of the BPNN, thus avoiding the uncertainty of initializing random parameters in the BPNN. Finally, the BPNN completes simulation training based on the set parameters and input health characteristics (<italic toggle="yes">SQI</italic> and <italic toggle="yes">&#x02206;Q</italic>), and outputs the predicted values.</p></sec><sec id="sec011"><title>Experiments and analysis</title><p>In this section, the extracted HFs will be experimentally validated using batteries subjected to different temperatures and charging rates. Additionally, the proposed COA-BPNN will be compared with traditional BPNN and other models in estimating the SOH of lithium-ion batteries, to validate the generalization of the proposed method.</p></sec><sec id="sec012"><title>Evaluation criteria</title><p>In this study, the SOH is defined as the ratio of the current maximum capacity to the rated capacity, as shown in <xref rid="pone.0324868.e025" ref-type="disp-formula">Eq. 13</xref>:</p><disp-formula id="pone.0324868.e025">
<alternatives><graphic xlink:href="pone.0324868.e025.jpg" id="pone.0324868.e025g" position="anchor"/><mml:math id="M25" display="block" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">/</mml:mo><mml:mrow><mml:mpadded width="0"><mml:mphantom><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mphantom></mml:mpadded></mml:mrow><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mrow><mml:mspace width="-"/><mml:mi>\nulldelimiterspace</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(13)</label>
</disp-formula><p>where <italic toggle="yes">Q</italic><sub><italic toggle="yes">c</italic></sub> is the maximum capacity within the current cycle, and <italic toggle="yes">Q</italic><sub><italic toggle="yes">r</italic></sub> is the rated capacity of the battery.</p><p>To evaluate the performance of the prediction models, this study uses the mean absolute error (MAE), root mean square error (RMSE), and the coefficient of determination <italic toggle="yes">R</italic><sup>2</sup> to assess the estimation results of SOH. Where a result closer to 1 for <italic toggle="yes">R</italic><sup>2</sup> indicates a better fit between the predicted values and the actual values.</p><disp-formula id="pone.0324868.e026">
<alternatives><graphic xlink:href="pone.0324868.e026.jpg" id="pone.0324868.e026g" position="anchor"/><mml:math id="M26" display="block" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(14)</label>
</disp-formula><disp-formula id="pone.0324868.e027">
<alternatives><graphic xlink:href="pone.0324868.e027.jpg" id="pone.0324868.e027g" position="anchor"/><mml:math id="M27" display="block" overflow="scroll"><mml:mrow><mml:mi>R</mml:mi><mml:mi>M</mml:mi><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives>
<label>(15)</label>
</disp-formula><disp-formula id="pone.0324868.e028">
<alternatives><graphic xlink:href="pone.0324868.e028.jpg" id="pone.0324868.e028g" position="anchor"/><mml:math id="M28" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover><mml:mi>T</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives>
<label>(16)</label>
</disp-formula><p>where <inline-formula id="pone.0324868.e029"><alternatives><graphic xlink:href="pone.0324868.e029.jpg" id="pone.0324868.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mover><mml:mi>T</mml:mi><mml:mo stretchy="true">&#x000af;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represent the mean of expected output, and <italic toggle="yes">k</italic> represents the cycle number.</p></sec><sec id="sec013"><title>Estimation results and analysis of SOH</title><p>In this study, a subset of batteries from datasets NCM and NCA is used to validate the effectiveness of the proposed method. The first 70% of the data is selected as the training set, while the remaining 30% is used as the testing set. The two HFs extracted during the CV charging phase are used as inputs for the model, while the battery&#x02019;s SOH serves as the output.</p></sec><sec id="sec014"><title>Prediction of battery SOH at different temperatures</title><p>To validate the applicability of the proposed method for estimating the SOH of batteries at different environmental temperatures, this study utilizes CY35-0.5/1#1 and CY35-0.5/1#2 from the NCM dataset with an ambient temperature of 35&#x000b0;C, and CY45-0.5/1#9 and CY45-0.5/1#10 with an ambient temperature of 45&#x000b0;C as test subjects. The estimation results and errors of these batteries under 45&#x000b0;C and 35&#x000b0;C environments are shown in <xref rid="pone.0324868.g004" ref-type="fig">Fig 4</xref>.</p><fig position="float" id="pone.0324868.g004"><object-id pub-id-type="doi">10.1371/journal.pone.0324868.g004</object-id><label>Fig 4</label><caption><title>SOH estimation results and errors.</title><p>(a) and (b) represent the estimation results and errors of CY35-0.5/1#1 (c) and (d) represent the estimation results and errors of CY35-0.5/1#2(e) and (f) represent the estimation results and errors of CY45-0.5/1#9, (g) and (h) represent the estimation results and errors of CY45-0.5/1#10.</p></caption><graphic xlink:href="pone.0324868.g004" position="float"/></fig><p>According to <xref rid="pone.0324868.g004" ref-type="fig">Fig 4</xref>, it can be observed that the errors estimated by COA-BPNN are smaller than those of the other three algorithms. It is worth noting that COA-BPNN exhibits significant errors during the 1005th and 1012th cycle periods when estimating Battery CY35-0.5/1#2. This phenomenon is due to fluctuations in the recorded current data during the CV charging phase for these two cycle periods in the original dataset. Such anomalies may indicate potential safety hazards in the battery or faults in the BMS system.</p><p>The comparison results of these batteries in different models are shown in <xref rid="pone.0324868.t002" ref-type="table">Table 2</xref>. According to <xref rid="pone.0324868.t002" ref-type="table">Table 2</xref>, it can be observed that SVM, BPNN, SSA-BPNN, and COA-BPNN achieve good estimation results for batteries at different environmental temperatures. The RMSE for four models is less than 0.37%, the MAE is less than 0.24%, and the R<sup>2</sup> value is greater than 0.9. However, the estimation performance of SVM is poor, with the error gradually increasing as the number of cycles increases. Its maximum RMSE is 0.37%, and its maximum MAE is 0.24%. The main reason is that SVM&#x02019;s performance is largely dependent on the choice of kernel function and the setting of parameters. Compared to traditional BPNN and SSA-BPNN, COA-BPNN achieves the best estimation results, with RMSE consistently less than 0.16%, MAE consistently less than 0.10%, and R2 consistently above 0.98. The results validate the significant effectiveness of COA in optimizing the initial parameters of BPNN, while also demonstrating the superiority of COA over SSA. Therefore, the proposed model not only maintains high accuracy in SOH estimation but also identifies anomalies in lithium-ion batteries or BMS systems, demonstrating the robustness of the proposed model across batteries at different environmental temperatures.</p><table-wrap position="float" id="pone.0324868.t002"><object-id pub-id-type="doi">10.1371/journal.pone.0324868.t002</object-id><label>Table 2</label><caption><title>RMSE, MAE and R<sup>2</sup> of SOH estimation of different models on NCM datasets.</title></caption><alternatives><graphic xlink:href="pone.0324868.t002" id="pone.0324868.t002g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="2" colspan="1">Indicators</th><th align="left" rowspan="2" colspan="1">Models</th><th align="left" colspan="4" rowspan="1">NCM</th></tr><tr><th align="left" rowspan="1" colspan="1">#1</th><th align="left" rowspan="1" colspan="1">#2</th><th align="left" rowspan="1" colspan="1">#9</th><th align="left" rowspan="1" colspan="1">#10</th></tr></thead><tbody><tr><td align="left" rowspan="4" colspan="1">RMSE(%)</td><td align="left" rowspan="1" colspan="1">SVM</td><td align="left" rowspan="1" colspan="1">0.37</td><td align="left" rowspan="1" colspan="1">0.29</td><td align="left" rowspan="1" colspan="1">0.21</td><td align="left" rowspan="1" colspan="1">0.22</td></tr><tr><td align="left" rowspan="1" colspan="1">BPNN</td><td align="left" rowspan="1" colspan="1">0.26</td><td align="left" rowspan="1" colspan="1">0.32</td><td align="left" rowspan="1" colspan="1">0.15</td><td align="left" rowspan="1" colspan="1">0.22</td></tr><tr><td align="left" rowspan="1" colspan="1">SSA-BPNN</td><td align="left" rowspan="1" colspan="1">0.15</td><td align="left" rowspan="1" colspan="1">0.27</td><td align="left" rowspan="1" colspan="1">0.13</td><td align="left" rowspan="1" colspan="1">0.11</td></tr><tr><td align="left" rowspan="1" colspan="1">COA-BPNN</td><td align="left" rowspan="1" colspan="1">0.11</td><td align="left" rowspan="1" colspan="1">0.16</td><td align="left" rowspan="1" colspan="1">0.07</td><td align="left" rowspan="1" colspan="1">0.07</td></tr><tr><td align="left" rowspan="4" colspan="1">MAE(%)</td><td align="left" rowspan="1" colspan="1">SVM</td><td align="left" rowspan="1" colspan="1">0.24</td><td align="left" rowspan="1" colspan="1">0.23</td><td align="left" rowspan="1" colspan="1">0.19</td><td align="left" rowspan="1" colspan="1">0.19</td></tr><tr><td align="left" rowspan="1" colspan="1">BPNN</td><td align="left" rowspan="1" colspan="1">0.19</td><td align="left" rowspan="1" colspan="1">0.27</td><td align="left" rowspan="1" colspan="1">0.12</td><td align="left" rowspan="1" colspan="1">0.18</td></tr><tr><td align="left" rowspan="1" colspan="1">SSA-BPNN</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.19</td><td align="left" rowspan="1" colspan="1">0.11</td><td align="left" rowspan="1" colspan="1">0.09</td></tr><tr><td align="left" rowspan="1" colspan="1">COA-BPNN</td><td align="left" rowspan="1" colspan="1">0.09</td><td align="left" rowspan="1" colspan="1">0.10</td><td align="left" rowspan="1" colspan="1">0.05</td><td align="left" rowspan="1" colspan="1">0.05</td></tr><tr><td align="left" rowspan="4" colspan="1">R<sup>2</sup></td><td align="left" rowspan="1" colspan="1">SVM</td><td align="left" rowspan="1" colspan="1">0.9002</td><td align="left" rowspan="1" colspan="1">0.9514</td><td align="left" rowspan="1" colspan="1">0.9192</td><td align="left" rowspan="1" colspan="1">0.9113</td></tr><tr><td align="left" rowspan="1" colspan="1">BPNN</td><td align="left" rowspan="1" colspan="1">0.9479</td><td align="left" rowspan="1" colspan="1">0.9413</td><td align="left" rowspan="1" colspan="1">0.9632</td><td align="left" rowspan="1" colspan="1">0.9139</td></tr><tr><td align="left" rowspan="1" colspan="1">SSA-BPNN</td><td align="left" rowspan="1" colspan="1">0.9826</td><td align="left" rowspan="1" colspan="1">0.9581</td><td align="left" rowspan="1" colspan="1">0.9719</td><td align="left" rowspan="1" colspan="1">0.9786</td></tr><tr><td align="left" rowspan="1" colspan="1">COA-BPNN</td><td align="left" rowspan="1" colspan="1">0.9904</td><td align="left" rowspan="1" colspan="1">0.9851</td><td align="left" rowspan="1" colspan="1">0.9919</td><td align="left" rowspan="1" colspan="1">0.9920</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="sec015"><title>Prediction of battery SOH at different charging rates</title><p>Since all batteries in the NCM dataset are charged at a rate of 0.5C, CY25-0.25/1#1 and CY25-0.25/1#2 from the NCA dataset, charged at a rate of 0.25C and with an ambient temperature of 25&#x000b0;C, are used as experimental subjects. The estimated results and errors of these two batteries are shown in <xref rid="pone.0324868.g005" ref-type="fig">Fig 5</xref>.</p><fig position="float" id="pone.0324868.g005"><object-id pub-id-type="doi">10.1371/journal.pone.0324868.g005</object-id><label>Fig 5</label><caption><title>SOH estimation results and errors.</title><p>(a) and (b) represent the estimation results and errors of CY25-0.25/1#1(c) and (d) represent the estimation results and errors of CY25-0.25/1#2.</p></caption><graphic xlink:href="pone.0324868.g005" position="float"/></fig><p>As shown in <xref rid="pone.0324868.g005" ref-type="fig">Fig 5</xref>, for batteries charged at different rates, all four models still achieve good SOH estimation accuracy. Among them, COA-BPNN exhibits the best fitting performance with the smallest errors. For the estimation of Battery CY25-0.25/1#1, COA-BPNN exhibits significant error during the 395th cycle period, similar to the situation observed for Battery CY35-0.5/1#2.</p><p>The comparison results of these batteries in different models are shown in <xref rid="pone.0324868.t003" ref-type="table">Table 3</xref>. As shown in <xref rid="pone.0324868.t003" ref-type="table">Table 3</xref>, the RMSE for four models is less than 0.47%, the MAE is less than 0.41%, and the R<sup>2</sup> value is above 0.91. Unlike before, when estimating CY25-0.25/1#2, SVM&#x02019;s estimation results are better than BPNN. The maximum RMSE for BPNN is 0.27%, which is 0.05% higher than SVM. This could be due to the influence of the random initialization of weights and thresholds in BPNN, resulting in network instability. The estimation results of SSA-BPNN are similar to those of COA-BPNN, but the estimation accuracy of the COA-BPNN model is higher. Its RMSE reaches a minimum of 0.14%, MAE reaches a minimum of 0.11%, and R<sup>2</sup> reaches a maximum of 0.9852. This indicates the superiority of the COA method.</p><table-wrap position="float" id="pone.0324868.t003"><object-id pub-id-type="doi">10.1371/journal.pone.0324868.t003</object-id><label>Table 3</label><caption><title>RMSE, MAE and R<sup>2</sup> of SOH estimation of different models on NCA datasets.</title></caption><alternatives><graphic xlink:href="pone.0324868.t003" id="pone.0324868.t003g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="2" colspan="1">Models</th><th align="left" colspan="3" rowspan="1">NCA(#1)</th><th align="left" colspan="3" rowspan="1">NCA(#2)</th></tr><tr><th align="left" rowspan="1" colspan="1">RMSE(%)</th><th align="left" rowspan="1" colspan="1">MAE(%)</th><th align="left" rowspan="1" colspan="1">R<sup>2</sup></th><th align="left" rowspan="1" colspan="1">RMSE(%)</th><th align="left" rowspan="1" colspan="1">MAE(%)</th><th align="left" rowspan="1" colspan="1">R<sup>2</sup></th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">SVM</td><td align="left" rowspan="1" colspan="1">0.47</td><td align="left" rowspan="1" colspan="1">0.41</td><td align="left" rowspan="1" colspan="1">0.9339</td><td align="left" rowspan="1" colspan="1">0.22</td><td align="left" rowspan="1" colspan="1">0.16</td><td align="left" rowspan="1" colspan="1">0.9433</td></tr><tr><td align="left" rowspan="1" colspan="1">BPNN</td><td align="left" rowspan="1" colspan="1">0.38</td><td align="left" rowspan="1" colspan="1">0.30</td><td align="left" rowspan="1" colspan="1">0.9575</td><td align="left" rowspan="1" colspan="1">0.27</td><td align="left" rowspan="1" colspan="1">0.19</td><td align="left" rowspan="1" colspan="1">0.9136</td></tr><tr><td align="left" rowspan="1" colspan="1">SSA-BPNN</td><td align="left" rowspan="1" colspan="1">0.37</td><td align="left" rowspan="1" colspan="1">0.31</td><td align="left" rowspan="1" colspan="1">0.9594</td><td align="left" rowspan="1" colspan="1">0.21</td><td align="left" rowspan="1" colspan="1">0.17</td><td align="left" rowspan="1" colspan="1">0.9469</td></tr><tr><td align="left" rowspan="1" colspan="1">COA-BPNN</td><td align="left" rowspan="1" colspan="1">0.22</td><td align="left" rowspan="1" colspan="1">0.16</td><td align="left" rowspan="1" colspan="1">0.9852</td><td align="left" rowspan="1" colspan="1">0.14</td><td align="left" rowspan="1" colspan="1">0.11</td><td align="left" rowspan="1" colspan="1">0.9777</td></tr></tbody></table></alternatives></table-wrap></sec></sec><sec sec-type="conclusions" id="sec016"><title>Conclusion</title><p>The paper proposes a method for estimating the SOH of lithium-ion batteries during the late stage of the CV charging phase. This method is not affected by the randomness of the initial charging stage, thus ensuring stability and accuracy in extracting HF. To better reflect the aging condition of the battery, the current curve during the CV charging phase is converted into a dQ/dI curve, and two health characteristics are extracted from the data within the range of 200mA current variation. Furthermore, to enhance prediction accuracy, COA is utilized to optimize the weights and thresholds of BPNN, thereby addressing the issue of BPNN&#x02019;s initialization parameters. The proposed method has been validated using two publicly available datasets, and the results demonstrate high accuracy in estimating the SOH of batteries at different environmental temperatures and charging rates. This validates the feasibility of estimating the SOH of lithium-ion batteries during the late stage of CV charging and the advantages of COA-BPNN. The estimation results of COA-BPNN are superior to those of SVM, BPNN, and SSA-BPNN, with RMSE and MAE both less than 0.22% and 0.16%, respectively. Although the COA-BPNN method demonstrated promising performance in experimental datasets, its generalization capability still requires further validation across more diverse datasets and application scenarios. Moreover, the SOH of batteries is a complex multidimensional issue, and there may be other important features related to battery aging that have not been extracted. In the future, we will further research and develop more effective feature extraction techniques to uncover more key information related to health status in battery data.</p></sec><sec id="sec017" sec-type="supplementary-material"><title>Supporting information</title><supplementary-material id="pone.0324868.s001" position="float" content-type="local-data"><label>S1 File</label><caption><title>CY45-0.5/1#9 Code file for data processing and prediction results.</title><p>(RAR)</p></caption><media xlink:href="pone.0324868.s001.rar"/></supplementary-material></sec></body><back><ref-list><title>References</title><ref id="pone.0324868.ref001"><label>1</label><mixed-citation publication-type="journal"><name><surname>Osmani</surname><given-names>K</given-names></name>, <name><surname>Alkhedher</surname><given-names>M</given-names></name>, <name><surname>Ramadan</surname><given-names>M</given-names></name>, <name><surname>Choi</surname><given-names>DS</given-names></name>, <name><surname>Li</surname><given-names>LKB</given-names></name>, <name><surname>Doranehgard</surname><given-names>MH</given-names></name>, <etal>et al</etal>. <article-title>Recent progress in the thermal management of lithium-ion batteries</article-title>. <source>J Clean Prod</source>. <year>2023</year>;<volume>389</volume>:<fpage>136024</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jclepro.2023.136024</pub-id></mixed-citation></ref><ref id="pone.0324868.ref002"><label>2</label><mixed-citation publication-type="journal"><name><surname>Sun</surname><given-names>F</given-names></name>. <article-title>Green energy and intelligent transportation&#x02014;promoting green and intelligent mobility</article-title>. <source>Green Energy Intell Transp</source>. <year>2022</year>;<volume>1</volume>(<issue>1</issue>):<fpage>100017</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.geits.2022.100017</pub-id></mixed-citation></ref><ref id="pone.0324868.ref003"><label>3</label><mixed-citation publication-type="journal"><name><surname>Dini</surname><given-names>P</given-names></name>, <name><surname>Colicelli</surname><given-names>A</given-names></name>, <name><surname>Saponara</surname><given-names>S</given-names></name>. <article-title>Review on modeling and SOC/SOH estimation of batteries for automotive applications</article-title>. <source>Batteries</source>. <year>2024</year>;<volume>10</volume>(<issue>1</issue>):<fpage>34</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/batteries10010034</pub-id></mixed-citation></ref><ref id="pone.0324868.ref004"><label>4</label><mixed-citation publication-type="journal"><name><surname>Jiang</surname><given-names>Y</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Xia</surname><given-names>L</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>. <article-title>State of health estimation for lithium-ion battery using empirical degradation and error compensation models</article-title>. <source>IEEE Access</source>. <year>2020</year>;<volume>8</volume>:<fpage>123858</fpage>&#x02013;<lpage>68</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/access.2020.3005229</pub-id></mixed-citation></ref><ref id="pone.0324868.ref005"><label>5</label><mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Feng</surname><given-names>G</given-names></name>, <name><surname>Zhen</surname><given-names>D</given-names></name>, <name><surname>Gu</surname><given-names>F</given-names></name>, <name><surname>Ball</surname><given-names>A</given-names></name>. <article-title>A review on online state of charge and state of health estimation for lithium-ion batteries in electric vehicles</article-title>. <source>Energy Rep</source>. <year>2021</year>;<volume>7</volume>:<fpage>5141</fpage>&#x02013;<lpage>61</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.egyr.2021.08.113</pub-id></mixed-citation></ref><ref id="pone.0324868.ref006"><label>6</label><mixed-citation publication-type="journal"><name><surname>Ni</surname><given-names>Z</given-names></name>, <name><surname>Yang</surname><given-names>Y</given-names></name>. <article-title>A Combined data-model method for state-of-charge estimation of lithium-ion batteries</article-title>. <source>IEEE Trans Instrum Meas</source>. <year>2022</year>;<volume>71</volume>:<fpage>1</fpage>&#x02013;<lpage>11</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tim.2021.3137550</pub-id></mixed-citation></ref><ref id="pone.0324868.ref007"><label>7</label><mixed-citation publication-type="journal"><name><surname>Tran</surname><given-names>M-K</given-names></name>, <name><surname>Mathew</surname><given-names>M</given-names></name>, <name><surname>Janhunen</surname><given-names>S</given-names></name>, <name><surname>Panchal</surname><given-names>S</given-names></name>, <name><surname>Raahemifar</surname><given-names>K</given-names></name>, <name><surname>Fraser</surname><given-names>R</given-names></name>, <etal>et al</etal>. <article-title>A comprehensive equivalent circuit model for lithium-ion batteries, incorporating the effects of state of health, state of charge, and temperature on model parameters</article-title>. <source>J Energy Storage</source>. <year>2021</year>;<volume>43</volume>:<fpage>103252</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.est.2021.103252</pub-id></mixed-citation></ref><ref id="pone.0324868.ref008"><label>8</label><mixed-citation publication-type="journal"><name><surname>Ning</surname><given-names>B</given-names></name>, <name><surname>Cao</surname><given-names>B</given-names></name>, <name><surname>Wang</surname><given-names>B</given-names></name>, <name><surname>Zou</surname><given-names>Z</given-names></name>. <article-title>Adaptive sliding mode observers for lithium-ion battery state estimation based on parameters identified online</article-title>. <source>Energy</source>. <year>2018</year>;<volume>153</volume>:<fpage>732</fpage>&#x02013;<lpage>42</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.energy.2018.04.026</pub-id></mixed-citation></ref><ref id="pone.0324868.ref009"><label>9</label><mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>R</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Zhang</surname><given-names>H</given-names></name>. <article-title>State of health and charge estimation based on adaptive boosting integrated with particle swarm optimization/support vector machine (AdaBoost-PSO-SVM) model for lithium-ion batteries</article-title>. <source>Int J Electrochem Sci</source>. <year>2022</year>;<volume>17</volume>(<issue>2</issue>):<fpage>220212</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.20964/2022.02.03</pub-id></mixed-citation></ref><ref id="pone.0324868.ref010"><label>10</label><mixed-citation publication-type="journal"><name><surname>Qian</surname><given-names>C</given-names></name>, <name><surname>He</surname><given-names>N</given-names></name>, <name><surname>He</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Cheng</surname><given-names>F</given-names></name>. <article-title>State of health estimation of lithium-ion battery using energy accumulation-based feature extraction and improved relevance vector regression</article-title>. <source>J Energy Storage</source>. <year>2023</year>;<volume>68</volume>:<fpage>107754</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.est.2023.107754</pub-id></mixed-citation></ref><ref id="pone.0324868.ref011"><label>11</label><mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>J</given-names></name>. <article-title>Health degradation detection and monitoring of lithium-ion battery based on adaptive learning method</article-title>. <source>IEEE Trans Instrum Meas</source>. <year>2014</year>;<volume>63</volume>(<issue>7</issue>):<fpage>1709</fpage>&#x02013;<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tim.2013.2293234</pub-id></mixed-citation></ref><ref id="pone.0324868.ref012"><label>12</label><mixed-citation publication-type="journal"><name><surname>Wen</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>. <article-title>SOH prediction of lithium battery based on IC curve feature and BP neural network</article-title>. <source>Energy</source>. <year>2022</year>;<volume>261</volume>:<fpage>125234</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.energy.2022.125234</pub-id></mixed-citation></ref><ref id="pone.0324868.ref013"><label>13</label><mixed-citation publication-type="journal"><name><surname>Shu</surname><given-names>X</given-names></name>, <name><surname>Shen</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>G</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>Z</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>. <article-title>A flexible state-of-health prediction scheme for lithium-ion battery packs with long short-term memory network and transfer learning</article-title>. <source>IEEE Trans Transp Electrific</source>. <year>2021</year>;<volume>7</volume>(<issue>4</issue>):<fpage>2238</fpage>&#x02013;<lpage>48</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tte.2021.3074638</pub-id></mixed-citation></ref><ref id="pone.0324868.ref014"><label>14</label><mixed-citation publication-type="journal"><name><surname>Shen</surname><given-names>S</given-names></name>, <name><surname>Sadoughi</surname><given-names>M</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Hu</surname><given-names>C</given-names></name>. <article-title>Deep convolutional neural networks with ensemble learning and transfer learning for capacity estimation of lithium-ion batteries</article-title>. <source>Appl Energy</source>. <year>2020</year>;<volume>260</volume>:<fpage>114296</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.apenergy.2019.114296</pub-id></mixed-citation></ref><ref id="pone.0324868.ref015"><label>15</label><mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>Y</given-names></name>, <name><surname>Yao</surname><given-names>M</given-names></name>, <name><surname>Liu</surname><given-names>H</given-names></name>, <name><surname>Tang</surname><given-names>Z</given-names></name>. <article-title>State of health estimation and remaining useful life prediction for lithium-ion batteries by improved particle swarm optimization-back propagation neural network</article-title>. <source>J Energy Storage</source>. <year>2022</year>;<volume>52</volume>:<fpage>104750</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.est.2022.104750</pub-id></mixed-citation></ref><ref id="pone.0324868.ref016"><label>16</label><mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>P</given-names></name>, <name><surname>An</surname><given-names>Z</given-names></name>. <article-title>Research on computer prediction model using SSA-BP neural network and sparrow search algorithm</article-title>. <source>J Phys: Conf Ser</source>. <year>2021</year>;<volume>2033</volume>(<issue>1</issue>):<fpage>012003</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1088/1742-6596/2033/1/012003</pub-id></mixed-citation></ref><ref id="pone.0324868.ref017"><label>17</label><mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>F</given-names></name>, <name><surname>Ye</surname><given-names>W</given-names></name>, <name><surname>Lei</surname><given-names>G</given-names></name>, <name><surname>Liu</surname><given-names>Y</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>. <article-title>SOH estimation of Li-ion battery based on FA-BPNN-K-means optimization algorithm</article-title>. <source>J Comput Method Sci Eng</source>. <year>2022</year>;<volume>22</volume>(<issue>4</issue>):<fpage>1209</fpage>&#x02013;<lpage>22</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3233/jcm226028</pub-id></mixed-citation></ref><ref id="pone.0324868.ref018"><label>18</label><mixed-citation publication-type="journal"><name><surname>Ghosh</surname><given-names>S</given-names></name>, <name><surname>Ogueda-Oliva</surname><given-names>A</given-names></name>, <name><surname>Ghosh</surname><given-names>A</given-names></name>, <name><surname>Banerjee</surname><given-names>M</given-names></name>, <name><surname>Seshaiyer</surname><given-names>P</given-names></name>. <article-title>Understanding the implications of under-reporting, vaccine efficiency and social behavior on the post-pandemic spread using physics informed neural networks: a case study of China</article-title>. <source>PLoS One</source>. <year>2023</year>;<volume>18</volume>(<issue>11</issue>):e0290368. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0290368</pub-id>
<pub-id pub-id-type="pmid">37972077</pub-id>
</mixed-citation></ref><ref id="pone.0324868.ref019"><label>19</label><mixed-citation publication-type="journal"><name><surname>Lin</surname><given-names>C</given-names></name>, <name><surname>Xu</surname><given-names>J</given-names></name>, <name><surname>Shi</surname><given-names>M</given-names></name>, <name><surname>Mei</surname><given-names>X</given-names></name>. <article-title>Constant current charging time based fast state-of-health estimation for lithium-ion batteries</article-title>. <source>Energy</source>. <year>2022</year>;<volume>247</volume>:<fpage>123556</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.energy.2022.123556</pub-id></mixed-citation></ref><ref id="pone.0324868.ref020"><label>20</label><mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>X</given-names></name>, <name><surname>Wang</surname><given-names>W</given-names></name>, <name><surname>Zou</surname><given-names>G</given-names></name>, <name><surname>Zhou</surname><given-names>C</given-names></name>, <name><surname>Zou</surname><given-names>H</given-names></name>. <article-title>State of health estimation of lithium-ion battery by removing model redundancy through aging mechanism</article-title>. <source>J Energy Storage</source>. <year>2022</year>;<volume>52</volume>:<fpage>105018</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.est.2022.105018</pub-id></mixed-citation></ref><ref id="pone.0324868.ref021"><label>21</label><mixed-citation publication-type="journal"><name><surname>Goh</surname><given-names>HH</given-names></name>, <name><surname>Lan</surname><given-names>Z</given-names></name>, <name><surname>Zhang</surname><given-names>D</given-names></name>, <name><surname>Dai</surname><given-names>W</given-names></name>, <name><surname>Kurniawan</surname><given-names>TA</given-names></name>, <name><surname>Goh</surname><given-names>KC</given-names></name>. <article-title>Estimation of the state of health (SOH) of batteries using discrete curvature feature extraction</article-title>. <source>J Energy Storage</source>. <year>2022</year>;<volume>50</volume>:<fpage>104646</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.est.2022.104646</pub-id></mixed-citation></ref><ref id="pone.0324868.ref022"><label>22</label><mixed-citation publication-type="journal"><name><surname>Jin</surname><given-names>H</given-names></name>, <name><surname>Cui</surname><given-names>N</given-names></name>, <name><surname>Cai</surname><given-names>L</given-names></name>, <name><surname>Meng</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>J</given-names></name>, <name><surname>Peng</surname><given-names>J</given-names></name>, <etal>et al</etal>. <article-title>State-of-health estimation for lithium-ion batteries with hierarchical feature construction and auto-configurable Gaussian process regression</article-title>. <source>Energy</source>. <year>2023</year>;<volume>262</volume>:<fpage>125503</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.energy.2022.125503</pub-id></mixed-citation></ref><ref id="pone.0324868.ref023"><label>23</label><mixed-citation publication-type="journal"><name><surname>Deng</surname><given-names>Z</given-names></name>, <name><surname>Hu</surname><given-names>X</given-names></name>, <name><surname>Xie</surname><given-names>Y</given-names></name>, <name><surname>Xu</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>P</given-names></name>, <name><surname>Lin</surname><given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Battery health evaluation using a short random segment of constant current charging</article-title>. <source>iScience</source>. <year>2022</year>;<volume>25</volume>(<issue>5</issue>):<fpage>104260</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.isci.2022.104260</pub-id>
<pub-id pub-id-type="pmid">35521525</pub-id>
</mixed-citation></ref><ref id="pone.0324868.ref024"><label>24</label><mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>D</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Pan</surname><given-names>R</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>Z</given-names></name>. <article-title>A novel Gaussian process regression model for state-of-health estimation of lithium-ion battery using charging curve</article-title>. <source>J Power Sourc</source>. <year>2018</year>;<volume>384</volume>:<fpage>387</fpage>&#x02013;<lpage>95</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.jpowsour.2018.03.015</pub-id></mixed-citation></ref><ref id="pone.0324868.ref025"><label>25</label><mixed-citation publication-type="journal"><name><surname>Ruan</surname><given-names>H</given-names></name>, <name><surname>He</surname><given-names>H</given-names></name>, <name><surname>Wei</surname><given-names>Z</given-names></name>, <name><surname>Quan</surname><given-names>Z</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>. <article-title>State of health estimation of lithium-ion battery based on constant-voltage charging reconstruction</article-title>. <source>IEEE J Emerg Sel Topics Power Electron</source>. <year>2023</year>;<volume>11</volume>(<issue>4</issue>):<fpage>4393</fpage>&#x02013;<lpage>402</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/jestpe.2021.3098836</pub-id></mixed-citation></ref><ref id="pone.0324868.ref026"><label>26</label><mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Xia</surname><given-names>B</given-names></name>, <name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Fu</surname><given-names>Y</given-names></name>, <name><surname>Mi</surname><given-names>C</given-names></name>. <article-title>Online state-of-health estimation for lithium-ion batteries using constant-voltage charging current analysis</article-title>. <source>Appl Energy</source>. <year>2018</year>;<volume>212</volume>:<fpage>1589</fpage>&#x02013;<lpage>600</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.apenergy.2018.01.010</pub-id></mixed-citation></ref><ref id="pone.0324868.ref027"><label>27</label><mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>S-Z</given-names></name>, <name><surname>Liang</surname><given-names>Z</given-names></name>, <name><surname>Yuan</surname><given-names>H</given-names></name>, <name><surname>Yang</surname><given-names>L</given-names></name>, <name><surname>Xu</surname><given-names>F</given-names></name>, <name><surname>Fan</surname><given-names>Y</given-names></name>. <article-title>A novel state of health estimation method for lithium-ion batteries based on constant-voltage charging partial data and convolutional neural network</article-title>. <source>Energy</source>. <year>2023</year>;<volume>283</volume>:<fpage>129103</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.energy.2023.129103</pub-id></mixed-citation></ref><ref id="pone.0324868.ref028"><label>28</label><mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>G</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Liu</surname><given-names>Z</given-names></name>. <article-title>State of health estimation of power batteries based on multi-feature fusion models using stacking algorithm</article-title>. <source>Energy</source>. <year>2022</year>;<volume>259</volume>:<fpage>124851</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.energy.2022.124851</pub-id></mixed-citation></ref><ref id="pone.0324868.ref029"><label>29</label><mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Zeng</surname><given-names>S</given-names></name>, <name><surname>Guo</surname><given-names>J</given-names></name>, <name><surname>Qin</surname><given-names>T</given-names></name>. <article-title>State of health estimation of lithium-ion batteries based on the constant voltage charging curve</article-title>. <source>Energy</source>. <year>2019</year>;<volume>167</volume>:<fpage>661</fpage>&#x02013;<lpage>9</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.energy.2018.11.008</pub-id></mixed-citation></ref><ref id="pone.0324868.ref030"><label>30</label><mixed-citation publication-type="journal"><name><surname>Ko</surname><given-names>C-J</given-names></name>, <name><surname>Chen</surname><given-names>K-C</given-names></name>, <name><surname>Su</surname><given-names>T-W</given-names></name>. <article-title>Differential current in constant-voltage charging mode: a novel tool for state-of-health and state-of-charge estimation of lithium-ion batteries</article-title>. <source>Energy</source>. <year>2024</year>;<volume>288</volume>:<fpage>129826</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.energy.2023.129826</pub-id></mixed-citation></ref><ref id="pone.0324868.ref031"><label>31</label><mixed-citation publication-type="journal"><name><surname>Ding</surname><given-names>X</given-names></name>, <name><surname>Zhou</surname><given-names>Q</given-names></name>, <name><surname>Li</surname><given-names>X</given-names></name>, <name><surname>Xiong</surname><given-names>X</given-names></name>. <article-title>Fast-charging anodes for lithium ion batteries: progress and challenges</article-title>. <source>Chem Commun (Camb)</source>. <year>2024</year>;<volume>60</volume>(<issue>18</issue>):<fpage>2472</fpage>&#x02013;<lpage>88</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1039/d4cc00110a</pub-id>
<pub-id pub-id-type="pmid">38314874</pub-id>
</mixed-citation></ref><ref id="pone.0324868.ref032"><label>32</label><mixed-citation publication-type="journal"><name><surname>Ye</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>X</given-names></name>. <article-title>A dynamic stability design strategy for lithium metal solid state batteries</article-title>. <source>Nature</source>. <year>2021</year>;<volume>593</volume>(<issue>7858</issue>):<fpage>218</fpage>&#x02013;<lpage>22</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41586-021-03486-3</pub-id>
<pub-id pub-id-type="pmid">33981053</pub-id>
</mixed-citation></ref><ref id="pone.0324868.ref033"><label>33</label><mixed-citation publication-type="journal"><name><surname>Zhu</surname><given-names>J</given-names></name>, <name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Bhushan Gopaluni</surname><given-names>R</given-names></name>, <name><surname>Cao</surname><given-names>Y</given-names></name>, <name><surname>Heere</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Data-driven capacity estimation of commercial lithium-ion batteries from voltage relaxation</article-title>. <source>Nat Commun</source>. <year>2022</year>;<volume>13</volume>(<issue>1</issue>):<fpage>2261</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41467-022-29837-w</pub-id>
<pub-id pub-id-type="pmid">35477711</pub-id>
</mixed-citation></ref><ref id="pone.0324868.ref034"><label>34</label><mixed-citation publication-type="journal"><name><surname>He</surname><given-names>Y</given-names></name>, <name><surname>Bai</surname><given-names>W</given-names></name>, <name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Wu</surname><given-names>H</given-names></name>, <name><surname>Ding</surname><given-names>M</given-names></name>. <article-title>SOH estimation for lithium-ion batteries: An improved GPR optimization method based on the developed feature extraction</article-title>. <source>J Energy Storage</source>. <year>2024</year>;<volume>83</volume>:<fpage>110678</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.est.2024.110678</pub-id></mixed-citation></ref><ref id="pone.0324868.ref035"><label>35</label><mixed-citation publication-type="journal"><name><surname>Dehghani</surname><given-names>M</given-names></name>, <name><surname>Montazeri</surname><given-names>Z</given-names></name>, <name><surname>Trojovsk&#x000e1;</surname><given-names>E</given-names></name>, <name><surname>Trojovsk&#x000fd;</surname><given-names>P</given-names></name>. <article-title>Coati optimization algorithm: a new bio-inspired metaheuristic algorithm for solving optimization problems</article-title>. <source>Knowl-Based Syst</source>. <year>2023</year>;<volume>259</volume>:<fpage>110011</fpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.knosys.2022.110011</pub-id></mixed-citation></ref></ref-list></back><sub-article article-type="author-comment" id="pone.0324868.r001" specific-use="rebutted-decision-letter-unavailable"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0324868.r001</article-id><title-group><article-title>Author response to Decision Letter 0</article-title></title-group><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>0</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="author-response-date">22 Jan 2025</named-content>
</p></body></sub-article><sub-article article-type="aggregated-review-documents" id="pone.0324868.r002" specific-use="decision-letter"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0324868.r002</article-id><title-group><article-title>Decision Letter 0</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhao</surname><given-names>Zhibin</given-names></name><role>Academic Editor</role></contrib></contrib-group><permissions><copyright-statement>&#x000a9; 2025 Zhibin Zhao</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Zhibin Zhao</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link> , which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0324868" id="rel-obj002" related-article-type="reviewed-article"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>0</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="letter-date">20 Feb 2025</named-content>
</p><p>PONE-D-25-03811A lithium-ion batteries SOH estimation method based on extracting new features during the constant voltage charging stage and improving BPNNPLOS ONE</p><p>Dear Dr. Li,</p><p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE&#x02019;s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p><p>Please submit your revised manuscript by Apr 06 2025 11:59PM. If you will need more time than this to complete your revisions, please reply to this message or contact the journal office at&#x000a0;<email>plosone@plos.org</email> . When you're ready to submit your revision, log on to <ext-link xlink:href="https://www.editorialmanager.com/pone/" ext-link-type="uri">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p><p>Please include the following items when submitting your revised manuscript:</p><p><list list-type="bullet"><list-item><p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). You should upload this letter as a separate file labeled 'Response to Reviewers'.</p></list-item><list-item><p>A marked-up copy of your manuscript that highlights changes made to the original version. You should upload this as a separate file labeled 'Revised Manuscript with Track Changes'.</p></list-item><list-item><p>An unmarked version of your revised paper without tracked changes. You should upload this as a separate file labeled 'Manuscript'.</p></list-item></list>
</p><p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter. Guidelines for resubmitting your figure files are available below the reviewer comments at the end of this letter.</p><p>If applicable, we recommend that you deposit your laboratory protocols in protocols.io to enhance the reproducibility of your results. Protocols.io assigns your protocol its own identifier (DOI) so that it can be cited independently in the future. For instructions see: <ext-link xlink:href="https://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols" ext-link-type="uri">https://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link> . Additionally, PLOS ONE offers an option for publishing peer-reviewed Lab Protocol articles, which describe protocols hosted on protocols.io. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&#x00026;utm_source=authorletters&#x00026;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&#x00026;utm_source=authorletters&#x00026;utm_campaign=protocols</ext-link> .</p><p>We look forward to receiving your revised manuscript.</p><p>Kind regards,</p><p>Zhibin Zhao</p><p>Academic Editor</p><p>PLOS ONE</p><p>Journal Requirements:</p><p>When submitting your revision, we need you to address these additional requirements.</p><p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at</p><p><ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and</p><p>
<ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link>
</p><p>2. Please note that PLOS ONE has specific guidelines on code sharing for submissions in which author-generated code underpins the findings in the manuscript. In these cases, we expect all author-generated code to be made available without restrictions upon publication of the work. Please review our guidelines at <ext-link xlink:href="https://journals.plos.org/plosone/s/materials-and-software-sharing#loc-sharing-code" ext-link-type="uri">https://journals.plos.org/plosone/s/materials-and-software-sharing#loc-sharing-code</ext-link> and ensure that your code is shared in a way that follows best practice and facilitates reproducibility and reuse.</p><p>3. Thank you for stating the following financial disclosure:</p><p>&#x0201c;National Natural Science Foundation, China (6197022931).&#x0201d;</p><p>Please state what role the funders took in the study. If the funders had no role, please state: "The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript."</p><p>If this statement is not correct you must amend it as needed.</p><p>Please include this amended Role of Funder statement in your cover letter; we will change the online submission form on your behalf.</p><p>4. We note that your Data Availability Statement is currently as follows: All relevant data are within the manuscript and its Supporting Information files.</p><p>Please confirm at this time whether or not your submission contains all raw data required to replicate the results of your study. Authors must share the &#x0201c;minimal data set&#x0201d; for their submission. PLOS defines the minimal data set to consist of the data required to replicate all study findings reported in the article, as well as related metadata and methods (<ext-link xlink:href="https://journals.plos.org/plosone/s/data-availability#loc-minimal-data-set-definition)." ext-link-type="uri">https://journals.plos.org/plosone/s/data-availability#loc-minimal-data-set-definition</ext-link>).</p><p>For example, authors should submit the following data:</p><p>- The values behind the means, standard deviations and other measures reported;</p><p>- The values used to build graphs;</p><p>- The points extracted from images for analysis.</p><p>Authors do not need to submit their entire data set if only a portion of the data was used in the reported study.</p><p>If your submission does not contain these data, please either upload them as Supporting Information files or deposit them to a stable, public repository and provide us with the relevant URLs, DOIs, or accession numbers. For a list of recommended repositories, please see <ext-link xlink:href="https://journals.plos.org/plosone/s/recommended-repositories." ext-link-type="uri">https://journals.plos.org/plosone/s/recommended-repositories</ext-link>.</p><p>If there are ethical or legal restrictions on sharing a de-identified data set, please explain them in detail (e.g., data contain potentially sensitive information, data are owned by a third-party organization, etc.) and who has imposed them (e.g., an ethics committee). Please also provide contact information for a data access committee, ethics committee, or other institutional body to which data requests may be sent. If data are owned by a third party, please indicate how others may request data access.</p><p>5. PLOS requires an ORCID iD for the corresponding author in Editorial Manager on papers submitted after December 6th, 2016. Please ensure that you have an ORCID iD and that it is validated in Editorial Manager. To do this, go to &#x02018;Update my Information&#x02019; (in the upper left-hand corner of the main menu), and click on the Fetch/Validate link next to the ORCID field. This will take you to the ORCID site and allow you to create a new iD or authenticate a pre-existing iD in Editorial Manager.</p><p>
<bold>Additional Editor Comments:</bold>
</p><p>This paper estimated the SOH of lithium-ion batteries by extracting health features (HF) during the constant voltage (CV) charging stage and optimizing a Backpropagation Neural Network. There are still some issues about method description, and experimental verification. Before acceptance, the authors should well answer these issues.</p><p>[Note: HTML markup is below. Please do not edit.]</p><p>Reviewers' comments:</p><p>Reviewer's Responses to Questions</p><p>
<bold>Comments to the Author</bold>
</p><p>1. Is the manuscript technically sound, and do the data support the conclusions?</p><p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p><p>Reviewer #1:&#x000a0;Partly</p><p>Reviewer #2:&#x000a0;Partly</p><p>**********</p><p>2. Has the statistical analysis been performed appropriately and rigorously? </p><p>Reviewer #1:&#x000a0;I Don't Know</p><p>Reviewer #2:&#x000a0;I Don't Know</p><p>**********</p><p>3. Have the authors made all data underlying the findings in their manuscript fully available?</p><p>The <ext-link xlink:href="http://www.plosone.org/static/policies.action#sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data&#x02014;e.g. participant privacy or use of data from a third party&#x02014;those must be specified.</p><p>Reviewer #1:&#x000a0;Yes</p><p>Reviewer #2:&#x000a0;No</p><p>**********</p><p>4. Is the manuscript presented in an intelligible fashion and written in standard English?</p><p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p><p>Reviewer #1:&#x000a0;Yes</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p>5. Review Comments to the Author</p><p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p><p>Reviewer #1:&#x000a0;The manuscript presents a method for estimating the SOH of lithium-ion batteries by extracting health features (HF) during the constant voltage (CV) charging stage and optimizing a Backpropagation Neural Network. While the approach shows potential, several issues in the paper need to be addressed to improve clarity and rigor. I recommend major revisions for the manuscript to address these issues.</p><p>1. In the abstract, the statement "Existing methods for estimating the state of health (SOH) of lithium-ion batteries primarily extract health features (HF) during the constant current (CC) charging stage." is inaccurate. Many studies also extract features during the CV stage. This needs to be revised for accuracy.</p><p>2. Why emphasize "Backpropagation Neural Network" (BPNN) instead of just "Neural Network" (NN)? BPNN is a type of NN, so the distinction is unnecessary unless there&#x02019;s a specific reason for using this term.</p><p>3. Contribution 1: "The current curve of the CV charging stage is transformed into a dQ/dI curve, from which two HFs are extracted." This is not a unique contribution, as many papers have done this already. Please revise this point.</p><p>4. Ensure that the symbols in equations and the text are consistent in their font style.</p><p>5. Regarding the first extracted feature, "sum of dQ/dI data points (SQI)," this is dependent on the sampling frequency and the initial current value during the CV charging stage. Therefore, this feature is not a universal one. Please discuss and clarify this.</p><p>6. The paper seems to use data from the entire CV charging stage. Why is there constant emphasis on "the end of the constant voltage charging stage"? How is the "end of the constant voltage charging stage" defined?</p><p>7. In Equation (4), based on the simplification, shouldn&#x02019;t IQIC just equal dQ?</p><p>8. Why were batteries #1, #2, #9, #10 from NCM and #1, #2 from NCA chosen for testing instead of all available batteries? Was this selection based on the results?</p><p>9. "However, when using BPNN, the initial parameters of the network are set randomly, which may cause the gradient descent algorithm to become trapped in local minima rather than global minima, thereby affecting the network's performance." Is this really an issue? Initialization is not generally a problem in NN training.</p><p>10. "BPNN is a supervised learning algorithm used to train multi-layer feedforward neural networks." Is BPNN an algorithm or a model? This needs clarification.</p><p>11. As far as I know, regardless of how NN values are initialized, optimization algorithms like SGD or Adam can ensure the model converges well. How do we determine whether the model's optimal point is due to SGD or the COA-initialized values? Since COA requires further optimization through SGD, could you provide evidence to show that the model cannot converge to an optimal point if initialized randomly, and that COA initialization makes a significant difference?</p><p>12. Please avoid using words to represent variables in formulas.</p><p>13. In Equations (14)-(16), please unify the symbols used with those in Equation (5) as they represent the same concepts.</p><p>14. "The first 70% of the data is selected as the training set, while the remaining 30% is used as the testing set." This validation method is not reasonable. How do you label the first 70% of the data? If the labels can be directly collected or computed, why then use BPNN to predict the remaining 30%? Training on one battery and testing on another (e.g., train on Battery A, test on Battery B) would be a more reasonable setup and closer to real-world applications.</p><p>15. In Table 2, how were the hyperparameters for the three NN models chosen? What were their specific values? Also, what does "SSA" mean in the &#x0201c;SSA-BPNN&#x0201d; method?</p><p>16. The Conclusion section lacks a discussion of the study's limitations and future research directions. These should be added to provide a more balanced perspective.</p><p>Reviewer #2:&#x000a0;1.The main challenges faced by the paper are not reflected in the abstract;</p><p>2.PINN is a hot topic of research, but the authors do not give any research progress from relevant scholars.</p><p>3.What are the differences and advantages of COA and other methods, the author does not give in 3.3;</p><p>4.How does the author solve the problem of insufficient dataset, only two features are applied to predict SOH, and the generalization ability is not guaranteed to be applied in practice?</p><p>5.The authors use BPNN as the main method to predict SOH, what is the difference between this and the existing LSTM and TCN?</p><p>**********</p><p>6. PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link> ). If published, this will include your full peer review and any attached files.</p><p>If you choose &#x0201c;no&#x0201d;, your identity will remain anonymous but your review may still be made public.</p><p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link> .</p><p>Reviewer #1:&#x000a0;<bold>Yes:&#x000a0;</bold> Fujin Wang</p><p>Reviewer #2:&#x000a0;No</p><p>**********</p><p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files.]</p><p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool,&#x000a0;<ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com/</ext-link> . PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email PLOS at&#x000a0;<email>figures@plos.org</email> . Please note that Supporting Information files do not need this step.</p></body></sub-article><sub-article article-type="author-comment" id="pone.0324868.r003"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0324868.r003</article-id><title-group><article-title>Author response to Decision Letter 1</article-title></title-group><related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0324868" id="rel-obj003" related-article-type="editor-report"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>1</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="author-response-date">15 Mar 2025</named-content>
</p><p>Dear Editors and Reviewers:</p><p>We are sincerely grateful for your time and effort in reviewing our manuscript. Your insightful comments have been instrumental in guiding us to enhance the quality and clarity of our work. We have carefully considered each of the reviewers' comments and have made every effort to incorporate the suggested changes into the revised manuscript. These revisions have refined our presentation and improved readability without altering the core content or framework. We have addressed each comment individually and provided detailed explanations of the changes we have made. We hope that these revisions meet with your approval and demonstrate our commitment to producing a work that meets the high standards of the journal.</p><p>Once again, we thank you for your dedication to maintaining the integrity and excellence of academic publishing. We are eager to hear your further thoughts and are confident that the revised manuscript addresses all concerns raised during the review process.</p><p>Reviewer #1</p><p>The manuscript presents a method for estimating the SOH of lithium-ion batteries by extracting health features (HF) during the constant voltage (CV) charging stage and optimizing a Backpropagation Neural Network. While the approach shows potential, several issues in the paper need to be addressed to improve clarity and rigor. I recommend major revisions for the manuscript to address these issues.</p><p>Response:</p><p>We sincerely appreciate the time and expertise you have dedicated to evaluating our manuscript. Your insightful comments have greatly contributed to strengthening the academic rigor and clarity of this work. We have carefully read each of your concerns with the utmost attention and made substantial revisions to enhance the clarity, rigor, and scientific contribution of the paper. The detailed responses to your comments are given as follows.</p><p>1.Comment:</p><p>In the abstract, the statement "Existing methods for estimating the state of health (SOH) of lithium-ion batteries primarily extract health features (HF) during the constant current (CC) charging stage." is inaccurate. Many studies also extract features during the CV stage. This needs to be revised for accuracy.</p><p>1.Reply:</p><p>Thank you for your careful review of the research background of this article. You pointed out that many studies are very accurate in extracting features during the CV stage. Our correction to this issue is as follows:</p><p>Original&#x0fffd;<!--&#x0ff1a;--></p><p>Existing methods for estimating the state of health (SOH) of lithium-ion batteries primarily extract health features (HF) during the constant current (CC) charging stage. However, this approach is susceptible to the randomness of the initial charging stage.</p><p>Revised:</p><p>Existing state of health (SOH) estimation methods for lithium-ion batteries predominantly extract health features (HF) from constant current (CC) and constant voltage (CV) charging phases. Nevertheless, CC charging phase feature extraction is susceptible to the randomness of the initial charging stage.</p><p>2.Comment:</p><p>Why emphasize "Backpropagation Neural Network" (BPNN) instead of just "Neural Network" (NN)? BPNN is a type of NN, so the distinction is unnecessary unless there&#x02019;s a specific reason for using this term.</p><p>2.Reply:</p><p>Thank you for your professional correction on the standardization of methodological terminology in this article. We understand your concerns and in our paper, we use the term 'BPNN' mainly based on the following aspects&#x0fffd;<!--&#x0ff1a;--></p><p>&#x0fffd;<!--&#x0ff08;-->1&#x0fffd;<!--&#x0ff09;--> BPNN is the main method used in our paper for predicting the SOH of batteries, and it is also one of the core technologies we study. We have made in-depth improvements and optimizations to BPNN, especially by combining COA to optimize its weights and thresholds, in order to improve the performance of the model. This improvement is one of the important innovations of the paper, so we emphasize that BPNN is intended to highlight our improvements and applications to this specific neural network model, rather than discussing neural networks in general.</p><p>&#x0fffd;<!--&#x0ff08;-->2&#x0fffd;<!--&#x0ff09;--> Although BPNN is a type of NN, it has its unique structure and training approach. BPNN is a multi-layer feedforward neural network trained using backpropagation algorithm, capable of handling complex nonlinear problems. In the specific task of battery SOH prediction, we utilize these characteristics of BPNN to establish a mapping relationship between health features and SOH. Emphasizing BPNN can enable readers to have a more accurate understanding of the methods and technical details we use.</p><p>We emphasize that 'BPNN' is to accurately convey the core methods used in our research, highlight our innovative points, and avoid possible ambiguity. This is not to say that we deliberately distinguish between BPNN and NN, but rather a reasonable choice based on the content and research focus of the paper. Thank you again for your concern and guidance on the paper. Your feedback has played an important role in improving the quality of our paper.</p><p>3.Comment:</p><p>Contribution 1: "The current curve of the CV charging stage is transformed into a dQ/dI curve, from which two HFs are extracted." This is not a unique contribution, as many papers have done this already. Please revise this point.</p><p>3.Reply:</p><p>Thank you for your rigorous evaluation of the innovative dimensions of this research. We have revised the statement of Contribution 1 as follows, with the aim of accurately stating the specific contribution of the article.</p><p>Original&#x0fffd;<!--&#x0ff1a;--></p><p>&#x0fffd;<!--&#x0ff08;-->1&#x0fffd;<!--&#x0ff09;--> The current curve of the CV charging stage is transformed into a dQ/dI curve, from which two HFs are extracted&#x0fffd;<!--&#x0ff1b;--></p><p>Revised:</p><p>&#x0fffd;<!--&#x0ff08;-->1&#x0fffd;<!--&#x0ff09;--> This study pioneers a novel method for lithium-ion battery health feature extraction within the 200mA threshold during the terminal phase of CV charging&#x0fffd;<!--&#x0ff1b;--></p><p>4.Comment:</p><p>Ensure that the symbols in equations and the text are consistent in their font style.</p><p>4.Reply:</p><p>Thank you for pointing out this crucial detail. We have conducted a comprehensive review of all formulas and mathematical symbols in the text description, and have now adopted the following format:</p><p>(1) Font style: Times New Roma;</p><p>(2) Character size: 12 pounds;</p><p>(3) Line spacing: Double line spacing.</p><p>5.Comment:</p><p>Regarding the first extracted feature, "sum of dQ/dI data points (SQI)," this is dependent on the sampling frequency and the initial current value during the CV charging stage. Therefore, this feature is not a universal one. Please discuss and clarify this.</p><p>5.Reply:</p><p>Thank you for your attention to the feature extraction section. The concern you raised about the possible dependence of "Sum of dQ/dI data points (SQI)" on sampling frequency and initial current values is reasonable, but we have systematically analyzed and verified its universality from the following perspectives:</p><p>&#x0fffd;<!--&#x0ff08;-->1&#x0fffd;<!--&#x0ff09;--> In the "Battery datasets" section of this article, the sampling conditions for all test data are clearly defined: the NCA and NCM datasets use constant voltage charging stage data with a 10 second sampling rate, which are sourced from (reference [32]). This rigorous experimental design ensures the consistency of the sampling frequency for SQI calculations and eliminates feature bias caused by differences in sampling rates across datasets. If applied to other scenarios in the future, further universality can be improved through normalization processing (such as standardizing dQ/dI by time integration).</p><p>&#x0fffd;<!--&#x0ff08;-->2&#x0fffd;<!--&#x0ff09;--> Although SQI seems to rely on the initial current value (Isi) in mathematical definition, there are mechanisms in the actual battery aging process that make it stable&#x0fffd;<!--&#x0ff1a;--></p><p>&#x0fffd;<!--&#x0f06c;--> The morphological changes of the dQ/dI curve are mainly caused by the internal resistance and polarization effect of the battery (reference [29]), rather than simply determined by the initial current. As the number of cycles increases, the internal resistance of the battery increases, leading to an accelerated decay rate of dQ/dI (as shown in Figure 1);</p><p>&#x0fffd;<!--&#x0f06c;--> By comparing the experimental data at different temperatures (35 &#x02103; vs 45 &#x02103;) and different rates (0.5C vs 0.25C) (Table 1), it was found that SQI showed a strong linear correlation with capacity degradation (Pearson coefficient&#x0003e;0.94), indicating that its feature extraction ability is not affected by the absolute value of the initial current, but is closely related to the internal state of the battery.</p><p>6.Comment:</p><p>The paper seems to use data from the entire CV charging stage. Why is there constant emphasis on "the end of the constant voltage charging stage"? How is the "end of the constant voltage charging stage" defined?</p><p>6.Reply:</p><p>Thank you for your attention to the logic of data selection. We use data from the entire CV charging stage in this article for visualization and theoretical analysis, revealing the complete evolution mechanism of the dQ/dI curve. But we emphasize 'the end of the constant voltage charging stage' because the health features in this article are only extracted at the moment when CV charging is about to end, in order to meet the real-time requirements and data storage limitations of BMS.</p><p>7.Comment:</p><p>In Equation (4), based on the simplification, shouldn&#x02019;t IQIC just equal dQ?</p><p>7.Reply:</p><p>Thank you for your attention to the details of the paper. The simplification issue you pointed out is very important, which reflects the rigor of the paper. After careful analysis, we acknowledge that there is a lack of rigor in the wording here. The following is a detailed explanation and correction of this issue:</p><p>&#x0fffd;<!--&#x0ff08;-->1&#x0fffd;<!--&#x0ff09;--> According to the fundamental theorem of calculus&#x0fffd;<!--&#x0ff1a;--> &#x0fffd;<!--&#x0ff0c;-->therefore &#x0fffd;<!--&#x0ff0c;-->so IQICi should be equal to &#x02206;Q&#x03002;</p><p>&#x0fffd;<!--&#x0ff08;-->2&#x0fffd;<!--&#x0ff09;--> We have revised all the parts of the paper that involve this expression to enhance readability and rigor. Thank you again for your valuable feedback!</p><p>8.Comment:</p><p>Why were batteries #1, #2, #9, #10 from NCM and #1, #2 from NCA chosen for testing instead of all available batteries? Was this selection based on the results?</p><p>8.Reply:</p><p>Thank you for your attention to the experimental design. The reason why we choose specific batteries for testing is as follows, rather than preference based on experimental results:</p><p>&#x0fffd;<!--&#x0f06c;--> The dataset provided in reference [32] contains multiple battery labels, but their parameters (such as temperature and charging rate) differ. We only select batteries that meet the following conditions.In the NCM dataset, we selected batteries (# 1, # 2, # 9, # 10) with different temperature conditions (35 &#x02103; and 45 &#x02103;) to verify the robustness of the method under temperature changes. Similarly, in the NCA dataset, batteries (# 1, # 2) with different charging rates (0.25C) were selected to test the model's adaptability to changes in charging rates. This design ensures that the experiment covers the key variables of temperature and charging rate, thus comprehensively evaluating the generalization ability of the method.</p><p>&#x0fffd;<!--&#x0f06c;--> During the experimental phase, we found that some battery labels in the dataset had missing data. For example, the battery (CY25-1/1 # 2) only had a total of 37 cycles, and the capacity data for the 26th cycle was missing; The rated capacity data for the 51st, 102nd, 153rd, 204th, 255th, and 306th cycles of battery (CY25-0.5/1 # 9) is missing. There are many similar results, which may be due to experimental errors or equipment abnormalities during dataset collection. In order to ensure the authenticity of the original data and avoid misleading conclusions caused by interpolation of the original dataset, we selected batteries with relatively complete original data for testing.</p><p>9.Comment:</p><p>"However, when using BPNN, the initial parameters of the network are set randomly, which may cause the gradient descent algorithm to become trapped in local minima rather than global minima, thereby affecting the network's performance." Is this really an issue? Initialization is not generally a problem in NN training.</p><p>9.Reply:</p><p>Thank you for your attention to the BPNN initialization issue. Although the importance of initialization in modern neural network training may vary depending on the complexity of the model, initialization issues still need to be taken seriously in this study, mainly for the following reasons:</p><p>&#x0fffd;<!--&#x0ff08;-->1&#x0fffd;<!--&#x0ff09;--> Indeed, the initial parameters of BPNN are randomly set, and this randomness may cause the gradient descent algorithm to get stuck in local minima during the optimization process, rather than finding the global minimum. This situation is particularly common in complex nonlinear problems, especially when the data has high-dimensional features or the network structure is complex. The existence of local minima can affect the performance of the model, leading to inaccurate or unstable prediction results. To ensure the rigor of the content, we have cited relevant literature on this sentence: &#x0201c;However, when using BPNN, the initial parameters of the network are set randomly, which may cause the gradient descent algorithm to become trapped in local minima rather than global minima, thereby affecting the network's performance[15].&#x0201d;</p><p>&#x0fffd;<!--&#x0ff08;-->2&#x0fffd;<!--&#x0ff09;--> In many cases, using standard initialization methods and optimization algorithms, BPNN can achieve good training results, especially in situations with large data volumes and reasonable feature distributions. However, in some specific cases, optimizing initialization is still necessary. For example, when the amount of data is limited, the features have complex nonlinear relationships, or the network structure is very sensitive to initial parameters, random initialization may lead to instability and performance fluctuations in model training. In our research, we found that optimizing the initial weights and thresholds of BPNN can significantly improve the predictive performance and stability of the model for battery SOH prediction. This is also the reason why we chose to use COA to optimize the initialization parameters of BPNN.</p><p>10.Comment:</p><p>"BPNN is a supervised learning algorithm used to train multi-layer feedforward neural networks." Is BPNN an algorithm or a model? This needs clarification.</p><p>10.Reply:</p><p>Thank you very much for pointing out this important issue of terminology confusion. After careful examination, BPNN is a model rather than an algorithm. We acknowledge that there were some unclear omissions in the initial draft of the paper and sincerely apologize to you. We have revised the original sentence:</p><p>Original&#x0fffd;<!--&#x0ff1a;--></p><p>BPNN is a supervised learning algorithm used to train multi-layer feedforward neural networks.</p><p>Revised:</p><p>BPNN is a shallow feedforward neural network model based on supervised learning.</p><p>11.Comment:</p><p>As far as I know, regardless of how NN values are initialized, optimization algorithms like SGD or Adam can ensure the model converges well. How do we determine whether the model's optimal point is due to SGD or the COA-initialized values? Since COA requires further optimization through SGD, could you provide evidence to show that the model cannot converge to an optimal point if initialized randomly, and that COA initialization makes a significant difference?</p><p>11.Reply:</p><p>Thank you for reviewing our paper and providing valuable feedback. We understand your concern about how to determine whether the optimal solution of a model is caused by SGD or COA initialization values, and whether evidence can be provided to prove that randomly initialized models cannot converge to the optimal solution, while COA initialization has significant differences. We provide the following explanation for this:</p><p>&#x0fffd;<!--&#x0ff08;-->1&#x0fffd;<!--&#x0ff09;--> Although optimization algorithms such as SGD or Adam can converge the model in most cases, the initial parameter settings still have a significant impact on the convergence speed and final performance of the model. Different initialization methods may cause the model to converge to different local or global minima during the training process. Especially in complex nonlinear problems, such as battery SOH prediction, the selection of initial parameters may affect the model's ability to capture complex patterns.</p><p>&#x0fffd;<!--&#x0ff08;-->2&#x0fffd;<!--&#x0ff09;--> Due to the random initialization of weights and thresholds in the BPNN model, each run yields different results, which can lead to unstable results. This is why we use COA to optimize the initial parameters. However, we need to clarify that it does not mean that without optimizing BPNN, it cannot achieve the optimal solution. Instead, through optimization, the parameters generated each time it runs can be</p><supplementary-material id="pone.0324868.s003" position="float" content-type="local-data"><label>Attachment</label><caption><p>Submitted filename: <named-content content-type="submitted-filename">Response to Reviewers.docx</named-content></p></caption><media xlink:href="pone.0324868.s003.docx"/></supplementary-material></body></sub-article><sub-article article-type="aggregated-review-documents" id="pone.0324868.r004" specific-use="decision-letter"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0324868.r004</article-id><title-group><article-title>Decision Letter 1</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhao</surname><given-names>Zhibin</given-names></name><role>Academic Editor</role></contrib></contrib-group><permissions><copyright-statement>&#x000a9; 2025 Zhibin Zhao</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Zhibin Zhao</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link> , which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0324868" id="rel-obj004" related-article-type="reviewed-article"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>1</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="letter-date">2 May 2025</named-content>
</p><p>A lithium-ion batteries SOH estimation method based on extracting new features during the constant voltage charging stage and improving BPNN</p><p>PONE-D-25-03811R1</p><p>Dear Dr. Li,</p><p>We&#x02019;re pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it meets all outstanding technical requirements.</p><p>Within one week, you&#x02019;ll receive an e-mail detailing the required amendments. When these have been addressed, you&#x02019;ll receive a formal acceptance letter and your manuscript will be scheduled for publication.</p><p>An invoice will be generated when your article is formally accepted. Please note, if your institution has a publishing partnership with PLOS and your article meets the relevant criteria, all or part of your publication costs will be covered. Please make sure your user information is up-to-date by logging into Editorial Manager at <ext-link xlink:href="https://www.editorialmanager.com/pone/" ext-link-type="uri">Editorial Manager&#x000ae;</ext-link> &#x000a0;and clicking the &#x02018;Update My Information' link at the top of the page. If you have any questions relating to publication charges, please contact our Author Billing department directly at authorbilling@plos.org.</p><p>If your institution or institutions have a press office, please notify them about your upcoming paper to help maximize its impact. If they&#x02019;ll be preparing press materials, please inform our press team as soon as possible -- no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact onepress@plos.org.</p><p>Kind regards,</p><p>Zhibin Zhao</p><p>Academic Editor</p><p>PLOS ONE</p><p>Additional Editor Comments (optional):</p><p>Before completely acceptance, please make the final revision.</p><p>Reviewers' comments:</p><p>Reviewer's Responses to Questions</p><p>
<bold>Comments to the Author</bold>
</p><p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the &#x0201c;Comments to the Author&#x0201d; section, enter your conflict of interest statement in the &#x0201c;Confidential to Editor&#x0201d; section, and submit your "Accept" recommendation.</p><p>Reviewer #1:&#x000a0;(No Response)</p><p>Reviewer #2:&#x000a0;All comments have been addressed</p><p>**********</p><p>2. Is the manuscript technically sound, and do the data support the conclusions?</p><p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. </p><p>Reviewer #1:&#x000a0;(No Response)</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p>3. Has the statistical analysis been performed appropriately and rigorously? </p><p>Reviewer #1:&#x000a0;(No Response)</p><p>Reviewer #2:&#x000a0;N/A</p><p>**********</p><p>4. Have the authors made all data underlying the findings in their manuscript fully available?</p><p>The <ext-link xlink:href="http://www.plosone.org/static/policies.action#sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data&#x02014;e.g. participant privacy or use of data from a third party&#x02014;those must be specified.</p><p>Reviewer #1:&#x000a0;(No Response)</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p>5. Is the manuscript presented in an intelligible fashion and written in standard English?</p><p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.</p><p>Reviewer #1:&#x000a0;(No Response)</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p>6. Review Comments to the Author</p><p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)</p><p>Reviewer #1:&#x000a0;For comment 4, inconsistencies exist between upright and italic typefaces. For instance, the symbols in Equation (1) appear in italics, whereas their corresponding references in the preceding text body are presented in Roman typeface. This typographic inconsistency requires unification.</p><p>Reviewer #2:&#x000a0;this paper proposes an SOH estimation method for extracting HF at the end of the CV charging stage and optimizes</p><p>the Backpropagation Neural Network (BPNN). The authors have solved my problems and it can be accepted.</p><p>**********</p><p>7. PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link> ). If published, this will include your full peer review and any attached files.</p><p>If you choose &#x0201c;no&#x0201d;, your identity will remain anonymous but your review may still be made public.</p><p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link> .</p><p>Reviewer #1:&#x000a0;No</p><p>Reviewer #2:&#x000a0;No</p><p>**********</p></body></sub-article><sub-article article-type="editor-report" id="pone.0324868.r005" specific-use="acceptance-letter"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0324868.r005</article-id><title-group><article-title>Acceptance letter</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Zhao</surname><given-names>Zhibin</given-names></name><role>Academic Editor</role></contrib></contrib-group><permissions><copyright-statement>&#x000a9; 2025 Zhibin Zhao</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Zhibin Zhao</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link> , which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0324868" id="rel-obj005" related-article-type="reviewed-article"/></front-stub><body><p>PONE-D-25-03811R1</p><p>PLOS ONE</p><p>Dear Dr. Li,</p><p>I'm pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now being handed over to our production team.</p><p>At this stage, our production department will prepare your paper for publication. This includes ensuring the following:</p><p>* All references, tables, and figures are properly cited</p><p>* All relevant supporting information is included in the manuscript submission,</p><p>* There are no issues that prevent the paper from being properly typeset</p><p>You will receive further&#x000a0;instructions from the production team, including instructions on how to review your proof when it&#x000a0;is ready. Please keep in mind that we are working through a large volume of accepted articles, so please give us a few days to review your paper and let you know the next and final steps.</p><p>Lastly, if your institution or institutions have a press office, please let them know about your upcoming paper now to help maximize its impact. If they'll be preparing press materials, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact onepress@plos.org.</p><p>If we can help with anything else, please email us at customercare@plos.org.</p><p>Thank you for submitting your work to PLOS ONE and supporting open access.</p><p>Kind regards,</p><p>PLOS ONE Editorial Office Staff</p><p>on behalf of</p><p>Dr. Zhibin Zhao</p><p>Academic Editor</p><p>PLOS ONE</p></body></sub-article></article>