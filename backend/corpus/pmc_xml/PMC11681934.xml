<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="en" article-type="research-article"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id><journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id><journal-id journal-id-type="publisher-id">bioinformatics</journal-id><journal-title-group><journal-title>Bioinformatics</journal-title></journal-title-group><issn pub-type="ppub">1367-4803</issn><issn pub-type="epub">1367-4811</issn><publisher><publisher-name>Oxford University Press</publisher-name></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmid">39666947</article-id><article-id pub-id-type="pmc">PMC11681934</article-id>
<article-id pub-id-type="doi">10.1093/bioinformatics/btae737</article-id><article-id pub-id-type="publisher-id">btae737</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Paper</subject><subj-group subj-group-type="category-toc-heading"><subject>Genetics and Population Analysis</subject></subj-group></subj-group><subj-group subj-group-type="category-taxonomy-collection"><subject>AcademicSubjects/SCI01060</subject></subj-group></article-categories><title-group><article-title>A hypercubic Mk model framework for capturing reversibility in disease, cancer, and evolutionary accumulation modelling</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8559-3519</contrib-id><name><surname>Johnston</surname><given-names>Iain G</given-names></name><aff>
<institution>Department of Mathematics, University of Bergen</institution>, <addr-line>Realfagbygget</addr-line>, Bergen 5007, <country country="NO">Norway</country></aff><aff>
<institution>Computational Biology Unit, University of Bergen</institution>, <addr-line>Thorm&#x000f8;hlensgate 55</addr-line>, Bergen 5008, <country country="NO">Norway</country></aff><xref rid="btae737-cor1" ref-type="corresp"/><!--iain.johnston@uib.no--></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6637-9039</contrib-id><name><surname>Diaz-Uriarte</surname><given-names>Ramon</given-names></name><aff>
<institution>Department of Biochemistry, School of Medicine, Universidad Autonoma de Madrid</institution>, Madrid 28029, <country country="ES">Spain</country></aff><aff>
<institution>Instituto de Investigaciones Biomedicas Sols-Morreale (IIBM), CSIC-UAM</institution>, Madrid 28029, <country country="ES">Spain</country></aff></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Schwartz</surname><given-names>Russell</given-names></name><role>Associate Editor</role></contrib></contrib-group><author-notes><corresp id="btae737-cor1">Corresponding author. Department of Mathematics, University of Bergen,&#x000a0;<addr-line>Realfagbygget</addr-line>, Bergen 5007, Norway. E-mail: <email>iain.johnston@uib.no</email></corresp></author-notes><pub-date pub-type="collection"><month>1</month><year>2025</year></pub-date><pub-date pub-type="epub" iso-8601-date="2024-12-12"><day>12</day><month>12</month><year>2024</year></pub-date><pub-date pub-type="pmc-release"><day>12</day><month>12</month><year>2024</year></pub-date><volume>41</volume><issue>1</issue><elocation-id>btae737</elocation-id><history><date date-type="received"><day>27</day><month>6</month><year>2024</year></date><date date-type="rev-recd"><day>29</day><month>11</month><year>2024</year></date><date date-type="editorial-decision"><day>07</day><month>12</month><year>2024</year></date><date date-type="accepted"><day>11</day><month>12</month><year>2024</year></date><date date-type="corrected-typeset"><day>28</day><month>12</month><year>2024</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2024. Published by Oxford University Press.</copyright-statement><copyright-year>2024</copyright-year><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><self-uri xlink:href="btae737.pdf"/><abstract><title>Abstract</title><sec id="s1"><title>Motivation</title><p>Accumulation models, where a system progressively acquires binary features over time, are common in the study of cancer progression, evolutionary biology, and other fields. Many approaches have been developed to infer the accumulation pathways by which features (e.g. mutations) are acquired over time. However, most of these approaches do not support reversibility: the loss of a feature once it has been acquired (e.g. the clearing of a mutation from a tumor or population).</p></sec><sec id="s2"><title>Results</title><p>Here, we demonstrate how the well-established Mk model from evolutionary biology, embedded on a hypercubic transition graph, can be used to infer the dynamics of accumulation processes, including the possibility of reversible transitions, from data which may be uncertain and cross-sectional, longitudinal, or phylogenetically/phylogenomically embedded. Positive and negative interactions between arbitrary sets of features (not limited to pairwise interactions) are supported. We demonstrate this approach with synthetic datasets and real data on bacterial drug resistance and cancer progression. While this implementation is limited in the number of features that can be considered, we discuss how this limitation may be relaxed to deal with larger systems.</p></sec><sec id="s3"><title>Availability and implementation</title><p>The code implementing this setup in R is freely available at <ext-link xlink:href="https://github.com/StochasticBiology/hypermk" ext-link-type="uri">https://github.com/StochasticBiology/hypermk</ext-link>.</p></sec></abstract><abstract abstract-type="graphical"><title>Graphical Abstract</title><p>
<fig position="float" id="btae737-F7"><label>Graphical Abstract</label><graphic xlink:href="btae737f7" position="float"/></fig>
</p></abstract><funding-group><award-group award-type="grant"><funding-source>
<institution-wrap><institution>European Research Council</institution><institution-id institution-id-type="DOI">10.13039/100010663</institution-id></institution-wrap>
</funding-source></award-group><award-group award-type="grant"><funding-source>
<institution-wrap><institution>European Union&#x02019;s Horizon 2020 Research and Innovation Programme</institution></institution-wrap>
</funding-source></award-group><award-group award-type="grant"><funding-source>
<institution-wrap><institution>Trond Mohn Foundation</institution><institution-id institution-id-type="DOI">10.13039/100016190</institution-id></institution-wrap>
</funding-source><award-id>TMS2021TMT09</award-id></award-group></funding-group><counts><page-count count="10"/></counts></article-meta></front><body><sec id="S1"><title>1 Introduction</title><p>Many systems of interest in biology, medicine, and beyond involve the progressive, random, coupled accumulation of different binary features over time. Such features&#x02014;variously called traits or characters&#x02014;may be, e.g. the presence or absence of particular mutations in a tumor (<xref rid="btae737-B4" ref-type="bibr">Beerenwinkel <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btae737-B37" ref-type="bibr">Schwartz and Sch&#x000e4;ffer 2017</xref>, <xref rid="btae737-B35" ref-type="bibr">Schill <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae737-B12" ref-type="bibr">Diaz-Uriarte and Johnston 2024</xref>), susceptibility or resistance to particular drugs in evolving pathogens (<xref rid="btae737-B3" ref-type="bibr">Beerenwinkel <italic toggle="yes">et al.</italic> 2005</xref>, <xref rid="btae737-B14" ref-type="bibr">Greenbury <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae737-B25" ref-type="bibr">Moen and Johnston 2023</xref>, <xref rid="btae737-B32" ref-type="bibr">Renz <italic toggle="yes">et al.</italic> 2024</xref>), the presence or absence of genes in evolving genomes (<xref rid="btae737-B18" ref-type="bibr">Johnston and Williams 2016</xref>), or the presentation or absence of particular clinical symptoms in patients (<xref rid="btae737-B16" ref-type="bibr">Johnston <italic toggle="yes">et al.</italic> 2019</xref>, <xref rid="btae737-B34" ref-type="bibr">Schill <italic toggle="yes">et al.</italic> 2024</xref>). In all these cases, the study of the dynamics by which features are acquired&#x02014;the trajectories or pathways of accumulation&#x02014;are of interest in both describing the scientific system and predicting its future behavior.</p><p>The field of accumulation modelling considers how sets of discrete, usually binary, features are acquired over time in a system. Many approaches have been developed in the cancer literature, where features are often driver mutations, and samples are independent patients (<xref rid="btae737-B4" ref-type="bibr">Beerenwinkel <italic toggle="yes">et al.</italic> 2015</xref>, <xref rid="btae737-B26" ref-type="bibr">Montazeri <italic toggle="yes">et al.</italic> 2016</xref>, <xref rid="btae737-B35" ref-type="bibr">Schill <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae737-B2" ref-type="bibr">Angaroni <italic toggle="yes">et al.</italic> 2022</xref>, <xref rid="btae737-B11" ref-type="bibr">Diaz-Uriarte and Herrera-Nieto 2022</xref>, <xref rid="btae737-B12" ref-type="bibr">Diaz-Uriarte and Johnston 2024</xref>, <xref rid="btae737-B34" ref-type="bibr">Schill <italic toggle="yes">et al.</italic> 2024</xref>) or, recently, trees reflecting the development of tumors over time (<xref rid="btae737-B7" ref-type="bibr">Caravagna <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btae737-B24" ref-type="bibr">Luo <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae737-B1" ref-type="bibr">Aga <italic toggle="yes">et al.</italic> 2024</xref>). There are 2<sup><italic toggle="yes">L</italic></sup> possible patterns of the presence or absence for each of <italic toggle="yes">L</italic> features, and transitions are usually considered to correspond to the acquisition of exactly one feature. Here, a system may be in one of 2<sup><italic toggle="yes">L</italic></sup> states, and transitions between any pair <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> of these states occur with a rate <italic toggle="yes">r<sub>ij</sub></italic>, which can be nonzero only if <italic toggle="yes">j</italic> differs from <italic toggle="yes">i</italic> by the presence of one feature.</p><p>The Markov k-state (Mk) model (<xref rid="btae737-B27" ref-type="bibr">Pagel 1994</xref>, <xref rid="btae737-B21" ref-type="bibr">Lewis 2001</xref>) is widely used in evolutionary biology to infer the dynamics by which features (usually called characters, in this context) change between discrete states on a phylogeny. Here, every instance of a system can occupy one of <italic toggle="yes">k</italic> discrete states, with Markovian transitions allowed between these states (<xref rid="btae737-F1" ref-type="fig">Fig.&#x000a0;1A</xref>). As an evolutionary process branches into different lineages, descendants inherit their ancestor&#x02019;s state and may transition to other states independently of their sister lineages. Different versions of the model place, or relax, different constraints on the rates of the transitions between states, which are parameters of the model. The original real-world example is how two binary traits, multiple mating partners and posterior decoration, co-evolve in primates (<xref rid="btae737-B27" ref-type="bibr">Pagel 1994</xref>). More generally in the Mk model (<xref rid="btae737-B5" ref-type="bibr">Boyko and Beaulieu 2021</xref>), a system may be in one of <italic toggle="yes">k</italic> states, and transitions between any pair <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic> of these states occur with a rate <italic toggle="yes">r<sub>ij</sub></italic> for a given instance of the system.</p><fig position="float" id="btae737-F1"><label>Figure 1.</label><caption><p>State spaces and features in (reversible) accumulation and Mk models. The state space and supported transitions in several accumulation model pictures for an <italic toggle="yes">L</italic>&#x02009;=&#x02009;3 feature system. Italics give the names of some approaches using each picture. (A) Unrestricted dynamics, where every state can transition to every other. (B) Reversible stepwise dynamics. (C) Irreversible stepwise dynamics. (D) Different accumulation modelling approaches are equivalent to the irreversible stepwise dynamics picture, and may assume independent rates, impose structure in the transition rates (modelling the influence of each feature on each other), or support only a subset of transitions (modelling dependencies in feature acquisitions). More detail in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>.</p></caption><graphic xlink:href="btae737f1" position="float"/></fig><p>As discussed previously (<xref rid="btae737-B25" ref-type="bibr">Moen and Johnston 2023</xref>), a mathematical connection exists between these two approaches, clearly visible from the final sentences of the preceding two paragraphs. If <italic toggle="yes">k&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>2<sup><italic toggle="yes">L</italic></sup> and the transition rates for the Mk model are constrained to be zero for the necessary pairs of states (those that differ by the acquisition of more than one change), the set of supported transitions in the Mk model are identical with those in the accumulation model (<xref rid="btae737-F1" ref-type="fig">Fig.&#x000a0;1C and D</xref>).</p><p>Consider now a <italic toggle="yes">reversible</italic> accumulation model, which is the same as the accumulation model, but where <italic toggle="yes">r<sub>ij</sub></italic> is now also allowed to be nonzero if <italic toggle="yes">j</italic> differs from <italic toggle="yes">i</italic> by the <italic toggle="yes">absence</italic> of one feature. In other words, the system can transition by acquiring <italic toggle="yes">or losing</italic> individual features. This reversibility challenges existing approaches designed to model accumulation processes, because an infinite set of accumulation pathways now in principle exists between any two states (involving arbitrarily long sequences of feature gain-loss pairs). However, this reversible picture still corresponds to a subset of the more general Mk model (<xref rid="btae737-F1" ref-type="fig">Fig.&#x000a0;1B</xref>). Indeed, using a (potentially hidden) Markov modelling framework to explore the coupled evolution of many binary traits is a central idea behind evolutionary analysis packages like <italic toggle="yes">corHMM</italic> (<xref rid="btae737-B5" ref-type="bibr">Boyko and Beaulieu 2021</xref>). Here, we will show that existing methods from the evolutionary literature for inferring parameters in the Mk model can readily be applied to this reversible accumulation picture, allowing analysis of this problem.</p></sec><sec id="S2"><title>2 Materials and methods</title><sec id="S3"><title>2.1 State spaces in (reversible) accumulation and Mk models</title><p>Consider a state space <bold>S</bold> = {<italic toggle="yes">S</italic><sub>0</sub>, &#x02026;, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mi>L</mml:mi></mml:msup></mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>}, consisting of 2<sup><italic toggle="yes">L</italic></sup> states. For convenience, we set the index of a state to the decimal value of a binary string of length <italic toggle="yes">L</italic>, corresponding to the absence (0) or presence (1) of each of the <italic toggle="yes">L</italic> features in that state (e.g. for <italic toggle="yes">L&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>3, 000 &#x02261; 0, 001 &#x02261; 1, 010 &#x02261; 2, &#x02026;, 110 &#x02261; 6, 111 &#x02261; 7). This is a general procedure for coding combinations of binary states as multistate characters that has been used before with the Mk model (e.g. in <xref rid="btae737-B5" ref-type="bibr">Boyko and Beaulieu (2021</xref>: 470)). This transformation allows us to seamlessly use the Mk model for accumulation processes that include the cross-sectional case, and that, then, allow us to model both irreversible and reversible cases.</p><p>We label the transition rate from the state with index <italic toggle="yes">i</italic> to the state with index <italic toggle="yes">j</italic> as <italic toggle="yes">r<sub>ij</sub></italic>. A general accumulation-only model allows <italic toggle="yes">r<sub>ij</sub></italic> &#x0003e; 0 if and only if <italic toggle="yes">j</italic>&#x02009;<italic toggle="yes">&#x02212;</italic>&#x02009;<italic toggle="yes">i&#x02009;</italic>=&#x02009;2<sup><italic toggle="yes">m</italic></sup>, where <italic toggle="yes">m</italic> is a nonnegative integer. In other words, transitions are only supported from <italic toggle="yes">i</italic> to <italic toggle="yes">j</italic> if <italic toggle="yes">i</italic> lacks exactly one feature that <italic toggle="yes">j</italic> possesses. The corresponding transition graph for this model takes the form of an <italic toggle="yes">L</italic>-dimensional hypercube with single directed edges (<xref rid="btae737-F1" ref-type="fig">Fig.&#x000a0;1C</xref>). A reversible accumulation model allows <italic toggle="yes">r<sub>ij</sub></italic> &#x0003e; 0 if and only if <italic toggle="yes">j</italic>&#x02009;<italic toggle="yes">&#x02212;</italic>&#x02009;<italic toggle="yes">i&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>2<sup><italic toggle="yes">m</italic></sup> or <italic toggle="yes">i</italic>&#x02009;<italic toggle="yes">&#x02212;</italic>&#x02009;<italic toggle="yes">j&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>2<sup><italic toggle="yes">m</italic></sup>. Hence, two (different) nonzero rates can correspond to the transition from <italic toggle="yes">i</italic> to <italic toggle="yes">j</italic> (gaining a feature) and from <italic toggle="yes">j</italic> to <italic toggle="yes">i</italic> (losing that feature). Now the transition graph is an <italic toggle="yes">L</italic>-dimensional hypercube with pairs of opposing directed edges between vertices (<xref rid="btae737-F1" ref-type="fig">Fig.&#x000a0;1B</xref>).</p><p>Now consider an Mk model with <italic toggle="yes">k&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>2<sup><italic toggle="yes">L</italic></sup> states. The most general picture (called the extended Mk model) allows <italic toggle="yes">r<sub>ij</sub></italic> &#x0003e; 0 for all <italic toggle="yes">i</italic> and <italic toggle="yes">j</italic>. Hence, the transition graph is a complete graph, with pairs of opposing directed edges between every pair of vertices (<xref rid="btae737-F1" ref-type="fig">Fig.&#x000a0;1A</xref>). Clearly, both the transition graphs for the accumulation-only and reversible accumulation models are subgraphs of the extended Mk model transition graph, and can be captured by constraining the required set of edges in the Mk model to be zero. We can then use these specific parameterizations of the Mk model as an accumulation model, as they allow transitions only between those states that an accumulation model would support.</p><p>More precisely, an <italic toggle="yes">extended Mk model</italic> is generally parameterized by a <italic toggle="yes">k</italic> &#x000d7; <italic toggle="yes">k</italic> matrix representing transition rates <italic toggle="yes">r<sub>ij</sub></italic> from every state <italic toggle="yes">i</italic> to every other state <italic toggle="yes">j</italic>. A <italic toggle="yes">reversible accumulation model</italic> describing <italic toggle="yes">L</italic> features can be represented as a <italic toggle="yes">k</italic> &#x000d7; <italic toggle="yes">k</italic> matrix (where <italic toggle="yes">k&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>2<sup><italic toggle="yes">L</italic></sup>) representing transition rates <italic toggle="yes">r<sub>ij</sub></italic>, where <italic toggle="yes">r<sub>ij</sub></italic> &#x0003e; 0 if and only if <italic toggle="yes">j</italic>&#x02009;<italic toggle="yes">&#x02212;</italic>&#x02009;<italic toggle="yes">i&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>2<sup><italic toggle="yes">m</italic></sup> or <italic toggle="yes">i</italic>&#x02009;<italic toggle="yes">&#x02212;</italic>&#x02009;<italic toggle="yes">j&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>2<sup><italic toggle="yes">m</italic></sup> for nonnegative integer <italic toggle="yes">m</italic>. An <italic toggle="yes">irreversible accumulation model</italic> can similarly be represented as a <italic toggle="yes">k</italic> &#x000d7; <italic toggle="yes">k</italic> matrix (where <italic toggle="yes">k&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>2<sup><italic toggle="yes">L</italic></sup>) representing transition rates <italic toggle="yes">r<sub>ij</sub></italic>, where <italic toggle="yes">r<sub>ij</sub></italic> &#x0003e; 0 if and only if <italic toggle="yes">j</italic>&#x02009;<italic toggle="yes">&#x02212;</italic>&#x02009;<italic toggle="yes">i&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>2<sup><italic toggle="yes">m</italic></sup> for nonnegative integer <italic toggle="yes">m</italic>. If we write {<italic toggle="yes">&#x003b8;<sub>eMk</sub></italic>}, {<italic toggle="yes">&#x003b8;<sub>rev</sub></italic>}, {<italic toggle="yes">&#x003b8;<sub>irrev</sub></italic>} respectively for the sets of possible parameterizations of these models, it can readily be seen that {<italic toggle="yes">&#x003b8;<sub>irrev</sub></italic>} &#x02282; {<italic toggle="yes">&#x003b8;<sub>rev</sub></italic>} &#x02282; {<italic toggle="yes">&#x003b8;<sub>eMk</sub></italic>}, simply by progressively relaxing the set of elements constrained to be zero.</p></sec><sec id="S4"><title>2.2 Relationships between observations in (reversible) accumulation and Mk models</title><p>We now consider the forms of data that can be used in the different modelling cases. Accumulation modelling often considers cross-sectional, independently observed samples (motivated by the cancer literature, where data have traditionally consisted of single observations for independent patients). Some developments including HyperTraPS (<xref rid="btae737-B18" ref-type="bibr">Johnston and Williams 2016</xref>, <xref rid="btae737-B14" ref-type="bibr">Greenbury <italic toggle="yes">et al.</italic> 2020</xref>. <xref rid="btae737-B17" ref-type="bibr">Johnston and R&#x000f8;yrvik 2020</xref>) and recent expansion HyperTraPS-CT (<xref rid="btae737-B1" ref-type="bibr">Aga <italic toggle="yes">et al.</italic> 2024</xref>), HyperHMM (<xref rid="btae737-B25" ref-type="bibr">Moen and Johnston 2023</xref>), and TreeMHN (<xref rid="btae737-B24" ref-type="bibr">Luo <italic toggle="yes">et al.</italic> 2023</xref>) allow observations to be connected <italic toggle="yes">via</italic> a tree. This may exactly be a phylogenetic tree in evolutionary applications, or a phylogenomic tree (corresponding to different cell lineages evolving within a patient or within a tumor) for disease cases. In all cases, the typical assumption is that a precursor or ancestral state exists which has not acquired any of the features considered (the patient before any cancer developed, for example).</p><p>The Mk model considers phylogenetically embedded data, where observations are often taken to represent the tips (terminal vertices) on a phylogenetic tree. This situation is motivated by the evolutionary biology literature, where we often observe properties of modern-day samples that are historically connected by their evolutionary relationship. The state of the root of the tree, and of internal nodes, is not in general known precisely (being in the unobserved evolutionary past) and must be inferred if required.</p><p>These various cases can be collected under an overall umbrella (<xref rid="btae737-F2" ref-type="fig">Fig.&#x000a0;2</xref>). A dataset is connected by a set of <italic toggle="yes">n<sub>tree</sub></italic> trees. In the cross-sectional case, we can either picture <italic toggle="yes">n<sub>tree</sub></italic> = 1 &#x0201c;star&#x0201d; tree connecting a single root node with state 0 to <italic toggle="yes">n</italic> independent observations, or <italic toggle="yes">n<sub>tree</sub></italic> = <italic toggle="yes">n</italic> &#x0201c;stump&#x0201d; trees, each connecting a root at state 0 to a single descendant observation; for cross-sectional data, the single star tree, with possibly different branch lengths is appropriate where different branch lengths reflect different times to sample. For the other cases, the trees (phylogenetic or phylogenomic) connecting observations come directly from the data.</p><fig position="float" id="btae737-F2"><label>Figure 2.</label><caption><p>Data types in accumulation modelling, and casting them as trees. (A) Cross-sectional data. Independent observations <italic toggle="yes">X</italic>, <italic toggle="yes">Y</italic>, <italic toggle="yes">Z</italic> can be represented as independent lineages branching from an initial state (the root of a polychotomous tree). The source data are then the set of independent transitions from the root state to each observation. (B) Longitudinal data. Each independent series can be represented as an independent lineage branching from an initial state, with progressive observations in a series following that lineage. The source data are then transited from the root to each lineage&#x02019;s ancestor, then transited within the lineage. (C) Phylogenetic data. With a phylogeny, transitions are independent ancestor&#x02013;descendant pairs. Ancestral states (ca, common ancestor) can be reconstructed using phylogenetic methods and/or invoking assumptions about the dynamics of the particular evolutionary process.</p></caption><graphic xlink:href="btae737f2" position="float"/></fig><p>We will refer to this picture, using a reversible or irreversible hypercubic transition graph in conjunction with the Mk model, as the &#x0201c;hypercubic Mk model&#x0201d; or &#x0201c;HyperMk&#x0201d; for short, but emphasize that this refers to the model structure and not a particular numerical implementation. As we discuss below, different implementations are possible and further refinements for the HyperMk case specifically are certainly feasible.</p></sec><sec id="S5"><title>2.3 Numerical implementation</title><p>Given data, inference of the transition parameters in an Mk model can be performed <italic toggle="yes">via</italic> likelihood maximization, often using Felstenstein&#x02019;s pruning algorithm (<xref rid="btae737-B13" ref-type="bibr">Felsenstein 1973</xref>), a dynamic programming approach recursing up the levels of the tree and considering conditional dependencies on ancestral states. Many specific software implementations exist for this process (see below and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1 and S2</xref>). We will focus on the <italic toggle="yes">castor</italic> package in R (<xref rid="btae737-B22" ref-type="bibr">Louca and Doebeli 2018</xref>, <xref rid="btae737-B23" ref-type="bibr">Louca and Pennell 2020</xref>) as an easily-implementable, open-source, solution with the flexibility to deal with the different HyperMk structures described above. The Mk fitting routine in <italic toggle="yes">castor</italic> (function fit_mk) supports inference using multiple trees and constraints on transition parameters, as well as the specification of prior states for unobserved vertices.</p><p>Data that are already embedded on one or more trees can naturally be passed to <italic toggle="yes">castor</italic>. Cross-sectional data could, in principle, be passed as a set of &#x0201c;stump&#x0201d; trees with one root and one tip. However, we found that this protocol challenged the numerical behavior of the fitting procedure. Instead we adopt the following protocol. For every observation, we construct a tree with one root and two tips. Using the capacity of <italic toggle="yes">castor</italic> to support prior distributions on vertices, we enforce that one tip must have the state corresponding to observation <italic toggle="yes">i</italic>, and allow the second tip to be completely unconstrained (uniform prior over all states). In this way, we produce a branching tree structure that is readily analyzed by <italic toggle="yes">castor</italic> without introducing any artefacts into the dataset.</p><p>Several other R packages offer the ability to fit Mk models of a given structure. The <italic toggle="yes">corHMM</italic> package (<xref rid="btae737-B5" ref-type="bibr">Boyko and Beaulieu 2021</xref>) offers a powerful interface for inferring transition parameters of (hidden) Markov models, which can readily be used to implement this hypercubic Mk model picture. The representation of states as binary strings is an explicit focus of that research, making the hypercubic modelling framework particularly easy to implement. However, we could not find a straightforward way of analyzing cross-sectional or multiple independent trees using this package. <italic toggle="yes">phytools</italic> (<xref rid="btae737-B33" ref-type="bibr">Revell 2012</xref>) also includes functionality for fitting Mk models and allows the natural inclusion of cross-sectional observations by considering a &#x0201c;star&#x0201d; phylogeny (polychotomous independent branches from an initial state). Here, we are not using <italic toggle="yes">phytools</italic>' fitPagel function to model correlated evolution because that function only allows for two traits, and because our transformation of combinations of binary traits into multistate characters is the standard procedure for analyzing with multiple, possibly correlated characters (see <xref rid="S2" ref-type="sec">Section 2</xref>, <xref rid="btae737-B5" ref-type="bibr">Boyko and Beaulieu 2021</xref>). However, the inclusion of uncertain data and the adjustment of the parameters of the underlying optimization process were less straightforward in this approach than in <italic toggle="yes">castor</italic>; we also found that some observations were apparently ignored in some cases. We underline that these&#x02014;and likely more&#x02014;alternatives may readily be used for many of the case studies in this report; <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref> demonstrates their application to a simple case study, and the code repository includes examples of using these different libraries as the core solver.</p><p>The code implementing this setup in R (<xref rid="btae737-B31" ref-type="bibr">R Core Team 2022</xref>) is freely available at <ext-link xlink:href="https://github.com/StochasticBiology/hypermk" ext-link-type="uri">https://github.com/StochasticBiology/hypermk</ext-link> and in addition to the libraries described above also uses libraries <italic toggle="yes">ape</italic> (<xref rid="btae737-B28" ref-type="bibr">Paradis and Schliep 2019</xref>) and <italic toggle="yes">phangorn</italic> (<xref rid="btae737-B36" ref-type="bibr">Schliep 2011</xref>) for modelling trees, <italic toggle="yes">ggplot2</italic> (<xref rid="btae737-B38" ref-type="bibr">Wickham 2016</xref>), <italic toggle="yes">ggraph</italic> (<xref rid="btae737-B30" ref-type="bibr">Pedersen 2020</xref>), <italic toggle="yes">igraph</italic> (<xref rid="btae737-B9" ref-type="bibr">Csardi and Nepusz 2006</xref>), <italic toggle="yes">ggtree</italic> (<xref rid="btae737-B39" ref-type="bibr">Yu <italic toggle="yes">et al.</italic> 2017</xref>), and <italic toggle="yes">ggpubr</italic> (<xref rid="btae737-B19" ref-type="bibr">Kassambara 2020</xref>) for visualization.</p></sec><sec id="S6"><title>2.4 Pruning and model comparison</title><p>In both the irreversible and reversible models, it can be (and often is) the case that many edges in the hypercubic transition network reflect transitions which do not contribute to the likelihood. For example, in the irreversible case, if 000&#x02013;001 is the only transition from the initial state 000, no transitions from 100 or 010 will ever contribute to the likelihood, as those source states are unreachable from the initial state. We implemented a &#x0201c;pruning&#x0201d; method to remove parameters associated with these negligible transitions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). Pruning&#x02014;removing particular edges from the hypercubic transition graph&#x02014;can readily be used to enforce a particular subset of dynamics in a model (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3B</xref>), but can also be used to simplify models by removing these extraneous parameters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3C</xref>). From a fitted model, we simulate dynamics on the transition network and track the probability associated with each transition. We then explicitly remove edges with probability below a threshold (by default 0.01, reduced to 10<sup>&#x02212;5</sup> for the tuberculosis case study to avoid removing edges that contribute to rare observations), and refit the model without these parameters. For all cases we confirm that the &#x0201c;pruned&#x0201d; likelihood is not detectably different from the original likelihood, confirming that we have not removed edges that contribute to the likelihood. The &#x0201c;pruned&#x0201d; version of that model, with a likelihood and parameter count, can be used in comparisons <italic toggle="yes">via</italic> model selection criteria; we use the Akaike information criterion (AIC) by default (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>).</p></sec></sec><sec id="S7"><title>3 Results</title><sec id="S8"><title>3.1 Synthetic case studies</title><p>To test the capacity of the Mk model picture to capture accumulation models, we construct a set of illustrative case studies with synthetic data. We first simulate a phylogeny using a birth&#x02013;death process and then simulate an evolutionary process on this phylogeny, involving <italic toggle="yes">L&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>5 features; the different instances discussed below differ in the accumulation model. In the first, irreversible, instance, these features are acquired in the deterministic order 00000&#x02013;10000&#x02013;11000&#x02013;11100&#x02013;11110&#x02013;11111. The corresponding tree is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4A</xref>. The Mk model, with parameters restricted to support irreversible accumulation, immediately identifies the generating pathway (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4B and C</xref>). For the illustrated dataset, the AIC of the HyperMk model with irreversible dynamics is 125.8, and that with reversible dynamics is 142.7; the lower AIC for the irreversible model reflects the fact that the less complex irreversible model is sufficient to capture these accumulation-only dynamics.</p><p>Next, we allow the first feature to undergo reversion, so that transitions involving the loss of the first feature are allowed from any state (<xref rid="btae737-F3" ref-type="fig">Fig.&#x000a0;3A</xref>). The corresponding outcomes are shown in <xref rid="btae737-F3" ref-type="fig">Fig.&#x000a0;3B and C</xref> (and compared with the irreversible case in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). Now, the reversible model has a lower AIC (130.0 compared to 172.6), reflecting the fact that a model allowing reversible transitions better capture the observations than the accumulation-only model.</p><fig position="float" id="btae737-F3"><label>Figure 3.</label><caption><p>Capturing irreversible and reversible accumulation dynamics with the Mk model. (A) Observations of different states of a reversible process on the tips of a 64-node randomly-simulated tree. (B) Inferred transition graph for these data, using an irreversible model. Node labels give different states; edge labels give the feature that is gained (+) or lost (&#x02212;) at each transition, but in this irreversible case no feature losses (&#x02212;) are allowed. The darkness of an edge gives its rate: darker edges have higher associated transition rates. (C) Inferred transition graph for these data using a reversible model. The AIC values for the full fitted model, and for the simplified model discarding all edges that do not support flux from the 00000 state (i.e. edges with two or more transitions), are given: the AIC for the irreversible model is lower, reflecting the irreversible generating process. More detail in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>.</p></caption><graphic xlink:href="btae737f3" position="float"/></fig><p>To demonstrate HyperMk&#x02019;s ability to capture positive and negative influences between traits, and to work with cross-sectional as well as phylogenetically-embedded observations, we next consider an <italic toggle="yes">L&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>4 case where two pathways are supported: 0000&#x02013;0001&#x02013;0011&#x02013;0111&#x02013;1111 and 0000&#x02013;1000&#x02013;1100&#x02013;1110&#x02013;1111. These two pathways are mutually repressing, so that the first step taken from 0000 completely determines the subsequent dynamics. We use the protocol described in <xref rid="S2" ref-type="sec">Section 2</xref> to represent observations from this system as a collection of trees that can be analyzed by <italic toggle="yes">castor</italic>, and show the results in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5A&#x02013;C</xref>. As expected, given the lack of restrictions placed on the transitions, HyperMk readily captures the cross-repressing nature of these pathways.</p><p>The Mk model can naturally account for uncertainty in observations, and uncertainty in the inferred transition parameters can be quantified via resampling, e.g. through using the bootstrap. In the fit routine in the <italic toggle="yes">castor</italic> package, uncertain observations are included by specifying &#x0201c;tip priors&#x0201d;: <italic toggle="yes">P<sub>is</sub></italic> is the likelihood of the observed state of tip <italic toggle="yes">i</italic> given that it was truly in state <italic toggle="yes">s</italic>. We demonstrate inference using data generated from the single pathway model (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4A&#x02013;C</xref>) with uncertainty in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5D&#x02013;F</xref>. For the irreversible model, HyperMk readily identifies a parsimonious generating mechanism. For the reversible model, the core of this mechanism is identified but with corresponding uncertainty. This uncertainty is manifest in the nonzero probabilities of transitions involving states that are not generated by this process.<xref rid="btae737-FN1" ref-type="fn"><sup>1</sup></xref></p></sec><sec id="S9"><title>3.2 Cancer progression</title><p>Although reversibility of genetic changes in cancer progression is likely less important than in other systems, we also include a case study of cancer progression to connect with previous studies. We use an old but commonly-used dataset on chromosomal aberrations accumulating during ovarian cancer progression (<xref rid="btae737-B20" ref-type="bibr">Knutsen <italic toggle="yes">et al.</italic> 2005</xref>). These samples are taken from different patients and we therefore use the cross-sectional implementation of HyperMk. We focus on <italic toggle="yes">L&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>5 features, labelled by chromosome, chromosomal arm, and gain or loss of genetic material: 8q+ means a gain of material q arm of chromosome 8. In the order presented in the data, the feature set is (8q+, 3q+, 5q&#x02212;, 4q&#x02212;, 8p&#x02212;) (<xref rid="btae737-F4" ref-type="fig">Fig.&#x000a0;4A</xref> shows the frequency distribution of the chromosomal aberration combinations).</p><fig position="float" id="btae737-F4"><label>Figure 4.</label><caption><p>Accumulation dynamics in ovarian cancer progression. (A) The set of 87 cross-sectional observations of chromosomal aberrations in ovarian cancer (from independent patients, not linked by a phylogeny) from <xref rid="btae737-B20" ref-type="bibr">Knutsen <italic toggle="yes">et al.</italic> (2005)</xref>. The (reduced) set of aberration locations is (8q+, 3q+, 5q&#x02212;, 4q&#x02212;, 8p&#x02212;). (B&#x02013;C) Inference of transition graphs using (B) irreversible and (C) reversible models.</p></caption><graphic xlink:href="btae737f4" position="float"/></fig><p>The most common pathways consistently identified by previous analyses have 8q+ and 3q+ as first steps, with 5q&#x02212; and 8p&#x02212; as competing early next steps and 4q&#x02212; occurring on average somewhat later. Average orderings from HyperHMM (<xref rid="btae737-B25" ref-type="bibr">Moen and Johnston 2023</xref>) place 8q+ with the highest probability first (lower probability 5q&#x02212; and 3q+), 3q+ second (lower probability 8p&#x02212; and 5q&#x02212;), 8p&#x02212;, 4q&#x02212;, or 8q+ third, 5q&#x02212;, 4q&#x02212;, or 8q+ fourth, and 8p&#x02212; fifth (lower probability 5q&#x02212;). These patterns are all borne out by both the reversible and irreversible inferred transition graphs (<xref rid="btae737-F4" ref-type="fig">Fig.&#x000a0;4B and C</xref>), which support several pathways of progression dominated with 8q+ and 3q+ as first steps, with the other transitions occurring in consistent orderings thereafter.</p><p>Agreeing with the intuition that reversible transitions may play a limited role in determining cancer progression pathways (see <xref rid="S12" ref-type="sec">Section 4</xref>), the AIC of the irreversible model is lower than that of the reversible model, suggesting that accumulation-only dynamics is the preferred picture for this dataset. The loss transitions supported by the inferred reversible model largely mirror acquisition transitions with lower probability (e.g. a lower probability &#x02212;1 transition from 10000 to 00000 mirroring the +1 transition from 00000 to 10000), suggesting that unmatched loss transitions do not play a substantial role in determining dynamics (unlike, e.g. the loss of feature 1 from multiple different states in the synthetic reversible example above, <xref rid="btae737-F3" ref-type="fig">Fig.&#x000a0;3</xref>).</p></sec><sec id="S10"><title>3.3 Anti-microbial resistance</title><p>To demonstrate the application of HyperMk to real-world questions, we consider data on the evolution of anti-microbial resistance in <italic toggle="yes">Mycobacterium tuberculosis</italic> (TB) (<xref rid="btae737-B8" ref-type="bibr">Casali <italic toggle="yes">et al.</italic> 2014</xref>), as curated in (<xref rid="btae737-B14" ref-type="bibr">Greenbury <italic toggle="yes">et al.</italic> 2020</xref>). Here, we take 150 isolates of TB with associated profiles of drug resistance, describing susceptibility (absence) or resistance (presence) to a collection of drugs. The observations are phylogenetically connected via a tree that was characterized using genetic data in the original publication (<xref rid="btae737-F5" ref-type="fig">Fig.&#x000a0;5A</xref>). For this illustrative case, we consider the first <italic toggle="yes">L&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>5 of these drugs: isoniazid (INH), rifampicin/rifampin (RIF), streptomycin (STR), ethambutol (EMB), pyrazinamide (PZA). Previous work using accumulation-only models HyperTraPS and HyperHMM (<xref rid="btae737-B14" ref-type="bibr">Greenbury <italic toggle="yes">et al.</italic> 2020</xref>; <xref rid="btae737-B25" ref-type="bibr">Moen and Johnston 2023</xref>) have shown that of this set, INH and RIF are the most likely first acquisitions, followed by EMB then STR.</p><fig position="float" id="btae737-F5"><label>Figure 5.</label><caption><p>Evolutionary dynamics in tuberculosis drug resistance. (A) Observations of patterns of drug resistance from <xref rid="btae737-B8" ref-type="bibr">Casali <italic toggle="yes">et al.</italic> (2014)</xref>. The phylogeny is plotted with uniform branch lengths for legibility; the true phylogeny has heterogeneous branch lengths. The (reduced) set of drug features is (INH, RIF, STR, EMB, PZA); 0 corresponds to susceptibility, 1 corresponds to resistance. (B&#x02013;C) Inference of transition graphs using (B) irreversible and (C) reversible models.</p></caption><graphic xlink:href="btae737f5" position="float"/></fig><p>Following HyperMk fitting, this ordering is clearly visible in both reversible and irreversible models (<xref rid="btae737-F5" ref-type="fig">Fig.&#x000a0;5B and C</xref>). The reversible model experiences a clear advantage according to AIC (561.3 versus 635.7 for the reversible and irreversible models, respectively), with the transition graph showing substantial probability flux associated with the loss of STR and EMB resistances.</p></sec><sec id="S11"><title>3.4 Implementation</title><p>The runtime of this approach, implemented using <italic toggle="yes">castor</italic>, does not scale particularly tractably with the number of features <italic toggle="yes">L</italic>. <xref rid="btae737-F6" ref-type="fig">Figure&#x000a0;6</xref> shows runtime in seconds for a fit involving <italic toggle="yes">N</italic> observations each of <italic toggle="yes">L</italic> features, on a simulated tree as in <xref rid="btae737-F3" ref-type="fig">Fig.&#x000a0;3</xref>. Every additional feature multiplies the runtime by at least one order of magnitude, and sometimes approaching two. Feature sets larger than <italic toggle="yes">L&#x02009;=&#x02009;</italic>7 will take inconveniently long to infer with this implementation. However, as discussed below, this implementation uses both a &#x0201c;full&#x0201d; parameterization where no reduction of parameter space is used and a general Mk model fitting package. Indeed, one key contribution of this article is showing the connection between the different problems represented in <xref rid="btae737-F1" ref-type="fig">Fig.&#x000a0;1</xref>, something that is evidenced by using off-the-shelf Mk software for all of them. A custom implementation for specific problems, involving, e.g. only pairwise interactions between features and/or specific speedups from the hypercubic transition network structure, may afford substantial gains in speed. As described in <xref rid="S2" ref-type="sec">Section 2</xref>, several different existing packages in addition to <italic toggle="yes">castor</italic> provide functionality for fitting Mk models compatible with this accumulation modelling picture (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p><fig position="float" id="btae737-F6"><label>Figure 6.</label><caption><p>Timing for synthetic case studies. Simulated fits using <italic toggle="yes">castor</italic> to implement HyperMk. Data are randomly generated, either from a uniform samples of states (cross-sectional examples) or from a simulated tree and a reversible generating process as in <xref rid="btae737-F3" ref-type="fig">Fig.&#x000a0;3A</xref>. Timings are for a single 3.2 GHz core (Apple M1 Pro).</p></caption><graphic xlink:href="btae737f6" position="float"/></fig><p>We observed that numerical convergence is a consistent issue with these approaches. Intuitively, the presence of reversible transitions means that an infinite set of possible pathways can in principle be responsible for a given observation. While in practice any non-infinite transition rates will act to decrease the probability of longer pathways, this dramatic expansion of possibilities over the irreversible case makes inference with the reversible model numerically challenging. We found that a combination of multiple start points and looser constraints on the number of permitted iterations mitigated these challenges to some extent&#x02014;at the inevitable cost of more computational resource. There were also some library-specific issues related to this convergence: the Mk model fit with <italic toggle="yes">castor</italic> sometimes crashed when multiple start points were invoked. Our working approach&#x02014;implemented in the software accompanying this article&#x02014;is thus to avoid multiple start points and only parallelize over different experiments; the case studies here in <xref rid="btae737-F3 btae737-F4 btae737-F5" ref-type="fig">Figs.&#x000a0;3&#x02013;5</xref> are all tractable on a single machine, with the tuberculosis case study taking the longest (several hours) to converge.</p></sec></sec><sec id="S12"><title>4 Discussion</title><p>We have introduced and demonstrated a way of supporting reversible transitions in accumulation modelling using the Mk model. Of course, the value of supporting reversibility depends on the scientific question being asked. In cancer progression, mutations occur and clonally proliferate as cells divide. Depending on what the &#x0201c;entity&#x0201d; being modelled is&#x02014;a cell, a tumor, a patient, etc. (<xref rid="btae737-B12" ref-type="bibr">Diaz-Uriarte and Johnston 2024</xref>)&#x02014;reversibility may simply be inappropriate to consider. The probability of a reverse mutation &#x0201c;undoing&#x0201d; a particular mutation at the cellular level is presumably very low, although at the tumor level it is not inconceivable that cell-level selection could remove a mutation from the cellular population once it has arisen.</p><p>In evolution, e.g. the evolution of anti-microbial resistance, this question can be case-specific. AMR traits in <italic toggle="yes">Klebsiella pneumoniae</italic> are often acquired <italic toggle="yes">via</italic> transfer of plasmids&#x02014;mobile DNA elements&#x02014;which can be gained and very readily lost again (<xref rid="btae737-B15" ref-type="bibr">Holt <italic toggle="yes">et al.</italic> 2015</xref>). AMR traits in tuberculosis are often acquired <italic toggle="yes">via</italic> chromosomal mutations, which are less readily lost once they have been acquired (<xref rid="btae737-B8" ref-type="bibr">Casali <italic toggle="yes">et al.</italic> 2014</xref>). At the level of single cells, reversibility may therefore be more important to consider for Klebsiella than tuberculosis (<xref rid="btae737-B32" ref-type="bibr">Renz <italic toggle="yes">et al.</italic> 2024</xref>). And&#x02014;in agreement with <xref rid="btae737-F5" ref-type="fig">Fig.&#x000a0;5</xref>&#x02014;reversible dynamics may occur at the population level (one strain outcompeting another to be the dominant observed type) without requiring single-cell reversibility (<xref rid="btae737-B12" ref-type="bibr">Diaz-Uriarte and Johnston 2024</xref>). In other cases, reversibility may be simply ill-posed&#x02014;e.g. in accumulation modelling of students completing tasks in online courses (<xref rid="btae737-B29" ref-type="bibr">Peach <italic toggle="yes">et al.</italic> 2021</xref>).</p><p>We have not focused on a continuous time variable in this study, instead viewing dynamics as &#x0201c;ordinal&#x0201d; and reporting the sequence, rather than timing, of transitions. This approach mirrors HyperTraPS and HyperHMM (<xref rid="btae737-B18" ref-type="bibr">Johnston and Williams 2016</xref>, <xref rid="btae737-B14" ref-type="bibr">Greenbury <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae737-B25" ref-type="bibr">Moen and Johnston 2023</xref>), but many other approaches (including a recent generalization of HyperTraPS (<xref rid="btae737-B1" ref-type="bibr">Aga <italic toggle="yes">et al.</italic> 2024</xref>)) assume a continuous timescale that is implicitly or explicitly connected to the observations (<xref rid="btae737-B35" ref-type="bibr">Schill <italic toggle="yes">et al.</italic> 2020</xref>, <xref rid="btae737-B11" ref-type="bibr">Diaz-Uriarte and Herrera-Nieto 2022</xref>, <xref rid="btae737-B12" ref-type="bibr">Diaz-Uriarte and Johnston 2024</xref>, <xref rid="btae737-B34" ref-type="bibr">Schill <italic toggle="yes">et al.</italic> 2024</xref>). The Mk model approach described here has the full capacity to capture continuous timing in observations, as the branch lengths in the phylogeny (or in the set of synthetic trees, for cross-sectional data) correspond to times between states. The rate parameters learned in the model fitting then become true rates in the time behavior of the system, rather than just describing relative propensities of events. Accumulation problems where continuous time data are available can exploit this natural feature of the Mk approach.</p><p>A clear shortcoming in this implementation is the number of features that can be considered. Existing methods for accumulation modelling can deal with dozens, and sometimes over a hundred, interacting features&#x02014;although the case of arbitrary dependencies between sets of features, not just pairwise interactions, is more limited (see details and discussion in <xref rid="btae737-B1" ref-type="bibr">Aga <italic toggle="yes">et al.</italic> (2024)</xref>). Here, feature sets larger than <italic toggle="yes">L&#x02009;</italic>=<italic toggle="yes">&#x02009;</italic>7 approach computational intractability. However, it is very possible that different software implementations will change this limitation&#x02014;and future developments exploiting the restrictions on parameter space specific to the reversible accumulation model may substantially increase efficiency. Approaches for reducing dimensionality in accumulation modelling datasets are also under development (<xref rid="btae737-B10" ref-type="bibr">Dauda <italic toggle="yes">et al.</italic> 2024</xref>). In particular, the picture outlined in this research allows arbitrary independent transitions between states, rather than coarse-graining transition parameters by the features involved in the transition (<xref rid="btae737-F1" ref-type="fig">Fig.&#x000a0;1</xref>). More restricted parameterizations, e.g. reflecting the pairwise-only interactions used in the <italic toggle="yes">L</italic><sup>2</sup> parameterization of HyperTraPS and equivalent in mutual hazard networks, would lead to smaller parameter spaces and presumably faster inference. The <italic toggle="yes">corHMM</italic> package (<xref rid="btae737-B5" ref-type="bibr">Boyko and Beaulieu 2021</xref>) allows different classes of parameter structure to be specified; implementations of accumulation modelling for single trees (or a more general picture, with future development) may provide a straightforward solution for this adaptation.</p><p>More generally, connections between the evolutionary and systematic literatures and accumulation modelling may allow more transfer of promising insights between the fields. One scenario that is likely to become more prevalent with single-cell sequencing involves data sets where several patients provide multiple within-patient samples which are phylogenetically related (<xref rid="btae737-B7" ref-type="bibr">Caravagna <italic toggle="yes">et al.</italic> 2018</xref>, <xref rid="btae737-B24" ref-type="bibr">Luo <italic toggle="yes">et al.</italic> 2023</xref>, <xref rid="btae737-B1" ref-type="bibr">Aga <italic toggle="yes">et al.</italic> 2024</xref>) which naturally fit in the hypercubic Mk modelling framework. A broader common question in applied accumulation modelling is whether continuous and/or ordinal features, as well as the presence/absence features, can be analyzed in the same framework. While binary accumulation approaches have been used to analyze datasets containing ordinal features (e.g. the levels of coma presentation in malaria patients (<xref rid="btae737-B16" ref-type="bibr">Johnston <italic toggle="yes">et al.</italic> 2019</xref>)), this has typically been done with a rather crude coding approach involving inequalities (a set of <italic toggle="yes">n</italic> features denoting &#x0201c;presence&#x0201d; of <italic toggle="yes">x&#x02009;</italic>&#x0003c;<italic toggle="yes">&#x02009;</italic>1, <italic toggle="yes">x&#x02009;</italic>&#x0003c;<italic toggle="yes">&#x02009;</italic>2, <italic toggle="yes">x&#x02009;</italic>&#x0003c;<italic toggle="yes">&#x02009;</italic>3, and so on). A recent advance in the systematics literature provides an approach by which the coupled dynamics of discrete and continuous characters can be naturally analyzed (<xref rid="btae737-B6" ref-type="bibr">Boyko <italic toggle="yes">et al.</italic> 2023</xref>). Broadly, we anticipate that if the usual picture of data linked by a dichotomous phylogenetic tree with branch lengths can be relaxed&#x02014;to star phylogenies or sets of trees or &#x0201c;stumps&#x0201d; for example&#x02014;a wide range of approaches from phylogenetic methods will find use in the analysis of accumulation processes.</p></sec><sec id="S13"><title>Supplementary data</title><p>
<xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p></sec><sec><title>&#x02002;</title><p>Conflict of interest: No direct economic conflicts of interest declared.</p></sec><sec id="S14"><title>Funding</title><p>This project has received funding from the European Research Council (ERC) under the European Union&#x02019;s Horizon 2020 Research and Innovation Programme [Grant agreement No. 805046 (EvoConBiO) to I.G.J.]. I.G.J. was supported by the Trond Mohn Foundation [project HyperEvol under grant agreement No. TMS2021TMT09], through the Centre for Antimicrobial Resistance in Western Norway (CAMRIA) [TMS2020TMT11]. R.D.U. was supported by grant PID2019-111256RB-I00 funded by MCIN/AEI/10.13039/501100011033.</p></sec><sec sec-type="supplementary-material"><title>Supplementary Material</title><supplementary-material id="sup1" position="float" content-type="local-data"><label>btae737_Supplementary_Data</label><media xlink:href="btae737_supplementary_data.pdf"/></supplementary-material></sec></body><back><fn-group><title>Footnotes</title><fn id="btae737-FN1"><label>1</label><p>The <italic toggle="yes">castor</italic> package also supports bootstrap resampling and multiple, parallelised fitting attempts per bootstrap, though we have not made use of it here.</p></fn></fn-group><ref-list id="ref1"><title>References</title><ref id="btae737-B1"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Aga</surname>
<given-names>ONL</given-names>
</string-name>, <string-name><surname>Brun</surname><given-names>M</given-names></string-name>, <string-name><surname>Dauda</surname><given-names>KA</given-names></string-name>&#x000a0;<etal>et al</etal>&#x000a0;</person-group>
<article-title>HyperTraPS-CT: Inference and prediction for accumulation pathways with flexible data and model structures</article-title>. <source>PLoS Comput Biol</source><year>2024</year>;<volume>20</volume>:<fpage>e1012393</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1012393</pub-id><pub-id pub-id-type="pmid">39231165</pub-id>
</mixed-citation></ref><ref id="btae737-B2"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Angaroni</surname>
<given-names>F</given-names>
</string-name>, <string-name><surname>Chen</surname><given-names>K</given-names></string-name>, <string-name><surname>Damiani</surname><given-names>C</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>PMCE: efficient inference of expressive models of cancer evolution with high prognostic power</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>754</fpage>&#x02013;<lpage>62</lpage>.<pub-id pub-id-type="pmid">34647978</pub-id>
</mixed-citation></ref><ref id="btae737-B3"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Beerenwinkel</surname>
<given-names>N</given-names>
</string-name>, <string-name><surname>D&#x000e4;umer</surname><given-names>M</given-names></string-name>, <string-name><surname>Sing</surname><given-names>T</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Estimating HIV evolutionary pathways and the genetic barrier to drug resistance</article-title>. <source>J Infect Dis</source><year>2005</year>;<volume>191</volume>:<fpage>1953</fpage>&#x02013;<lpage>60</lpage>.<pub-id pub-id-type="pmid">15871130</pub-id>
</mixed-citation></ref><ref id="btae737-B4"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Beerenwinkel</surname>
<given-names>N</given-names>
</string-name>, <string-name><surname>Schwarz</surname><given-names>RF</given-names></string-name>, <string-name><surname>Gerstung</surname><given-names>M</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Cancer evolution: mathematical models and computational inference</article-title>. <source>Syst Biol</source><year>2015</year>;<volume>64</volume>:<fpage>e1</fpage>&#x02013;<lpage>25</lpage>.<pub-id pub-id-type="pmid">25293804</pub-id>
</mixed-citation></ref><ref id="btae737-B5"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Boyko</surname>
<given-names>JD</given-names>
</string-name>, <string-name><surname>Beaulieu</surname><given-names>JM.</given-names></string-name></person-group>
<article-title>Generalized hidden Markov models for phylogenetic comparative datasets</article-title>. <source>Methods Ecol Evol</source><year>2021</year>;<volume>12</volume>:<fpage>468</fpage>&#x02013;<lpage>78</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.13534</pub-id>.</mixed-citation></ref><ref id="btae737-B6"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Boyko</surname>
<given-names>JD</given-names>
</string-name>, <string-name><surname>O'Meara</surname><given-names>BC</given-names></string-name>, <string-name><surname>Beaulieu</surname><given-names>JM.</given-names></string-name></person-group>
<article-title>A novel method for jointly modeling the evolution of discrete and continuous traits</article-title>. <source>Evolution</source><year>2023</year>;<volume>77</volume>:<fpage>836</fpage>&#x02013;<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1093/evolut/qpad002</pub-id>.<pub-id pub-id-type="pmid">36723908</pub-id>
</mixed-citation></ref><ref id="btae737-B7"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Caravagna</surname>
<given-names>G</given-names>
</string-name>, <string-name><surname>Giarratano</surname><given-names>Y</given-names></string-name>, <string-name><surname>Ramazzotti</surname><given-names>D</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Detecting repeated cancer evolution from multi-region tumor sequencing data</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>707</fpage>&#x02013;<lpage>14</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-018-0108-x</pub-id>.<pub-id pub-id-type="pmid">30171232</pub-id>
</mixed-citation></ref><ref id="btae737-B8"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Casali</surname>
<given-names>N</given-names>
</string-name>, <string-name><surname>Nikolayevskyy</surname><given-names>V</given-names></string-name>, <string-name><surname>Balabanova</surname><given-names>Y</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Evolution and transmission of drug-resistant tuberculosis in a Russian population</article-title>. <source>Nat Genet</source><year>2014</year>;<volume>46</volume>:<fpage>279</fpage>&#x02013;<lpage>86</lpage>. <pub-id pub-id-type="doi">10.1038/ng.2878</pub-id>.<pub-id pub-id-type="pmid">24464101</pub-id>
</mixed-citation></ref><ref id="btae737-B9"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Csardi</surname>
<given-names>G</given-names>
</string-name>, <string-name><surname>Nepusz</surname><given-names>T.</given-names></string-name></person-group>
<article-title>The igraph software package for complex network research</article-title>. <source>InterJ Complex Syst</source><year>2006</year>;<volume>1695</volume>:<fpage>1</fpage>&#x02013;<lpage>9</lpage>.</mixed-citation></ref><ref id="btae737-B10"><mixed-citation publication-type="other">
<person-group person-group-type="author">
<string-name>
<surname>Dauda</surname>
<given-names>KA</given-names>
</string-name>, <string-name><surname>Olav</surname><given-names>NLA</given-names></string-name>, <string-name><surname>Johnston</surname><given-names>IG.</given-names></string-name></person-group> Clustering large-scale biomedical data to model dynamic accumulation processes in disease progression and anti-microbial resistance evolution. bioRxiv, <pub-id pub-id-type="doi">10.1101/2024.09.19.613871</pub-id>, <year>2024</year>, preprint: not peer reviewed.</mixed-citation></ref><ref id="btae737-B11"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Diaz-Uriarte</surname>
<given-names>R</given-names>
</string-name>, <string-name><surname>Herrera-Nieto</surname><given-names>P.</given-names></string-name></person-group>
<article-title>EvAM-tools: tools for evolutionary accumulation and cancer progression models</article-title>. <source>Bioinformatics</source><year>2022</year>;<volume>38</volume>:<fpage>5457</fpage>&#x02013;<lpage>9</lpage>.<pub-id pub-id-type="pmid">36287062</pub-id>
</mixed-citation></ref><ref id="btae737-B12"><mixed-citation publication-type="other">
<person-group person-group-type="author">
<string-name>
<surname>Diaz-Uriarte</surname>
<given-names>R</given-names>
</string-name>, <string-name><surname>Johnston</surname><given-names>IG.</given-names></string-name></person-group> A picture guide to cancer progression and monotonic accumulation models: evolutionary assumptions, plausible interpretations, and alternative uses. arXiv. <pub-id pub-id-type="doi">10.48550/arXiv.2312.06824</pub-id>, <year>2024</year>, preprint: not peer reviewed.</mixed-citation></ref><ref id="btae737-B13"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Felsenstein</surname>
<given-names>J.</given-names>
</string-name>
</person-group>
<article-title>Maximum likelihood and minimum-steps methods for estimating evolutionary trees from data on discrete characters</article-title>. <source>Syst Biol</source><year>1973</year>;<volume>22</volume>:<fpage>240</fpage>&#x02013;<lpage>9</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/22.3.240</pub-id>.</mixed-citation></ref><ref id="btae737-B14"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Greenbury</surname>
<given-names>SF</given-names>
</string-name>, <string-name><surname>Barahona</surname><given-names>M</given-names></string-name>, <string-name><surname>Johnston</surname><given-names>IG.</given-names></string-name></person-group>
<article-title>HyperTraPS: inferring probabilistic patterns of trait acquisition in evolutionary and disease progression pathways</article-title>. <source>Cell Syst</source><year>2020</year>;<volume>10</volume>:<fpage>39</fpage>&#x02013;<lpage>51.e10</lpage>.<pub-id pub-id-type="pmid">31786211</pub-id>
</mixed-citation></ref><ref id="btae737-B15"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Holt</surname>
<given-names>KE</given-names>
</string-name>, <string-name><surname>Wertheim</surname><given-names>H</given-names></string-name>, <string-name><surname>Zadoks</surname><given-names>RN</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Genomic analysis of diversity, population structure, virulence, and antimicrobial resistance in <italic toggle="yes">Klebsiella pneumoniae</italic>, an urgent threat to public health</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2015</year>;<volume>112</volume>:<fpage>E3574</fpage>&#x02013;<lpage>81</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1501049112</pub-id>.<pub-id pub-id-type="pmid">26100894</pub-id>
</mixed-citation></ref><ref id="btae737-B16"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Johnston</surname>
<given-names>IG</given-names>
</string-name>, <string-name><surname>Hoffmann</surname><given-names>T</given-names></string-name>, <string-name><surname>Greenbury</surname><given-names>SF</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Precision identification of high-risk phenotypes and progression pathways in severe malaria without requiring longitudinal data</article-title>. <source>NPJ Digit Med</source><year>2019</year>;<volume>2</volume>:<fpage>63</fpage>.<pub-id pub-id-type="pmid">31312723</pub-id>
</mixed-citation></ref><ref id="btae737-B17"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Johnston</surname>
<given-names>IG</given-names>
</string-name>, <string-name><surname>R&#x000f8;yrvik</surname><given-names>EC.</given-names></string-name></person-group>
<article-title>Data-driven inference reveals distinct and conserved dynamic pathways of tool use emergence across animal taxa</article-title>. <source>Iscience</source><year>2020</year>;<volume>23</volume>:<fpage>101245</fpage>.<pub-id pub-id-type="pmid">32629611</pub-id>
</mixed-citation></ref><ref id="btae737-B18"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Johnston</surname>
<given-names>IG</given-names>
</string-name>, <string-name><surname>Williams</surname><given-names>BP.</given-names></string-name></person-group>
<article-title>Evolutionary inference across eukaryotes identifies specific pressures favoring mitochondrial gene retention</article-title>. <source>Cell Syst</source><year>2016</year>;<volume>2</volume>:<fpage>101</fpage>&#x02013;<lpage>11</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2016.01.013</pub-id>.<pub-id pub-id-type="pmid">27135164</pub-id>
</mixed-citation></ref><ref id="btae737-B19"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Kassambara</surname>
<given-names>A.</given-names>
</string-name>
</person-group>
<article-title>Ggpubr:&#x0201c;Ggplot2&#x0201d; based publication ready plots</article-title>. <source>R Package Version</source><year>2020</year>;<volume>0</volume>:<fpage>0</fpage>&#x02013;<lpage>438</lpage>.</mixed-citation></ref><ref id="btae737-B20"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Knutsen</surname>
<given-names>T</given-names>
</string-name>, <string-name><surname>Gobu</surname><given-names>V</given-names></string-name>, <string-name><surname>Knaus</surname><given-names>R</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>The interactive online SKY/M-FISH &#x00026; CGH database and the entrez cancer chromosomes search database: linkage of chromosomal aberrations with the genome sequence</article-title>. <source>Genes Chromosomes Cancer</source><year>2005</year>;<volume>44</volume>:<fpage>52</fpage>&#x02013;<lpage>64</lpage>. <pub-id pub-id-type="doi">10.1002/gcc.20224</pub-id>.<pub-id pub-id-type="pmid">15934046</pub-id>
</mixed-citation></ref><ref id="btae737-B21"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Lewis</surname>
<given-names>PO.</given-names>
</string-name>
</person-group>
<article-title>A likelihood approach to estimating phylogeny from discrete morphological character data</article-title>. <source>Syst Biol</source><year>2001</year>;<volume>50</volume>:<fpage>913</fpage>&#x02013;<lpage>25</lpage>.<pub-id pub-id-type="pmid">12116640</pub-id>
</mixed-citation></ref><ref id="btae737-B22"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Louca</surname>
<given-names>S</given-names>
</string-name>, <string-name><surname>Doebeli</surname><given-names>M.</given-names></string-name></person-group>
<article-title>Efficient comparative phylogenetics on large trees</article-title>. <source>Bioinformatics</source><year>2018</year>;<volume>34</volume>:<fpage>1053</fpage>&#x02013;<lpage>5</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx701</pub-id>.<pub-id pub-id-type="pmid">29091997</pub-id>
</mixed-citation></ref><ref id="btae737-B23"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Louca</surname>
<given-names>S</given-names>
</string-name>, <string-name><surname>Pennell</surname><given-names>MW.</given-names></string-name></person-group>
<article-title>A general and efficient algorithm for the likelihood of diversification and discrete-trait evolutionary models</article-title>. <source>Syst Biol</source><year>2020</year>;<volume>69</volume>:<fpage>545</fpage>&#x02013;<lpage>56</lpage>. <pub-id pub-id-type="doi">10.1093/sysbio/syz055</pub-id>.<pub-id pub-id-type="pmid">31432088</pub-id>
</mixed-citation></ref><ref id="btae737-B24"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Luo</surname>
<given-names>XG</given-names>
</string-name>, <string-name><surname>Kuipers</surname><given-names>J</given-names></string-name>, <string-name><surname>Beerenwinkel</surname><given-names>N.</given-names></string-name></person-group>
<article-title>Joint inference of exclusivity patterns and recurrent trajectories from tumor mutation trees</article-title>. <source>Nat Commun</source><year>2023</year>;<volume>14</volume>:<fpage>3676</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-023-39400-w</pub-id>.<pub-id pub-id-type="pmid">37344522</pub-id>
</mixed-citation></ref><ref id="btae737-B25"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Moen</surname>
<given-names>MT</given-names>
</string-name>, <string-name><surname>Johnston</surname><given-names>IG.</given-names></string-name></person-group>
<article-title>HyperHMM: efficient inference of evolutionary and progressive dynamics on hypercubic transition graphs</article-title>. <source>Bioinformatics</source><year>2023</year>;<volume>39</volume>:<fpage>btac803</fpage>.<pub-id pub-id-type="pmid">36511587</pub-id>
</mixed-citation></ref><ref id="btae737-B26"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Montazeri</surname>
<given-names>H</given-names>
</string-name>, <string-name><surname>Kuipers</surname><given-names>J</given-names></string-name>, <string-name><surname>Kouyos</surname><given-names>R</given-names></string-name></person-group>
<etal>et al</etal>; and <collab>Swiss HIV Cohort Study</collab>. <article-title>Large-scale inference of conjunctive Bayesian networks</article-title>. <source>Bioinformatics</source><year>2016</year>;<volume>32</volume>:<fpage>i727</fpage>&#x02013;<lpage>35</lpage>.<pub-id pub-id-type="pmid">27587695</pub-id>
</mixed-citation></ref><ref id="btae737-B27"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Pagel</surname>
<given-names>M.</given-names>
</string-name>
</person-group>
<article-title>Detecting correlated evolution on phylogenies: a general method for the comparative analysis of discrete characters</article-title>. <source>Proc R Soc Lond Ser B Biol Sci</source><year>1994</year>;<volume>255</volume>:<fpage>37</fpage>&#x02013;<lpage>45</lpage>.</mixed-citation></ref><ref id="btae737-B28"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Paradis</surname>
<given-names>E</given-names>
</string-name>, <string-name><surname>Schliep</surname><given-names>K.</given-names></string-name></person-group>
<article-title>Ape 5.0: an environment for modern phylogenetics and evolutionary analyses in R</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>:<fpage>526</fpage>&#x02013;<lpage>8</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/bty633</pub-id>.<pub-id pub-id-type="pmid">30016406</pub-id>
</mixed-citation></ref><ref id="btae737-B29"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Peach</surname>
<given-names>RL</given-names>
</string-name>, <string-name><surname>Greenbury</surname><given-names>SF</given-names></string-name>, <string-name><surname>Johnston</surname><given-names>IG</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Understanding learner behaviour in online courses with Bayesian modelling and time series characterisation</article-title>. <source>Sci Rep</source><year>2021</year>;<volume>11</volume>:<fpage>2823</fpage>.<pub-id pub-id-type="pmid">33531544</pub-id>
</mixed-citation></ref><ref id="btae737-B30"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Pedersen</surname>
<given-names>TL.</given-names>
</string-name>
</person-group>
<article-title>Ggraph: an implementation of grammar of graphics for graphs and networks</article-title>. <source>R Package Version</source><year>2020</year>;<volume>2</volume>:<fpage>1</fpage>.</mixed-citation></ref><ref id="btae737-B31"><mixed-citation publication-type="book">
<collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>. <publisher-loc>Vienna, Austria</publisher-loc>: <publisher-name>R Foundation for Statistical Computing</publisher-name>, <year>2022</year>.</mixed-citation></ref><ref id="btae737-B32"><mixed-citation publication-type="other">
<person-group person-group-type="author">
<string-name>
<surname>Renz</surname>
<given-names>J</given-names>
</string-name>, <string-name><surname>Dauda</surname><given-names>KA</given-names></string-name>, <string-name><surname>Olav</surname><given-names>NLA</given-names></string-name></person-group>
<etal>et al</etal> Evolutionary accumulation modelling in AMR: machine learning to infer and predict evolutionary dynamics of multi-drug resistance. arXiv, <pub-id pub-id-type="doi">10.48550/arXiv.2411.00219</pub-id>, <year>2024</year>, preprint: not peer reviewed.</mixed-citation></ref><ref id="btae737-B33"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Revell</surname>
<given-names>LJ.</given-names>
</string-name>
</person-group>
<article-title>Phytools: an R package for phylogenetic comparative biology (and other things)</article-title>. <source>Methods Ecol Evol</source><year>2012</year>;<volume>3</volume>:<fpage>217</fpage>&#x02013;<lpage>23</lpage>.</mixed-citation></ref><ref id="btae737-B34"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Schill</surname>
<given-names>R</given-names>
</string-name>, <string-name><surname>Klever</surname><given-names>M</given-names></string-name>, <string-name><surname>Rupp</surname><given-names>K</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Reconstructing disease histories in huge discrete state spaces</article-title>. <source>KI&#x02014;K&#x000fc;nstl Intell</source><year>2024</year>. <pub-id pub-id-type="doi">10.1007/s13218-023-00822-9</pub-id>.</mixed-citation></ref><ref id="btae737-B35"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Schill</surname>
<given-names>R</given-names>
</string-name>, <string-name><surname>Solbrig</surname><given-names>S</given-names></string-name>, <string-name><surname>Wettig</surname><given-names>T</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Modelling cancer progression using mutual hazard networks</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>241</fpage>&#x02013;<lpage>9</lpage>.<pub-id pub-id-type="pmid">31250881</pub-id>
</mixed-citation></ref><ref id="btae737-B36"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Schliep</surname>
<given-names>KP.</given-names>
</string-name>
</person-group>
<article-title>Phangorn: phylogenetic analysis in R</article-title>. <source>Bioinformatics</source><year>2011</year>;<volume>27</volume>:<fpage>592</fpage>&#x02013;<lpage>3</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq706</pub-id>.<pub-id pub-id-type="pmid">21169378</pub-id>
</mixed-citation></ref><ref id="btae737-B37"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Schwartz</surname>
<given-names>R</given-names>
</string-name>, <string-name><surname>Sch&#x000e4;ffer</surname><given-names>AA.</given-names></string-name></person-group>
<article-title>The evolution of tumour phylogenetics: principles and practice</article-title>. <source>Nat Rev Genet</source><year>2017</year>;<volume>18</volume>:<fpage>213</fpage>&#x02013;<lpage>29</lpage>. <pub-id pub-id-type="doi">10.1038/nrg.2016.170</pub-id>.<pub-id pub-id-type="pmid">28190876</pub-id>
</mixed-citation></ref><ref id="btae737-B38"><mixed-citation publication-type="book">
<person-group person-group-type="author">
<string-name>
<surname>Wickham</surname>
<given-names>H.</given-names>
</string-name>
</person-group>
<source>Ggplot2: Elegant Graphics for Data Analysis</source>. <publisher-name>Springer-Verlag</publisher-name>, <year>2016</year>. <ext-link xlink:href="https://link.springer.com/book/10.1007/978-0-387-98141-3" ext-link-type="uri">https://link.springer.com/book/10.1007/978-0-387-98141-3</ext-link>.</mixed-citation></ref><ref id="btae737-B39"><mixed-citation publication-type="journal">
<person-group person-group-type="author">
<string-name>
<surname>Yu</surname>
<given-names>G</given-names>
</string-name>, <string-name><surname>Smith</surname><given-names>DK</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>H</given-names></string-name></person-group>
<etal>et al</etal>
<article-title>Ggtree: an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data</article-title>. <source>Methods Ecol Evol</source><year>2017</year>;<volume>8</volume>:<fpage>28</fpage>&#x02013;<lpage>36</lpage>. <pub-id pub-id-type="doi">10.1111/2041-210X.12628</pub-id>.</mixed-citation></ref></ref-list></back></article>