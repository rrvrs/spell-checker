<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="en" article-type="research-article"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Front Neurorobot</journal-id><journal-id journal-id-type="iso-abbrev">Front Neurorobot</journal-id><journal-id journal-id-type="publisher-id">Front. Neurorobot.</journal-id><journal-title-group><journal-title>Frontiers in Neurorobotics</journal-title></journal-title-group><issn pub-type="epub">1662-5218</issn><publisher><publisher-name>Frontiers Media S.A.</publisher-name></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmc">PMC12098330</article-id><article-id pub-id-type="doi">10.3389/fnbot.2025.1562519</article-id><article-categories><subj-group subj-group-type="heading"><subject>Neuroscience</subject><subj-group><subject>Original Research</subject></subj-group></subj-group></article-categories><title-group><article-title>Motion control and singular perturbation algorithms for lower limb rehabilitation robots</article-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><name><surname>Xie</surname><given-names>Yanchun</given-names></name><xref rid="aff1" ref-type="aff">
<sup>1</sup>
</xref><xref rid="fn001" ref-type="author-notes">
<sup>&#x02020;</sup>
</xref><uri xlink:href="http://loop.frontiersin.org/people/2950799/overview"/><role content-type="https://credit.niso.org/contributor-roles/writing-original-draft/"/></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Wang</surname><given-names>Anna</given-names></name><xref rid="aff2" ref-type="aff">
<sup>2</sup>
</xref><xref rid="fn001" ref-type="author-notes">
<sup>&#x02020;</sup>
</xref><role content-type="https://credit.niso.org/contributor-roles/writing-original-draft/"/></contrib><contrib contrib-type="author"><name><surname>Zhao</surname><given-names>Xue</given-names></name><xref rid="aff3" ref-type="aff">
<sup>3</sup>
</xref><role content-type="https://credit.niso.org/contributor-roles/writing-review-editing/"/></contrib><contrib contrib-type="author"><name><surname>Jiang</surname><given-names>Yang</given-names></name><xref rid="aff4" ref-type="aff">
<sup>4</sup>
</xref><role content-type="https://credit.niso.org/contributor-roles/writing-original-draft/"/></contrib><contrib contrib-type="author"><name><surname>Wu</surname><given-names>Yao</given-names></name><xref rid="aff4" ref-type="aff">
<sup>4</sup>
</xref><role content-type="https://credit.niso.org/contributor-roles/writing-original-draft/"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Yu</surname><given-names>Hailong</given-names></name><xref rid="aff1" ref-type="aff">
<sup>1</sup>
</xref><xref rid="c001" ref-type="corresp">
<sup>*</sup>
</xref><role content-type="https://credit.niso.org/contributor-roles/writing-original-draft/"/></contrib></contrib-group><aff id="aff1"><sup>1</sup><institution>Department of Orthopaedics, General Hospital of Northern Theater Command</institution>, <addr-line>Shenyang</addr-line>, <country>China</country></aff><aff id="aff2"><sup>2</sup><institution>Department of Burns and Plastic Surgery, General Hospital of Northern Theater Command</institution>, <addr-line>Shenyang</addr-line>, <country>China</country></aff><aff id="aff3"><sup>3</sup><institution>Daniel L. Goodwin College of Business, Benedictine University</institution>, <addr-line>Chicago, IL</addr-line>, <country>United States</country></aff><aff id="aff4"><sup>4</sup><institution>Faculty of Robot Science and Engineering, Northeastern University</institution>, <addr-line>Shenyang</addr-line>, <country>China</country></aff><author-notes><fn fn-type="edited-by"><p>Edited by: Tomohiro Shibata, Kyushu Institute of Technology, Japan</p></fn><fn fn-type="edited-by"><p>Reviewed by: Bin Zhi Li, Chinese Academy of Sciences (CAS), China</p><p>Wentai Zhang, Peking Union Medical College Hospital (CAMS), China</p></fn><corresp id="c001">*Correspondence: Hailong Yu <email>1955416359@qq.com</email></corresp><fn fn-type="equal" id="fn001"><p>&#x02020;These authors have contributed equally to this work</p></fn></author-notes><pub-date pub-type="epub"><day>09</day><month>5</month><year>2025</year></pub-date><pub-date pub-type="collection"><year>2025</year></pub-date><volume>19</volume><elocation-id>1562519</elocation-id><history><date date-type="received"><day>17</day><month>1</month><year>2025</year></date><date date-type="accepted"><day>28</day><month>3</month><year>2025</year></date></history><permissions><copyright-statement>Copyright &#x000a9; 2025 Xie, Wang, Zhao, Jiang, Wu and Yu.</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Xie, Wang, Zhao, Jiang, Wu and Yu</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p></license></permissions><abstract><p>To better assist patients with lower limb injuries in their rehabilitation training, this paper focuses on motion control and singular perturbation algorithms and their practical applications. First, the paper conducts an in-depth analysis of the mechanical structure of such robots and establishes detailed kinematics and dynamics models. An optimal S-type planning algorithm is proposed, transforming the S-type planning into an iterative solution problem for efficient and accelerated trajectory planning using dynamic equations. This algorithm comprehensively considers joint range of motion, speed constraints, and dynamic conditions, ensuring the smoothness and continuity of motion trajectories. Second, a zero-force control method is introduced, incorporating friction terms into the traditional dynamic equations and utilizing the LuGre friction model for friction analysis to achieve zero-force control. Furthermore, to address the multi-scale dynamic system characteristics present in rehabilitation training, a control method based on singular perturbation theory is proposed. This method enhances the system's robustness and adaptability by simplifying the system model and optimizing controller design, enabling it to better accommodate complex motion requirements during rehabilitation. Finally, experiments verify the correctness of the kinematics and optimal S-type trajectory planning. In lower limb rehabilitation robots, zero-force control can better assist patients in rehabilitation training for lower limb injuries, while the singular perturbation method improves the accuracy, response speed, and robustness of the control system, allowing it to adapt to individual rehabilitation needs and complex motion patterns. The novelty of this paper lies in the integration of the singular perturbation method with the LuGre friction model, significantly enhancing the precision of joint dynamic control, and improving controller design through the introduction of a torque deviation feedback mechanism, thereby increasing system stability and response speed. Experimental results demonstrate significant improvements in tracking error and system response compared to traditional methods, providing patients with a more comfortable and safer rehabilitation experience.</p></abstract><kwd-group><kwd>rehabilitation robots</kwd><kwd>trajectory planning</kwd><kwd>singular perturbation</kwd><kwd>flexible control</kwd><kwd>controller design</kwd></kwd-group><funding-group><funding-statement>The author(s) declare that financial support was received for the research and/or publication of this article. This research was funded by Basic Research on Stress induced Bone Growth of Porous Titanium and Its Potential Application in Spinal Fusion Cages (Project No.: 2023JH2/101700136), Basic and Applied Research Project of Liaoning Provincial Science and Technology Planning.</funding-statement></funding-group><counts><fig-count count="12"/><table-count count="2"/><equation-count count="55"/><ref-count count="18"/><page-count count="14"/><word-count count="7206"/></counts></article-meta></front><body><sec id="s1"><title>1 Introduction</title><p>With the global aging trend and evolving lifestyles, the demand for lower limb rehabilitation following injuries has surged, driving the widespread adoption of rehabilitation robots in medical applications. Notably, these robots exhibit significant potential in lower limb rehabilitation training (Qassim and Wan Hasan, <xref rid="B13" ref-type="bibr">2020</xref>). Traditional rehabilitation relies heavily on specialized therapists to manually guide patients through passive exercises, a process that struggles to ensure consistency and continuity due to the limited availability of qualified therapists and variations in their skill levels stemming from individual differences. These factors represent key bottlenecks in current rehabilitation technology. Flexible lower limb rehabilitation robots address these challenges by simulating natural human movement patterns, offering personalized training programs, and facilitating the gradual restoration of motor functions, thereby alleviating the shortage of skilled trainers. However, technical challenges persist, particularly in achieving real-time responsiveness and precise trajectory planning in practical applications. The system models of lower limb rehabilitation robots typically exhibit complex characteristics, such as high order, non-linearity, and strong coupling. Additionally, the accuracy of these models is often challenging to ensure ultimately, which complicates the control structure. However, the singular perturbation method can simplify system models (Kevorkian and Cole, <xref rid="B9" ref-type="bibr">2012</xref>) by partitioning the system into fast and slow subsystems based on time scales (Yu and Chen, <xref rid="B16" ref-type="bibr">2015</xref>). Subsequently, controller design is conducted separately for these two subsystems. This approach reduces the order of the robot model and significantly decreases the computational burden. Li et al. (<xref rid="B11" ref-type="bibr">2021</xref>) developed an image-driven control strategy for the slow dynamic part involving rigid body motion to reduce visual errors, while compensating for errors in the approximated Jacobian matrix. For the fast dynamic part related to elastic vibrations, they designed an observer to predict the fast dynamic state to avoid relying on direct vibration state measurements. Based on these predicted states, a control feedback mechanism was developed to mitigate vibrations in the flexible robot. However, this system requires extra visual sensors, which introduces additional failure points. These visual sensors may experience malfunctions or degraded performance due to lighting conditions and dust.</p><p>The trajectory planning methods for rehabilitation robots have evolved from traditional robotic arms. Additionally, literature 0 introduced a smooth algorithm for trajectory planning of spray guns to address trajectory connection issues (From et al., <xref rid="B5" ref-type="bibr">2010</xref>). Literature 0 explored the trajectory planning for the robot end effector (Dhanaraj et al., <xref rid="B4" ref-type="bibr">2022</xref>). While literature 0 investigated the robot kinematic model using neural network approaches (Gao, <xref rid="B6" ref-type="bibr">2020</xref>). However, due to the model complexity and the lengthy computation time, its engineering applications are limited. Motion control and singular perturbation control are critical technologies in rehabilitation robot control systems, directly impacting rehabilitation training effectiveness and safety. Further optimization of these control strategies significantly enhances the performance and clinical rehabilitation robot value.</p><p>This paper explores the development of kinematic and dynamic models for lower limb rehabilitation robots, providing a theoretical basis for trajectory planning. By applying maximum acceleration constraints to S-type trajectory planning, the study generates optimal acceleration trajectories that consider joint motion ranges, speed limits, and dynamic conditions, ensuring smooth and efficient robot operations. The integration of the LuGre friction model into the dynamic equations enables zero-force control, enhancing patient comfort during rehabilitation. Additionally, the combination of singular perturbation control and motor current-based joint torque control improves system performance, offering precise regulation and rapid response to dynamic changes. These advancements enhance the robustness and stability of the control system under external disturbances, supporting personalized rehabilitation treatments and expanding the clinical applicability of lower limb rehabilitation robots.</p></sec><sec id="s2"><title>2 Motion control of lower limb rehabilitation robot</title><p>As shown in <xref rid="F1" ref-type="fig">Figure 1</xref>, this system employs a hierarchical open architecture design Based on the human lower limb structure and its regular movement mechanisms to enhance patients' efficiency and enjoyment during rehabilitation training while allowing for personalized adjustments based on individual differences. Regarding safety, the robot legs can be equipped with flexible tactile sensor modules, which enhance the robot's interactivity and the precision of rehabilitation training. The robot also incorporates multiple safety mechanisms, including force feedback, position limits, and emergency stop buttons, ensuring rapid response in abnormal situations to protect patient safety.</p><fig position="float" id="F1"><label>Figure 1</label><caption><p>Coordinate system and connecting rod diagram of flexible lower limb rehabilitation robot.</p></caption><graphic xlink:href="fnbot-19-1562519-g0001" position="float"/></fig><sec><title>2.1 Kinematic model</title><p>In <xref rid="F1" ref-type="fig">Figure 1</xref>, represent the lengths of the three links, while &#x003b2; denotes the angle between the extension line of link 3 and link 2. Let the height of the rise at joint 1 be <italic>h</italic>, and the rotational angles at the three joints be &#x003b8;<sub>1</sub>, &#x003b8;<sub>2</sub>, &#x003b8;<sub>3</sub>. These three rotational angles collectively determine the spatial position and orientation. By adjusting the angles, the robot can navigate to different points in three-dimensional space, providing versatile functionality for patient interaction and treatment.</p><p>The DH parameters (as shown in <xref rid="T1" ref-type="table">Table 1</xref>) are used to describe the geometric relationship between adjacent joints in robotic manipulators, consisting of four key parameters: &#x003b8; (joint angle), <italic>d</italic> (link offset), <italic>a</italic> (link length), and &#x003b1; (link twist angle). Specifically, &#x003b8; represents the rotation angle about the <italic>Z</italic>-axis, describing the rotational displacement of the current joint and is typically a variable; <italic>d</italic> denotes the translation distance along the <italic>Z</italic>-axis, indicating the linear displacement of the current joint along the <italic>Z</italic>-axis and is usually a constant; <italic>a</italic> signifies the translation distance along the <italic>X</italic>-axis, representing the linear displacement of the current joint along the <italic>X</italic>-axis and is generally a constant; and &#x003b1; represents the rotation angle about the <italic>X</italic>-axis, describing the twist angle between adjacent joint axes and is typically a constant. Together, these parameters define the relative position and orientation between the joints of a robotic arm, providing a foundational framework for kinematic analysis.</p><disp-formula id="E1">
<label>(1)</label>
<mml:math id="M3" overflow="scroll"><mml:mmultiscripts><mml:mi>T</mml:mi><mml:mprescripts/><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mmultiscripts><mml:mi>T</mml:mi><mml:mprescripts/><mml:mn>1</mml:mn><mml:mn>0</mml:mn></mml:mmultiscripts><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mmultiscripts><mml:mtext>&#x000a0;</mml:mtext><mml:mprescripts/><mml:mn>2</mml:mn><mml:mn>1</mml:mn></mml:mmultiscripts><mml:mi>T</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mmultiscripts><mml:mtext>&#x000a0;</mml:mtext><mml:mprescripts/><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mi>T</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mmultiscripts><mml:mtext>&#x000a0;</mml:mtext><mml:mprescripts/><mml:mn>4</mml:mn><mml:mn>3</mml:mn></mml:mmultiscripts><mml:mi>T</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mmultiscripts><mml:mtext>&#x000a0;</mml:mtext><mml:mprescripts/><mml:mi>H</mml:mi><mml:mn>4</mml:mn></mml:mmultiscripts><mml:mtext>&#x000a0;</mml:mtext><mml:mi>T</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math>
</disp-formula><disp-formula id="E2">
<label>(2)</label>
<mml:math id="M4" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>l</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>z</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>l</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mo>&#x02212;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><table-wrap position="float" id="T1"><label>Table 1</label><caption><p>Robot D-H parameters.</p></caption><table frame="box" rules="all"><thead><tr style="background-color:#8f9496;color:#ffffff"><th valign="top" align="left" rowspan="1" colspan="1">
<bold>rods</bold>
</th><th valign="top" align="center" rowspan="1" colspan="1">
<bold>&#x003b1;</bold>
</th><th valign="top" align="center" rowspan="1" colspan="1">
<bold>a</bold>
</th><th valign="top" align="center" rowspan="1" colspan="1">
<bold>d</bold>
</th><th valign="top" align="center" rowspan="1" colspan="1">
<bold>&#x003b8;</bold>
</th></tr></thead><tbody><tr><td valign="top" align="left" rowspan="1" colspan="1">1</td><td valign="top" align="center" rowspan="1" colspan="1">0</td><td valign="top" align="center" rowspan="1" colspan="1">0</td><td valign="top" align="center" rowspan="1" colspan="1">
<italic>h</italic>
</td><td valign="top" align="center" rowspan="1" colspan="1">0</td></tr><tr><td valign="top" align="left" rowspan="1" colspan="1">2</td><td valign="top" align="center" rowspan="1" colspan="1">
<inline-formula>
<mml:math id="M1" overflow="scroll"><mml:mfrac><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math>
</inline-formula>
</td><td valign="top" align="center" rowspan="1" colspan="1">0</td><td valign="top" align="center" rowspan="1" colspan="1">0</td><td valign="top" align="center" rowspan="1" colspan="1">&#x003b8;<sub>1</sub></td></tr><tr><td valign="top" align="left" rowspan="1" colspan="1">3</td><td valign="top" align="center" rowspan="1" colspan="1">0</td><td valign="top" align="center" rowspan="1" colspan="1">
<italic>l</italic>
<sub>1</sub>
</td><td valign="top" align="center" rowspan="1" colspan="1">0</td><td valign="top" align="center" rowspan="1" colspan="1">
<inline-formula>
<mml:math id="M2" overflow="scroll"><mml:msub><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math>
</inline-formula>
</td></tr><tr><td valign="top" align="left" rowspan="1" colspan="1">4</td><td valign="top" align="center" rowspan="1" colspan="1">0</td><td valign="top" align="center" rowspan="1" colspan="1">
<italic>l</italic>
<sub>2</sub>
</td><td valign="top" align="center" rowspan="1" colspan="1">0</td><td valign="top" align="center" rowspan="1" colspan="1">&#x003b8;<sub>3</sub>+&#x003b2;</td></tr><tr><td valign="top" align="left" rowspan="1" colspan="1">H</td><td valign="top" align="center" rowspan="1" colspan="1">0</td><td valign="top" align="center" rowspan="1" colspan="1">
<italic>l</italic>
<sub>3</sub>
</td><td valign="top" align="center" rowspan="1" colspan="1">0</td><td valign="top" align="center" rowspan="1" colspan="1">0</td></tr></tbody></table></table-wrap><p>The known variables are:</p><disp-formula id="E3">
<label>(3)</label>
<mml:math id="M5" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>&#x000a0;&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>&#x000a0;&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mi>sin</mml:mi><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>&#x000a0;&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mi>sin</mml:mi><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mo>=</mml:mo><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p>The pose transformation matrix (<xref rid="E1" ref-type="disp-formula">Equation 1</xref>) can be obtained according to DH table, and the forward kinematics equation can be derived. In this matrix, the first three columns correspond to the projections of the new coordinate system's <italic>X</italic>-axis, <italic>Y</italic>-axis, and <italic>Z</italic>-axis direction vectors within the original coordinate system, represented as <inline-formula><mml:math id="M6" overflow="scroll"><mml:mstyle mathvariant="bold"><mml:mtext>n</mml:mtext></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>
<inline-formula><mml:math id="M7" overflow="scroll"><mml:mstyle mathvariant="bold"><mml:mtext>o</mml:mtext></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>o</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, respectively. These vectors collectively define the rotational (orientational) transformation of the new coordinate system relative to the original one. The fourth column <inline-formula><mml:math id="M8" overflow="scroll"><mml:mstyle mathvariant="bold"><mml:mtext>p</mml:mtext></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>z</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> denotes the position vector of the new coordinate system's origin with respect to the original coordinate system, encapsulating the translational transformation. The final row [0, 0, 0, 1] serves as the normalization component of the homogeneous coordinates. Such transformation matrices are extensively utilized in robotic kinematics, where sequential multiplication facilitates the computation of the end-effector's pose relative to the base coordinate system.</p></sec><sec><title>2.2 Zero-force control</title><p>Set on the joint coordinates <inline-formula><mml:math id="M9" overflow="scroll"><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>q</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:math></inline-formula>. <italic>m</italic><sub>1</sub>, <italic>m</italic><sub>2</sub> and <italic>m</italic><sub>3</sub> respectively, represent the mass of the three members, <italic>l</italic><sub>1</sub>, <italic>l</italic><sub>2</sub> and <italic>l</italic><sub>3</sub> represent the length of the three members, <italic>d</italic><sub>1</sub>, <italic>d</italic><sub>2</sub>, <italic>d</italic><sub>3</sub> indicate the distance from the mass center to the axes of the three members, respectively.</p><p>(1) Rehabilitation of robot total potential energy</p><p>Potential energy <italic>P</italic><sub>1</sub> of rehabilitation robot rod 1</p><disp-formula id="E4">
<label>(4)</label>
<mml:math id="M10" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo class="qopname">cos</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>The potential energy <italic>P</italic><sub>2</sub> of rehabilitation robot rod 2</p><disp-formula id="E5">
<label>(5)</label>
<mml:math id="M11" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>=</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mi>g</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo class="qopname">cos</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>-</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo class="qopname">cos</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>The potential energy <italic>P</italic><sub>3</sub> of rehabilitation robot rod 3</p><disp-formula id="E6">
<label>(6)</label>
<mml:math id="M12" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo class="qopname">sin</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo class="qopname">sin</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo class="qopname">cos</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>The rehabilitation robot total potential energy as <xref rid="E7" ref-type="disp-formula">Equation 7</xref>.</p><disp-formula id="E7">
<label>(7)</label>
<mml:math id="M13" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>(2) The rehabilitation robot total kinetic energy of can be similarly obtained as follows</p><disp-formula id="E8">
<label>(8)</label>
<mml:math id="M14" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>The Lagrange function <italic>L</italic> is:</p><disp-formula id="E9">
<label>(9)</label>
<mml:math id="M15" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>The known variables are:</p><disp-formula id="E10">
<label>(10)</label>
<mml:math id="M16" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>&#x000a0;&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>&#x000a0;&#x000a0;</mml:mtext><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:mo>=</mml:mo><mml:mi>sin</mml:mi><mml:msub><mml:mi>q</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>&#x000a0;&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:msub><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mi>sin</mml:mi><mml:msub><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:mo>=</mml:mo><mml:mi>cos</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:mo>=</mml:mo><mml:mi>sin</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x003b2;</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mtext>&#x000a0;</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p>The driving torque for each joint of the rehabilitation robot is then given by:</p><disp-formula id="E11">
<label>(11)</label>
<mml:math id="M17" overflow="scroll"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mo>&#x02202;</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02202;</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:mo>&#x02202;</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02202;</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>C</mml:mi><mml:mn>1</mml:mn><mml:msub><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mn>2</mml:mn><mml:msub><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mi>S</mml:mi><mml:mn>3</mml:mn><mml:msub><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>S</mml:mi><mml:mn>1</mml:mn><mml:msubsup><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>l</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>C</mml:mi><mml:mn>2</mml:mn><mml:msubsup><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mi>C</mml:mi><mml:mn>3</mml:mn><mml:msubsup><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>g</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>Similarly, we can get other joint driving torques. Take the friction term into the traditional dynamic equation and use the LuGre friction model for friction analysis and realize zero-force control. This study utilized a flexible lower-limb rehabilitation robotic experimental platform to approach enabled zero-force and high-precision control of the end effector force in the robot, achieving effective force feedback management.</p><disp-formula id="E12">
<label>(12)</label>
<mml:math id="M18" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mi>M</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mo>=</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>&#x003c4;</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p><italic>T</italic><sub><italic>f</italic></sub>is torque of LuGre friction, <inline-formula><mml:math id="M19" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:math></inline-formula> is angular velocity vector, <inline-formula><mml:math id="M20" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:math></inline-formula> is rotational angular acceleration vector.</p><p>This paper uses the LuGre friction model to compensate for joint dynamics. LuGre friction method not only enhances the fit of friction characteristics simulation but also improves the overall accuracy of the collision detection model. The LuGre friction model is</p><disp-formula id="E13">
<label>(13)</label>
<mml:math id="M21" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mo>=</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>-</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo class="qopname">exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo class="qopname">&#x000b0;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo class="qopname">&#x000b0;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mi>s</mml:mi><mml:mi>g</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo class="qopname">&#x000b0;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo class="qopname">&#x000b0;</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>In order to obtain the real friction parameters, experiments are carried out on the vacuum manipulator platform to obtain the following data: among others, <italic>f</italic><sub><italic>C</italic></sub> is Coulomb friction, <italic>f</italic><sub><italic>S</italic></sub> is static friction; <inline-formula><mml:math id="M22" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> provides real-time speed for the joints; <inline-formula><mml:math id="M23" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> for Stribeck Speed &#x003b4; is a parameter related to the shape of the contact surface; &#x003c3;<sub>2</sub> is the coefficient of viscous friction;&#x003c4;(<italic>t</italic>) is the joint drive torque measured by a sensor. The sampling frequency is high enough to capture changes in friction over time.</p><p>In rehabilitation robotics, the LuGre friction model provides critical support for joint friction compensation. When a patient applies a minimal external force, the robot, based on real-time joint velocity measurements and identified friction parameters (such as static friction), generates an equivalent compensating torque through the controller to counteract the inherent friction resistance of the mechanical system. This process enables the end-effector to exhibit a &#x0201c;weightless&#x0201d; zero-force control effect for the patient, meaning that only a minimal force is required to drive the robot's motion. This significantly enhances the compliance of rehabilitation training and the safety of human-robot interaction. By experimentally calibrating parameters (e.g., low-speed sweep tests for static friction and high-speed constant velocity tests for viscous friction separation), the LuGre model further optimizes friction compensation accuracy, ensuring the robustness of zero-force control in complex motion scenarios.</p></sec><sec><title>2.3 Optimal S-type planning</title><p>Under optimal trajectory control, the lower limb rehabilitation robot significantly improves its trajectory planning ability and operational flexibility and maximizes the advantages of the lower limb rehabilitation robot. The trajectory interpolated core considers both kinematic constraints (such as joint angles and end-effector positions) and dynamic constraints (including forces, torques, and inertia). Optimal trajectory parameters that satisfy these constraints are computed using optimization algorithms.</p><p>A complete S-curve trajectory planning can be constructed based on <xref rid="E14" ref-type="disp-formula">Equations 14</xref>, <xref rid="E17" ref-type="disp-formula">15</xref>.</p><p><italic>J</italic>(<italic>t</italic>) is Jerk, <italic>A</italic>(<italic>t</italic>) is Acceleration and <italic>V</italic>(<italic>t</italic>) is Velocity:</p><disp-formula id="E14">
<label>(14)</label>
<mml:math id="M24" overflow="scroll"><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mi>J</mml:mi><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02264;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x0003c;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>J</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02264;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x0003c;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02264;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x0003c;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>J</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02264;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x0003c;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02264;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x0003c;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>J</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x02264;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x0003c;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><disp-formula id="E15">
<mml:math id="M25" overflow="scroll"><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mi>J</mml:mi><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>&#x000a0;</mml:mtext><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>J</mml:mi><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mn>0</mml:mn><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mi>J</mml:mi><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo>&#x02212;</mml:mo><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02212;</mml:mo><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>J</mml:mi><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math>
</disp-formula><disp-formula id="E16">
<mml:math id="M26" overflow="scroll"><mml:mi>V</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>02</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>03</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>04</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>05</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>06</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>7</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>t</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p>Position is <italic>S</italic>(<italic>t</italic>):</p><disp-formula id="E17">
<label>(15)</label>
<mml:math id="M27" overflow="scroll"><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>1</mml:mn><mml:mn>3</mml:mn></mml:msubsup><mml:mtext>&#x000a0;</mml:mtext><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>01</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mtext>&#x000a0;&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>02</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>02</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mtext>&#x000a0;&#x000a0;&#x000a0;</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>03</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>03</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mtext>&#x000a0;&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>04</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>04</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mtext>&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>05</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>05</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>6</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mtext>&#x000a0;&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mn>06</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>06</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>7</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>6</mml:mn></mml:mfrac><mml:mi>J</mml:mi><mml:msubsup><mml:mi>&#x003c4;</mml:mi><mml:mn>7</mml:mn><mml:mn>3</mml:mn></mml:msubsup><mml:mtext>&#x000a0;&#x000a0;</mml:mtext><mml:msub><mml:mi>t</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>7</mml:mn></mml:msub><mml:mtext>&#x000a0;&#x000a0;</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p>An example of a planning segment from time node <italic>t</italic><sub>0</sub>to <italic>t</italic><sub>7</sub>is considered, where <italic>t</italic><sub>0</sub> represents the initial moment and <italic>t</italic><sub>7</sub> indicates the final moment. At both the start and end points, the robot velocity and acceleration are set to zero to ensure a smooth initiation and cessation of motion. Furthermore, it is essential to account for the limits of robot speed, acceleration, and jerk (the accelerated change rate) during the movement process. These include the max velocity <italic>v</italic><sub><italic>m</italic></sub>, the max acceleration <italic>a</italic><sub><italic>mu</italic></sub>, the max deceleration <italic>a</italic><sub><italic>md</italic></sub>, as well as the max jerk during the acceleration and deceleration phases, denoted as <italic>j</italic><sub><italic>mu</italic></sub>, <italic>j</italic><sub><italic>md</italic></sub>. These parameters are directly related to robot safety and efficiency.</p><p>The states of trajectory planning at each discrete point <inline-formula><mml:math id="M28" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are obtained using the robot S-type programming model. Based on the established dynamic model (<xref rid="E18" ref-type="disp-formula">Equation 16</xref>), the inverse dynamic IDy is used to solve the theoretical torque &#x003c4;<sub><italic>i, cal</italic></sub> of each joint demand.</p><disp-formula id="E18">
<label>(16)</label>
<mml:math id="M29" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mi>D</mml:mi><mml:mi>y</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>The calculated moment value is compared with each manipulator joint's maximum output moment &#x003c4;<sub><italic>i</italic>, max</sub>. If the calculated moment value exceeds the theoretical moment value, it indicates that the joint cannot provide the moment value and must be corrected to make the planning result conform to the moment limit. The corrected joint calculated moment is as follows <xref rid="E19" ref-type="disp-formula">Equation 17</xref>.</p><disp-formula id="E19">
<label>(17)</label>
<mml:math id="M30" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext class="textrm" mathvariant="normal">calmax</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo class="qopname">sign</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mo class="qopname">min</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo class="qopname">max</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext class="textrm" mathvariant="normal">cal</mml:mtext></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>The optimal trajectory control can be achieved only when the robot dynamics constraint is applied to the trajectory planning of the manipulator's end. According to the dynamic equation of the manipulator, the corresponding relationship between the joint torque and acceleration <inline-formula><mml:math id="M31" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">newmax</mml:mtext></mml:mstyle></mml:mrow></mml:msub></mml:math></inline-formula> is obtained as follows <xref rid="E20" ref-type="disp-formula">Equation 18</xref>.</p><disp-formula id="E20">
<label>(18)</label>
<mml:math id="M32" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext class="textrm" mathvariant="normal">newmax</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext class="textrm" mathvariant="normal">calmax</mml:mtext></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>On this basis, the torque constraint is mapped to the acceleration constraint, the acceleration subject to the torque constraint is obtained, and the final acceleration constraint is obtained by comparing it with the joint acceleration in the initial state. The process is as follows <xref rid="E21" ref-type="disp-formula">Equation 19</xref>. <inline-formula><mml:math id="M33" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo class="qopname">max</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> is the maximum acceleration constraint in the initial state, <inline-formula><mml:math id="M34" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mstyle class="text"><mml:mtext class="textrm" mathvariant="normal">modified</mml:mtext></mml:mstyle></mml:mrow></mml:msub></mml:math></inline-formula> is the maximum acceleration of the <italic>i</italic> joint calculated by torque constraint.</p><disp-formula id="E21">
<label>(19)</label>
<mml:math id="M35" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext class="textrm" mathvariant="normal">newmax</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo class="qopname">min</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo class="qopname">&#x000a8;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo class="qopname">max</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo class="qopname">&#x000a8;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mtext class="textrm" mathvariant="normal">modified</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p><inline-formula><mml:math id="M36" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>w</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mtext>&#x000a0;</mml:mtext></mml:math></inline-formula>is the maximum acceleration constraint adjusted by the dynamic constraint, and <inline-formula><mml:math id="M37" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:math></inline-formula> is the vector formed by the maximum joint acceleration calculated by the torque constraint. If the new acceleration constraint is substituted into the dynamic trajectory planning, the complete trajectory planning satisfies the dynamic constraint.</p></sec></sec><sec id="s3"><title>3 Singular perturbation method of lower limb rehabilitation robot</title><p>In the widespread robot application, a particular type of system is often encountered, characterized by significant differences in the rates of change between various states, exhibiting unique singularities and separated phenomena in motion (Weingartshofer et al., <xref rid="B15" ref-type="bibr">2023</xref>; Amersdorfer and Meurer, <xref rid="B1" ref-type="bibr">2022</xref>; Jiang et al., <xref rid="B8" ref-type="bibr">2023</xref>; Wang et al., <xref rid="B14" ref-type="bibr">2021</xref>; Pana et al., <xref rid="B12" ref-type="bibr">2023</xref>; Cao et al., <xref rid="B3" ref-type="bibr">2023</xref>; Zhang et al., <xref rid="B17" ref-type="bibr">2024</xref>). Such systems, including electric motors, generators, precision robotic structures, and complex biological systems, are collectively called singularly perturbed systems or systems with dual time scales. For these dual time-scale dynamic systems, also known as singular perturbation systems, the design of control strategies must consider their multi-time-scale characteristics. Traditional control methods based on a single time scale are often inadequate, as the dynamic behaviors of such systems differ significantly across various time scales. To achieve precise control of these systems, it is common to utilize singular perturbation theory to decompose the original system into multiple subsystems that are temporally separated yet mutually coupled, with each subsystem corresponding to a specific time scale.</p><sec><title>3.1 Singular perturbation model of robotics</title><p>This chapter focuses on transforming dynamic models into singular perturbation forms. Based on the inherent dynamic characteristics, mathematical transformation methods are applied to derive robot system models that comply with the requirements of singular perturbation theory analysis. During this derivation process, friction factors are temporarily excluded from consideration to simplify the analysis and highlight the core dynamic characteristics. The aim is to capture the essential dynamic behavior, it provides a theoretical framework for the design of subsequent controllers based on singular perturbation theory. The singular perturbation model is categorized into separate fast and slow subsystems. Typically, the fast subsystem reflects the high-frequency dynamic characteristics, while the slow subsystem characterizes the long-term behavior and primary motion trends.</p><p>By temporarily neglecting the influence of friction, a simplified dynamic model of the robotic joint torque system can be expressed as follows <xref rid="E22" ref-type="disp-formula">Equation 20</xref>, <italic>N</italic> is the accelerator transmission ratio, <italic>J</italic><sub><italic>em</italic></sub> is motor rotor inertia, is the electromotor torque formula, which from the AC permanent magnet synchronous motor torque model. &#x003c4; is joint torque, &#x003c4;<sub><italic>ext</italic></sub> is the external reaction torque.</p><disp-formula id="E22">
<label>(20)</label>
<mml:math id="M38" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>n</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>y</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p>It can be observed as follows <xref rid="E23" ref-type="disp-formula">Equation 21</xref>.</p><disp-formula id="E23">
<label>(21)</label>
<mml:math id="M39" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mi>N</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>&#x003c8;</mml:mi></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>&#x003c9;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>In the analysis of robotic dynamics, the electromotor torque &#x003c4;<sub><italic>em</italic></sub> serves as the driving source, and its output is transmitted to the robot joints through the transmission system, resulting in the joint torque &#x003c4;. When the robot design includes joint torque sensors, this critical parameter can be directly measured. The expression for joint torque is given by <xref rid="E24" ref-type="disp-formula">Equation 22</xref>, where <italic>K</italic> represents the inherent stiffness of the joint, <italic>N</italic><sup>&#x02212;1</sup>&#x003b8; is the equivalent joint angular displacement obtained by inversely transforming the motor angle &#x003b8; through the gear ratio <italic>N</italic>, and <italic>q</italic> is the actual joint angle. This Equation illustrates the dynamic relationship between joint torque, motor angle, and joint angle, as well as the impact of stiffness <italic>K</italic> on system response. The motor angular acceleration is obtained from <xref rid="E25" ref-type="disp-formula">Equation 23</xref>.</p><disp-formula id="E24">
<label>(22)</label>
<mml:math id="M40" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>&#x003b8;</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E25">
<label>(23)</label>
<mml:math id="M41" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>Substituting <xref rid="E24" ref-type="disp-formula">Equations 22</xref>, <xref rid="E25" ref-type="disp-formula">23</xref> into the second equation in <xref rid="E22" ref-type="disp-formula">Equation 20</xref>, we get <xref rid="E26" ref-type="disp-formula">Equation 24</xref>.</p><disp-formula id="E26">
<label>(24)</label>
<mml:math id="M42" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>Since the inertia matrix is a symmetric positive definite matrix, the following equation can be obtained.</p><disp-formula id="E27">
<label>(25)</label>
<mml:math id="M43" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mtext class="textrm" mathvariant="normal">ext</mml:mtext></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>Substituting Equation <xref rid="E27" ref-type="disp-formula">25</xref> into <xref rid="E26" ref-type="disp-formula">Equation 24</xref> gives <xref rid="E28" ref-type="disp-formula">Equation 26</xref>.</p><disp-formula id="E28">
<label>(26)</label>
<mml:math id="M44" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E29">
<mml:math id="M45" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>By introducing a small parameter &#x003b5;, the system equations can be reformulated as a standard singular perturbation model. The joint stiffness <italic>K</italic> is often very high, so <inline-formula><mml:math id="M46" overflow="scroll"><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:math></inline-formula> can be used instead of <italic>K</italic>. <italic>K</italic><sub>&#x003b5;</sub> is positive definite diagonal matrix. Substituting the expression of <italic>K</italic> and sorting it out, we can get the singular perturbation model of the system:</p><disp-formula id="E30">
<label>(27)</label>
<mml:math id="M47" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mtext>ext&#x000a0;</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>&#x003b5;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mover accent="true"><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>&#x003b5;</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>&#x003b5;</mml:mi></mml:msub><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>&#x003b5;</mml:mi></mml:msub><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mtext>ext&#x000a0;</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p>The system boundary layer model is derived by introducing a new coordinate variable as follows <xref rid="E31" ref-type="disp-formula">Equation 28</xref>.</p><disp-formula id="E31">
<label>(28)</label>
<mml:math id="M48" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>J</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mover accent="true"><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>M</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mover accent="true"><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mrow><mml:mtext>ext&#x000a0;</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>&#x003b3;</mml:mi><mml:mo>=</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mi>&#x0211d;</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p>Introduce a new time scale as follows <xref rid="E32" ref-type="disp-formula">Equation 29</xref>.</p><disp-formula id="E32">
<label>(29)</label>
<mml:math id="M49" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if&#x000a0;</mml:mtext><mml:mi>&#x003b5;</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p><xref rid="E33" ref-type="disp-formula">Equation 30</xref> is derived from <xref rid="E31" ref-type="disp-formula">Equations 28</xref>, <xref rid="E32" ref-type="disp-formula">29</xref>.</p><disp-formula id="E33">
<label>(30)</label>
<mml:math id="M50" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>&#x003b3;</mml:mi><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E34">
<mml:math id="M51" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>At the time scale <italic>v</italic>, the state variables and the external inputs &#x003c4;<sub><italic>ext</italic></sub> are regarded as static values. <xref rid="E35" ref-type="disp-formula">Equation 31</xref> can be derived.</p><disp-formula id="E35">
<label>(31)</label>
<mml:math id="M52" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E36">
<mml:math id="M53" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext class="textrm" mathvariant="normal">ext</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>By substituting it into <xref rid="E33" ref-type="disp-formula">Equation 30</xref>, the final system boundary layer model is as follows <xref rid="E37" ref-type="disp-formula">Equation 32</xref>.</p><disp-formula id="E37">
<label>(32)</label>
<mml:math id="M54" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003b3;</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula></sec><sec><title>3.2 Controller design based on singular perturbation</title><p>In robotic controller design, singular perturbation methods are often integrated into composite feedback strategies to optimize system performance, as shown in <xref rid="F2" ref-type="fig">Figure 2</xref>. This decomposition strategy independently addresses the different time scale issues in the system dynamics, thereby enhancing system stability, improving response speed, and simplifying the controller complexity (Bhardwaj et al., <xref rid="B2" ref-type="bibr">2021</xref>; Khan et al., <xref rid="B10" ref-type="bibr">2022</xref>; Zheng et al., <xref rid="B18" ref-type="bibr">2022</xref>; Iskandar et al., <xref rid="B7" ref-type="bibr">2022</xref>).</p><fig position="float" id="F2"><label>Figure 2</label><caption><p>Singular control structure diagram.</p></caption><graphic xlink:href="fnbot-19-1562519-g0002" position="float"/></fig><p>This design decomposes the control input into slow and fast system components, as shown in <xref rid="E38" ref-type="disp-formula">Equation 33</xref>.</p><disp-formula id="E38">
<label>(33)</label>
<mml:math id="M55" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>The slow subsystem represents the long-term behavior and primary motion trends of the robot. It is characterized by slower dynamics, such as the robot's overall trajectory and position control. The slow subsystem employs classical control strategies, such as computed torque control and torque feedforward control, which are commonly used in rigid robot models. These strategies ensure that the robot's motion is smooth and accurate over time.</p><p>For the selection of the control input &#x003c4;<sub><italic>em, slow</italic></sub> for the slow subsystem, it must be based on the assumption that the system has a standard form, meaning that the average time scale <inline-formula><mml:math id="M56" overflow="scroll"><mml:mover accent="false" class="mml-overline"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo accent="true">&#x000af;</mml:mo></mml:mover></mml:math></inline-formula> in the quasi-steady-state model exists and has a unique solution. The key point is that the determination of &#x003c4;<sub><italic>em, slow</italic></sub> should depend solely on the state variables of the quasi-steady-state model <inline-formula><mml:math id="M57" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, avoiding the direct introduction of instantaneous feedback from the joint torque &#x003c4;, to ensure the independence and stability of the control input.</p><p>The fast subsystem captures high-frequency dynamics, such as vibrations and rapid adjustments in the robot's joints. These dynamics are critical for ensuring stability during rapid movements or when external disturbances are present.</p><p>In designing the control input &#x003c4;<sub><italic>em, fast</italic></sub> for the fast subsystem, it is essential to strictly adhere to the principle that it has no impact on the quasi-steady-state model when boundary layer effects are significant (&#x003b5; = 0). This requires that the norm tends to zero under the limit condition (&#x003c4;<sub><italic>em, fast</italic></sub>|<sub>&#x003b5;<italic>to</italic>0</sub> = 0). This design criterion aims to isolate potential disturbances from the fast subsystem on the dynamic behavior of the slow subsystem, ensuring the overall stability and accuracy of the system during rapid dynamic adjustments while optimizing performance in the boundary layer region. And we get the <xref rid="E39" ref-type="disp-formula">Equation 34</xref>.</p><disp-formula id="E39">
<label>(34)</label>
<mml:math id="M58" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mtext>slow</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>E</mml:mi><mml:mo>&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>&#x003c4;</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mtext>fast</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mmultiscripts><mml:mi>&#x003c4;</mml:mi><mml:mprescripts/><mml:mo>&#x02212;</mml:mo><mml:none/></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:msub><mml:mi>D</mml:mi><mml:mi>&#x003c4;</mml:mi></mml:msub><mml:mover accent="true"><mml:mi>&#x003b3;</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p>It becomes clear that this structure aligns with that of a rigid robot model. This alignment allows for the direct application of classical control strategies used for rigid manipulators, such as the computed torque method and torque feedforward control, for design slow subsystem.</p><p>The damping matrix <italic>D</italic><sub>&#x003c4;</sub> is designed as a positive definite matrix to ensure the stability and convergence of the system. A positive definite damping matrix introduces an energy dissipation mechanism into the system, which helps to suppress oscillations and stabilize the system. This is particularly crucial for rehabilitation robots, as smooth and stable motion is vital for patient safety and comfort.</p><p>For the slow subsystem, the controller design follows the fundamental principles (<xref rid="E40" ref-type="disp-formula">Equation 35</xref>) of the rigid manipulator model. The variables <inline-formula><mml:math id="M59" overflow="scroll"><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:math></inline-formula> represent the joint position and velocity. Considering the specificity of the boundary layer system, where time <italic>t</italic> and state variables can be treated as constants within a specific analytical framework, the original term <inline-formula><mml:math id="M60" overflow="scroll"><mml:mo>-</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:math></inline-formula> can be reasonably transformed into <inline-formula><mml:math id="M61" overflow="scroll"><mml:mo>-</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:math></inline-formula>. This transformation deepens the understanding of the system dynamic behavior under boundary conditions.</p><disp-formula id="E40">
<label>(35)</label>
<mml:math id="M62" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>The design of the overall composite feedback controller for the robotic system integrates the control strategies of the aforementioned fast and slow subsystems. By adjusting the positive definite damping matrix, the control laws of the rigid manipulator model, and the dynamic adjustments under boundary layer effects, a robust and efficient control system framework is ultimately formed. This framework is capable of addressing complex and variable operational environments and task requirements.</p><disp-formula id="E41">
<label>(36)</label>
<mml:math id="M63" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mtext class="textrm" mathvariant="normal">rigid</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>It utilizes an increased damping term to act on the system. However, it does not address or optimize the dynamic characteristics of the boundary layer, which limits the system's overall performance improvement. To overcome this shortcoming, we introduce a torque deviation feedback mechanism. By monitoring and feeding back torque deviations in real-time, we can dynamically adjust the control strategy, enhancing system stability and significantly improving the boundary layer's dynamic response and adjustment capability, leading to more efficient system control.</p><p>The torque deviation feedback is <xref rid="E42" ref-type="disp-formula">Equation 37</xref>.</p><disp-formula id="E42">
<label>(37)</label>
<mml:math id="M64" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>-</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p><italic>K</italic><sub>&#x003c4;</sub>is gain matrix, which used to improve the boundary layer dynamic performance. Therefore, the entire controller can be expressed as follows:</p><disp-formula id="E43">
<label>(38)</label>
<mml:math id="M65" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mtext class="textrm" mathvariant="normal">rigid</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mo>-</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mtext class="textrm" mathvariant="normal">rigid</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E44">
<mml:math id="M66" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>-</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula></sec><sec><title>3.3 Improved controller design</title><p>To implement an effective feedback mechanism, it is often necessary to accurately solve the steady-state function <inline-formula><mml:math id="M67" overflow="scroll"><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. However, this can be quite challenging in practical applications, such as the difficulties in accurately measuring external torque &#x003c4;<sub>ext</sub> and the complex computation of the inverse inertia matrix <italic>M</italic>(<italic>q</italic>). The Tychonov theorem states that for trajectory tracking errors, it ensures that the deviation from the quasi-steady state is bounded by a high-order infinitesimal quantity &#x003b5;. This characteristic becomes significant only as &#x003b5; approaches zero, highlighting the remarkable advantage of the boundary layer model over the quasi-steady state model in terms of dynamic response speed. By finely tuning the parameter &#x003b5;, rapid convergence of the error to a range close to the quasi-steady state can be achieved. Its introduction enables us to decompose complex multi-timescale systems into two independent subsystems&#x02014;the fast subsystem and the slow subsystem&#x02014;thereby simplifying controller design. The fast subsystem is typically employed to address high-frequency dynamics (e.g., vibrations, rapid adjustments), while the slow subsystem is utilized to manage low-frequency dynamics (e.g., overall trajectory control, position control).</p><p>To lessen the complexity of the state function, the controller is broken down into the following structure.</p><disp-formula id="E45">
<label>(39)</label>
<mml:math id="M68" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mi>&#x003c4;</mml:mi><mml:mo>-</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>The positive definite control gain matrix <italic>K</italic><sub>&#x003c4;</sub>, <italic>D</italic><sub>&#x003c4;</sub> are crucial, as they ensure the system stability and responsiveness. The real-time control input <inline-formula><mml:math id="M69" overflow="scroll"><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in the quasi-steady state model is dynamically adjusted based on the system state to achieve precise control. By replacing <italic>K</italic><sub>&#x003c4;</sub>&#x003c4; in the original <xref rid="E45" ref-type="disp-formula">Equation 39</xref> with <italic>K</italic><sub>&#x003c4;</sub><italic>y</italic>, it directly affects the dual time scale control strategy. On one hand, it directly acts on the fast system component, optimizing the computation of &#x003c4;<sub><italic>m, fast</italic></sub> to enhance the system rapid response capability and dynamic performance. On the other hand, this strategy also indirectly affects the control input of the slow system component &#x003c4;<sub><italic>m, slow</italic></sub> by optimizing the long-term control strategy, thereby improving the system robustness and steady-state accuracy. During the design process, careful adjustments to <italic>K</italic><sub>&#x003c4;</sub>, <italic>D</italic><sub>&#x003c4;</sub> are necessary, taking into account the interactions between the fast and slow systems to ensure that the overall control system can respond quickly to external changes while maintaining long-term stable operation.</p><disp-formula id="E46">
<label>(40)</label>
<mml:math id="M70" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E47">
<label>(41)</label>
<mml:math id="M71" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E48">
<mml:math id="M72" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>N</mml:mi><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>&#x003c4;<sub><italic>d</italic></sub>as a new control input, it can be designed based on rigid robots to derive the steady-state system as follows <xref rid="E47" ref-type="disp-formula">Equation 41</xref>. Finally, we get the <xref rid="E49" ref-type="disp-formula">Equation 42</xref> and Closed-loop control system <xref rid="E50" ref-type="disp-formula">Equation 43</xref>.</p><disp-formula id="E49">
<label>(42)</label>
<mml:math id="M73" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E50">
<label>(43)</label>
<mml:math id="M74" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mtext>&#x000a0;&#x000a0;&#x000a0;&#x000a0;</mml:mtext><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003f5;</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003f5;</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E51">
<mml:math id="M75" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003b3;</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><p>For the newly constructed quasi-steady state system, the design of the inertia matrix <italic>K</italic><sub>&#x003c4;</sub> is closely related to the control gain matrix. We can dynamically configure the inertia distribution coefficient of the motor rotor by adjusting this parameter. This not only enhances the system resistance to external disturbances but also optimizes the response speed and stability of the control loop.</p><p>For the modified boundary layer system, the control input for the fast subsystem part is in the form of <xref rid="E52" ref-type="disp-formula">Equation 44</xref>.</p><disp-formula id="E52">
<label>(44)</label>
<mml:math id="M76" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mtext class="textrm" mathvariant="normal">fast</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x000af;</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mo>-</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mover accent="true"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E53">
<label>(45)</label>
<mml:math id="M77" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>d</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula><disp-formula id="E54">
<mml:math id="M78" overflow="scroll"><mml:mtable class="eqnarray" columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mi>M</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003b3;</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math>
</disp-formula></sec></sec><sec id="s4"><title>4 Experiment</title><sec><title>4.1 Kinematics and trajectory planning</title><p>The kinematic experiment uses cylindrical helices and conical helices to verify the kinematic trajectories. The parametric equation for a cylindrical helix can be expressed as <xref rid="E55" ref-type="disp-formula">Equation 46</xref>.</p><disp-formula id="E55">
<label>(46)</label>
<mml:math id="M79" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>sin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p>Here, <italic>t</italic> is the parameter, <italic>R</italic> is the radius of the helix, and <italic>c</italic> is the pitch constant, which represents the distance the helix moves in the <italic>z</italic> direction for each complete turn.</p><p>The parametric equation for a conical helix can be expressed as <xref rid="E56" ref-type="disp-formula">Equation 47</xref>.</p><disp-formula id="E56">
<label>(47)</label>
<mml:math id="M80" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>y</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>sin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mtext>&#x000a0;</mml:mtext><mml:mo>&#x000b7;</mml:mo><mml:mtext>&#x000a0;</mml:mtext><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
</disp-formula><p>Here, <italic>R</italic><sub>0</sub> is the initial radius of the helix, <italic>k</italic> is the pheasant rate of change and <italic>c</italic> is the pitch constant.</p><p>As shown in <xref rid="F3" ref-type="fig">Figure 3</xref>, by comparing the original end effector trajectory with the trajectory obtained from the forward kinematics calculations, the results indicate a high degree of consistency between the two. This not only verifies the correctness of the inverse and forward solution algorithms but also further demonstrates the accuracy and reliability of the robot kinematic model in design and practical applications.</p><fig position="float" id="F3"><label>Figure 3</label><caption><p>Cylindrical helix and conical helix.</p></caption><graphic xlink:href="fnbot-19-1562519-g0003" position="float"/></fig><p><xref rid="F4" ref-type="fig">Figure 4</xref> clearly illustrates the trajectory constraints of S-curve trajectory planning within a specified time frame and how to accurately generate trajectories that comply with preset acceleration limits, thereby validating the correctness of this planning method. The main advantage of trajectory planning in joint space is the direct control of the robotic joint movements. Compared to trajectory planning in operational space, this approach significantly enhances operational flexibility and accuracy. Furthermore, this method effectively avoids potential issues arising from motion singularities and operational complexities, thereby enhancing the robustness of the system.</p><fig position="float" id="F4"><label>Figure 4</label><caption><p>S-type trajectory planning.</p></caption><graphic xlink:href="fnbot-19-1562519-g0004" position="float"/></fig><p>In this paper, the torque value obtained by the complete dynamic model is converted into the acceleration value, and the acceleration value is further applied as a limiting factor in trajectory planning to obtain the optimal trajectory control of the lower limb rehabilitation robot. As shown in <xref rid="F5" ref-type="fig">Figure 5</xref>, the horizontal coordinate is the time, and the vertical coordinate is the TCP end position of the vacuum manipulator. Red is the general planning curve, and blue is the optimal trajectory curve. When the end position is from 0 to &#x02212;80 and then to 90, the robot's time is obtained from the acceleration calculated by the dynamics, and the planning time becomes significantly faster.</p><fig position="float" id="F5"><label>Figure 5</label><caption><p>Optimal trajectory control end position time.</p></caption><graphic xlink:href="fnbot-19-1562519-g0005" position="float"/></fig><p>The acceleration calculated by the dynamics is applied to the S-type trajectory planning, and the optimal trajectory control of the acceleration of the S-type trajectory is performed indirectly according to the acceleration solved by the dynamics to achieve the corresponding optimal. Comparing the running time with the ordinary planning time, optimal S-type planning performs quickly. Optimal S-type planning typically requires that servo drives use position control, which enhances the speed and current response of the motor, thereby improving the effectiveness of position control.</p></sec><sec><title>4.2 Zero-force control based on friction model</title><p>Zero force control is a compliant control strategy that aims to ensure that the force between the system and the environment remains at zero level. The LuGre friction parameters are identified and optimized, and the theoretical driving torque is solved against the collected actual torque, as shown in <xref rid="F6" ref-type="fig">Figure 6</xref>. The blue curve represents the real friction moment curve, while the red curve is the moment curve of the LuGre friction model proposed in this paper. The deviation of actual friction and LuGre friction is calculated to be about 5 Nm. The results verify that the whole dynamic algorithm with The LuGre friction can effectively solve zero-force control.</p><fig position="float" id="F6"><label>Figure 6</label><caption><p>Comparison of actual torque and theoretical torque on zero-load control.</p></caption><graphic xlink:href="fnbot-19-1562519-g0006" position="float"/></fig><p>To intuitively and scientifically validate the effectiveness of the dynamic algorithm, this study utilized a flexible lower-limb rehabilitation robotic experimental platform to demonstrate a zero-load control algorithm. As shown in <xref rid="F7" ref-type="fig">Figure 7</xref>, this approach enabled high-precision control of the end effector force in the robot, achieving effective force feedback management.</p><fig position="float" id="F7"><label>Figure 7</label><caption><p>Zero-load control of flexible lower limb rehabilitation robot.</p></caption><graphic xlink:href="fnbot-19-1562519-g0007" position="float"/></fig><p>Implementing the zero-load control algorithm on the experimental platform signifies that the robot can more accurately simulate the natural movement patterns of the human body while performing rehabilitation training tasks. This reduces unnecessary mechanical resistance and discomfort, enhancing patient rehabilitation experience and therapeutic outcomes. Such advancements have profound implications for improving rehabilitation efficiency, shortening recovery periods, and reducing overall rehabilitation costs.</p></sec><sec><title>4.3 Singular perturbation</title><p>To validate the effectiveness of the designed control method, we compared the PD control strategy with a PD-based composite control strategy that integrates singular perturbation theory. The core of the experiment involved quantitatively analyzing the system performance under both control architectures, focusing on key metrics such as system tracking error, velocity response curves, and velocity error. <xref rid="F8" ref-type="fig">Figures 8</xref>, <xref rid="F9" ref-type="fig">9</xref> visually demonstrate the system dynamic behavior using classical PD control, providing a benchmark for subsequent comparison with PD control combined with singular perturbation theory. In figures, the Tracking difference on the <italic>Y</italic>-axis represents the actual code drive value minus the planned code drive value, and its units can be expressed in PPR (Pulse Per Revolution).</p><fig position="float" id="F8"><label>Figure 8</label><caption><p>Tracking error of PD control.</p></caption><graphic xlink:href="fnbot-19-1562519-g0008" position="float"/></fig><fig position="float" id="F9"><label>Figure 9</label><caption><p>Command velocity vs. actual velocity with PD control.</p></caption><graphic xlink:href="fnbot-19-1562519-g0009" position="float"/></fig><p>The system data curves for the PD combined with singular perturbation control are presented in <xref rid="F10" ref-type="fig">Figures 10</xref>, <xref rid="F11" ref-type="fig">11</xref>.</p><fig position="float" id="F10"><label>Figure 10</label><caption><p>Tracking error of PD + singular perturbation control.</p></caption><graphic xlink:href="fnbot-19-1562519-g0010" position="float"/></fig><fig position="float" id="F11"><label>Figure 11</label><caption><p>Command velocity vs. actual velocity with PD control + singular perturbation.</p></caption><graphic xlink:href="fnbot-19-1562519-g0011" position="float"/></fig><p>The comparison curves (<xref rid="F12" ref-type="fig">Figure 12</xref>) indicate that a singular perturbation controller significantly enhances system tracking performance, reducing the tracking error by about one-third compared to using only a PD controller. As a critical step in evaluating the controller performance, experimental validation, through comparative data, demonstrates that the PD with singular perturbation control effectively reduces system tracking errors, ensuring more accurate trajectory tracking.</p><fig position="float" id="F12"><label>Figure 12</label><caption><p>Compared curves of the two methods.</p></caption><graphic xlink:href="fnbot-19-1562519-g0012" position="float"/></fig><p>From <xref rid="T2" ref-type="table">Table 2</xref>, we can intuitively observe the advantages and disadvantages of the two control methods. The PD control excels in its simplicity and low computational cost, making it suitable for real-time applications in rigid systems. However, it struggles with multi-time-scale dynamics and external disturbances, leading to larger tracking errors and slower response times. In contrast, the PD + Singular Control (PD+SC) significantly improves response speed, tracking accuracy, and system robustness by effectively handling multi-time-scale dynamics. Nevertheless, it comes with increased complexity in controller design, higher computational demands, and potential errors due to model simplification. This comparison highlights the trade-offs between simplicity and performance in control system design.</p><table-wrap position="float" id="T2"><label>Table 2</label><caption><p>Compared methods.</p></caption><table frame="box" rules="all"><thead><tr style="background-color:#8f9496;color:#ffffff"><th valign="top" align="left" rowspan="1" colspan="1">
<bold>Method</bold>
</th><th valign="top" align="left" rowspan="1" colspan="1">
<bold>Advantages</bold>
</th><th valign="top" align="left" rowspan="1" colspan="1">
<bold>Limitations</bold>
</th></tr></thead><tbody><tr><td valign="top" align="left" rowspan="1" colspan="1">PD</td><td valign="top" align="left" rowspan="1" colspan="1">1. Simple structure</td><td valign="top" align="left" rowspan="1" colspan="1">1. Limited effectiveness in multi-time-scale systems</td></tr><tr><td rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1">2. Low computational cost</td><td valign="top" align="left" rowspan="1" colspan="1">2. Difficulty in handling high-frequency dynamics</td></tr><tr><td rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1">3. Performs well in rigid systems</td><td valign="top" align="left" rowspan="1" colspan="1">3. Larger tracking errors and slower response speed</td></tr><tr><td valign="top" align="left" rowspan="1" colspan="1">PD+SC</td><td valign="top" align="left" rowspan="1" colspan="1">1. Improves response</td><td valign="top" align="left" rowspan="1" colspan="1">1. Complex controller design</td></tr><tr><td rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1">2. Effectively handles multi-time-scale dynamics</td><td valign="top" align="left" rowspan="1" colspan="1">2. Higher computational cost</td></tr><tr><td rowspan="1" colspan="1"/><td valign="top" align="left" rowspan="1" colspan="1">3. Enhances system robustness</td><td rowspan="1" colspan="1"/></tr></tbody></table></table-wrap><p>The improvement in tracking error has significant practical implications for patient rehabilitation. By reducing tracking errors, the robot can more precisely follow the patient's movement intentions, minimizing unnecessary mechanical resistance or sudden adjustments. This enhanced precision makes the rehabilitation training feel more natural and comfortable for patients, reducing discomfort caused by inaccurate robot movements. Additionally, smaller tracking errors enable the robot to respond more accurately to the patient's actions during training, enhancing safety by preventing accidents due to control delays or errors. For example, if a patient suddenly stops or changes direction, the robot can adjust quickly and accurately, lowering the risk of injury. Furthermore, precise motion control allows patients to engage in more effective rehabilitation training. By providing consistent and accurate assistance, the robot helps patients better restore their motor functions, potentially accelerating the recovery process and shortening rehabilitation time. The experimental results allow for further adjustments and optimization of the control parameters to achieve the best control outcomes. This validates the theoretical design's correctness and provides valuable experience and data support for future engineering applications.</p></sec></sec><sec id="s5"><title>5 Conclusion</title><p>This paper focuses on developing a flexible lower limb rehabilitation robot, with an in-depth exploration of the construction process for motion control and singular perturbation algorithms. The classical DH method was employed to ensure the accuracy and practicality of the models. The study demonstrates a dynamic zero-load control algorithm to utilize a flexible lower-limb rehabilitation robotic. Take the friction term into the traditional dynamic equation and use the LuGre friction model for friction analysis to realize zero-force control. This approach enabled high-precision control of the end effector force in the robot, achieving effective force feedback management. In this paper, an optimal S-type planning with limited acceleration is proposed, and a complete algorithm for all possible trajectory shapes under various constraints is given. The trajectory planning algorithm proposed in this paper is more consistent with the actual motion performance of the robot. The limitations of traditional singular perturbation control methods in flexible joint robots were anal in control strategize. The rehabilitation robot employing the improved singular perturbation control strategy can rapidly respond to and adjust the applied external forces when the patient actively participates in training, significantly reducing the discomfort and stress risks perceived by the patient. This technology demonstrates significant control accuracy, system response speed, and operational safety advantages.</p><p>Looking ahead, we plan to expand further and optimize the findings of this research, including but not limited to improving the accuracy of the dynamic models, optimizing the efficiency of the control algorithms, and enhancing the robustness and adaptability of the system. Additionally, we will actively explore the application potential of this technology in other rehabilitation robot fields, such as upper limb and spinal rehabilitation, to benefit more patients in need of rehabilitation support.</p></sec></body><back><sec sec-type="data-availability" id="s6"><title>Data availability statement</title><p>The raw data supporting the conclusions of this article will be made available by the authors, without undue reservation.</p></sec><sec sec-type="author-contributions" id="s7"><title>Author contributions</title><p>YX: Writing &#x02013; original draft. AW: Writing &#x02013; original draft. XZ: Writing &#x02013; review &#x00026; editing. YJ: Writing &#x02013; original draft. YW: Writing &#x02013; original draft. HY: Writing &#x02013; original draft.</p></sec><sec sec-type="COI-statement" id="conf1"><title>Conflict of interest</title><p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p></sec><sec id="s9"><title>Generative AI statement</title><p>The author(s) declare that no Gen AI was used in the creation of this manuscript.</p></sec><sec sec-type="disclaimer" id="s10"><title>Publisher's note</title><p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p></sec><ref-list><title>References</title><ref id="B1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Amersdorfer</surname><given-names>M.</given-names></name><name><surname>Meurer</surname><given-names>T.</given-names></name></person-group> (<year>2022</year>). <article-title>Equidistant tool path and cartesian trajectory planning for robotic machining of curved freeform surfaces</article-title>. <source>IEEE Trans. Automat. Sci. Eng.</source>
<volume>19</volume>, <fpage>3311</fpage>&#x02013;<lpage>3323</lpage>. <pub-id pub-id-type="doi">10.1109/TASE.2021.3117691</pub-id></mixed-citation></ref><ref id="B2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bhardwaj</surname><given-names>S.</given-names></name><name><surname>Khan</surname><given-names>A. A.</given-names></name><name><surname>Muzammil</surname><given-names>M.</given-names></name></person-group> (<year>2021</year>). <article-title>Lower limb rehabilitation robotics: the current understanding and technology</article-title>. <source>Work</source>
<volume>69</volume>, <fpage>775</fpage>&#x02013;<lpage>793</lpage>. <pub-id pub-id-type="doi">10.3233/WOR-205012</pub-id><pub-id pub-id-type="pmid">34180443</pub-id>
</mixed-citation></ref><ref id="B3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>Y.</given-names></name><name><surname>Chen</surname><given-names>X.</given-names></name><name><surname>Zhang</surname><given-names>M.</given-names></name><name><surname>Huang</surname><given-names>J.</given-names></name></person-group> (<year>2023</year>). <article-title>Adaptive position constrained assist-as-needed control for rehabilitation robots</article-title>. <source>IEEE Trans. Indus. Electron.</source>
<volume>71</volume>, <fpage>4059</fpage>&#x02013;<lpage>4068</lpage>. <pub-id pub-id-type="doi">10.1109/TIE.2023.3273270</pub-id></mixed-citation></ref><ref id="B4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dhanaraj</surname><given-names>N.</given-names></name><name><surname>Yoon</surname><given-names>Y. J.</given-names></name><name><surname>Malhan</surname><given-names>R.</given-names></name><name><surname>Bhatt</surname><given-names>P. M.</given-names></name><name><surname>Thakar</surname><given-names>S.</given-names></name><name><surname>Gupta</surname><given-names>S. K.</given-names></name></person-group> (<year>2022</year>). <article-title>A mobile manipulator system for accurate and efficient spraying on large surfaces</article-title>. <source>Proc. Comput. Sci.</source>
<volume>200</volume>, <fpage>1528</fpage>&#x02013;<lpage>1539</lpage>. <pub-id pub-id-type="doi">10.1016/j.procs.2022.01.354</pub-id></mixed-citation></ref><ref id="B5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>From</surname><given-names>P. J.</given-names></name><name><surname>Gunnar</surname><given-names>J.</given-names></name><name><surname>Gravdahl</surname><given-names>J. T.</given-names></name></person-group> (<year>2010</year>). <article-title>Optimal paint gun orientation in spray paint applications&#x02014;experimental results</article-title>. <source>IEEE Trans. Automat. Sci. Eng.</source>
<volume>8</volume>, <fpage>438</fpage>&#x02013;<lpage>442</lpage>. <pub-id pub-id-type="doi">10.1109/TASE.2010.2089450</pub-id></mixed-citation></ref><ref id="B6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gao</surname><given-names>R.</given-names></name></person-group> (<year>2020</year>). <article-title>Inverse kinematics solution of Robotics based on neural network algorithms</article-title>. <source>J. Ambient Intell. Human. Comput.</source>
<volume>11</volume>, <fpage>6199</fpage>&#x02013;<lpage>6209</lpage>. <pub-id pub-id-type="doi">10.1007/s12652-020-01815-4</pub-id></mixed-citation></ref><ref id="B7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Iskandar</surname><given-names>M.</given-names></name><name><surname>van Ommeren</surname><given-names>C.</given-names></name><name><surname>Wu</surname><given-names>X.</given-names></name><name><surname>Albu-Sch&#x000e4;ffer</surname><given-names>A.</given-names></name><name><surname>Dietrich</surname><given-names>A.</given-names></name></person-group> (<year>2022</year>). <article-title>Model predictive control applied to different time-scale dynamics of flexible joint robots</article-title>. <source>IEEE Robot. Automat. Lett.</source>
<volume>8</volume>, <fpage>672</fpage>&#x02013;<lpage>679</lpage>. <pub-id pub-id-type="doi">10.1109/LRA.2022.3229226</pub-id></mixed-citation></ref><ref id="B8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jiang</surname><given-names>Y.</given-names></name><name><surname>Yu</surname><given-names>Y.</given-names></name><name><surname>Zhang</surname><given-names>H. Y.</given-names></name><name><surname>Sun</surname><given-names>D. K.</given-names></name><name><surname>Li</surname><given-names>Z. H.</given-names></name></person-group> (<year>2023</year>). <article-title>Research on application of compliant control of smart meter box handling robot</article-title>. <source>Energy Rep.</source>
<volume>9</volume>, <fpage>1494</fpage>&#x02013;<lpage>1501</lpage>
<pub-id pub-id-type="doi">10.1016/j.egyr.2023.06.050</pub-id></mixed-citation></ref><ref id="B9"><mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Kevorkian</surname><given-names>J.</given-names></name><name><surname>Cole</surname><given-names>J. D.</given-names></name></person-group> (<year>2012</year>). <source>Multiple Scale and Singular Perturbation Methods</source>, <volume>Vol. 114</volume>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer Science &#x00026; Business Media</publisher-name>.</mixed-citation></ref><ref id="B10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Khan</surname><given-names>R. F. A.</given-names></name><name><surname>Rsetam</surname><given-names>K.</given-names></name><name><surname>Cao</surname><given-names>Z.</given-names></name><name><surname>Man</surname><given-names>Z.</given-names></name></person-group> (<year>2022</year>). <article-title>Singular perturbation-based adaptive integral sliding mode control for flexible joint robots</article-title>. <source>IEEE Trans. Indus. Electron.</source>
<volume>70</volume>, <fpage>10516</fpage>&#x02013;<lpage>10525</lpage>. <pub-id pub-id-type="doi">10.1109/TIE.2022.3222684</pub-id></mixed-citation></ref><ref id="B11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>K.</given-names></name><name><surname>Wang</surname><given-names>H.</given-names></name><name><surname>Liang</surname><given-names>X.</given-names></name><name><surname>Miao</surname><given-names>Y.</given-names></name></person-group> (<year>2021</year>). <article-title>Visual servoing of flexible-link manipulators by considering vibration suppression without deformation measurements</article-title>. <source>IEEE Trans. Cybernet.</source>
<volume>52</volume>, <fpage>12454</fpage>&#x02013;<lpage>12463</lpage>. <pub-id pub-id-type="doi">10.1109/TCYB.2021.3072779</pub-id><pub-id pub-id-type="pmid">34043522</pub-id>
</mixed-citation></ref><ref id="B12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pana</surname><given-names>C. F.</given-names></name><name><surname>Popescu</surname><given-names>D.</given-names></name><name><surname>Radulescu</surname><given-names>V. M.</given-names></name></person-group> (<year>2023</year>). <article-title>Patent review of lower limb rehabilitation robotic systems by sensors and actuation systems used</article-title>. <source>Sensors</source>
<volume>23</volume>:<fpage>6237</fpage>. <pub-id pub-id-type="doi">10.3390/s23136237</pub-id><pub-id pub-id-type="pmid">37448084</pub-id>
</mixed-citation></ref><ref id="B13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qassim</surname><given-names>H. M.</given-names></name><name><surname>Wan Hasan</surname><given-names>W. Z.</given-names></name></person-group> (<year>2020</year>). <article-title>A review on upper limb rehabilitation robots</article-title>. <source>Appl. Sci.</source>
<volume>10</volume>:<fpage>6976</fpage>. <pub-id pub-id-type="doi">10.3390/app10196976</pub-id></mixed-citation></ref><ref id="B14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Z.</given-names></name><name><surname>Li</surname><given-names>Y.</given-names></name><name><surname>Sun</surname><given-names>P.</given-names></name><name><surname>Luo</surname><given-names>Y.</given-names></name><name><surname>Chen</surname><given-names>B.</given-names></name><name><surname>Zhu</surname><given-names>W.</given-names></name></person-group> (<year>2021</year>). <article-title>A multi-objective approach for the trajectory planning of a 7-DOF serial-parallel hybrid humanoid arm</article-title>. <source>Mechanism Machine Theory</source>
<volume>165</volume>:<fpage>104423</fpage>. <pub-id pub-id-type="doi">10.1016/j.mechmachtheory.2021.104423</pub-id></mixed-citation></ref><ref id="B15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weingartshofer</surname><given-names>T.</given-names></name><name><surname>Hartl-Nesic</surname><given-names>C.</given-names></name><name><surname>Kugi</surname><given-names>A.</given-names></name></person-group> (<year>2023</year>). <article-title>Automatic and flexible robotic drawing on complex surfaces with an industrial robot</article-title>. <source>IEEE Trans. Control Syst. Technol.</source>
<volume>32</volume>, <fpage>1602</fpage>&#x02013;<lpage>1615</lpage>. <pub-id pub-id-type="doi">10.1109/TCST.2023.3345209</pub-id></mixed-citation></ref><ref id="B16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yu</surname><given-names>X. Y.</given-names></name><name><surname>Chen</surname><given-names>L.</given-names></name></person-group> (<year>2015</year>). <article-title>Modeling and observer-based augmented adaptive control of flexible-joint free-floating space manipulators</article-title>. <source>Acta Astronaut.</source>
<volume>108</volume>, <fpage>146</fpage>&#x02013;<lpage>155</lpage>. <pub-id pub-id-type="doi">10.1016/j.actaastro.2014.12.002</pub-id></mixed-citation></ref><ref id="B17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X.</given-names></name><name><surname>Rong</surname><given-names>X.</given-names></name><name><surname>Luo</surname><given-names>H.</given-names></name></person-group> (<year>2024</year>). <article-title>Optimizing lower limb rehabilitation: the intersection of machine learning and rehabilitative robotics</article-title>. <source>Front. Rehabil. Sci.</source>
<volume>5</volume>:<fpage>1246773</fpage>. <pub-id pub-id-type="doi">10.3389/fresc.2024.1246773</pub-id><pub-id pub-id-type="pmid">38343790</pub-id>
</mixed-citation></ref><ref id="B18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zheng</surname><given-names>K.</given-names></name><name><surname>Zhang</surname><given-names>Q.</given-names></name><name><surname>Zeng</surname><given-names>S.</given-names></name></person-group> (<year>2022</year>). <article-title>Trajectory control and vibration suppression of rigid-flexible parallel robot based on singular perturbation method</article-title>. <source>Asian J. Control</source>
<volume>24</volume>, <fpage>3006</fpage>&#x02013;<lpage>3021</lpage>. <pub-id pub-id-type="doi">10.1002/asjc.2729</pub-id></mixed-citation></ref></ref-list></back></article>