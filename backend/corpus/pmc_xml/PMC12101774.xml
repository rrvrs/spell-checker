<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="en" article-type="research-article"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="iso-abbrev">PLoS Comput Biol</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-title-group><journal-title>PLOS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmid">40327728</article-id><article-id pub-id-type="pmc">PMC12101774</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1012970</article-id><article-id pub-id-type="publisher-id">PCOMPBIOL-D-24-01244</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Evolutionary Biology</subject><subj-group><subject>Population Genetics</subject><subj-group><subject>Effective Population Size</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population Genetics</subject><subj-group><subject>Effective Population Size</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Population Biology</subject><subj-group><subject>Population Genetics</subject><subj-group><subject>Effective Population Size</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Population Biology</subject><subj-group><subject>Population Metrics</subject><subj-group><subject>Effective Population Size</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Population Biology</subject><subj-group><subject>Population Metrics</subject><subj-group><subject>Population Size</subject><subj-group><subject>Effective Population Size</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Simulation and Modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Evolutionary Biology</subject><subj-group><subject>Population Genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Population Genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and Life Sciences</subject><subj-group><subject>Population Biology</subject><subj-group><subject>Population Genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>People and places</subject><subj-group><subject>Geographical locations</subject><subj-group><subject>North America</subject><subj-group><subject>United States</subject><subj-group><subject>Washington</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Viruses</subject><subj-group><subject>RNA viruses</subject><subj-group><subject>Coronaviruses</subject><subj-group><subject>SARS coronavirus</subject><subj-group><subject>SARS CoV 2</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subj-group><subject>Microbial pathogens</subject><subj-group><subject>Viral pathogens</subject><subj-group><subject>Coronaviruses</subject><subj-group><subject>SARS coronavirus</subject><subj-group><subject>SARS CoV 2</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pathology and laboratory medicine</subject><subj-group><subject>Pathogens</subject><subj-group><subject>Microbial pathogens</subject><subj-group><subject>Viral pathogens</subject><subj-group><subject>Coronaviruses</subject><subj-group><subject>SARS coronavirus</subject><subj-group><subject>SARS CoV 2</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Viruses</subject><subj-group><subject>Viral pathogens</subject><subj-group><subject>Coronaviruses</subject><subj-group><subject>SARS coronavirus</subject><subj-group><subject>SARS CoV 2</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and Health Sciences</subject><subj-group><subject>Medical Conditions</subject><subj-group><subject>Infectious Diseases</subject><subj-group><subject>Viral Diseases</subject><subj-group><subject>Covid 19</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Database and Informatics Methods</subject><subj-group><subject>Biological Databases</subject><subj-group><subject>Sequence Databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Database and Informatics Methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence Analysis</subject><subj-group><subject>Sequence Databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Database and Informatics Methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence Analysis</subject><subj-group><subject>Sequence Alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Accounting for reporting delays in real-time phylodynamic analyses with preferential sampling</article-title><alt-title alt-title-type="running-head">Reporting delays in real-time phylodynamic analyses with preferential sampling</alt-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Medina</surname><given-names>Catalina M.</given-names></name><role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role><role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role><role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role><role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role><role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role><role content-type="http://credit.niso.org/contributor-roles/software/">Software</role><role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role><role content-type="http://credit.niso.org/contributor-roles/visualization/">Visualization</role><role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing &#x02013; original draft</role><role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing &#x02013; review &#x00026; editing</role><xref rid="aff001" ref-type="aff">
<sup>1</sup>
</xref></contrib><contrib contrib-type="author"><name><surname>Palacios</surname><given-names>Julia A.</given-names></name><role content-type="http://credit.niso.org/contributor-roles/data-curation/">Data curation</role><role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role><role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role><role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing &#x02013; review &#x00026; editing</role><xref rid="aff002" ref-type="aff">
<sup>2</sup>
</xref></contrib><contrib contrib-type="author" corresp="yes"><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1917-9288</contrib-id><name><surname>Minin</surname><given-names>Volodymyr M.</given-names></name><role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role><role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role><role content-type="http://credit.niso.org/contributor-roles/funding-acquisition/">Funding acquisition</role><role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role><role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role><role content-type="http://credit.niso.org/contributor-roles/project-administration/">Project administration</role><role content-type="http://credit.niso.org/contributor-roles/supervision/">Supervision</role><role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing &#x02013; original draft</role><role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing &#x02013; review &#x00026; editing</role><xref rid="aff001" ref-type="aff">
<sup>1</sup>
</xref><xref rid="cor001" ref-type="corresp">*</xref></contrib></contrib-group><aff id="aff001"><label>1</label>
<addr-line>Department of Statistics, University of California, Irvine, Irvine, California, United States of America</addr-line></aff><aff id="aff002"><label>2</label>
<addr-line>Departments of Statistics and Biomedical Data Science, Stanford University, Stanford, California, United States of America</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Barido-Sottani</surname><given-names>Jo&#x000eb;lle</given-names></name><role>Editor</role><xref rid="edit1" ref-type="aff"/></contrib></contrib-group><aff id="edit1">
<addr-line>Ecole Normale Superieure, FRANCE</addr-line>
</aff><author-notes><fn fn-type="COI-statement" id="coi001"><p>The authors have declared that no competing interests exist.</p></fn><corresp id="cor001">* E-mail: <email>vminin@uci.edu</email></corresp></author-notes><pub-date pub-type="epub"><day>6</day><month>5</month><year>2025</year></pub-date><pub-date pub-type="collection"><month>5</month><year>2025</year></pub-date><volume>21</volume><issue>5</issue><elocation-id>e1012970</elocation-id><history><date date-type="received"><day>24</day><month>7</month><year>2024</year></date><date date-type="accepted"><day>17</day><month>3</month><year>2025</year></date></history><permissions><copyright-statement>&#x000a9; 2025 Medina et al</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Medina et al</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pcbi.1012970.pdf"/><abstract><p>The COVID-19 pandemic demonstrated that fast and accurate analysis of continually collected infectious disease surveillance data is crucial for situational awareness and policy making. Coalescent-based phylodynamic analysis can use genetic sequences of a pathogen to estimate changes in its effective population size, a measure of genetic diversity. These changes in effective population size can be connected to the changes in the number of infections in the population of interest under certain conditions. Phylodynamics is an important set of tools because its methods are often resilient to the ascertainment biases present in traditional surveillance data (e.g., preferentially testing symptomatic individuals). Unfortunately, it takes weeks or months to sequence and deposit the sampled pathogen genetic sequences into a database, making them available for such analyses. These reporting delays severely decrease precision of phylodynamic methods closer to present time, and for some models can lead to extreme biases. Here we present a method that affords reliable estimation of the effective population size trajectory closer to the time of data collection, allowing for policy decisions to be based on more recent data. Our work uses readily available historic times between sampling and reporting of sequenced samples for a population of interest, and incorporates this information into the sampling model to mitigate the effects of reporting delay in real-time analyses. We illustrate our methodology on simulated data and on SARS-CoV-2 sequences collected in the state of Washington in 2021.</p></abstract><abstract abstract-type="summary"><title>Author summary</title><p>Estimating the number of individuals infected by a given virus is key for informing dynamic health policy, but it is also a nontrivial task. Reported case data often suffers from sampling biases, preventing accurate inference for a population of interest. Pathogen genetic data provide an alternative data source that can be used in phylodynamic analyses that are more robust to sampling biases. Unfortunately, the time between when a sample is collected and when it is sequenced and available for analysis, which we refer to as the reporting delay, results in unobserved samples near present time for real-time analyses. Missing data can be particularly problematic in methods that model the relationship between the number of samples collected over time and the number of infections. Specifically, the concern for those models is that fewer reported samples near present time would result in lower estimates of the true disease prevalence. We propose a model that incorporates information about recent reporting delays to account for missing samples near present time due to having not been reported by the time of analysis. Using simulated data and SARS-CoV-2 sequences from the state of Washington in 2021, we show that our new method ourperforms state-of-the-art methods.</p></abstract><funding-group><award-group id="award001"><funding-source><institution>UC Irvine Investing to Develop Center-Scale Multidisciplinary Convergence Research Programs Seed Funding</institution>
</funding-source><principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1917-9288</contrib-id>
<name><surname>Minin</surname><given-names>Volodymyr M.</given-names></name>
</principal-award-recipient></award-group><award-group id="award002"><funding-source><institution>UC CDPH Modeling Consortium</institution>
</funding-source><principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-1917-9288</contrib-id>
<name><surname>Minin</surname><given-names>Volodymyr M.</given-names></name>
</principal-award-recipient></award-group><award-group id="award003"><funding-source><institution>NSF</institution>
</funding-source><award-id>DMS-2143242</award-id><principal-award-recipient>
<name><surname>Palacios</surname><given-names>Julia A.</given-names></name>
</principal-award-recipient></award-group><award-group id="award004"><funding-source><institution>NIH</institution>
</funding-source><award-id>R35GM14833801</award-id><principal-award-recipient>
<name><surname>Palacios</surname><given-names>Julia A.</given-names></name>
</principal-award-recipient></award-group><funding-statement>V.M.M. was in part funded by the UC Irvine Investing to Develop Center-Scale Multidisciplinary Convergence Research Programs Seed Funding Award and by the UC CDPH Modeling Consortium. J.A.P. acknowledges support from NSF grant DMS-2143242, NIH grant R35GM14833801. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><fig-count count="6"/><table-count count="0"/><page-count count="18"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>All data and code to reproduce the results in this paper can be found at <ext-link xlink:href="https://github.com/CatalinaMedina/reporting-delays-in-phylodynamics-paper" ext-link-type="uri">https://github.com/CatalinaMedina/reporting-delays-in-phylodynamics-paper</ext-link>.</meta-value></custom-meta><custom-meta><meta-name>PLOS Publication Stage</meta-name><meta-value>vor-update-to-uncorrected-proof</meta-value></custom-meta><custom-meta><meta-name>Publication Update</meta-name><meta-value>2025-05-23</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>All data and code to reproduce the results in this paper can be found at <ext-link xlink:href="https://github.com/CatalinaMedina/reporting-delays-in-phylodynamics-paper" ext-link-type="uri">https://github.com/CatalinaMedina/reporting-delays-in-phylodynamics-paper</ext-link>.</p></notes></front><body><sec sec-type="intro" id="sec001"><title>1. Introduction</title><p>The COVID-19 pandemic demonstrated that fast and accurate analysis of continually collected infectious disease surveillance data is crucial for situational awareness and policy making [<xref rid="pcbi.1012970.ref001" ref-type="bibr">1</xref>, <xref rid="pcbi.1012970.ref002" ref-type="bibr">2</xref>]. Phylodynamic methods form an important set of tools that use genetic sequences of a pathogen of interest to infer its phylogeny and parameters of disease dynamics, such as the effective population size. The effective population size is a measure of genetic diversity, and estimation of effective population size is often of interest because under certain conditions this quantity can be connected to the number of infections in the population [<xref rid="pcbi.1012970.ref003" ref-type="bibr">3</xref>] or in some cases more directly to transmission [<xref rid="pcbi.1012970.ref004" ref-type="bibr">4</xref>]. Inference of the effective population size can also be useful to compare the growth of different viral lineages [<xref rid="pcbi.1012970.ref005" ref-type="bibr">5</xref>, <xref rid="pcbi.1012970.ref006" ref-type="bibr">6</xref>], as one part of an argument for the effectiveness of an intervention [<xref rid="pcbi.1012970.ref007" ref-type="bibr">7</xref>], and ultimately, for informed health policy decisions [<xref rid="pcbi.1012970.ref008" ref-type="bibr">8</xref>].</p><p>The COVID-19 pandemic resulted in a massive push towards sharing sampled pathogenic sequences in public databases such as: GISAID (<ext-link xlink:href="http://www.gisaid.org/www.gisaid.org" ext-link-type="uri">http://www.gisaid.org/www.gisaid.org</ext-link>), NCBI (<ext-link xlink:href="http://www.ncbi.nlm.nih.gov/www.ncbi.nlm.nih.gov" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/www.ncbi.nlm.nih.gov</ext-link>), and ViPR (<ext-link xlink:href="http://www.viprbrc.org/www.viprbrc.org" ext-link-type="uri">http://www.viprbrc.org/www.viprbrc.org</ext-link>). Unfortunately, collected samples can take weeks or even months to sequence, upload to a database, and become available for analysis [<xref rid="pcbi.1012970.ref009" ref-type="bibr">9</xref>]. We refer to this time between sample collection and sequence reporting as the <italic toggle="yes">reporting delay</italic> for a sample. Reporting delays result in missing data near present time since recently collected samples are less likely to have been sequenced and uploaded yet. During the COVID-19 pandemic, reporting delays were a novel and important consideration to most, with the emerging need for real-time analysis, i.e., analysis conducted up to present time [<xref rid="pcbi.1012970.ref009" ref-type="bibr">9</xref>]. The distribution of delays can be location, time, and even lineage specific [<xref rid="pcbi.1012970.ref010" ref-type="bibr">10</xref>], influenced by factors such as sequencing cost and laboratory limited capacity. Researchers who had considered reporting delays for surveillance data in real-time analyses, were limited to methods that utilized only aggregated level reporting delay information [<xref rid="pcbi.1012970.ref011" ref-type="bibr">11</xref>]. The shared public databases of pathogenic sequences provide a new opportunity to utilize detailed sequence-level data of reporting delays.</p><p>Modern methods to estimate effective population size changes from genetic data have evolved from the original coalescent skyline plot where the effective population size trajectory, <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>), was modeled nonparametrically as piecewise constant [<xref rid="pcbi.1012970.ref012" ref-type="bibr">12</xref>], to grouping methods that resulted in smoother estimates [<xref rid="pcbi.1012970.ref013" ref-type="bibr">13</xref>], to the first Bayesian coalescent skyline plot model [<xref rid="pcbi.1012970.ref014" ref-type="bibr">14</xref>] which jointly inferred a pathogen&#x02019;s evolutionary tree and <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>). Several advancements on the Bayesian coalescent skyline plot models have been proposed in recent years which consider different interval specifications for the piecewise <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) or regularization methods for <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>). See Ho and Shapiro (2011) and Billenstein and H&#x000f6;hna (2024) for a detailed comparison of Bayesian nonparametric inference of <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) methods [<xref rid="pcbi.1012970.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1012970.ref016" ref-type="bibr">16</xref>]. When pathogen samples are being continually collected over time it is often the case that the frequency at which samples are collected is related to the burden of the infection in the population. This is known as preferential sampling, and Karcher <italic toggle="yes">et al</italic>. (2016) proposed a phylodynamic model that built on Bayesian coalescent skyline plot models to relate the sampling intensity to the effective population size [<xref rid="pcbi.1012970.ref017" ref-type="bibr">17</xref>]. It was shown that when preferential sampling is present, not accounting for it can result in biases, while accounting for it can result in more accurate and precise inference of the effective population size trajectory. This model has been extended to allow for additional factors to be related to the sampling intensity and effective population size [<xref rid="pcbi.1012970.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1012970.ref019" ref-type="bibr">19</xref>].</p><p>In this work we use simulations to investigate the effects of reporting delays in real-time phylodynamic inference of the effective population size; we compare the effects across various state-of-the-art inferential strategies. We also propose a strategy to mitigate the effects of reporting delays within the preferential model, by incorporating information about the distribution of recent reporting delays. This extends the Karcher <italic toggle="yes">et al</italic>. (2020) model by including reporting probabilities into the sampling intensity model [<xref rid="pcbi.1012970.ref018" ref-type="bibr">18</xref>]. We use simulations to compare the performance of our proposed model with competitive real-time phylodynamic strategies in the presence of preferential sampling and reporting delays and show that our model has lower bias, better coverage, and higher precision than state-of-the-art methods. Finally, we use SARS-CoV-2 sequences from Washington state as a case study to compare real-time inferential strategies on data which suffers from reporting delays to the performance of retrospective inference on all sampled sequences in the hypothetical case of no reporting delays.</p></sec><sec sec-type="materials|methods" id="sec002"><title>2. Methods</title><p>We will begin with a description of the nonparametric phylodynamic methodology proposed in Karcher <italic toggle="yes">et al</italic>. (2020) [<xref rid="pcbi.1012970.ref018" ref-type="bibr">18</xref>]. This Bayesian strategy will be described starting with how the pathogen genetic samples are modeled conditionally on its evolutionary tree, sampling times, number of samples at each time, and effective population size trajectory, followed by details of the overall full hierarchical model. Once this framework is understood, we will introduce our proposal to mitigate the effects of delays between collecting a sample and depositing a pathogen sequence obtained from the sample into a public database.</p><sec id="sec003"><title>2.1. Summary of Bayesian nonparametric <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) inference</title><p>When analyzing pathogen evolution, we use an alignment of sampled pathogen genetic sequences as data. These sequences can either be collected at the same time, isochronous sampling, or at different points in time, heterochronous sampling. Here we are concerned with viruses that evolve rapidly with continuously collected samples so we will consider heterochronous sampling of DNA or RNA sequences aligned and stored in matrix <inline-formula id="pcbi.1012970.e001"><alternatives><graphic xlink:href="pcbi.1012970.e001.jpg" id="pcbi.1012970.e001g" position="anchor"/><mml:math id="M1" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1012970.e002"><alternatives><graphic xlink:href="pcbi.1012970.e002.jpg" id="pcbi.1012970.e002g" position="anchor"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1012970.e003"><alternatives><graphic xlink:href="pcbi.1012970.e003.jpg" id="pcbi.1012970.e003g" position="anchor"/><mml:math id="M3" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>L</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <italic toggle="yes">n</italic> is the number of sequences and <italic toggle="yes">L</italic> is the alignment length. The sequences, <inline-formula id="pcbi.1012970.e004"><alternatives><graphic xlink:href="pcbi.1012970.e004.jpg" id="pcbi.1012970.e004g" position="anchor"/><mml:math id="M4" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, all ultimately share a common ancestry, and the evolution of the sequences from their most recent common ancestor is described by a bifurcating tree called a genealogy, denoted as <inline-formula id="pcbi.1012970.e005"><alternatives><graphic xlink:href="pcbi.1012970.e005.jpg" id="pcbi.1012970.e005g" position="anchor"/><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p><p>We assume that given the genealogy, alignment sites are independent and identically distributed. The evolutionary changes in the nucleotides present at each alignment site, column of matrix <inline-formula id="pcbi.1012970.e006"><alternatives><graphic xlink:href="pcbi.1012970.e006.jpg" id="pcbi.1012970.e006g" position="anchor"/><mml:math id="M6" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, are modeled by a continuous-time Markov chain substitution model parameterized by vector <inline-formula id="pcbi.1012970.e007"><alternatives><graphic xlink:href="pcbi.1012970.e007.jpg" id="pcbi.1012970.e007g" position="anchor"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. From a given viral genealogy and substitution rate matrix, the probability of observing sequences <inline-formula id="pcbi.1012970.e008"><alternatives><graphic xlink:href="pcbi.1012970.e008.jpg" id="pcbi.1012970.e008g" position="anchor"/><mml:math id="M8" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1012970.e009"><alternatives><graphic xlink:href="pcbi.1012970.e009.jpg" id="pcbi.1012970.e009g" position="anchor"/><mml:math id="M9" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> can be calculated using an efficient dynamic programming algorithm [<xref rid="pcbi.1012970.ref020" ref-type="bibr">20</xref>]. Equipped with a model for the alignment, a model is needed for the pathogen&#x02019;s genealogy.</p><p>The lower half of <xref rid="pcbi.1012970.g001" ref-type="fig">Fig 1</xref> displays a genealogy relating five sequences, black tree tips, collected across four sampling times. Note the purple tips denote samples collected but not yet reported and available for use by the time of analysis. Sampling times are denoted by <inline-formula id="pcbi.1012970.e010"><alternatives><graphic xlink:href="pcbi.1012970.e010.jpg" id="pcbi.1012970.e010g" position="anchor"/><mml:math id="M10" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and sample sizes by <inline-formula id="pcbi.1012970.e011"><alternatives><graphic xlink:href="pcbi.1012970.e011.jpg" id="pcbi.1012970.e011g" position="anchor"/><mml:math id="M11" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1012970.e012"><alternatives><graphic xlink:href="pcbi.1012970.e012.jpg" id="pcbi.1012970.e012g" position="anchor"/><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. In this set up we imagine generating the genealogy backwards in time starting from the most recent sampling time, <italic toggle="yes">s</italic><sub><italic toggle="yes">m</italic></sub>&#x02009;=&#x02009;0. The branches of this evolutionary tree end at the sampling times <inline-formula id="pcbi.1012970.e013"><alternatives><graphic xlink:href="pcbi.1012970.e013.jpg" id="pcbi.1012970.e013g" position="anchor"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and the convergence, or coalescence, of two branches corresponds to a common ancestor of the two sequences. The tree&#x02019;s branches coalesce until the most recent common ancestor of all of the samples, the root of the tree. The times of the coalescent events are denoted <inline-formula id="pcbi.1012970.e014"><alternatives><graphic xlink:href="pcbi.1012970.e014.jpg" id="pcbi.1012970.e014g" position="anchor"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, with <inline-formula id="pcbi.1012970.e015"><alternatives><graphic xlink:href="pcbi.1012970.e015.jpg" id="pcbi.1012970.e015g" position="anchor"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and the most recent sampling time <italic toggle="yes">s</italic><sub><italic toggle="yes">m</italic></sub>&#x02009;=&#x02009;0 will be denoted by <italic toggle="yes">t</italic><sub><italic toggle="yes">n</italic></sub> because this notation will make it convenient to define the joint density of coalescent times later.</p><fig position="float" id="pcbi.1012970.g001"><object-id pub-id-type="doi">10.1371/journal.pcbi.1012970.g001</object-id><label>Fig 1</label><caption><title>Example of an effective population size trajectory (top figure) and corresponding genealogy (bottom figure), with reporting probabilities and corresponding unobserved tips denoted by purple coloring.</title><p>For a real-time analysis the reporting probability decreases as the collection date gets closer to present time, time zero.</p></caption><graphic xlink:href="pcbi.1012970.g001" position="float"/></fig><p>The effective population size, denoted <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>), is a time-varying measure of genetic diversity. The number of active lineages at a time <italic toggle="yes">t</italic> is the difference between the number of sampling and coalescent events between times 0 and <italic toggle="yes">t</italic>. The intervals <italic toggle="yes">I</italic><sub><italic toggle="yes">i</italic>,<italic toggle="yes">k</italic></sub> are defined by the sampling and coalescent times, so the number of active lineages, denoted <italic toggle="yes">l</italic><sub><italic toggle="yes">i</italic>,<italic toggle="yes">k</italic></sub>, in an interval is constant. For <inline-formula id="pcbi.1012970.e016"><alternatives><graphic xlink:href="pcbi.1012970.e016.jpg" id="pcbi.1012970.e016g" position="anchor"/><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, the intervals that end in a coalescent event are denoted <inline-formula id="pcbi.1012970.e017"><alternatives><graphic xlink:href="pcbi.1012970.e017.jpg" id="pcbi.1012970.e017g" position="anchor"/><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, for <inline-formula id="pcbi.1012970.e018"><alternatives><graphic xlink:href="pcbi.1012970.e018.jpg" id="pcbi.1012970.e018g" position="anchor"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and intervals that end with a sampling event are denoted <inline-formula id="pcbi.1012970.e019"><alternatives><graphic xlink:href="pcbi.1012970.e019.jpg" id="pcbi.1012970.e019g" position="anchor"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, for <inline-formula id="pcbi.1012970.e020"><alternatives><graphic xlink:href="pcbi.1012970.e020.jpg" id="pcbi.1012970.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> with <italic toggle="yes">i</italic>&#x0003e;0. For a more detailed explanation of the <italic toggle="yes">I</italic><sub><italic toggle="yes">i</italic>,<italic toggle="yes">k</italic></sub> intervals, and a clarifying visual, see Lan <italic toggle="yes">et al</italic>. (2015) [<xref rid="pcbi.1012970.ref021" ref-type="bibr">21</xref>].</p><p>Coalescent models are continuous-time Markov chains used to model a genealogy from a sample of sequences [<xref rid="pcbi.1012970.ref022" ref-type="bibr">22</xref>]. Rodrigo <italic toggle="yes">et al</italic>. (1999) extended coalescent theory for heterochronous sampling to calculate the joint distribution of a genealogy given its sampling times, number of samples collected at each time, and the effective population size, as the product of conditional densities and tail probabilities of coalescent times [<xref rid="pcbi.1012970.ref023" ref-type="bibr">23</xref>]:</p><disp-formula id="pcbi.1012970.e021"><alternatives><graphic xlink:href="pcbi.1012970.e021.jpg" id="pcbi.1012970.e021g" position="anchor"/><mml:math id="M21" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">n</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mspace linebreak="newline"/><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mo fence="true" maxsize="2.047em" minsize="2.047em" stretchy="true">{</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>&#x02212;</mml:mo><mml:munder><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo fence="true" maxsize="2.047em" minsize="2.047em" stretchy="true">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(1)</label></disp-formula><p>with the coalescent factors <inline-formula id="pcbi.1012970.e022"><alternatives><graphic xlink:href="pcbi.1012970.e022.jpg" id="pcbi.1012970.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo maxsize="2.047em" minsize="2.047em">(</mml:mo><mml:mfrac linethickness="0"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo maxsize="2.047em" minsize="2.047em">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p><p>Assuming the effective population size trajectory <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) is an unknown function in continuous time, the integral in <xref rid="pcbi.1012970.e021" ref-type="disp-formula">Eq 1</xref> is intractable. We adopt a common approach [<xref rid="pcbi.1012970.ref024" ref-type="bibr">24</xref>&#x02013;<xref rid="pcbi.1012970.ref026" ref-type="bibr">26</xref>], well described by Lan <italic toggle="yes">et al</italic>. (2015), that discretizes the effective population size to be piecewise constant, with changes occurring at evenly spaced time points that form a regular grid <inline-formula id="pcbi.1012970.e023"><alternatives><graphic xlink:href="pcbi.1012970.e023.jpg" id="pcbi.1012970.e023g" position="anchor"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, spanning from the most recent sampling time, <inline-formula id="pcbi.1012970.e024"><alternatives><graphic xlink:href="pcbi.1012970.e024.jpg" id="pcbi.1012970.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, to the first coalescent time, <inline-formula id="pcbi.1012970.e025"><alternatives><graphic xlink:href="pcbi.1012970.e025.jpg" id="pcbi.1012970.e025g" position="anchor"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> [<xref rid="pcbi.1012970.ref021" ref-type="bibr">21</xref>]. In this approach we define <inline-formula id="pcbi.1012970.e026"><alternatives><graphic xlink:href="pcbi.1012970.e026.jpg" id="pcbi.1012970.e026g" position="anchor"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>&#x003b3;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and approximate <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) by <inline-formula id="pcbi.1012970.e027"><alternatives><graphic xlink:href="pcbi.1012970.e027.jpg" id="pcbi.1012970.e027g" position="anchor"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mn>1</mml:mn><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The <inline-formula id="pcbi.1012970.e028"><alternatives><graphic xlink:href="pcbi.1012970.e028.jpg" id="pcbi.1012970.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>&#x02019;s <italic toggle="yes">a priori</italic> follow a first order random walk: <inline-formula id="pcbi.1012970.e029"><alternatives><graphic xlink:href="pcbi.1012970.e029.jpg" id="pcbi.1012970.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>~</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>&#x003ba;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1012970.e030"><alternatives><graphic xlink:href="pcbi.1012970.e030.jpg" id="pcbi.1012970.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>~</mml:mi><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>&#x003c3;</mml:mi><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We adopt the common approach of using a gamma prior distribution for the hyperparameter <inline-formula id="pcbi.1012970.e031"><alternatives><graphic xlink:href="pcbi.1012970.e031.jpg" id="pcbi.1012970.e031g" position="anchor"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003ba;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.</p><p>With heterochronous sampling, it is likely that the frequency of sampling is related to the number of infections in the population (e.g., increased sampling intensity when there is an increase in infections). Additional factors may also influence the sampling intensity, such as time variable cost of sequencing a pathogen genome. We denote these additional factors as <inline-formula id="pcbi.1012970.e032"><alternatives><graphic xlink:href="pcbi.1012970.e032.jpg" id="pcbi.1012970.e032g" position="anchor"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. In the preferential sampling model, we model sampling events as a Poisson Process with intensity <inline-formula id="pcbi.1012970.e033"><alternatives><graphic xlink:href="pcbi.1012970.e033.jpg" id="pcbi.1012970.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> that depends on such time-varying factors:</p><disp-formula id="pcbi.1012970.e034"><alternatives><graphic xlink:href="pcbi.1012970.e034.jpg" id="pcbi.1012970.e034g" position="anchor"/><mml:math id="M34" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>log</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(2)</label></disp-formula><p>Note the sampling intensity can include interactions between the covariates and the log effective population size, but we do not include them in our model here. The coefficients <inline-formula id="pcbi.1012970.e035"><alternatives><graphic xlink:href="pcbi.1012970.e035.jpg" id="pcbi.1012970.e035g" position="anchor"/><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>&#x02019;s are assigned independent normal priors with means <inline-formula id="pcbi.1012970.e036"><alternatives><graphic xlink:href="pcbi.1012970.e036.jpg" id="pcbi.1012970.e036g" position="anchor"/><mml:math id="M36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003bc;</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and variances <inline-formula id="pcbi.1012970.e037"><alternatives><graphic xlink:href="pcbi.1012970.e037.jpg" id="pcbi.1012970.e037g" position="anchor"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003c3;</mml:mi></mml:mrow><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Since the effective population size is piecewise constant on the regular grid <inline-formula id="pcbi.1012970.e038"><alternatives><graphic xlink:href="pcbi.1012970.e038.jpg" id="pcbi.1012970.e038g" position="anchor"/><mml:math id="M38" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, for simplicity we require time-varying covariates also be piecewise constant on the same grid.</p><p>Altogether, the posterior we are interested in is</p><disp-formula id="pcbi.1012970.e039"><alternatives><graphic xlink:href="pcbi.1012970.e039.jpg" id="pcbi.1012970.e039g" position="anchor"/><mml:math id="M39" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>&#x003ba;</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0221d;</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>&#x003ba;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace linebreak="newline"/><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003ba;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(3)</label></disp-formula><p>Approximation of this posterior via Markov Chain Monte Carlo (MCMC) is implemented in the phylodynamic software BEAST [<xref rid="pcbi.1012970.ref018" ref-type="bibr">18</xref>, <xref rid="pcbi.1012970.ref027" ref-type="bibr">27</xref>]. This Bayesian inference is time and memory intensive though, so it is common in practice to estimate the genealogy first and assume the genealogy is known. When the genealogy is known the posterior of interest reduces to</p><disp-formula id="pcbi.1012970.e040"><alternatives><graphic xlink:href="pcbi.1012970.e040.jpg" id="pcbi.1012970.e040g" position="anchor"/><mml:math id="M40" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>&#x003ba;</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0221d;</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b3;</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>&#x003ba;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003ba;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(4)</label></disp-formula><p>Approximations of this posterior via MCMC and via Integrated Nested Laplace Approximations (INLA) [<xref rid="pcbi.1012970.ref024" ref-type="bibr">24</xref>] are implemented in the phylodynamic R package <monospace>phylodyn</monospace> [<xref rid="pcbi.1012970.ref028" ref-type="bibr">28</xref>].</p></sec><sec id="sec004"><title>2.2. Accounting for reporting delays</title><p>The time delay between collecting a sample and depositing that sample&#x02019;s sequence into a database arose as a problem during the SARS-CoV-2 pandemic, because of the urgent need for up-to-date understanding of disease dynamics. Missing the most recent data is especially problematic for the preferential sampling model because of the dependency between the sampling intensity and the effective population size. Intuitively, a model that takes into account preferential sampling would underestimate the effective population size close to the present time due to the lack of observed samples. One possible solution of this problem is to use a coalescent model without the preferential sampling component, avoiding the dependency between the sampling intensity and the effective population size. While the biases from the missing data would be avoided with this strategy, unaccounted preferential sampling can result in biases, and wider credible intervals than those modeled with preferential sampling [<xref rid="pcbi.1012970.ref017" ref-type="bibr">17</xref>].</p><p>Another way to circumvent this missing data issue is to only use data up to a time when all of the data is likely to have been reported (e.g., data up to two months prior to time of analysis). For example, phylodynamics was used to compare SARS-CoV-2 lineages in England with data truncated by two weeks to avoid reporting delays in 2021 [<xref rid="pcbi.1012970.ref006" ref-type="bibr">6</xref>]. The major pitfall of this truncation strategy is the inability to perform real-time phylodynamics to inform outbreak mitigation, a problem that increases for locations or time periods with extensive reporting delays.</p></sec><sec id="sec005"><title>2.3. Incorporating reporting delay distribution into preferential sampling model</title><p>To mitigate effects of reporting delays on real-time phylodynamic analyses with preferential sampling, we propose incorporating information about the distribution of recent delays in the sampling intensity model. In the preferential sampling model sampling times are modeled as a Poisson process with intensity <inline-formula id="pcbi.1012970.e041"><alternatives><graphic xlink:href="pcbi.1012970.e041.jpg" id="pcbi.1012970.e041g" position="anchor"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Let <inline-formula id="pcbi.1012970.e042"><alternatives><graphic xlink:href="pcbi.1012970.e042.jpg" id="pcbi.1012970.e042g" position="anchor"/><mml:math id="M42" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> be the probability that a sample collected at time <italic toggle="yes">t</italic> was sequenced and reported by the time of the analysis. Define the observed sampling times, <inline-formula id="pcbi.1012970.e043"><alternatives><graphic xlink:href="pcbi.1012970.e043.jpg" id="pcbi.1012970.e043g" position="anchor"/><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> to be the subset of the true sampling times, <inline-formula id="pcbi.1012970.e044"><alternatives><graphic xlink:href="pcbi.1012970.e044.jpg" id="pcbi.1012970.e044g" position="anchor"/><mml:math id="M44" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, that are reported by the time of analysis. Then the observed sampling intensity, <inline-formula id="pcbi.1012970.e045"><alternatives><graphic xlink:href="pcbi.1012970.e045.jpg" id="pcbi.1012970.e045g" position="anchor"/><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, could be expressed as the product of the true sampling intensity and the probability of a sample being reported, resulting in a thinned Poisson process with intensity <inline-formula id="pcbi.1012970.e046"><alternatives><graphic xlink:href="pcbi.1012970.e046.jpg" id="pcbi.1012970.e046g" position="anchor"/><mml:math id="M46" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Plugging <xref rid="pcbi.1012970.e034" ref-type="disp-formula">Eq 2</xref> into the definition of <inline-formula id="pcbi.1012970.e047"><alternatives><graphic xlink:href="pcbi.1012970.e047.jpg" id="pcbi.1012970.e047g" position="anchor"/><mml:math id="M47" display="inline" overflow="scroll"><mml:mrow><mml:mover><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, we get the following new model for the log-sampling intensity</p><disp-formula id="pcbi.1012970.e048"><alternatives><graphic xlink:href="pcbi.1012970.e048.jpg" id="pcbi.1012970.e048g" position="anchor"/><mml:math id="M48" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>log</mml:mi><mml:mover><mml:mrow><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>log</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:msub><mml:mi>f</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(5)</label></disp-formula><p>We refer to this proposed adjustment to the preferential sampling model as the delay-aware BNPR PS model.</p></sec><sec id="sec006"><title>2.4. Implementation of delay-aware BNPR PS model</title><p>Our proposed model assumes that the reporting probabilities are known, but in reality they would likely not be known, and they could be changing over time. Reporting and sampling dates are readily available metadata for pathogen sequences, so the user of our method is advised to use these reported metadata for a pathogen of interest to calculate the empirical cumulative distribution function (cdf) of the delays to approximate the reporting probabilities <inline-formula id="pcbi.1012970.e049"><alternatives><graphic xlink:href="pcbi.1012970.e049.jpg" id="pcbi.1012970.e049g" position="anchor"/><mml:math id="M49" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Similarly to the effective population size and any covariates, the reporting probabilities <inline-formula id="pcbi.1012970.e050"><alternatives><graphic xlink:href="pcbi.1012970.e050.jpg" id="pcbi.1012970.e050g" position="anchor"/><mml:math id="M50" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">r</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> must also be defined as piecewise constant across the regular grid <inline-formula id="pcbi.1012970.e051"><alternatives><graphic xlink:href="pcbi.1012970.e051.jpg" id="pcbi.1012970.e051g" position="anchor"/><mml:math id="M51" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msubsup><mml:mo stretchy="false">}</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. When approximating the reporting probabilities there are several considerations: Is there recent data that can provide information about reporting delay behavior? Should the reporting delays of recently reported sequence or recently sampled sequences be used? What should be considered recent?</p><p>Our proposed method is not applicable to situations without some data about recent reporting delays, such as the first few weeks of an outbreak where sequencing efforts are just beginning. In a situation with available data on recent reporting delays, it is important to recognize that the empirical cdf of sequences sampled during a predefined time window will provide biased estimates of reporting probabilities due to unreported sequences being censored. In the scenario with all sampling times known, regardless of sequences being reported by the time of analysis, survival analysis methods (e.g., Kaplan-Meier estimator) could be used to approximate the reporting probabilities. Otherwise, the empirical cdf of samples reported during a predefined time window should be used to estimate reporting probabilities.</p><p>When considering what time frame of reported sequences to use, it is important to look at the most recent reporting delays and examine if the delay behavior is changing overtime. The time frame of reported sequences to use should be chosen from the time of analysis back to a time where the reporting delay behavior continues to be relatively consistent. This is important because more data can provide better estimates, but reporting delays from sequences collected during a time period with very different delay behavior will not approximate current delay behavior well. Further investigation of these modeling decisions and their impact on the inference with the delay aware BNPR PS model is provided in <xref rid="pcbi.1012970.s001" ref-type="supplementary-material">S1 Appendix</xref> Sect 3.</p><p>We developed a new version of the R package <bold>phylodyn</bold> [<xref rid="pcbi.1012970.ref028" ref-type="bibr">28</xref>], <bold>phylodyn2</bold> (<ext-link xlink:href="https://github.com/CatalinaMedina/phylodyn2" ext-link-type="uri">https://github.com/CatalinaMedina/phylodyn2</ext-link>), which has a well-documented subset of the functionality of phylodyn, with the additional ability to account for reporting delays in real-time analyses through our proposed delay-aware BNPR PS model. The R package phylodyn included several posterior sampling strategies. For phylodyn2 we chose to focus on the Integrated Nested Laplace Approximations (INLA) based strategy to approximate the marginal posterior distributions <inline-formula id="pcbi.1012970.e052"><alternatives><graphic xlink:href="pcbi.1012970.e052.jpg" id="pcbi.1012970.e052g" position="anchor"/><mml:math id="M52" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">g</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> because it is faster than the MCMC-based method. This INLA implementation formulates the model for sampling times as a Poisson regression [<xref rid="pcbi.1012970.ref024" ref-type="bibr">24</xref>]. A helpful observation is that the <inline-formula id="pcbi.1012970.e053"><alternatives><graphic xlink:href="pcbi.1012970.e053.jpg" id="pcbi.1012970.e053g" position="anchor"/><mml:math id="M53" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> term in <xref rid="pcbi.1012970.e048" ref-type="disp-formula">Eq 5</xref> could be operationally viewed as an offset to this Poisson regression. However, the original phylodyn implementation did not allow for inclusion of a user specified offset term. That is one major change present in phylodyn2 that allowed for the implementation of the delay-aware BNPR PS model, where the reporting probabilities are calculated from a user specified vector of recent reporting delays.</p><p>Another way of viewing the <inline-formula id="pcbi.1012970.e054"><alternatives><graphic xlink:href="pcbi.1012970.e054.jpg" id="pcbi.1012970.e054g" position="anchor"/><mml:math id="M54" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> term within the framework developed in [<xref rid="pcbi.1012970.ref018" ref-type="bibr">18</xref>] is considering it to be a time-varying covariate of the sampling intensity, with a coefficient of the value one. The appeal of this perspective is the ease of implementation with existing phylodynamic tools that allow for time-varying covariates in the sampling intensity, such as BEAST and phylodyn. One could specify <inline-formula id="pcbi.1012970.e055"><alternatives><graphic xlink:href="pcbi.1012970.e055.jpg" id="pcbi.1012970.e055g" position="anchor"/><mml:math id="M55" display="inline" overflow="scroll"><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> as a regression covariate with a narrow prior for the coefficient of this term centered at one. This adds unnecessary randomness, since the coefficient of this term is theoretically one, but the ease of use makes this option worth exploring. This implementation is also available in phylodyn2, and its performance is examined in <xref rid="pcbi.1012970.s001" ref-type="supplementary-material">S1 Appendix</xref> Sect 1.1.</p><p>All code to reproduce the results in this paper can be found at <ext-link xlink:href="https://github.com/CatalinaMedina/reporting-delays-in-phylodynamics-paper" ext-link-type="uri">https://github.com/CatalinaMedina/reporting-delays-in-phylodynamics-paper</ext-link>.</p></sec></sec><sec sec-type="results" id="sec007"><title>3. Results</title><sec id="sec008"><title>3.1. Simulations</title><p>We performed simulation studies to mimic real-time phylodynamic analyses in the presence of preferential sampling, aiming at two primary objectives. Firstly, to investigate the effects of reporting delays with currently available phylodynamic inferential strategies. Secondly, to compare the performance of our proposed model against the currently available strategies. Of key interest is how well the effective population size trajectory can be inferred close to the most recent sampling time.</p><p>Three real-time inferential strategies were considered for comparison: avoid modeling the sampling time dependency by using the the Bayesian nonparametric phylodynamic reconstruction (BNPR) model, model the sampling time dependency with the Bayesian nonparametric phylodynamic reconstruction with preferential sampling (BNPR PS) model, and model the sampling time dependency and reporting delays with our proposed delay-aware BNPR PS model. We also fit the BNPR PS model to all of the data, regardless of whether it was reported, to provide a retrospective baseline for the performance of these real-time inferential strategies.</p><p>We used three simulation scenarios with the same effective population size trajectory, but across different time periods so that the effects of reporting delays with different trajectory behavior near time zero could be investigated. The upper-left panel of <xref rid="pcbi.1012970.g002" ref-type="fig">Fig 2</xref> shows the effective population size trajectory, as well as the most recent sampling time, the time of analysis, for each scenario. Since time is viewed in reverse, the most recent sample in simulation scenario C is time zero, and the earliest sample was 300 days prior. Scenarios A and B had sampling time periods of 150 days and 220 days, respectively. Scenario A is meant to resemble an initial outbreak, which would have fewest samples due to reporting delays. Scenario B allows us to examine behavior when there is a slight increase occurring near present time, but less with sampling. Lastly, in scenario C there is a decline near present time and the recent peak corresponds to more reported samples near time zero than in scenario B. In both scenarios B and C the recent change in trajectory direction would be expected to be difficult to detect due to reporting delays.</p><fig position="float" id="pcbi.1012970.g002"><object-id pub-id-type="doi">10.1371/journal.pcbi.1012970.g002</object-id><label>Fig 2</label><caption><title>Simulation details: effective population trajectories (upper left plot), reporting probability by sampling time (upper right plot) obtained from the Washington state data, and histograms of sampling times from the last simulation of in each simulation scenario, approximately 1500 samples each, colored by whether sample was reported by time of analysis (bottom plots).</title><p>Each simulation scenario had a different time zero, i.e., time of latest sample (dashed lines). The earliest sampling time in each scenario was at the same point in the trajectory (dotted line).</p></caption><graphic xlink:href="pcbi.1012970.g002" position="float"/></fig><p>Sampling times were simulated from an inhomogeneous Poisson process with intensity <inline-formula id="pcbi.1012970.e056"><alternatives><graphic xlink:href="pcbi.1012970.e056.jpg" id="pcbi.1012970.e056g" position="anchor"/><mml:math id="M56" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mrow><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Coalescent times were simulated using the <monospace>coalsim()</monospace> function in the phylodyn R package [<xref rid="pcbi.1012970.ref028" ref-type="bibr">28</xref>], which uses a time-transformation technique where the coalescent likelihood is treated as an inhomogeneous Poisson process [<xref rid="pcbi.1012970.ref029" ref-type="bibr">29</xref>]. Parameter <inline-formula id="pcbi.1012970.e057"><alternatives><graphic xlink:href="pcbi.1012970.e057.jpg" id="pcbi.1012970.e057g" position="anchor"/><mml:math id="M57" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> was set to 2 to create a reasonably strong preferential sampling effect and <inline-formula id="pcbi.1012970.e058"><alternatives><graphic xlink:href="pcbi.1012970.e058.jpg" id="pcbi.1012970.e058g" position="anchor"/><mml:math id="M58" display="inline" overflow="scroll"><mml:mrow><mml:mi>exp</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> was selected to achieve a sample size of approximately 1500 samples, each with its own sampling time.</p><p>For each sampling time we simulated a random Bernoulli to indicate if a sample was reported by the time of analysis. Sampling times for each scenario are plotted in <xref rid="pcbi.1012970.g002" ref-type="fig">Fig 2</xref> and colored by whether it was observed or not. To create realistic delays, the reporting probabilities were obtained from the empirical reporting delay distribution of SARS-CoV-2 sequences collected in the state of Washington. See the real data investigation results subsection for details, visualized in upper-right panel of <xref rid="pcbi.1012970.g002" ref-type="fig">Fig 2</xref>. The tips of the genealogy of the full tree that correspond to unreported samples were pruned from the tree, to get the observed genealogy. Each inference was performed with the INLA-based Bayesian phylodynamic inference implemented in the R package phylodyn2.</p><p>We will begin by discussing the results of a single simulation within a scenario, in order to better understand the patterns in the performance of each inference strategy across all of the simulations. Plots of the results of each inference strategy from a single simulation in each simulation scenario are available in <xref rid="pcbi.1012970.s001" ref-type="supplementary-material">S1 Appendix</xref> Sect 1.1. <xref rid="pcbi.1012970.g003" ref-type="fig">Fig 3</xref> plots the true (solid lines) and inferred (dashed lines) effective population size trajectory for the 100 days prior to the most recently collected sample. Here we focus on the two options of real-time inference, the BNPR and BNPR PS models, and our proposed delay-aware BNPR PS model. While the ultimate goal is to be able to infer the true effective population size trajectory, it is useful to see how closely the data generating model can approximate the true trajectory, within simulation scenario C, where the trajectory of interest is on the decline at present time. This is why each plot also contains the BNPR PS inference performed retrospectively on all of the data, not just the observed data &#x02013; this serves as a baseline to compare the inference of <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) from each real-time inferential method. The white background indicates the time period of interest, where delays are probable, and conversely the gray background indicates the period where reporting delays are unlikely. We chose to use the 90th percentile of the Washington state data reporting delays distribution, which was 41 days in this case, as the cutoff for these two periods.</p><fig position="float" id="pcbi.1012970.g003"><object-id pub-id-type="doi">10.1371/journal.pcbi.1012970.g003</object-id><label>Fig 3</label><caption><title>Comparison of real-time phylodynamic methods to infer the effective population size trajectory for a single simulation in scenario C, with reporting delays and preferential sampling present.</title><p>Median estimates of the effective population size and 95% credible intervals are plotted. The BNPR PS model was also applied retrospectively with all of the sampled sequences, regardless of if they were reported by time zero, to serve as a reference for comparison for the three real-time inference methods. The white background indicates the recent time period likely suffering from reporting delays, specifically where reporting probabilities (RPs) are below 90%, and is therefore the region of interest.</p></caption><graphic xlink:href="pcbi.1012970.g003" position="float"/></fig><p>In the first panel of <xref rid="pcbi.1012970.g003" ref-type="fig">Fig 3</xref> we see real-time inference with the BNPR model, which ignores the dependency between <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) and the sampling time. The BNPR model appears to have relatively low bias, but wide 95% credible intervals that increase in width near time zero. The real-time inference with the BNPR PS model stands out because of the bias which increases as time approaches the most recently collected sample. This demonstrates the bias introduced when using the data generating model, the BNPR PS model, when there are reporting delays present in the data. Alternatively, our implementation of the delay-aware BNPR PS model has less bias than the BNPR PS model near time zero and visibly narrower 95% credible intervals than the BNPR model near time zero.</p><p>The results identified from the single simulation in <xref rid="pcbi.1012970.g003" ref-type="fig">Fig 3</xref> generally persist across all 500 simulations, in each of the three simulation scenarios, visualized in <xref rid="pcbi.1012970.g004" ref-type="fig">Fig 4</xref>. The plots present a seven-day moving average of the mean relative deviation, mean percent of 95% Bayesian credible intervals which covered the true value, and mean 95% credible interval width for each inference strategy in each simulation scenario. A moving average was chosen because a metric of the inference over the entire time period would be insufficient to describe how inference performance changes with proximity to time zero. Mean relative deviation is the most important of the three chosen metrics because it assess accuracy, of the point estimate, interval coverage was selected to examine the accuracy of the uncertainty of the estimates, and interval width was useful for assessing precision to compare those models with good accuracy and good coverage. Since the performance of these estimation strategies near time zero is of key interest, these plots were truncated to the most recent 100 days. To view the performance metrics results for all inferential methods considered see <xref rid="pcbi.1012970.s001" ref-type="supplementary-material">S1 Appendix</xref> Tables A-C.</p><fig position="float" id="pcbi.1012970.g004"><object-id pub-id-type="doi">10.1371/journal.pcbi.1012970.g004</object-id><label>Fig 4</label><caption><title>Seven-day moving averages of the mean relative deviation, mean percent coverage, and mean interval width by the 95% Bayesian credible intervals, for each real-time phylodynamic strategies to infer the effective population size in each simulation scenario with preferential sampling (PS) and reporting delays in the observed data.</title><p>Real-time inference was performed with the Bayesian nonparametric phylodynamic reconstruction (BNPR) model, BNPR PS model, and with the delay-aware BNPR PS model with 500 simulations per scenario.</p></caption><graphic xlink:href="pcbi.1012970.g004" position="float"/></fig><p>Focusing on the time period of interest, the most recent 41 days, our proposed delay-aware BNPR PS model consistently has lower mean relative deviation than the BNPR method, in each seven-day moving average, though there is not much practical difference. The BNPR PS model has increasing relatively large mean relative deviation as sampling times decrease to time zero, in each simulation scenario. The absolute maximum mean relative deviations in scenario A are all achieved in the week prior to time zero are 0.15, 0.82, and 0.06 for the BNPR, BNPR PS, and our delay-aware BNPR PS model respectively. The 95% Bayesian credible intervals for the BNPR and our delay-aware BNPR PS model are consistently conservative, while the BNPR PS model&#x02019;s 95% credible intervals&#x02019; coverage drops below 95% and approaches 0% as sampling time approaches time zero. Finally, while maintaining competitively low bias and high coverage, our proposed model consistently has lower mean 95% Bayesian credible interval widths than the BNPR model, with the difference between the two models increasing as sampling time approaches time zero.</p></sec><sec id="sec009"><title>3.2. Real data investigation: Washington state COVID dynamics</title><p>We used SARS-CoV-2 sequences from Washington state for the purpose of investigating the differences between a real-time phylodynamic analysis with and without our proposed method to account for reporting delays in genomic data. The SARS-CoV-2 sequences were accessed via the GISAID database available at <ext-link xlink:href="https://gisaid.org/EPI_SET_220330me" ext-link-type="uri">https://gisaid.org/EPI_SET_220330me</ext-link>, for Washington state sampled between February 01, 2021 and August 01, 2021, inclusive [<xref rid="pcbi.1012970.ref030" ref-type="bibr">30</xref>]. This time period was of interest because researchers were regularly sequencing Washington samples at this point in the pandemic, and the reporting behavior is relatively consistent during this period. <xref rid="pcbi.1012970.g005" ref-type="fig">Fig 5</xref> plots seven-day rolling average number of COVID-19 cases per 100,000 people in population in the state of Washington, the daily number of SARS-CoV-2 samples available in GISAID for Washington, colored by whether the sequence was sampled by August 01, 2021 (middle plot), and the empirical cumulative distribution function for sampling dates between July 01, 2021 and August 01, 2021.</p><fig position="float" id="pcbi.1012970.g005"><object-id pub-id-type="doi">10.1371/journal.pcbi.1012970.g005</object-id><label>Fig 5</label><caption><title>Left plot is the seven-day rolling average of positive COVID-19 tests per 100,000 people in the state of Washington.</title><p>Middle panel shows number of SARS-CoV-2 genetic samples collected in Washington state, colored by whether the sample was reported by the time of analysis, August 1, 2021. Right panel shows empirical cumulative distribution of reporting delays from the month prior to time of analysis.</p></caption><graphic xlink:href="pcbi.1012970.g005" position="float"/></fig><p>The observed data are samples that had been sequenced and reported to GISAID on or before August 01, 2021, time zero of our analysis. The 90th percentile of the reporting delays distribution is 41 days. Since we are interested in the inference of <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) when reporting delays are present, we chose to focus our attention on the most recent 41 days.</p><p>Genealogy estimation was performed in BEAST for each data set: all 500 sequences to represent a retrospective analysis, the observed 412 sequences to represent a real-time analysis, and 375 remaining sequences after truncating any sequence with sampling times larger than 41 days to avoid reporting delays in a near real-time analysis. We used the HKY substitution model with empirically estimated base frequencies [<xref rid="pcbi.1012970.ref031" ref-type="bibr">31</xref>], Bayesian Skygrid coalescent model [<xref rid="pcbi.1012970.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1012970.ref032" ref-type="bibr">32</xref>], and a Uniform prior on the clock rate between <inline-formula id="pcbi.1012970.e059"><alternatives><graphic xlink:href="pcbi.1012970.e059.jpg" id="pcbi.1012970.e059g" position="anchor"/><mml:math id="M59" display="inline" overflow="scroll"><mml:mrow><mml:mn>2.38</mml:mn><mml:mi>&#x000d7;</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1012970.e060"><alternatives><graphic xlink:href="pcbi.1012970.e060.jpg" id="pcbi.1012970.e060g" position="anchor"/><mml:math id="M60" display="inline" overflow="scroll"><mml:mrow><mml:mn>8</mml:mn><mml:mi>&#x000d7;</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> [<xref rid="pcbi.1012970.ref033" ref-type="bibr">33</xref>]. The MCMC was run for <inline-formula id="pcbi.1012970.e061"><alternatives><graphic xlink:href="pcbi.1012970.e061.jpg" id="pcbi.1012970.e061g" position="anchor"/><mml:math id="M61" display="inline" overflow="scroll"><mml:mrow><mml:mn>25</mml:mn><mml:mi>&#x000d7;</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> iterations, logging parameters every 2000th iteration. The maximum clade credibility tree of the posteriors were used as the known genealogy in the phylodynamic reconstruction, for each of the three analyses. See <xref rid="pcbi.1012970.s001" ref-type="supplementary-material">S1 Appendix</xref> Sect 2 for more details about this analysis to obtain the genealogies.</p><p>Inference of the effective population size was performed with the same strategies used in our simulations to compare the performance of our proposed methods against available options. <xref rid="pcbi.1012970.g006" ref-type="fig">Fig 6</xref> shows the inference of the effective population size for three modeling strategy: Bayesian nonparametric phylodynamic reconstruction (BNPR), BNPR with preferential sampling (BNPR PS), and our proposed delay-aware BNPR PS model.</p><fig position="float" id="pcbi.1012970.g006"><object-id pub-id-type="doi">10.1371/journal.pcbi.1012970.g006</object-id><label>Fig 6</label><caption><title>Bayesian nonparametric phylodynamic reconstruction (BNPR) methods used to infer effective population size trajectory for SARS-CoV-19 in Washington state.</title><p>Each panel shows the inference from a real-time analysis on data suffering from reporting delays and from a retrospective analysis with completely reported data. The white background indicates the recent time period likely suffering from reporting delays.</p></caption><graphic xlink:href="pcbi.1012970.g006" position="float"/></fig><p>The retrospective analysis with all of the collected samples with the BNPR PS model infers a peak in transmission activity in mid April of 2021, dropping to a minimum in mid June, followed by a steady increase continuing into August 2021. The results for these analyses are consistent with the trajectory of COVID-19 cases for this time period, visualized in <xref rid="pcbi.1012970.g005" ref-type="fig">Fig 5</xref>, with approximately a two week delay which could be due to reporting delays in COVID test results.</p><p>When comparing the real-time analyses we see similar patterns as those identified in our simulations. Using the retrospective BNPR PS model for comparison we see near real time, the BNPR model suffers from low precision, the BNPR PS model&#x02019;s credible intervals disagree with the retrospective analysis credible intervals, and our proposed delay-aware BNPR PS model is consistent with the retrospective BNPR PS model results, with higher precision than the BNPR model. This gain in precision found with our proposed model would have allowed real-time analysis to infer the increase near present time that the two currently available competitive methods underestimated.</p></sec></sec><sec sec-type="conclusions" id="sec010"><title>4. Discussion</title><p>In this work we investigated the effects of reporting delays on real-time phylodynamic methods to infer the effective population size and we proposed the delay-aware BNPR PS model. Through simulations we demonstrated that when preferential sampling is present, real-time analysis with the BNPR PS model suffers from increasingly extreme bias when inferring the effective population size near present time, implying that the BNPR PS model should not be used for such cases because it is unreliable. We also showed that when the preferential sampling relationship is not modeled, real-time analysis with the BNPR model has less bias than the BNPR PS model, but is largely uninformative due to its low precision near present time. Across simulations we found our delay-aware BNPR PS model to perform comparably to the BNPR model in terms of accuracy, without suffering from the same biases as the BNPR PS model. We also found that with more data our model obtains increased precision near present time, relative to the BNPR model. Our results support the intuition that we can infer <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) more accurately and precisely with more data, specifically when there are more samples sequenced and available for analysis. Beyond the simulations, our Washington data analysis found evidence of preferential sampling and behavior consistent with out simulation results: we saw agreeable results between our delay-aware BNPR PS model and the retrospective BNPR PS model, the real-time BNPR model had very low precision near present time, and the real-time BNPR PS model strongly disagreed with the retrospective BNPR PS model. The simulated and real data results provide compelling arguments that reporting delays should not be ignored in real-time analysis, and that the effective population size trajectory is a reasonable indicator for the effective number of infections.</p><p>For simplicity, we assumed the pathogen genealogy is known in our implementation of the delay-aware BNPR PS model in phylodyn2, obtaining the marginal posteriors of <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) with INLA. The value of this choice is that it is fast and can handle much larger number of sequences than BEAST which jointly infers the genealogy and other model parameters, including <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>). Computational speed and feasibility are necessary considerations with Bayesian phylodynamic methods, especially with online surveillance. It is also important to know how much the unaccounted phylogentic uncertainty from the tree affects our inference. In <xref rid="pcbi.1012970.s001" ref-type="supplementary-material">S1 Appendix</xref> Sect 4 we investigated the effect of the phylogenetic tree on the ultimate inference of the effective population size. The results suggest that we are underestimating the effective population size uncertainty, which is expected. A natural next step from this work would be to incorporate our reporting probability adjustment into the joint posterior inferred by the BNPR PS model in BEAST.</p><p>Our delay-aware BNPR PS model currently assumes that reporting probabilities are known, and our implementation uses recent reporting delays to estimate current reporting probabilities. This strategy is limited to locations, times, lineages, and even laboratories where there is believed to be consistency in reporting delays for sequences [<xref rid="pcbi.1012970.ref010" ref-type="bibr">10</xref>]. As such, care is necessary when defining the reporting probability distribution for use in the sampling intensity of our model. We investigated the effects of misspecification of the reporting probabilities, available in <xref rid="pcbi.1012970.s001" ref-type="supplementary-material">S1 Appendix</xref> Sect 3, and found the delay-aware BNPR PS model to be preferable to the BNPR PS model, even with relatively major misspecification of the reporting probabilities. That being said, the results do show better performance with better specification of the reporting probabilities. With major misspecification of the reporting probabilities, the BNPR model is preferable because it better reflects the uncertainty of the estimates. The next extension of this work would be to jointly infer the reporting probabilities and the effective population size. This could allow for increased accuracy and better uncertainty quantification, especially for areas with rapid changes in reporting behavior. Perhaps of most interest would be to allow for the reporting delay distribution to change overtime, allowing for updated surveillance of the effective population size with continual data collection.</p><p>The BNPR PS method models the sampling intensity parametrically, so naturally there may be concern of model misspecification, especially when studying new variants of unknown infectiousness. Cappello and Palacios (2022) proposed a model which allows for the relationship between the effective population size and the sampling intensity to vary with time as follows: <inline-formula id="pcbi.1012970.e062"><alternatives><graphic xlink:href="pcbi.1012970.e062.jpg" id="pcbi.1012970.e062g" position="anchor"/><mml:math id="M62" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003bb;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1012970.e063"><alternatives><graphic xlink:href="pcbi.1012970.e063.jpg" id="pcbi.1012970.e063g" position="anchor"/><mml:math id="M63" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is inferred nonparametrically from the genetic and sampling time data [<xref rid="pcbi.1012970.ref019" ref-type="bibr">19</xref>]. It would be of interest to extend this model to incorporate known reporting probabilities. The next question would be if it could jointly infer reporting probabilities and <italic toggle="yes">N</italic><sub><italic toggle="yes">e</italic></sub>(<italic toggle="yes">t</italic>) with the time-varying <inline-formula id="pcbi.1012970.e064"><alternatives><graphic xlink:href="pcbi.1012970.e064.jpg" id="pcbi.1012970.e064g" position="anchor"/><mml:math id="M64" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p><p>Another avenue of interest for future work is to investigate the impact of reporting delays on another class of models. There are two ways to estimate pathogen spread via phylogenies: 1) coalescent and 2) birth-death models. The second class of models needs to model sampling rates by default, which is not true for coalescent-based models, so it would be natural to extend our framework to birth-death models since the observed sampling rates near present time would be impacted by reporting delays [<xref rid="pcbi.1012970.ref034" ref-type="bibr">34</xref>].</p><p>Our proposed delay-aware BNPR PS model is a first step in mitigating the effects of reporting delays on real-time phylodynamic analyses. This work has important implications for real-time research with genomic data. We identified that the data generating model can be biased when ignoring the presence of missing data near present time due to reporting delays. The severity of this bias increases as the number of sequences observed decreases, but this bias can be corrected by using historical data about reporting delays.</p></sec><sec id="sec011" sec-type="supplementary-material"><title>5. Supporting information</title><supplementary-material id="pcbi.1012970.s001" position="float" content-type="local-data"><label>S1 Appendix</label><caption><title>Additional text, tables, and figure for the manuscript</title><p>(PDF)</p></caption><media xlink:href="pcbi.1012970.s001.pdf"/></supplementary-material></sec></body><back><ack><p>We gratefully acknowledge all data contributors, i.e., the authors and their originating laboratories responsible for obtaining the specimens, and their submitting laboratories for generating the genetic sequence and metadata and sharing via the GISAID Initiative, on which this research is based. We thank Lorenzo Cappello for useful discussions during the early stages of this project.</p></ack><ref-list><title>References</title><ref id="pcbi.1012970.ref001"><label>1</label><mixed-citation publication-type="other">Cori A, Kucharski A. <article-title>Inference of epidemic dynamics in the COVID-19 era and beyond</article-title>. <source>OSF Preprints</source>. <year>2024</year>.</mixed-citation></ref><ref id="pcbi.1012970.ref002"><label>2</label><mixed-citation publication-type="journal"><name><surname>Engebretsen</surname><given-names>S</given-names></name>, <name><surname>Diz-Lois Palomares</surname><given-names>A</given-names></name>, <name><surname>R&#x000f8;</surname><given-names>G</given-names></name>, Kristoffersen AB, Lindstr&#x000f8;m JC, <name><surname>Eng&#x000f8;-Monsen</surname><given-names>K</given-names></name>, <etal>et al</etal>. <article-title>A real-time regional model for COVID-19: Probabilistic situational awareness and forecasting</article-title>. <source>PLoS Comput Biol</source>. <year>2023</year>;<volume>19</volume>(<issue>1</issue>):e1010860. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1010860</pub-id>
<pub-id pub-id-type="pmid">36689468</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref003"><label>3</label><mixed-citation publication-type="journal"><name><surname>Volz</surname><given-names>EM</given-names></name>, <name><surname>Kosakovsky</surname><given-names>Pond SL</given-names></name>, <name><surname>Ward</surname><given-names>MJ</given-names></name>, <name><surname>Leigh Brown</surname><given-names>AJ</given-names></name>, <name><surname>Frost</surname><given-names>SDW</given-names></name>. <article-title>Phylodynamics of infectious disease epidemics</article-title>. <source>Genetics</source>. <year>2009</year>;<volume>183</volume>(<issue>4</issue>):<fpage>1421</fpage>&#x02013;<lpage>30</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1534/genetics.109.106021</pub-id>
<pub-id pub-id-type="pmid">19797047</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref004"><label>4</label><mixed-citation publication-type="journal"><name><surname>Frost</surname><given-names>SDW</given-names></name>, <name><surname>Volz</surname><given-names>EM</given-names></name>. <article-title>Viral phylodynamics and the search for an &#x0201c;effective number of infections&#x0201d;</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source>. <year>2010</year>;<volume>365</volume>(<issue>1548</issue>):<fpage>1879</fpage>&#x02013;<lpage>90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1098/rstb.2010.0060</pub-id>
<pub-id pub-id-type="pmid">20478883</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref005"><label>5</label><mixed-citation publication-type="journal"><name><surname>Fountain-Jones</surname><given-names>N</given-names></name>, <name><surname>Appaw</surname><given-names>R</given-names></name>, <name><surname>Carver</surname><given-names>S</given-names></name>, <name><surname>Didelot</surname><given-names>X</given-names></name>, <name><surname>Volz</surname><given-names>E</given-names></name>, <name><surname>Charleston</surname><given-names>M</given-names></name>. <article-title>Emerging phylogenetic structure of the SARS-CoV-2 pandemic</article-title>. <source>Virus Evol</source>. <year>2020</year>;<volume>6</volume>(<issue>2</issue>):veaa082.</mixed-citation></ref><ref id="pcbi.1012970.ref006"><label>6</label><mixed-citation publication-type="journal"><name><surname>Volz</surname><given-names>E</given-names></name>, <name><surname>Mishra</surname><given-names>S</given-names></name>, <name><surname>Chand</surname><given-names>M</given-names></name>, <name><surname>Barrett</surname><given-names>JC</given-names></name>, <name><surname>Johnson</surname><given-names>R</given-names></name>, <name><surname>Geidelberg</surname><given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Assessing transmissibility of SARS-CoV-2 lineage B.1.1.7 in England</article-title>. <source>Nature</source>. <year>2021</year>;<volume>593</volume>(<issue>7858</issue>):<fpage>266</fpage>&#x02013;<lpage>9</lpage>.<pub-id pub-id-type="pmid">33767447</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref007"><label>7</label><mixed-citation publication-type="journal"><name><surname>van Ballegooijen</surname><given-names>WM</given-names></name>, <name><surname>van Houdt</surname><given-names>R</given-names></name>, <name><surname>Bruisten</surname><given-names>SM</given-names></name>, <name><surname>Boot</surname><given-names>HJ</given-names></name>, <name><surname>Coutinho</surname><given-names>RA</given-names></name>, <name><surname>Wallinga</surname><given-names>J</given-names></name>. <article-title>Molecular sequence data of hepatitis B virus and genetic diversity after vaccination</article-title>. <source>Am J Epidemiol</source>. <year>2009</year>;<volume>170</volume>(<issue>12</issue>):<fpage>1455</fpage>&#x02013;<lpage>63</lpage>.<pub-id pub-id-type="pmid">19910379</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref008"><label>8</label><mixed-citation publication-type="journal"><name><surname>Rich</surname><given-names>SN</given-names></name>, <name><surname>Richards</surname><given-names>V</given-names></name>, <name><surname>Mavian</surname><given-names>C</given-names></name>, <name><surname>Rife Magalis</surname><given-names>B</given-names></name>, <name><surname>Grubaugh</surname><given-names>N</given-names></name>, <name><surname>Rasmussen</surname><given-names>SA</given-names></name>, <etal>et al</etal>. <article-title>Application of phylodynamic tools to inform the public health response to COVID-19: qualitative analysis of expert opinions</article-title>. <source>JMIR Form Res</source>. <year>2023</year>;<volume>7</volume>:e39409. <comment>doi: </comment><pub-id pub-id-type="doi">10.2196/39409</pub-id>
<pub-id pub-id-type="pmid">36848460</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref009"><label>9</label><mixed-citation publication-type="journal"><name><surname>Kalia</surname><given-names>K</given-names></name>, <name><surname>Saberwal</surname><given-names>G</given-names></name>, <name><surname>Sharma</surname><given-names>G</given-names></name>. <article-title>The lag in SARS-CoV-2 genome submissions to GISAID</article-title>. <source>Nat Biotechnol</source>. <year>2021</year>;<volume>39</volume>(<issue>9</issue>):<fpage>1058</fpage>&#x02013;<lpage>60</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1038/s41587-021-01040-0</pub-id>
<pub-id pub-id-type="pmid">34376850</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref010"><label>10</label><mixed-citation publication-type="journal"><name><surname>Petrone</surname><given-names>ME</given-names></name>, <name><surname>Lucas</surname><given-names>C</given-names></name>, <name><surname>Menasche</surname><given-names>B</given-names></name>, Breban MI, <name><surname>Yildirim</surname><given-names>I</given-names></name>, <name><surname>Campbell</surname><given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Nonsystematic reporting biases of the SARS-CoV-2 variant mu could impact our understanding of the epidemiological dynamics of emerging variants</article-title>. <source>Genome Biol Evol</source>. <year>2023</year>;<volume>15</volume>(<issue>4</issue>):evad052. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/gbe/evad052</pub-id>
<pub-id pub-id-type="pmid">36974986</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref011"><label>11</label><mixed-citation publication-type="journal"><name><surname>Bastos</surname><given-names>LS</given-names></name>, <name><surname>Economou</surname><given-names>T</given-names></name>, <name><surname>Gomes</surname><given-names>MFC</given-names></name>, <name><surname>Villela</surname><given-names>DAM</given-names></name>, <name><surname>Coelho</surname><given-names>FC</given-names></name>, <name><surname>Cruz</surname><given-names>OG</given-names></name>, <etal>et al</etal>. <article-title>A modelling approach for correcting reporting delays in disease surveillance data</article-title>. <source>Stat Med</source>. <year>2019</year>;<volume>38</volume>(<issue>22</issue>):<fpage>4363</fpage>&#x02013;<lpage>77</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1002/sim.8303</pub-id>
<pub-id pub-id-type="pmid">31292995</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref012"><label>12</label><mixed-citation publication-type="journal"><name><surname>Pybus</surname><given-names>OG</given-names></name>, <name><surname>Rambaut</surname><given-names>A</given-names></name>, <name><surname>Harvey</surname><given-names>PH</given-names></name>. <article-title>An integrated framework for the inference of viral population history from reconstructed genealogies</article-title>. <source>Genetics</source>. <year>2000</year>;<volume>155</volume>(<issue>3</issue>):<fpage>1429</fpage>&#x02013;<lpage>37</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/155.3.1429</pub-id>
<pub-id pub-id-type="pmid">10880500</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref013"><label>13</label><mixed-citation publication-type="journal"><name><surname>Strimmer</surname><given-names>K</given-names></name>, <name><surname>Pybus</surname><given-names>OG</given-names></name>. <article-title>Exploring the demographic history of DNA sequences using the generalized skyline plot</article-title>. <source>Mol Biol Evol</source>. <year>2001</year>;<volume>18</volume>(<issue>12</issue>):<fpage>2298</fpage>&#x02013;<lpage>305</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a003776</pub-id>
<pub-id pub-id-type="pmid">11719579</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref014"><label>14</label><mixed-citation publication-type="journal"><name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Rambaut</surname><given-names>A</given-names></name>, <name><surname>Shapiro</surname><given-names>B</given-names></name>, <name><surname>Pybus</surname><given-names>OG</given-names></name>. <article-title>Bayesian coalescent inference of past population dynamics from molecular sequences</article-title>. <source>Mol Biol Evol</source>. <year>2005</year>;<volume>22</volume>(<issue>5</issue>):<fpage>1185</fpage>&#x02013;<lpage>92</lpage>.<pub-id pub-id-type="pmid">15703244</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref015"><label>15</label><mixed-citation publication-type="journal"><name><surname>Ho</surname><given-names>SYW</given-names></name>, <name><surname>Shapiro</surname><given-names>B</given-names></name>. <article-title>Skyline-plot methods for estimating demographic history from nucleotide sequences</article-title>. <source>Mol Ecol Resour</source>. <year>2011</year>;<volume>11</volume>(<issue>3</issue>):<fpage>423</fpage>&#x02013;<lpage>34</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/j.1755-0998.2011.02988.x</pub-id>
<pub-id pub-id-type="pmid">21481200</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref016"><label>16</label><mixed-citation publication-type="journal"><name><surname>Billenstein</surname><given-names>RJ</given-names></name>, <name><surname>H&#x000f6;hna</surname><given-names>S</given-names></name>. <article-title>Comparison of Bayesian coalescent skyline plot models for inferring demographic histories</article-title>. <source>Mol Biol Evol</source>. <year>2024</year>;<volume>41</volume>(<issue>5</issue>):msae073. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/msae073</pub-id>
<pub-id pub-id-type="pmid">38630635</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref017"><label>17</label><mixed-citation publication-type="journal"><name><surname>Karcher</surname><given-names>MD</given-names></name>, <name><surname>Palacios</surname><given-names>JA</given-names></name>, <name><surname>Bedford</surname><given-names>T</given-names></name>, <name><surname>Suchard</surname><given-names>MA</given-names></name>, <name><surname>Minin</surname><given-names>VN</given-names></name>. <article-title>Quantifying and mitigating the effect of preferential sampling on phylodynamic inference</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>3</issue>):e1004789. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1004789</pub-id>
<pub-id pub-id-type="pmid">26938243</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref018"><label>18</label><mixed-citation publication-type="journal"><name><surname>Karcher</surname><given-names>MD</given-names></name>, <name><surname>Carvalho</surname><given-names>LM</given-names></name>, <name><surname>Suchard</surname><given-names>MA</given-names></name>, <name><surname>Dudas</surname><given-names>G</given-names></name>, <name><surname>Minin</surname><given-names>VN</given-names></name>. <article-title>Estimating effective population size changes from preferentially sampled genetic sequences</article-title>. <source>PLoS Comput Biol</source>. <year>2020</year>;<volume>16</volume>(<issue>10</issue>):e1007774. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pcbi.1007774</pub-id>
<pub-id pub-id-type="pmid">33044955</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref019"><label>19</label><mixed-citation publication-type="journal"><name><surname>Cappello</surname><given-names>L</given-names></name>, <name><surname>Palacios</surname><given-names>JA</given-names></name>. <article-title>Adaptive preferential sampling in phylodynamics with an application to SARS-CoV-2</article-title>. <source>J Comput Graph Stat</source>. <year>2022</year>;<volume>31</volume>(<issue>2</issue>):<fpage>541</fpage>&#x02013;<lpage>52</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1080/10618600.2021.1987256</pub-id>
<pub-id pub-id-type="pmid">36035966</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref020"><label>20</label><mixed-citation publication-type="journal"><name><surname>Felsenstein</surname><given-names>J</given-names></name>. <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>J Mol Evol</source>. <year>1981</year>;<volume>17</volume>(<issue>6</issue>):<fpage>368</fpage>&#x02013;<lpage>76</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/BF01734359</pub-id>
<pub-id pub-id-type="pmid">7288891</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref021"><label>21</label><mixed-citation publication-type="journal"><name><surname>Lan</surname><given-names>S</given-names></name>, <name><surname>Palacios</surname><given-names>JA</given-names></name>, <name><surname>Karcher</surname><given-names>M</given-names></name>, <name><surname>Minin</surname><given-names>VN</given-names></name>, <name><surname>Shahbaba</surname><given-names>B</given-names></name>. <article-title>An efficient Bayesian inference framework for coalescent-based nonparametric phylodynamics</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>20</issue>):<fpage>3282</fpage>&#x02013;<issue>9</issue>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/bioinformatics/btv378</pub-id>
<pub-id pub-id-type="pmid">26093147</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref022"><label>22</label><mixed-citation publication-type="other">Kingman JFC. <article-title>The coalescent</article-title>. <source>Stochast Process Appl</source>. <year>1982</year>;<issue>13</issue>(<issue>3</issue>):<fpage>235</fpage>&#x02013;<lpage>48</lpage>. <pub-id pub-id-type="doi">10.1016/0304-4149(82)90011-4</pub-id></mixed-citation></ref><ref id="pcbi.1012970.ref023"><label>23</label><mixed-citation publication-type="other">Rodrigo A, Felsenstein J. <article-title>The evolution of HIV</article-title>. <year>1999</year>. P. <fpage>233</fpage>&#x02013;<lpage>72</lpage>.</mixed-citation></ref><ref id="pcbi.1012970.ref024"><label>24</label><mixed-citation publication-type="confproc"><name><surname>Palacios</surname><given-names>JA</given-names></name>, <name><surname>Minin</surname><given-names>VN</given-names></name>. <article-title>Integrated nested Laplace approximation for Bayesian nonparametric phylodynamics</article-title>. In: <conf-name>Proceedings of the Twenty-Eighth Conference on Uncertainty in Artificial Intelligence</conf-name>. AUAI Press. <year>2012</year>. <fpage>726</fpage>&#x02013;<lpage>35</lpage>.</mixed-citation></ref><ref id="pcbi.1012970.ref025"><label>25</label><mixed-citation publication-type="journal"><name><surname>Gill</surname><given-names>MS</given-names></name>, <name><surname>Lemey</surname><given-names>P</given-names></name>, <name><surname>Faria</surname><given-names>NR</given-names></name>, <name><surname>Rambaut</surname><given-names>A</given-names></name>, <name><surname>Shapiro</surname><given-names>B</given-names></name>, <name><surname>Suchard</surname><given-names>MA</given-names></name>. <article-title>Improving Bayesian population dynamics inference: a coalescent-based model for multiple loci</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>;<volume>30</volume>(<issue>3</issue>):<fpage>713</fpage>&#x02013;<lpage>24</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/molbev/mss265</pub-id>
<pub-id pub-id-type="pmid">23180580</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref026"><label>26</label><mixed-citation publication-type="journal"><name><surname>Faulkner</surname><given-names>JR</given-names></name>, <name><surname>Magee</surname><given-names>AF</given-names></name>, <name><surname>Shapiro</surname><given-names>B</given-names></name>, <name><surname>Minin</surname><given-names>VN</given-names></name>. <article-title>Horseshoe-based Bayesian nonparametric estimation of effective population size trajectories</article-title>. <source>Biometrics</source>. <year>2020</year>;<volume>76</volume>(<issue>3</issue>):<fpage>677</fpage>&#x02013;<lpage>90</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/biom.13276</pub-id>
<pub-id pub-id-type="pmid">32277713</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref027"><label>27</label><mixed-citation publication-type="journal"><name><surname>Suchard</surname><given-names>MA</given-names></name>, <name><surname>Lemey</surname><given-names>P</given-names></name>, <name><surname>Baele</surname><given-names>G</given-names></name>, <name><surname>Ayres</surname><given-names>DL</given-names></name>, <name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Rambaut</surname><given-names>A</given-names></name>. <article-title>Bayesian phylogenetic and phylodynamic data integration using BEAST 1.10</article-title>. <source>Virus Evol</source>. <year>2018</year>;<volume>4</volume>(<issue>1</issue>):vey016. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/ve/vey016</pub-id>
<pub-id pub-id-type="pmid">29942656</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref028"><label>28</label><mixed-citation publication-type="journal"><name><surname>Karcher</surname><given-names>MD</given-names></name>, <name><surname>Palacios</surname><given-names>JA</given-names></name>, <name><surname>Lan</surname><given-names>S</given-names></name>, <name><surname>Minin</surname><given-names>VN</given-names></name>. <article-title>phylodyn: an R package for phylodynamic simulation and inference</article-title>. <source>Mol Ecol Resour</source>. <year>2017</year>;<volume>17</volume>(<issue>1</issue>):<fpage>96</fpage>&#x02013;<lpage>100</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1111/1755-0998.12630</pub-id>
<pub-id pub-id-type="pmid">27801980</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref029"><label>29</label><mixed-citation publication-type="journal"><name><surname>Slatkin</surname><given-names>M</given-names></name>, <name><surname>Hudson</surname><given-names>RR</given-names></name>. <article-title>Pairwise comparisons of mitochondrial DNA sequences in stable and exponentially growing populations</article-title>. <source>Genetics</source>. <year>1991</year>;<volume>129</volume>(<issue>2</issue>):<fpage>555</fpage>&#x02013;<lpage>62</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/129.2.555</pub-id>
<pub-id pub-id-type="pmid">1743491</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref030"><label>30</label><mixed-citation publication-type="journal"><name><surname>Shu</surname><given-names>Y</given-names></name>, <name><surname>McCauley</surname><given-names>J</given-names></name>. <article-title>GISAID: Global initiative on sharing all influenza data - from vision to reality</article-title>. <source>Euro Surveill</source>. <year>2017</year>;<volume>22</volume>(<issue>13</issue>):<year>30494</year>. <comment>doi: </comment><pub-id pub-id-type="doi">10.2807/1560-7917.ES.2017.22.13.30494</pub-id>
<pub-id pub-id-type="pmid">28382917</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref031"><label>31</label><mixed-citation publication-type="journal"><name><surname>Hasegawa</surname><given-names>M</given-names></name>, <name><surname>Kishino</surname><given-names>H</given-names></name>, <name><surname>Yano</surname><given-names>T</given-names></name>. <article-title>Dating of the human-ape splitting by a molecular clock of mitochondrial DNA</article-title>. <source>J Mol Evol</source>. <year>1985</year>;<volume>22</volume>(<issue>2</issue>):<fpage>160</fpage>&#x02013;<lpage>74</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1007/BF02101694</pub-id>
<pub-id pub-id-type="pmid">3934395</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref032"><label>32</label><mixed-citation publication-type="journal"><name><surname>Drummond</surname><given-names>AJ</given-names></name>, <name><surname>Nicholls</surname><given-names>GK</given-names></name>, <name><surname>Rodrigo</surname><given-names>AG</given-names></name>, <name><surname>Solomon</surname><given-names>W</given-names></name>. <article-title>Estimating mutation parameters, population history and genealogy simultaneously from temporally spaced sequence data</article-title>. <source>Genetics</source>. <year>2002</year>;<volume>161</volume>(<issue>3</issue>):<fpage>1307</fpage>&#x02013;<lpage>20</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/genetics/161.3.1307</pub-id>
<pub-id pub-id-type="pmid">12136032</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref033"><label>33</label><mixed-citation publication-type="journal"><name><surname>Neher</surname><given-names>RA</given-names></name>. <article-title>Contributions of adaptation and purifying selection to SARS-CoV-2 evolution</article-title>. <source>Virus Evol</source>. <year>2022</year>;<volume>8</volume>(<issue>2</issue>):veac113. <comment>doi: </comment><pub-id pub-id-type="doi">10.1093/ve/veac113</pub-id>
<pub-id pub-id-type="pmid">37593203</pub-id>
</mixed-citation></ref><ref id="pcbi.1012970.ref034"><label>34</label><mixed-citation publication-type="journal"><name><surname>Stadler</surname><given-names>T</given-names></name>, <name><surname>K&#x000fc;hnert</surname><given-names>D</given-names></name>, <name><surname>Bonhoeffer</surname><given-names>S</given-names></name>, <name><surname>Drummond</surname><given-names>AJ</given-names></name>. <article-title>Birth-death skyline plot reveals temporal changes of epidemic spread in HIV and hepatitis C virus (HCV)</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2013</year>;<volume>110</volume>(<issue>1</issue>):<fpage>228</fpage>&#x02013;<lpage>33</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1073/pnas.1207965110</pub-id>
<pub-id pub-id-type="pmid">23248286</pub-id>
</mixed-citation></ref></ref-list></back></article>