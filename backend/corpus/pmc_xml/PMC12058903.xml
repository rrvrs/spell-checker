<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Bull Math Biol</journal-id><journal-id journal-id-type="iso-abbrev">Bull Math Biol</journal-id><journal-title-group><journal-title>Bulletin of Mathematical Biology</journal-title></journal-title-group><issn pub-type="ppub">0092-8240</issn><issn pub-type="epub">1522-9602</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmid">40332627</article-id><article-id pub-id-type="pmc">PMC12058903</article-id>
<article-id pub-id-type="publisher-id">1445</article-id><article-id pub-id-type="doi">10.1007/s11538-025-01445-x</article-id><article-categories><subj-group subj-group-type="heading"><subject>Original Article</subject></subj-group></article-categories><title-group><article-title>Matching Habitat Choice and the Evolution of a Species&#x02019; Range</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1412-957X</contrib-id><name><surname>Shirani</surname><given-names>Farshad</given-names></name><address><email>f.shirani@gatech.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Miller</surname><given-names>Judith R.</given-names></name><xref ref-type="aff" rid="Aff2">2</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01zkghx44</institution-id><institution-id institution-id-type="GRID">grid.213917.f</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 4943</institution-id><institution>School of Mathematics, </institution><institution>Georgia Institute of Technology, </institution></institution-wrap>Atlanta, GA 30332 USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/05vzafd60</institution-id><institution-id institution-id-type="GRID">grid.213910.8</institution-id><institution-id institution-id-type="ISNI">0000 0001 1955 1644</institution-id><institution>Department of Mathematics and Statistics, </institution><institution>Georgetown University, </institution></institution-wrap>Washington, DC 20057 USA </aff></contrib-group><pub-date pub-type="epub"><day>7</day><month>5</month><year>2025</year></pub-date><pub-date pub-type="pmc-release"><day>7</day><month>5</month><year>2025</year></pub-date><pub-date pub-type="ppub"><year>2025</year></pub-date><volume>87</volume><issue>6</issue><elocation-id>70</elocation-id><history><date date-type="received"><day>26</day><month>6</month><year>2024</year></date><date date-type="accepted"><day>2</day><month>4</month><year>2025</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2025, corrected publication 2025</copyright-statement><copyright-year>2025</copyright-year><license><ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Natural selection is not the only mechanism that promotes adaptation of an organism to its environment. Another mechanism is matching habitat choice, in which individuals sense and disperse toward habitat best suited to their phenotype. This can in principle facilitate rapid adaptation, enhance range expansion, and promote genetic differentiation, reproductive isolation, and speciation. However, empirical evidence that confirms the evolution of matching habitat choice in nature is limited. Here we obtain theoretical evidence that phenotype-optimal dispersal, a particular form of matching habitat choice, is likely to evolve only in the presence of a steep environmental gradient. Such a gradient may be steeper than the gradient the majority of species typically experience in nature, adding to the collection of possible explanations for the scarcity of evidence for matching habitat choice. We draw this conclusion from numerical solutions of a system of deterministic partial differential equations for a population&#x02019;s density along with the mean and variance of a fitness-related quantitative phenotypic trait such as body size. In steep gradients, we find that phenotype-optimal dispersal facilitates rapid adaptation on single-generation time scales, reduces within-population trait variation, increases range expansion speed, and enhances the chance of survival in rapidly changing environments. Moreover, it creates a directed gene flow that compensates for the maladaptive core-to-edge effects of random gene flow caused by random movements. These results suggest that adaptive gene flow to range margins, together with substantially reduced trait variation at central populations, may be hallmarks of phenotype-optimal dispersal in natural populations. Further, slowly-growing species under strong natural selection may particularly benefit from evolving phenotype-optimal dispersal.</p><sec><title>Supplementary Information</title><p>The online version contains supplementary material available at 10.1007/s11538-025-01445-x.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Adaptive dispersal</kwd><kwd>Range dynamics</kwd><kwd>Genetic variation</kwd><kwd>Competition</kwd><kwd>Evolutionary partial differential equations</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) under exclusive licence to Society for Mathematical Biology 2025</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">A species&#x02019; range evolves through complex eco-evolutionary processes, the understanding of which is crucial for predicting species&#x02019; response to climate change, informing conservation efforts for preserving biodiversity, and developing strategies for controlling invasive species (MacArthur <xref ref-type="bibr" rid="CR77">1972</xref>; Gaston <xref ref-type="bibr" rid="CR46">2003</xref>; Brown et&#x000a0;al. <xref ref-type="bibr" rid="CR17">1996</xref>; Hoffmann and Blows <xref ref-type="bibr" rid="CR53">1994</xref>; Kirkpatrick and Barton <xref ref-type="bibr" rid="CR63">1997</xref>; Pulliam <xref ref-type="bibr" rid="CR89">2000</xref>; Keitt et&#x000a0;al. <xref ref-type="bibr" rid="CR67">2001</xref>; Sexton et&#x000a0;al. <xref ref-type="bibr" rid="CR111">2009</xref>; Bridle and Vines <xref ref-type="bibr" rid="CR19">2007</xref>; Miller et&#x000a0;al. <xref ref-type="bibr" rid="CR76">2020</xref>; Angert et&#x000a0;al. <xref ref-type="bibr" rid="CR1">2020</xref>; Ponchon and Travis <xref ref-type="bibr" rid="CR88">2022</xref>; Rafajlovi&#x00107; et&#x000a0;al. <xref ref-type="bibr" rid="CR90">2022</xref>; Holt and Keitt <xref ref-type="bibr" rid="CR57">2005</xref>; Godsoe et&#x000a0;al. <xref ref-type="bibr" rid="CR49">2017</xref>; Louthan et&#x000a0;al. <xref ref-type="bibr" rid="CR71">2015</xref>; Fronhofer and Altermatt <xref ref-type="bibr" rid="CR42">2015</xref>; Case et&#x000a0;al. <xref ref-type="bibr" rid="CR23">2005</xref>; Duckworth and Badyaev <xref ref-type="bibr" rid="CR31">2007</xref>; Haddad et&#x000a0;al. <xref ref-type="bibr" rid="CR54">2015</xref>; Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>). Dispersal is one of the key ecological factors involved in determining a species&#x02019; range. Since dispersal creates gene flow, it affects the spatial dynamics of genetic variance and local adaptation, as well as population dynamic measures such as range expansion rates (Slatkin <xref ref-type="bibr" rid="CR108">1985</xref>, <xref ref-type="bibr" rid="CR109">1987</xref>; Holt and Gomulkiewicz <xref ref-type="bibr" rid="CR56">1997</xref>; Kirkpatrick and Barton <xref ref-type="bibr" rid="CR63">1997</xref>; Gomulkiewicz et&#x000a0;al. <xref ref-type="bibr" rid="CR48">1999</xref>; Bowler and Benton <xref ref-type="bibr" rid="CR8">2005</xref>; Ronce <xref ref-type="bibr" rid="CR95">2007</xref>; Bonte et&#x000a0;al. <xref ref-type="bibr" rid="CR20">2012</xref>; Baguette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2013</xref>; Jacob et&#x000a0;al. <xref ref-type="bibr" rid="CR60">2015</xref>; Kawecki and Ebert <xref ref-type="bibr" rid="CR65">2004</xref>; Okubo and Levin <xref ref-type="bibr" rid="CR83">2001</xref>; Pellerin et&#x000a0;al. <xref ref-type="bibr" rid="CR85">2019</xref>).</p><p id="Par3">The simplest types of dispersal, including the archetype of diffusive spread, are in theory independent of individual, population, and environmental characteristics (Lowe and McPeek <xref ref-type="bibr" rid="CR74">2014</xref>). In general, random dispersal of individuals to other habitat locations irrespective of their genotypes imposes a <italic>migration load</italic> on the population&#x02019;s mean fitness (Edelaar and Bolnick <xref ref-type="bibr" rid="CR35">2012</xref>; Bolnick and Otto <xref ref-type="bibr" rid="CR15">2013</xref>; Lenormand <xref ref-type="bibr" rid="CR72">2002</xref>; Bonte et&#x000a0;al. <xref ref-type="bibr" rid="CR20">2012</xref>). By contrast, a population&#x02019;s fitness increases, most generally, when its individuals evolve adaptive dispersal strategies based on their environment structure, their own characteristics, and their intra- and interspecific interactions (Levins <xref ref-type="bibr" rid="CR73">1963</xref>; Bowler and Benton <xref ref-type="bibr" rid="CR8">2005</xref>; Cote et&#x000a0;al. <xref ref-type="bibr" rid="CR21">2017</xref>; Edelaar and Bolnick <xref ref-type="bibr" rid="CR35">2012</xref>; Saastamoinen et&#x000a0;al. <xref ref-type="bibr" rid="CR101">2018</xref>; Bonte et&#x000a0;al. <xref ref-type="bibr" rid="CR20">2012</xref>; Clobert et&#x000a0;al. <xref ref-type="bibr" rid="CR25">2009</xref>; Travis et&#x000a0;al. <xref ref-type="bibr" rid="CR113">2012</xref>; Baguette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2013</xref>; Baines et&#x000a0;al. <xref ref-type="bibr" rid="CR14">2019</xref>; Lustenhouwer et&#x000a0;al. <xref ref-type="bibr" rid="CR75">2023</xref>; Ronce <xref ref-type="bibr" rid="CR95">2007</xref>; Holt <xref ref-type="bibr" rid="CR58">1985</xref>, <xref ref-type="bibr" rid="CR59">1987</xref>; Jaenike and Holt <xref ref-type="bibr" rid="CR61">1991</xref>; Rausher <xref ref-type="bibr" rid="CR91">1984</xref>). Such convoluted evolution of dispersal&#x02014;as a complex multi-dimensional phenotype comprising of different components (propensity to disperse, distance and direction of movements, and settlement choice (Saastamoinen et&#x000a0;al. <xref ref-type="bibr" rid="CR101">2018</xref>))&#x02014;is driven by the balance between the cost incurred at each stage of dispersal and the overall benefit acquired from dispersal (Bonte et&#x000a0;al. <xref ref-type="bibr" rid="CR20">2012</xref>; Bowler and Benton <xref ref-type="bibr" rid="CR8">2005</xref>; Cote et&#x000a0;al. <xref ref-type="bibr" rid="CR21">2017</xref>; Garant et&#x000a0;al. <xref ref-type="bibr" rid="CR47">2007</xref>; Rosenzweig <xref ref-type="bibr" rid="CR96">1981</xref>).</p><p id="Par4">Empirical evidence in a variety of species confirms that individuals often bias their dispersal towards preferred habitat locations (Holt <xref ref-type="bibr" rid="CR59">1987</xref>; Fretwell <xref ref-type="bibr" rid="CR45">1972</xref>; Ronce <xref ref-type="bibr" rid="CR95">2007</xref>; Bolnick and Otto <xref ref-type="bibr" rid="CR15">2013</xref>; Cote et&#x000a0;al. <xref ref-type="bibr" rid="CR21">2017</xref>; Jacob et&#x000a0;al. <xref ref-type="bibr" rid="CR60">2015</xref>; Armsworth and Roughgarden <xref ref-type="bibr" rid="CR5">2008</xref>; Rice and Salt <xref ref-type="bibr" rid="CR100">1990</xref>; Lowe and McPeek <xref ref-type="bibr" rid="CR74">2014</xref>; Pellerin et&#x000a0;al. <xref ref-type="bibr" rid="CR85">2019</xref>). To carry out such fitness-associated dispersal, individuals of such species must perceive their internal phenotypic traits, and must efficiently orient their movements by actively using different sources of information, such as abiotic cues, landscape landmarks, and presence and behavior of conspecifics. For instance, nocturnal snakes can sense the temperature and physical structure of rocks to move to thermally preferable habitats (Clobert et&#x000a0;al. <xref ref-type="bibr" rid="CR25">2009</xref>; Ponchon and Travis <xref ref-type="bibr" rid="CR88">2022</xref>; Bowler and Benton <xref ref-type="bibr" rid="CR8">2005</xref>).</p><p id="Par5">Here, we propose and numerically study a deterministic model of a species&#x02019; range evolution under a fairly idealized habitat-matching strategy. The dispersal strategy that we study has been hypothesized to have substantial and distinctive effects on species evolutionary range dynamics (Edelaar et&#x000a0;al. <xref ref-type="bibr" rid="CR41">2008</xref>). We demonstrate such effects through numerical simulations and identify conditions under which this adaptive dispersal strategy will be sufficiently beneficial to evolve.</p><sec id="Sec2"><title>Matching Habitat Choice: An Adaptive Dispersal Strategy</title><p id="Par6">In the most idealized version of adaptive dispersal, individuals can perceive all components of their absolute fitness and are able to move freely. Therefore, they can climb local fitness gradients and achieve their maximum expected fitness (Holt <xref ref-type="bibr" rid="CR58">1985</xref>, <xref ref-type="bibr" rid="CR59">1987</xref>; Fretwell <xref ref-type="bibr" rid="CR45">1972</xref>; Rosenzweig <xref ref-type="bibr" rid="CR96">1981</xref>; Ruxton and Rohani <xref ref-type="bibr" rid="CR98">1999</xref>; Armsworth and Roughgarden <xref ref-type="bibr" rid="CR4">2005</xref>, <xref ref-type="bibr" rid="CR5">2008</xref>; Armsworth <xref ref-type="bibr" rid="CR6">2009</xref>; Ravign&#x000e9; et&#x000a0;al. <xref ref-type="bibr" rid="CR92">2009</xref>). However, acquiring information about all major components of fitness is infeasible. In a still idealized but more realistic conception, dispersing individuals move toward habitat that is best for their fitness-related phenotypes. For example, medium ground finches with deeper bills, which can crack larger seeds, tend to settle in areas richer in large-seeded plants to increase their food intake (Edelaar and Bolnick <xref ref-type="bibr" rid="CR36">2019</xref>). Therefore, with this type of phenotype-dependent adaptive dispersal&#x02014;which is often referred to as <italic>matching habitat choice</italic> (Edelaar et&#x000a0;al. <xref ref-type="bibr" rid="CR41">2008</xref>; Ravign&#x000e9; et&#x000a0;al. <xref ref-type="bibr" rid="CR94">2004</xref>)&#x02014;the expected performance of the individuals is maximized.</p><p id="Par7">Although the maximized performance under matching habitat choice is also likely to lead to a considerable increase in the individuals&#x02019; fitness (Edelaar and Bolnick <xref ref-type="bibr" rid="CR36">2019</xref>)&#x02014;due to the presumed correlation between individuals&#x02019; phenotype and fitness&#x02014;it is worth clarifying the difference between matching habitat choice (as phenotype-optimal dispersal) and fitness-optimal dispersal. Matching habitat choice is a phenotype-environment matching strategy that can involve following an environmental gradient in optimum phenotype. This is not necessarily the same as following the gradient in optimal (maximum) fitness. In general, as we described above, matching habitat choice is often conceptualized as a &#x0201c;performance&#x0201d;-maximizing but not necessarily a &#x0201c;fitness&#x0201d;-maximizing strategy. For example, grasshoppers choosing a habitat based on a match between their color and the thermal radiation of the habitat are not necessarily maximizing their fitness by doing so. In fact, many factors affecting population fitness, such as resource availability, mating success, fecundity, and importantly, competition do not directly contribute to adopting a matching habitat choice strategy.</p><p id="Par8">Although strong evidence for matching habitat choice in nature is still limited, a growing number of experimental and empirical studies have identified it in diverse taxa. For instance, using microcosms of a ciliate species which shows genetic variability in performance along a thermal gradient, Jacob et&#x000a0;al. (<xref ref-type="bibr" rid="CR62">2017</xref>) have experimentally shown that local adaptation to the upper margin of the species&#x02019; thermal niche is favored by dispersal with matching habitat choice, whereas it is hindered under random dispersal. Similarly, in a semi-natural warming experiment with a model species of reptiles, Bestion et&#x000a0;al. (<xref ref-type="bibr" rid="CR10">2015</xref>) have shown that individuals disperse to warmer or cooler habitats based on their preferred temperature. In another study, Camacho et&#x000a0;al. (<xref ref-type="bibr" rid="CR28">2020</xref>) performed a color manipulation experiment on grasshoppers to test for camouflage-based background matching in an urban mosaic of dark and pale pavements. They found that black-painted grasshoppers mostly chose to settle in dark asphalt, whereas white-painted ones chose pale pavement&#x02014;the same matching substrate choice behavior observed naturally in unmanipulated morphs. A similar study by Karpestam et&#x000a0;al. (<xref ref-type="bibr" rid="CR69">2012</xref>) on color-manipulated pygmy grasshoppers over a solar radiation mosaic demonstrated that black-painted individuals tended to reside in habitats with less radiation, and white-painted females had more hatchlings than black-painted ones in increased radiation treatments. Color-dependent habitat choice has also been identified in dark and pale barn owls (Dreiss et&#x000a0;al. <xref ref-type="bibr" rid="CR30">2012</xref>). For a species of nomadic crossbill bird, matching habitat choice has been proposed as a contributor to rapid diversification of ecotypes; this hypothesis was supported by mark-recapture data (Benkman <xref ref-type="bibr" rid="CR12">2017</xref>).</p></sec><sec id="Sec3"><title>Eco-evolutionary Impacts of Matching Habitat Choice</title><p id="Par9">With matching habitat choice, individuals sort themselves across the environment to minimize their phenotype-environment mismatch. This means that, matching habitat choice is in fact an adaptation mechanism that operates at the individual level and, in principle, results in rapid population adaptation on <italic>within-generation</italic> timescales&#x02014;that is, a strong match between mean population phenotype and environment optimum phenotype can occur within one generation time. This mode of rapid adaptation is essentially different from adaptation by natural selection, which operates at the population level. Although, in essence, the process of adaptation by natural selection also takes place within generations, plausible levels of natural selection often require many generations to cause a significant level of mean population phenotype-environment match. Importantly, with matching habitat choice, the preferential sorting across the environment also leads to substantial inter-individual variability in the distance and direction of dispersal, which creates specifically directed nonrandom gene flow in the population (Edelaar and Bolnick <xref ref-type="bibr" rid="CR36">2019</xref>; Bolnick and Otto <xref ref-type="bibr" rid="CR15">2013</xref>; Edelaar and Bolnick <xref ref-type="bibr" rid="CR35">2012</xref>; Holt <xref ref-type="bibr" rid="CR59">1987</xref>; Endler <xref ref-type="bibr" rid="CR38">1977</xref>)</p><p id="Par10">With these phenomena in mind, researchers have used verbal models and agent-based simulations to explore the implications of matching habitat choice for ecological and evolutionary dynamics. The most thoroughly developed part of the resulting theory concerns the partitioning of genetic variance across space and its consequences. Indeed, theory suggests that non-random (directed) gene flow induced by matching habitat choice can compensate for, or even reverse, the homogenizing (maladaptive) effects of gene flow caused by diffusive (random) dispersal. This effect can reduce standing genetic variation within locally adapted subpopulations, while increasing genetic divergence among subpopulations (Edelaar et&#x000a0;al. <xref ref-type="bibr" rid="CR41">2008</xref>; Edelaar and Bolnick <xref ref-type="bibr" rid="CR35">2012</xref>, <xref ref-type="bibr" rid="CR36">2019</xref>; Jacob et&#x000a0;al. <xref ref-type="bibr" rid="CR60">2015</xref>; Holt <xref ref-type="bibr" rid="CR59">1987</xref>; Bolnick and Otto <xref ref-type="bibr" rid="CR15">2013</xref>; Garant et&#x000a0;al. <xref ref-type="bibr" rid="CR50">2005</xref>; Jacob et&#x000a0;al. <xref ref-type="bibr" rid="CR62">2017</xref>; Felsenstein <xref ref-type="bibr" rid="CR43">1976</xref>; Hedrick <xref ref-type="bibr" rid="CR55">1986</xref>; Kawecki and Ebert <xref ref-type="bibr" rid="CR65">2004</xref>; Cote et&#x000a0;al. <xref ref-type="bibr" rid="CR21">2017</xref>). At the metapopulation scale, the enhanced genetic differentiation in turn can indirectly cause assortative mating by decreasing reproductive interactions among local populations. The resulting reproductive isolation and phenotypic segregation can eventually lead to sympatric speciation and increased biodiversity (Maynard Smith <xref ref-type="bibr" rid="CR80">1966</xref>; Endler <xref ref-type="bibr" rid="CR38">1977</xref>; Holt <xref ref-type="bibr" rid="CR59">1987</xref>; Rice and Salt <xref ref-type="bibr" rid="CR99">1988</xref>, <xref ref-type="bibr" rid="CR100">1990</xref>; Rice and Hostert <xref ref-type="bibr" rid="CR93">1993</xref>; Coyne <xref ref-type="bibr" rid="CR27">1992</xref>; Kirkpatrick and Ravign&#x000e9; <xref ref-type="bibr" rid="CR68">2002</xref>; Bolnick and Otto <xref ref-type="bibr" rid="CR15">2013</xref>; Nicolaus and Edelaar <xref ref-type="bibr" rid="CR81">2018</xref>; Edelaar et&#x000a0;al. <xref ref-type="bibr" rid="CR41">2008</xref>, <xref ref-type="bibr" rid="CR39">2023</xref>; Berner and Thibert-Plante <xref ref-type="bibr" rid="CR18">2015</xref>; Ravign&#x000e9; et&#x000a0;al. <xref ref-type="bibr" rid="CR92">2009</xref>. In addition, the adaptation promoted by phenotype-environment matching can enhance species persistence under temporal climatic changes in the environment (Pellerin et&#x000a0;al. <xref ref-type="bibr" rid="CR85">2019</xref>; Edelaar and Bolnick <xref ref-type="bibr" rid="CR36">2019</xref>; Nicolaus and Edelaar <xref ref-type="bibr" rid="CR81">2018</xref>; Edelaar and Bolnick <xref ref-type="bibr" rid="CR35">2012</xref>; Jacob et&#x000a0;al. <xref ref-type="bibr" rid="CR62">2017</xref>; Bonte et&#x000a0;al. <xref ref-type="bibr" rid="CR20">2012</xref>).</p><p id="Par11">By contrast, predicting how matching habitat choice will influence the range dynamics of a species in a heterogeneous environment is difficult. This is partly because under matching habitat choice, increased local competition between phenotypically similar individuals counterbalances the adaptive effects of directed gene flow on fitness. In spatially structured populations, such interactions can be essentially different in central versus marginal populations. Non-quantitative predictions of the consequences of matching habitat choice on range dynamics can thus fail or mislead&#x02014;even at the basic level of indicating whether its effects are substantial enough to warrant attention. Rather, quantitative theory is needed for understanding the net effect of matching habitat choice on adaptive evolution. For predicting such outcomes as the speed and ultimate extent of range shifts, developing the theory is crucial.</p></sec><sec id="Sec4"><title>Present Work: When and How Matching Habitat Choice Influences Species Range Evolution</title><p id="Par12">In the present work we propose and numerically study a deterministic partial differential equation (PDE) model for the spatiotemporal dynamics of the moments of a fitness-related quantitative trait in the presence of matching habitat choice. The predictive benefit of our model is that it allows us to quantify the extent to which matching habitat choice facilitates adaptation and speeds up range expansion. We model dispersal as a combination of diffusion (random dispersal) and a particular form of matching habitat choice that we call <italic>phenotype-optimal dispersal</italic>. In the most idealized formalism of matching habitat choice, individuals are able to assess the entire available habitat and move to the globally optimum location. We make the still idealized, but more realistic, assumption that individuals can only locally assess their immediate surrounding environment and direct their movement toward their maximally matching neighborhood. Continuously repeating such assessments and movements, the individuals eventually settle in a location which is the best compared with other locations within their perceivable surroundings. We model this phenotype-optimal dispersal by allowing the individuals to follow the direction of a gradient in environmental optimum phenotype. Individuals who perceive both a phenotype-environment mismatch and a non-zero environmental gradient move in the direction of the gradient, which gives a maximal (local) decrease in their perceived mismatch. If the environmental gradient is zero, or the individuals are not sensitive to it, then there will be no directed dispersal in our model as all surrounding areas appear to be equally preferable to the individuals.</p><p id="Par13">We aim to characterize conditions under which phenotype-optimal dispersal is or is not sufficiently beneficial to evolve in nature. In order to do so, we use our model to describe the effects of phenotype-optimal dispersal on population dynamics measures such as expansion wave speed and equilibrium population density, as well as evolutionary processes such as rates of local adaptation and phenotypic differentiation. We focus on a continuous environment that varies in space but not in time. We also explore scenarios with repeated abrupt environmental shifts or fragmented habitat. To isolate the effects of matching habitat choice, we compare the outcomes of numerical simulations including it with the outcomes of simulations that include only diffusive dispersal.</p><p id="Par14">We find that in shallow to moderate environmental gradients, phenotype-optimal dispersal has only mild effects on invasion speeds and adaptation rates. By contrast, it has several noteworthy effects in strong to extreme environmental gradients. There, it substantially increases the rate and extent of local adaptation, especially at range margins. It also reduces local phenotypic variance and increases the speed of range expansions. However, it has little effect on equilibrium population densities even in the case of a steep environmental gradient. Finally, we find that matching habitat choice in this case can greatly enhance the range expansion capacity and improve the survival prospects of a population under periodic environmental fluctuations.</p></sec></sec><sec id="Sec5"><title>Model Description</title><p id="Par15">We base our model on our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>), which was an extension of the seminal works of Pease et&#x000a0;al. (<xref ref-type="bibr" rid="CR87">1989</xref>), Kirkpatrick and Barton (<xref ref-type="bibr" rid="CR63">1997</xref>), and Case and Taper (<xref ref-type="bibr" rid="CR29">2000</xref>) and allowed us to study the adaptive range dynamics of a community of interacting species under an environmental gradient. Since in the present work we investigate the range evolution of a solitary species, we use a reduction of our previous multi-species model to a single species case. We incorporate into the model new components that represent the effects of phenotype-optimal dispersal. We describe only those details of our previous work that are necessary for a clear description of the new model. We refer the reader to our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>) for further details.</p><p id="Par16">Before specifying our model equations, it is worth recognizing that they are rather complex. This is because they include the contributions of three eco-evolutionary processes not included in the seminal work of Kirkpatrick and Barton (<xref ref-type="bibr" rid="CR63">1997</xref>). The first of these is, of course, phenotype-optimal dispersal itself. The second is evolving trait variance. We include this because matching habitat choice is known to have substantial impacts on trait variance, which our work is aimed to quantify. Moreover, it is known that including the evolution of trait variance yields range dynamics very different from what occurs when variance is (arbitrarily) held fixed as in the work of Kirkpatrick and Barton (<xref ref-type="bibr" rid="CR63">1997</xref>); see for example Barton (<xref ref-type="bibr" rid="CR7">2001</xref>), Shirani and Miller (<xref ref-type="bibr" rid="CR110">2022</xref>). The third is phenotype-dependent competition. We include this because competition is widely known as a determinant of range limits. We specifically make competition phenotype-dependent so that we can quantitatively resolve possibly conflicting effects of dispersal and competition when both depend on phenotype.</p><p id="Par17">We model the <inline-formula id="IEq1"><alternatives><tex-math id="d33e694">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{m}$$\end{document}</tex-math><mml:math id="d33e699"><mml:mtext>m</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq1.gif"/></alternatives></inline-formula>-dimensional habitat of the species by an open rectangle <inline-formula id="IEq2"><alternatives><tex-math id="d33e703">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega \subset \mathbb {R}^{\textrm{m}}$$\end{document}</tex-math><mml:math id="d33e708"><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>&#x02282;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq2.gif"/></alternatives></inline-formula>, <inline-formula id="IEq3"><alternatives><tex-math id="d33e720">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{m}\in \{1,2,3\}$$\end{document}</tex-math><mml:math id="d33e725"><mml:mrow><mml:mtext>m</mml:mtext><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq3.gif"/></alternatives></inline-formula>. Although in general the habitat can be three-dimensional, in this study we only consider one- and two-dimensional habitats. We model the adaptive range dynamics of the species at each location <inline-formula id="IEq4"><alternatives><tex-math id="d33e740">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x = (x_1,\dots , x_{\textrm{m}}) \in \Omega $$\end{document}</tex-math><mml:math id="d33e745"><mml:mrow><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq4.gif"/></alternatives></inline-formula> and time <inline-formula id="IEq5"><alternatives><tex-math id="d33e767">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in [0, T]$$\end{document}</tex-math><mml:math id="d33e772"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq5.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq6"><alternatives><tex-math id="d33e786">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_i$$\end{document}</tex-math><mml:math id="d33e791"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq6.gif"/></alternatives></inline-formula>, <inline-formula id="IEq7"><alternatives><tex-math id="d33e797">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{1, \dots , \textrm{m}\}$$\end{document}</tex-math><mml:math id="d33e802"><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mtext>m</mml:mtext><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq7.gif"/></alternatives></inline-formula>, denotes the coordinate of the location <italic>x</italic> along the <italic>i</italic>th dimension of the geographic space, and <inline-formula id="IEq8"><alternatives><tex-math id="d33e823">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T&#x0003e;0$$\end{document}</tex-math><mml:math id="d33e828"><mml:mrow><mml:mi>T</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq8.gif"/></alternatives></inline-formula> denotes the evolution time horizon. For this, we derive equations that govern the joint evolution of three population quantities: <italic>n</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) denoting the population density of the species, <italic>q</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) denoting the mean value of a fitness-related quantitative phenotypic trait within the population, and <italic>v</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) denoting the intraspecific variance of the trait.</p><p id="Par18">The derivation of the equations of the model relies on a basic equation that specifies, over a small interval of time, the variation in population density of individuals with a quantitative phenotypic trait value <italic>p</italic>. To present this equation, we first denote by <inline-formula id="IEq9"><alternatives><tex-math id="d33e869">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi (x,t,p)$$\end{document}</tex-math><mml:math id="d33e874"><mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq9.gif"/></alternatives></inline-formula> the relative frequency of phenotype value <inline-formula id="IEq10"><alternatives><tex-math id="d33e888">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \in \mathbb {R}$$\end{document}</tex-math><mml:math id="d33e893"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq10.gif"/></alternatives></inline-formula> among all individuals of the species&#x02019; population. In addition, we denote by <italic>g</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>,&#x000a0;<italic>p</italic>) the intrinsic<xref ref-type="fn" rid="Fn1">1</xref> growth rate of the population of individuals with phenotype value <italic>p</italic>. This growth rate, as given below by (<xref rid="Equ8" ref-type="disp-formula">5</xref>), includes a Lotka-Volterra model of intraspecific competition. We denote by <inline-formula id="IEq12"><alternatives><tex-math id="d33e952">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha (p,p')$$\end{document}</tex-math><mml:math id="d33e957"><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq12.gif"/></alternatives></inline-formula> the competition kernel that captures the strength of per capita effects of individuals with phenotype <inline-formula id="IEq13"><alternatives><tex-math id="d33e972">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p'$$\end{document}</tex-math><mml:math id="d33e977"><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq13.gif"/></alternatives></inline-formula> on the frequency of individuals with phenotype <italic>p</italic>. Finally, we denote by <inline-formula id="IEq14"><alternatives><tex-math id="d33e986">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _t^{(\textrm{M})} \phi (x,t,p)$$\end{document}</tex-math><mml:math id="d33e991"><mml:mrow><mml:msubsup><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>M</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq14.gif"/></alternatives></inline-formula> the rate of mutational changes in the frequency of phenotype <italic>p</italic>. The basic equation underlying the derivation of the model can then be presented as <disp-formula id="Equ1"><label>1a</label><alternatives><tex-math id="d33e1018">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n(x,t+\tau ) \phi (x,t+\tau ,p&#x00026;) - n(x, t) \phi (x,t,p) \nonumber \\&#x00026;= \tau {{\,\textrm{div}\,}}\Big ( \textrm{D}(x) \nabla _x\big ( n(x,t)\phi (x,t,p) \big ) \Big ) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e1024" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mtext>D</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ2"><label>1b</label><alternatives><tex-math id="d33e1131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad - \tau {{\,\textrm{div}\,}}\Big ( \textrm{A}(x) n(x,t)\phi (x,t,p) \big (-\nabla _x\theta (x,p) \big ) \Big ) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e1137" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>1c</label><alternatives><tex-math id="d33e1206">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad + \tau g(x,t,p) n(x,t) \phi (x,t,p) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e1212" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>&#x003d5;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ4"><label>1d</label><alternatives><tex-math id="d33e1254">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad + \tau n(x,t) \partial _t^{(\textrm{M})} \phi (x,t,p), \end{aligned}$$\end{document}</tex-math><mml:math id="d33e1260" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>M</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq15"><alternatives><tex-math id="d33e1302">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x$$\end{document}</tex-math><mml:math id="d33e1307"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq15.gif"/></alternatives></inline-formula> denotes the gradient with respect to <italic>x</italic>, and <inline-formula id="IEq16"><alternatives><tex-math id="d33e1317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\textrm{div}\,}}$$\end{document}</tex-math><mml:math id="d33e1322"><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq16.gif"/></alternatives></inline-formula> denotes the divergence with respect to <italic>x</italic>. In writing (<xref rid="Equ1" ref-type="disp-formula">1</xref>), we assume that the change in the population density of individuals with phenotype <italic>p</italic> over a small time interval of <inline-formula id="IEq17"><alternatives><tex-math id="d33e1339">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \rightarrow 0$$\end{document}</tex-math><mml:math id="d33e1344"><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq17.gif"/></alternatives></inline-formula> results from the contributions of four factors: diffusive (random) dispersal of individuals to and from neighboring locations, modeled by (<xref rid="Equ1" ref-type="disp-formula">1a</xref>); directed (optimal) dispersal of individuals in the direction that gives them maximum environmental match, modeled by (<xref rid="Equ2" ref-type="disp-formula">1b</xref>); intrinsic population growth, modeled by (<xref rid="Equ3" ref-type="disp-formula">1c</xref>); and mutational changes in the relative frequency of <italic>p</italic>, modeled by (<xref rid="Equ4" ref-type="disp-formula">1d</xref>). As defined in Table <xref rid="Tab1" ref-type="table">1</xref>, parameter <inline-formula id="IEq18"><alternatives><tex-math id="d33e1371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{D}$$\end{document}</tex-math><mml:math id="d33e1376"><mml:mtext>D</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq18.gif"/></alternatives></inline-formula> denotes the diffusion coefficient of the species&#x02019; random dispersal. Parameter <inline-formula id="IEq19"><alternatives><tex-math id="d33e1380">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e1385"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> and the term <inline-formula id="IEq20"><alternatives><tex-math id="d33e1389">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\nabla _x\theta $$\end{document}</tex-math><mml:math id="d33e1394"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq20.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">1b</xref>) can be interpreted, respectively, as individuals&#x02019; propensity and individuals&#x02019; perceived force to disperse optimally. Further descriptions on these terms are provided in Sect.&#x000a0;<xref rid="Sec8" ref-type="sec">2.3</xref> below.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Definition and plausible range of values of the parameters of the model (<xref rid="Equ14" ref-type="disp-formula">10</xref>)&#x02013;(<xref rid="Equ23" ref-type="disp-formula">12</xref>)</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><bold>Parameter</bold></th><th align="left"><bold>Definition</bold></th><th align="left"><bold>Range</bold></th><th align="left"><bold>Typical</bold></th><th align="left"><bold>Unit</bold></th></tr></thead><tbody><tr><td align="left"><inline-formula id="IEq21"><alternatives><tex-math id="d33e1455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{m}$$\end{document}</tex-math><mml:math id="d33e1460"><mml:mtext>m</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq1.gif"/></alternatives></inline-formula></td><td align="left">Spatial dimension of the geographic space</td><td align="left"><inline-formula id="IEq22"><alternatives><tex-math id="d33e1467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,2,3\}$$\end{document}</tex-math><mml:math id="d33e1472"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq22.gif"/></alternatives></inline-formula></td><td align="left">1, 2</td><td align="left">&#x02014;</td></tr><tr><td align="left"><inline-formula id="IEq23"><alternatives><tex-math id="d33e1491">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{D}(x)$$\end{document}</tex-math><mml:math id="d33e1496"><mml:mrow><mml:mtext>D</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq23.gif"/></alternatives></inline-formula></td><td align="left">Diffusion coefficient of the species&#x02019; random dispersal</td><td align="left"><inline-formula id="IEq24"><alternatives><tex-math id="d33e1509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[0,25]^{*}$$\end{document}</tex-math><mml:math id="d33e1514"><mml:mmultiscripts><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>25</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq24.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq25"><alternatives><tex-math id="d33e1531">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1^{*}$$\end{document}</tex-math><mml:math id="d33e1536"><mml:mmultiscripts><mml:mn>1</mml:mn><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq25.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq26"><alternatives><tex-math id="d33e1546">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\texttt{X}}^2 / \texttt{T}$$\end{document}</tex-math><mml:math id="d33e1551"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq26.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-formula id="IEq27"><alternatives><tex-math id="d33e1566">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}(x)$$\end{document}</tex-math><mml:math id="d33e1571"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq27.gif"/></alternatives></inline-formula></td><td align="left">Measure of the species&#x02019; propensity to disperse optimally</td><td align="left">[0,&#x000a0;10]</td><td align="left">4</td><td align="left"><inline-formula id="IEq28"><alternatives><tex-math id="d33e1588">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\texttt{X}}^2 / \texttt{T}$$\end{document}</tex-math><mml:math id="d33e1593"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq26.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-formula id="IEq29"><alternatives><tex-math id="d33e1608">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}(x)$$\end{document}</tex-math><mml:math id="d33e1613"><mml:mrow><mml:mtext>K</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq29.gif"/></alternatives></inline-formula></td><td align="left">Carrying capacity of the <inline-formula id="IEq30"><alternatives><tex-math id="d33e1625">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {environment}^\dagger $$\end{document}</tex-math><mml:math id="d33e1630"><mml:msup><mml:mtext>environment</mml:mtext><mml:mo>&#x02020;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq30.gif"/></alternatives></inline-formula></td><td align="left">(0,&#x000a0;10]</td><td align="left">1</td><td align="left"><inline-formula id="IEq31"><alternatives><tex-math id="d33e1641">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{N}/ \texttt{X}^{\textrm{m}}$$\end{document}</tex-math><mml:math id="d33e1646"><mml:mrow><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mtext>m</mml:mtext></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq31.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-formula id="IEq32"><alternatives><tex-math id="d33e1660">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}(x)$$\end{document}</tex-math><mml:math id="d33e1665"><mml:mrow><mml:mtext>R</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq32.gif"/></alternatives></inline-formula></td><td align="left">Maximum population growth rate of the species</td><td align="left">[0.1,&#x000a0;10]</td><td align="left">2</td><td align="left"><inline-formula id="IEq33"><alternatives><tex-math id="d33e1682">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1/{\texttt{T}}$$\end{document}</tex-math><mml:math id="d33e1687"><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq33.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-formula id="IEq34"><alternatives><tex-math id="d33e1698">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e1703"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula></td><td align="left">Variance of the species&#x02019; phenotype utilization distribution</td><td align="left">[0.25,&#x000a0;25]</td><td align="left">4</td><td align="left"><inline-formula id="IEq35"><alternatives><tex-math id="d33e1714">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\texttt{Q}}^2$$\end{document}</tex-math><mml:math id="d33e1719"><mml:msup><mml:mrow><mml:mi mathvariant="monospace">Q</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq35.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-formula id="IEq36"><alternatives><tex-math id="d33e1729">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e1734"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula></td><td align="left">Measure of the strength of stabilizing selection</td><td align="left">[0,&#x000a0;2]</td><td align="left">0.2</td><td align="left"><inline-formula id="IEq37"><alternatives><tex-math id="d33e1745">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\texttt{Q}}^{-2} / \texttt{T}$$\end{document}</tex-math><mml:math id="d33e1750"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="monospace">Q</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq37.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-formula id="IEq38"><alternatives><tex-math id="d33e1767">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{U}$$\end{document}</tex-math><mml:math id="d33e1772"><mml:mtext>U</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq38.gif"/></alternatives></inline-formula></td><td align="left">Rate of increase in trait variance due to mutation</td><td align="left">[0,&#x000a0;0.2]</td><td align="left">0.02</td><td align="left"><inline-formula id="IEq39"><alternatives><tex-math id="d33e1783">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\texttt{Q}}^2 / \texttt{T}$$\end{document}</tex-math><mml:math id="d33e1788"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="monospace">Q</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq39.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-formula id="IEq40"><alternatives><tex-math id="d33e1803">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e1808"><mml:mrow><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq40.gif"/></alternatives></inline-formula></td><td align="left">Optimal trait value for the environment</td><td align="left"><inline-formula id="IEq41"><alternatives><tex-math id="d33e1821">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[0, \infty )$$\end{document}</tex-math><mml:math id="d33e1826"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>&#x0221e;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq41.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq42"><alternatives><tex-math id="d33e1838">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {Linear}^\ddagger $$\end{document}</tex-math><mml:math id="d33e1843"><mml:msup><mml:mtext>Linear</mml:mtext><mml:mo>&#x02021;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq42.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq43"><alternatives><tex-math id="d33e1850">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{Q}$$\end{document}</tex-math><mml:math id="d33e1855"><mml:mi mathvariant="monospace">Q</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq43.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><inline-formula id="IEq44"><alternatives><tex-math id="d33e1862">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e1867"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq44.gif"/></alternatives></inline-formula></td><td align="left">Magnitude of the gradient of the optimal trait</td><td align="left">[0,&#x000a0;10]</td><td align="left">0.2</td><td align="left"><inline-formula id="IEq45"><alternatives><tex-math id="d33e1895">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{Q}/ \texttt{X}$$\end{document}</tex-math><mml:math id="d33e1900"><mml:mrow><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq45.gif"/></alternatives></inline-formula></td></tr></tbody></table><table-wrap-foot><p><inline-formula id="IEq46"><alternatives><tex-math id="d33e1911">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{*}$$\end{document}</tex-math><mml:math id="d33e1916"><mml:mmultiscripts><mml:mrow/><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq46.gif"/></alternatives></inline-formula>When <inline-formula id="IEq47"><alternatives><tex-math id="d33e1925">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{m}&#x0003e;1$$\end{document}</tex-math><mml:math id="d33e1930"><mml:mrow><mml:mtext>m</mml:mtext><mml:mo>&#x0003e;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq47.gif"/></alternatives></inline-formula>, the range of values specified for <inline-formula id="IEq48"><alternatives><tex-math id="d33e1937">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{D}(x)$$\end{document}</tex-math><mml:math id="d33e1942"><mml:mrow><mml:mtext>D</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq23.gif"/></alternatives></inline-formula> can be considered for each entry of <inline-formula id="IEq49"><alternatives><tex-math id="d33e1952">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{D}(x)\subset \mathbb {R}^{\textrm{m}\times \textrm{m}}$$\end{document}</tex-math><mml:math id="d33e1957"><mml:mrow><mml:mtext>D</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02282;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mtext>m</mml:mtext><mml:mo>&#x000d7;</mml:mo><mml:mtext>m</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq49.gif"/></alternatives></inline-formula>. Typically, <inline-formula id="IEq50"><alternatives><tex-math id="d33e1977">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{D}$$\end{document}</tex-math><mml:math id="d33e1982"><mml:mtext>D</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq18.gif"/></alternatives></inline-formula> is assumed to be diagonal</p><p><inline-formula id="IEq51"><alternatives><tex-math id="d33e1987">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\dagger $$\end{document}</tex-math><mml:math id="d33e1992"><mml:mmultiscripts><mml:mrow/><mml:mrow/><mml:mo>&#x02020;</mml:mo></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq51.gif"/></alternatives></inline-formula>The carrying capacity <inline-formula id="IEq52"><alternatives><tex-math id="d33e1999">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}$$\end{document}</tex-math><mml:math id="d33e2004"><mml:mtext>K</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq52.gif"/></alternatives></inline-formula> is defined as the maximum population density when individuals are strongly competitive (generalist), that is, <inline-formula id="IEq53"><alternatives><tex-math id="d33e2008">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}\gg 1$$\end{document}</tex-math><mml:math id="d33e2013"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>&#x0226b;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq53.gif"/></alternatives></inline-formula>. When <inline-formula id="IEq54"><alternatives><tex-math id="d33e2020">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e2025"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> is not large, the resulting competitive release lets the maximum population density exceed the value of <inline-formula id="IEq55"><alternatives><tex-math id="d33e2029">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}$$\end{document}</tex-math><mml:math id="d33e2034"><mml:mtext>K</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq52.gif"/></alternatives></inline-formula> specified here</p><p><inline-formula id="IEq56"><alternatives><tex-math id="d33e2039">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^\ddagger $$\end{document}</tex-math><mml:math id="d33e2044"><mml:mmultiscripts><mml:mrow/><mml:mrow/><mml:mo>&#x02021;</mml:mo></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq56.gif"/></alternatives></inline-formula>The typical value &#x0201c;Linear&#x0201d; specified for <inline-formula id="IEq57"><alternatives><tex-math id="d33e2051">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e2056"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> means that <inline-formula id="IEq58"><alternatives><tex-math id="d33e2060">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e2065"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> is typically considered to be a linear function of <italic>x</italic> over <inline-formula id="IEq59"><alternatives><tex-math id="d33e2072">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><mml:math id="d33e2077"><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq59.gif"/></alternatives></inline-formula></p><p>Except for <inline-formula id="IEq60"><alternatives><tex-math id="d33e2083">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}(x)$$\end{document}</tex-math><mml:math id="d33e2088"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq27.gif"/></alternatives></inline-formula>, the range of parameter values and their choice of units are the same as those proposed by Shirani and Miller (<xref ref-type="bibr" rid="CR110">2022</xref>). Unless otherwise stated, the typical values given here are the values used in the numerical studies of Sect.&#x000a0;<xref rid="Sec15" ref-type="sec">4</xref></p></table-wrap-foot></table-wrap></p><p id="Par20">Below, we first provide a list of key assumptions that we have made in writing (<xref rid="Equ1" ref-type="disp-formula">1</xref>) and some other equations in the rest of the paper. We then give the formulation of the species&#x02019; intrinsic growth rate <italic>g</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>,&#x000a0;<italic>p</italic>) in (<xref rid="Equ3" ref-type="disp-formula">1c</xref>), and describe in detail how we model the optimal dispersal in (<xref rid="Equ2" ref-type="disp-formula">1b</xref>). The diffusion term (<xref rid="Equ1" ref-type="disp-formula">1a</xref>) that models species&#x02019; random dispersal is standard, and the formulation for the effect of mutational changes in (<xref rid="Equ4" ref-type="disp-formula">1d</xref>), based on Assumption (viii) below, is given in Section A.3 of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>).</p><sec id="Sec6"><title>Model Assumptions</title><p id="Par21">To derive the equations of our model, we make the following major assumptions on the populations&#x02019; dispersal and reproduction, as well as the elements of the intrinsic growth rate and the intraspecific competition kernel: <list list-type="simple"><list-item><label>(i)</label><p id="Par22">Random dispersal of the individuals in the habitat is diffusive.</p></list-item><list-item><label>(ii)</label><p id="Par23">An individual&#x02019;s environmental <italic>potential energy</italic> for optimal dispersal is proportional to the square of the difference between its phenotype value and the environment&#x02019;s optimum phenotype. This assumption is crucial for the quantitative outcomes of the model, as explained in Sect.&#x000a0;<xref rid="Sec8" ref-type="sec">2.3</xref>.</p></list-item><list-item><label>(iii)</label><p id="Par24">Nonlinear environmental selection for an optimal phenotype <inline-formula id="IEq61"><alternatives><tex-math id="d33e2162">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e2167"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> is stabilizing for all <inline-formula id="IEq62"><alternatives><tex-math id="d33e2171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\in \Omega $$\end{document}</tex-math><mml:math id="d33e2176"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq62.gif"/></alternatives></inline-formula>. The optimal phenotype can vary over space and time.</p></list-item><list-item><label>(iv)</label><p id="Par25">The frequency of phenotype values within the species is normally distributed at each occupied point in space at all times. That is, <disp-formula id="Equ5"><label>2</label><alternatives><tex-math id="d33e2189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \phi (x,t,p):= \frac{1}{\sqrt{2 \pi v(x,t)}} \exp \left( -\frac{(p - q(x,t))^2}{2 \, v(x,t)} \right) , \quad x \in \Omega , \quad t \in [0,T]. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e2195" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mspace width="0.166667em"/><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p></list-item><list-item><label>(v)</label><p id="Par26">In the absence of selection, the intrinsic growth rate of the individuals with phenotype <italic>p</italic> follows a logistic growth (see (<xref rid="Equ8" ref-type="disp-formula">5a</xref>)) with phenotype-dependent competition. The carrying capacity and maximum growth rate of the individuals are independent of their phenotype.</p></list-item><list-item><label>(vi)</label><p id="Par27">Environmental resources vary continuously along a resource axis. After identifying the resource axis with a phenotype axis, as described in Remark <xref ref-type="sec" rid="FPar2">2</xref> below, the <italic>phenotype utilization distribution</italic> for an individual with phenotype <italic>p</italic> is assumed to be normal, given by <disp-formula id="Equ6"><label>3</label><alternatives><tex-math id="d33e2307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \psi _p(\tilde{p}):= \frac{1}{\sqrt{2 \pi \textrm{V}}} \exp \left( -\frac{(\tilde{p} - p)^2}{2 \textrm{V}} \right) , \end{aligned}$$\end{document}</tex-math><mml:math id="d33e2313" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mtext>V</mml:mtext></mml:mrow></mml:msqrt></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq63"><alternatives><tex-math id="d33e2363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e2368"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> denotes the variance of phenotype utilization by every individuals of the species.</p></list-item><list-item><label>(vii)</label><p id="Par28">The strength of intraspecific competition between individuals is determined by the overlap between their phenotype utilization curves, which results in the competition kernel <disp-formula id="Equ7"><label>4</label><alternatives><tex-math id="d33e2377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \alpha (p,p') = \exp \left( -\frac{(p - p')^2}{4 \textrm{V}} \right) . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e2383" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>4</mml:mn><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula> The details of the derivation of this kernel function are available in Sections A.2 and A.4 of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>). Here, we only consider symmetric competition between the individuals of different phenotypes, that is, we set <inline-formula id="IEq64"><alternatives><tex-math id="d33e2426">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\kappa = 0$$\end{document}</tex-math><mml:math id="d33e2431"><mml:mrow><mml:mi>&#x003ba;</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq64.gif"/></alternatives></inline-formula> in the formulation given in our previous work.</p></list-item><list-item><label>(viii)</label><p id="Par29">The probability of mutational changes from one phenotype <italic>p</italic> to another phenotype <inline-formula id="IEq65"><alternatives><tex-math id="d33e2446">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p'$$\end{document}</tex-math><mml:math id="d33e2451"><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq13.gif"/></alternatives></inline-formula> depends on the difference <inline-formula id="IEq66"><alternatives><tex-math id="d33e2457">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta p = p - p'$$\end{document}</tex-math><mml:math id="d33e2462"><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq66.gif"/></alternatives></inline-formula> between the phenotypes. Letting <inline-formula id="IEq67"><alternatives><tex-math id="d33e2474">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu (\delta p)$$\end{document}</tex-math><mml:math id="d33e2479"><mml:mrow><mml:mi>&#x003bd;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq67.gif"/></alternatives></inline-formula> denote the probability density of such mutational changes, we further assume that <inline-formula id="IEq68"><alternatives><tex-math id="d33e2490">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nu $$\end{document}</tex-math><mml:math id="d33e2495"><mml:mi>&#x003bd;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq68.gif"/></alternatives></inline-formula> follows a distribution with constant zero mean and constant variance <inline-formula id="IEq69"><alternatives><tex-math id="d33e2500">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}_{\textsc {m}}$$\end{document}</tex-math><mml:math id="d33e2505"><mml:msub><mml:mtext>V</mml:mtext><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">M</mml:mi></mml:mstyle></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq69.gif"/></alternatives></inline-formula>. See Section A.3 of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>) for the formulation of our model of mutational changes.</p></list-item></list></p><sec id="FPar1"><title>[Style3 Style3]Remark 1</title><p id="Par30"><italic>(Reproduction types)</italic> For an isolated population, in the absence of dispersal, competition, selection, and mutation, the phenotype density evolution equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>) with the intrinsic growth rate (<xref rid="Equ8" ref-type="disp-formula">5</xref>) gives <inline-formula id="IEq70"><alternatives><tex-math id="d33e2528">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _t\big ( n(x,t) \phi (x,t,p) \big ) = \textrm{R}(x) \big ( n(x,t) \phi (x,t,p) \big )$$\end{document}</tex-math><mml:math id="d33e2533"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>R</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq70.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq71"><alternatives><tex-math id="d33e2601">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _t$$\end{document}</tex-math><mml:math id="d33e2606"><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq71.gif"/></alternatives></inline-formula> denotes the partial derivative with respect to <italic>t</italic>. This means that, under our assumption that the maximum growth rate <inline-formula id="IEq72"><alternatives><tex-math id="d33e2616">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e2621"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula> is phenotype-independent (Assumption (v)), the intrinsic rate of change in the density of an isolated population of individuals with phenotype <italic>p</italic> depends only on the population density of individuals with the same phenotype <italic>p</italic>. This condition fits in trivially with an asexual reproduction system. However, within the context of this work, we can speculatively argue that the predictions of our model are approximately valid even for the range evolution of a sexually reproducing species, under certain conditions. Ascertaining our arguments will require direct incorporation of individuals&#x02019; mating into the model.</p><p id="Par31">In a basic infinitesimal model for a large population, the phenotype value of the offspring of parents with phenotypes <italic>p</italic> and <inline-formula id="IEq73"><alternatives><tex-math id="d33e2636">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p^{*}$$\end{document}</tex-math><mml:math id="d33e2641"><mml:mmultiscripts><mml:mi>p</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq73.gif"/></alternatives></inline-formula> follows a normal distribution with mean <inline-formula id="IEq74"><alternatives><tex-math id="d33e2650">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(p + p^{*})/2$$\end{document}</tex-math><mml:math id="d33e2655"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mmultiscripts><mml:mi>p</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq74.gif"/></alternatives></inline-formula> and segregation (within-family) variance <inline-formula id="IEq75"><alternatives><tex-math id="d33e2674">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{\textsc {s}}$$\end{document}</tex-math><mml:math id="d33e2679"><mml:msub><mml:mi>v</mml:mi><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">S</mml:mi></mml:mstyle></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq75.gif"/></alternatives></inline-formula> (Barton et&#x000a0;al. <xref ref-type="bibr" rid="CR13">2017</xref>). Without selection, the population trait variance <italic>v</italic> of a fully panmictic (randomly mating) isolated population reaches the equilibrium value <inline-formula id="IEq76"><alternatives><tex-math id="d33e2694">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v = 2 v_{\textsc {s}}$$\end{document}</tex-math><mml:math id="d33e2699"><mml:mrow><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">S</mml:mi></mml:mstyle></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq76.gif"/></alternatives></inline-formula>. Stabilizing selection reduces this equilibrium variance. That is, for a randomly-mating population under selection we have <inline-formula id="IEq77"><alternatives><tex-math id="d33e2711">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v &#x0003c; 2 v_{\textsc {s}}$$\end{document}</tex-math><mml:math id="d33e2716"><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">S</mml:mi></mml:mstyle></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq77.gif"/></alternatives></inline-formula> (Barton et&#x000a0;al. <xref ref-type="bibr" rid="CR13">2017</xref>,&#x000a0;Eq. (6)). Reproduction through assortative mating can substantially increase the equilibrium trait variance, that is, <inline-formula id="IEq78"><alternatives><tex-math id="d33e2731">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v \gg 2 v_{\textsc {s}}$$\end{document}</tex-math><mml:math id="d33e2736"><mml:mrow><mml:mi>v</mml:mi><mml:mo>&#x0226b;</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">S</mml:mi></mml:mstyle></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq78.gif"/></alternatives></inline-formula>. In the absence of selection, very strong cost-free assortment results in an indefinite increase in trait variance (Barton et&#x000a0;al. <xref ref-type="bibr" rid="CR13">2017</xref>). In the real world, however, selection prevents divergence of the trait variance (Polechov&#x000e1; and Barton <xref ref-type="bibr" rid="CR84">2005</xref>,&#x000a0;Eq. (7)).</p><p id="Par32">If the species represented by our model reproduces sexually through strong assortative mating (<inline-formula id="IEq79"><alternatives><tex-math id="d33e2757">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \approx p^{*}$$\end{document}</tex-math><mml:math id="d33e2762"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02248;</mml:mo><mml:mmultiscripts><mml:mi>p</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq79.gif"/></alternatives></inline-formula>), then the infinitesimal model predicts that the average segregation variance will be much smaller than the total trait variance over the entire population. However, locally, at a given point <inline-formula id="IEq80"><alternatives><tex-math id="d33e2774">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in \Omega $$\end{document}</tex-math><mml:math id="d33e2779"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq80.gif"/></alternatives></inline-formula>, <inline-formula id="IEq81"><alternatives><tex-math id="d33e2787">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{\textsc {s}}(x)$$\end{document}</tex-math><mml:math id="d33e2792"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">S</mml:mi></mml:mstyle></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq81.gif"/></alternatives></inline-formula> can be comparable to <italic>v</italic>(<italic>x</italic>). Our present work focuses on species range evolution in relatively steep environmental gradients, implying that the trait variance will be dominantly maintained by gene flow. As we show in the results presented in Sect.&#x000a0;<xref rid="Sec15" ref-type="sec">4</xref>, the directed gene flow created by phenotype-optimal dispersal substantially reduces within-population (local) trait variance. That is, with strong phenotype-optimal dispersal, <italic>v</italic>(<italic>x</italic>) and hence <inline-formula id="IEq82"><alternatives><tex-math id="d33e2823">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{\textsc {s}}(x)$$\end{document}</tex-math><mml:math id="d33e2828"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">S</mml:mi></mml:mstyle></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq81.gif"/></alternatives></inline-formula> take small values at every <inline-formula id="IEq83"><alternatives><tex-math id="d33e2843">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in \Omega $$\end{document}</tex-math><mml:math id="d33e2848"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq80.gif"/></alternatives></inline-formula>. Therefore, for an assortatively-mating population that disperses optimally, we expect that the offsprings take the mid-parent value <inline-formula id="IEq84"><alternatives><tex-math id="d33e2856">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(p + p^{*})/2 \approx p$$\end{document}</tex-math><mml:math id="d33e2861"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>+</mml:mo><mml:mmultiscripts><mml:mi>p</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x02248;</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq84.gif"/></alternatives></inline-formula> with fairly large confidence (small segregation variance). This means that the range evolution of such a population should be essentially similar to the range evolution of an asexual population that satisfies the assumption of our model trivially. We should note that, as stated in the in Sect.&#x000a0;<xref rid="Sec3" ref-type="sec">1.2</xref>, phenotype-optimal dispersal can indeed promote the evolution of assortative mating.</p><p id="Par33">The results of our model are also expected to be approximately valid for a panmictic population with locally-mating individuals, that is, a population in which each individual mates randomly with nearby individuals without any phenotypic preference. With local random mating the mid-parent phenotype values can be significantly different from each parents&#x02019; phenotype, and the segregation variance <inline-formula id="IEq85"><alternatives><tex-math id="d33e2888">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v_{\textsc {s}}(x)$$\end{document}</tex-math><mml:math id="d33e2893"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">S</mml:mi></mml:mstyle></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq81.gif"/></alternatives></inline-formula> can be close to the local trait variance, <inline-formula id="IEq86"><alternatives><tex-math id="d33e2908">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v(x) \le 2 v_{\textsc {s}}(x)$$\end{document}</tex-math><mml:math id="d33e2913"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02264;</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mstyle mathsize="0.6em"><mml:mi mathvariant="normal">S</mml:mi></mml:mstyle></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq86.gif"/></alternatives></inline-formula>. Therefore, our reproduction assumption is not directly satisfied for a panmictic population&#x02014;unless the population trait variance is heavily reduced by directed gene flow, so that all phenotypes concentrate close to the mean value. However, the infinitesimal model states that with random mating the trait distribution in the population converges to a normal distribution (Barton et&#x000a0;al. <xref ref-type="bibr" rid="CR13">2017</xref>), consistent with our assumption of normal phenotype distribution (Assumption (iv)) in the presence of gene flow. Therefore, even though random mating does not meet our reproduction assumption at the individual phenotype level, it should not substantially affect the population-level distribution of phenotypes (in particular, their mean and variance) when the main source of phenotypic variation is gene flow. Knowing that our model represents the populations at a mean-field level, with equations that govern only the evolution of the mean and variance of the traits, we expect our results to essentially remain valid even for a sexually-reproducing panmictic population, provided that mating in the population takes place locally. <inline-formula id="IEq87"><alternatives><tex-math id="d33e2940">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="d33e2945"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq87.gif"/></alternatives></inline-formula></p></sec><sec id="FPar2"><title>[Style3 Style3]Remark 2</title><p id="Par34"><italic>(Phenotype Utilization Distribution)</italic> The phenotype utilization distribution function <inline-formula id="IEq88"><alternatives><tex-math id="d33e2954">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi _p(\tilde{p})$$\end{document}</tex-math><mml:math id="d33e2959"><mml:mrow><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq88.gif"/></alternatives></inline-formula> can be interpreted as a function that gives the probability density that an individual with phenotype <italic>p</italic> will utilize a unit of resource that is expected to be mostly utilized by (is most favorable for) an individual with phenotype <inline-formula id="IEq89"><alternatives><tex-math id="d33e2978">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{p}$$\end{document}</tex-math><mml:math id="d33e2983"><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq89.gif"/></alternatives></inline-formula>. To see this more precisely, we assume (as in Assumption (vi)) that environmental resources vary continuously along a resource axis parameterized by a variable <italic>r</italic>. Let <inline-formula id="IEq90"><alternatives><tex-math id="d33e2993">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi _p$$\end{document}</tex-math><mml:math id="d33e2998"><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq90.gif"/></alternatives></inline-formula> be a probability density function that denotes the <italic>resource utilization distribution</italic> of individuals with phenotype <italic>p</italic>. That is, <inline-formula id="IEq91"><alternatives><tex-math id="d33e3011">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi _p(r)$$\end{document}</tex-math><mml:math id="d33e3016"><mml:mrow><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq91.gif"/></alternatives></inline-formula> gives the probability density that an individual with phenotype <italic>p</italic> obtains a unit of resource from a point <italic>r</italic> on the resource axis. It is then convenient for our modeling purposes, and for trait-based niche conceptualizations (Ackerly and Cornwell <xref ref-type="bibr" rid="CR2">2007</xref>; Violle and Jiang <xref ref-type="bibr" rid="CR116">2009</xref>), to assume that the resource axis can be identified by the phenotype axis (Roughgarden <xref ref-type="bibr" rid="CR97">1979</xref>, Equ. (24.51)). This means that, we assume there exits a smooth one-to-one map <inline-formula id="IEq92"><alternatives><tex-math id="d33e3045">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I:p \mapsto r_p$$\end{document}</tex-math><mml:math id="d33e3050"><mml:mrow><mml:mi>I</mml:mi><mml:mo>:</mml:mo><mml:mi>p</mml:mi><mml:mo>&#x021a6;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq92.gif"/></alternatives></inline-formula> that identifies the <italic>r</italic>-axis with the <italic>p</italic>-axis. That is, for every <inline-formula id="IEq93"><alternatives><tex-math id="d33e3067">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r \in \mathbb {R}$$\end{document}</tex-math><mml:math id="d33e3072"><mml:mrow><mml:mi>r</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq93.gif"/></alternatives></inline-formula>, there exist a unique phenotype <inline-formula id="IEq94"><alternatives><tex-math id="d33e3081">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{p}\in \mathbb {R}$$\end{document}</tex-math><mml:math id="d33e3086"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq94.gif"/></alternatives></inline-formula> such that <inline-formula id="IEq95"><alternatives><tex-math id="d33e3097">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r = r_{\tilde{p}} = I(\tilde{p})\equiv \tilde{p}$$\end{document}</tex-math><mml:math id="d33e3102"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:msub><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02261;</mml:mo><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq95.gif"/></alternatives></inline-formula>. For instance, <inline-formula id="IEq96"><alternatives><tex-math id="d33e3130">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r_{\tilde{p}}$$\end{document}</tex-math><mml:math id="d33e3135"><mml:msub><mml:mi>r</mml:mi><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq96.gif"/></alternatives></inline-formula> can be the point on the <italic>r</italic>-axis from which individuals of phenotype <inline-formula id="IEq97"><alternatives><tex-math id="d33e3147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tilde{p}$$\end{document}</tex-math><mml:math id="d33e3152"><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq89.gif"/></alternatives></inline-formula> obtain their average amount of resources. Following this identification, the resource utilization distributions <inline-formula id="IEq98"><alternatives><tex-math id="d33e3159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi _p(r)$$\end{document}</tex-math><mml:math id="d33e3164"><mml:mrow><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq91.gif"/></alternatives></inline-formula> are translated into phenotype utilization distributions <inline-formula id="IEq99"><alternatives><tex-math id="d33e3178">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi _p(\tilde{p})$$\end{document}</tex-math><mml:math id="d33e3183"><mml:mrow><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo stretchy="false">~</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq88.gif"/></alternatives></inline-formula>, which we assume to take the Gaussian form (<xref rid="Equ6" ref-type="disp-formula">3</xref>) with utilization variance <inline-formula id="IEq100"><alternatives><tex-math id="d33e3202">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e3207"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula>. This resource-phenotype identification can be conceptualized to represent the empirical relationship between functional response traits and environments&#x02014;inspiring our choice of optimal dispersal potential energy function (<xref rid="Equ10" ref-type="disp-formula">6</xref>) described below. In a trait-based niche quantification framework (Ackerly and Cornwell <xref ref-type="bibr" rid="CR2">2007</xref>; Violle and Jiang <xref ref-type="bibr" rid="CR116">2009</xref>) the variance of phenotype utilization distributions can be used to quantify the within-phenotype component of a species&#x02019; niche breadth. Further details can be found in Appendix A.2 and Section 3.2 of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>). <inline-formula id="IEq101"><alternatives><tex-math id="d33e3224">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="d33e3229"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq87.gif"/></alternatives></inline-formula></p></sec></sec><sec id="Sec7"><title>Intrinsic Growth Rate</title><p id="Par35">In the absence of dispersal and genetic mutations, the local population dynamics of the species is determined by its intrinsic population growth, which we model as (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>,&#x000a0;Eq. (17)), <disp-formula id="Equ8"><label>5a</label><alternatives><tex-math id="d33e3239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} g(x,t,p) :=&#x00026;\textrm{R}(x) \left( 1 - \frac{1}{\textrm{K}(x)} n(x,t) \int _{\mathbb {R}} \alpha (p, p') \phi (x,t, p') \textrm{d}p' \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e3245" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>R</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mtext>K</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:msup><mml:mi>p</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ9"><label>5b</label><alternatives><tex-math id="d33e3327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad -\frac{\textrm{S}}{2} (p - \textrm{Q}(x))^2, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e3333" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula> where <inline-formula id="IEq102"><alternatives><tex-math id="d33e3364">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e3369"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula> denotes the maximum growth rate of the species, <inline-formula id="IEq103"><alternatives><tex-math id="d33e3373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}$$\end{document}</tex-math><mml:math id="d33e3378"><mml:mtext>K</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq52.gif"/></alternatives></inline-formula> denotes the carrying capacity of the environment, <inline-formula id="IEq104"><alternatives><tex-math id="d33e3382">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e3387"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula> denotes the strength of stabilizing selection, and <inline-formula id="IEq105"><alternatives><tex-math id="d33e3392">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e3397"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> denotes the environment&#x02019;s optimal trait value. The phenotype distribution <inline-formula id="IEq106"><alternatives><tex-math id="d33e3401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\phi $$\end{document}</tex-math><mml:math id="d33e3406"><mml:mi>&#x003d5;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq106.gif"/></alternatives></inline-formula> and the competition kernel <inline-formula id="IEq107"><alternatives><tex-math id="d33e3410">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha $$\end{document}</tex-math><mml:math id="d33e3415"><mml:mi>&#x003b1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq107.gif"/></alternatives></inline-formula> are given by (<xref rid="Equ5" ref-type="disp-formula">2</xref>) and (<xref rid="Equ7" ref-type="disp-formula">4</xref>), respectively. The convolution term in the logistic growth rate (<xref rid="Equ8" ref-type="disp-formula">5a</xref>) captures the effect of intraspecific phenotypic competition on the frequency of phenotype <italic>p</italic>. The quadratic term (<xref rid="Equ9" ref-type="disp-formula">5b</xref>) incorporates the effects of directional and stabilizing selection on individuals with phenotype <italic>p</italic>, by penalizing the phenotypes that are far from the optimal phenotype <inline-formula id="IEq108"><alternatives><tex-math id="d33e3438">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e3443"><mml:mrow><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq40.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec8"><title>Phenotype-Optimal Dispersal</title><p id="Par36">We model the species&#x02019; phenotype- and environment-dependent optimal dispersal by the advection term (<xref rid="Equ2" ref-type="disp-formula">1b</xref>). The parameter <inline-formula id="IEq109"><alternatives><tex-math id="d33e3460">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e3465"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> is analogous to the <italic>mobility</italic> parameter that is often used in drift-diffusion models of particles flowing in a fluid. In our model, we can reasonably interpret <inline-formula id="IEq110"><alternatives><tex-math id="d33e3472">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e3477"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> as a simplified model of individuals&#x02019; propensity to disperse optimally. The evolution of a species&#x02019; dispersal propensity depends on many factors, such as costs and benefits of different stages of dispersal, environmental conditions, and frequency-dependent eco-evolutionary processes (Bonte et&#x000a0;al. <xref ref-type="bibr" rid="CR20">2012</xref>; Clobert et&#x000a0;al. <xref ref-type="bibr" rid="CR25">2009</xref>). Moreover, the dispersal propensity of the individuals of a species is often plastic, and can change on an ecological timescale. We do not include the evolution of the species&#x02019; optimal dispersal propensity in our model though, since quantitative estimates of dispersal propensity that allow for a sufficiently meaningful approximation of its evolutionary dynamics are currently lacking in the literature. Instead, we perform our studies with different values of <inline-formula id="IEq111"><alternatives><tex-math id="d33e3488">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e3493"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> to explore whether different degrees of dispersal propensity will be sufficiently beneficial to evolve in a species. Although the equations of our model allow for <inline-formula id="IEq112"><alternatives><tex-math id="d33e3497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e3502"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> to be dependent on space, in the results we present in this work we assume <inline-formula id="IEq113"><alternatives><tex-math id="d33e3506">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e3511"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> to be constant in space and time.</p><p id="Par37">The term <inline-formula id="IEq114"><alternatives><tex-math id="d33e3517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\nabla _x\theta (x,p)$$\end{document}</tex-math><mml:math id="d33e3522"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq114.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">1b</xref>) is analogous to the force acting on particles in drift-diffusion models, derived from an external potential energy <inline-formula id="IEq115"><alternatives><tex-math id="d33e3543">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta (x,p)$$\end{document}</tex-math><mml:math id="d33e3548"><mml:mrow><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq115.gif"/></alternatives></inline-formula>. In our model, <inline-formula id="IEq116"><alternatives><tex-math id="d33e3560">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta (x,p)$$\end{document}</tex-math><mml:math id="d33e3565"><mml:mrow><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq115.gif"/></alternatives></inline-formula> is interpreted as individuals&#x02019; <italic>dispersal potential energy</italic> (for directed dispersal), which depends on both the phenotype <italic>p</italic> of each individual and the (perceived) environmental trait optimum. As a result, the advective optimal dispersal (<xref rid="Equ2" ref-type="disp-formula">1b</xref>) in our model represents an informed dispersal strategy that is both phenotype-dependent (dependence on <italic>p</italic>) and condition-dependent (dependence on <inline-formula id="IEq117"><alternatives><tex-math id="d33e3590">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e3595"><mml:mrow><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq40.gif"/></alternatives></inline-formula>), as defined by Clobert et&#x000a0;al. (<xref ref-type="bibr" rid="CR25">2009</xref>). In this informed dispersal context, the phenotype value of an individual is an internal state of the individual, developed by the individual&#x02019;s self perception. The environmental trait optimum and its gradient, as described below, are external factors that can initiate and direct the species&#x02019; optimal dispersal through the evolution of sensory and cognitive processing mechanisms in the individuals.</p><p id="Par38">To fix ideas, we consider the following simplified yet meaningful model for the dispersal potential energy function of an individual with phenotype <italic>p</italic> at habitat location <italic>x</italic>,<disp-formula id="Equ10"><label>6</label><alternatives><tex-math id="d33e3616">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \theta (x,p):= \frac{\big (p - \textrm{Q}(x)\big )^2}{2 \textrm{V}}. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e3622" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>Note that this potential energy function can be obtained as a first-order approximation<xref ref-type="fn" rid="Fn2">2</xref> of the function <inline-formula id="IEq123"><alternatives><tex-math id="d33e3888">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 - \sqrt{2 \pi \textrm{V}} \psi _p(\textrm{Q}(x))$$\end{document}</tex-math><mml:math id="d33e3893"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mtext>V</mml:mtext></mml:mrow></mml:msqrt><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq123.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq124"><alternatives><tex-math id="d33e3920">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi _p$$\end{document}</tex-math><mml:math id="d33e3925"><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq90.gif"/></alternatives></inline-formula> is the phenotype utilization distribution (<xref rid="Equ6" ref-type="disp-formula">3</xref>). That is,<disp-formula id="Equ69"><alternatives><tex-math id="d33e3934">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 1 - \sqrt{2 \pi \textrm{V}} \psi _p(\textrm{Q}(x))&#x00026;= 1 - \exp \left( - \frac{\big (p - \textrm{Q}(x)\big )^2}{2 \textrm{V}} \right) \\&#x00026;\approx 1- \left( 1 - \frac{\big (p - \textrm{Q}(x)\big )^2}{2 \textrm{V}} \right) = \frac{\big (p - \textrm{Q}(x)\big )^2}{2 \textrm{V}} = \theta (x,p). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e3939" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mtext>V</mml:mtext></mml:mrow></mml:msqrt><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ69.gif" position="anchor"/></alternatives></disp-formula>This approximation implies that the dispersal potential energy for an individual with phenotype <italic>p</italic> can be interpreted as how well or poorly the individual can utilize the environment&#x02019;s optimal phenotype<xref ref-type="fn" rid="Fn3">3</xref> at its current location. If the individual&#x02019;s phenotype matches the optimum phenotype perfectly, then there is no phenotypically and environmentally induced force on the individual to disperse. If the individual&#x02019;s phenotype differs significantly from the environment&#x02019;s optimum&#x02014;measured relative to the species&#x02019; phenotype utilization variance <inline-formula id="IEq125"><alternatives><tex-math id="d33e4079">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e4084"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula>&#x02014;then the individual perceives a high potential energy to disperse to habitat locations of better quality that match its phenotype. Yet, a high dispersal potential energy <inline-formula id="IEq126"><alternatives><tex-math id="d33e4089">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta (x,p)$$\end{document}</tex-math><mml:math id="d33e4094"><mml:mrow><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq115.gif"/></alternatives></inline-formula> does not generate a significant dispersal force <inline-formula id="IEq127"><alternatives><tex-math id="d33e4106">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$- \nabla _x\theta (x,p)$$\end{document}</tex-math><mml:math id="d33e4111"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq127.gif"/></alternatives></inline-formula> on the individual, unless a sufficiently large gradient in the dispersal potential energy is perceived by the individual. As the following discussion shows, such a gradient is present if the environmental gradient <inline-formula id="IEq128"><alternatives><tex-math id="d33e4129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e4134"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula> is sufficiently steep and the individual is sufficiently sensitive to it. In this case, the individual enjoys a considerably better-matching habitat after carrying out the directed dispersal.</p><p id="Par41">The dispersal potential energy (<xref rid="Equ10" ref-type="disp-formula">6</xref>) gives the <italic>optimal dispersal force</italic> term <inline-formula id="IEq129"><alternatives><tex-math id="d33e4151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\nabla _x\theta $$\end{document}</tex-math><mml:math id="d33e4156"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq20.gif"/></alternatives></inline-formula> used in (<xref rid="Equ2" ref-type="disp-formula">1b</xref>) as<disp-formula id="Equ11"><label>7</label><alternatives><tex-math id="d33e4169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} -\nabla _x\theta (x,p) = \frac{p - \textrm{Q}(x)}{\textrm{V}} \, \nabla _x\textrm{Q}(x). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e4175" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>If the magnitude of the environmental gradient <inline-formula id="IEq130"><alternatives><tex-math id="d33e4223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e4228"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq44.gif"/></alternatives></inline-formula> is zero (where <inline-formula id="IEq131"><alternatives><tex-math id="d33e4249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| . \right\| _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e4254"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:mo>.</mml:mo></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq131.gif"/></alternatives></inline-formula> denotes the Euclidean norm in <inline-formula id="IEq132"><alternatives><tex-math id="d33e4265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb {R}^{\textrm{m}}$$\end{document}</tex-math><mml:math id="d33e4270"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq132.gif"/></alternatives></inline-formula>) or is perceived as equal to zero due to insensitivity of an individual to the gradient, then the perceived directed dispersal force on the individual is zero&#x02014;regardless of the presence of a phenotype-environment mismatch <inline-formula id="IEq133"><alternatives><tex-math id="d33e4278">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \ne \textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e4283"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq133.gif"/></alternatives></inline-formula>. In this case the individual only disperses randomly, due to the diffusion term (<xref rid="Equ1" ref-type="disp-formula">1a</xref>). If <inline-formula id="IEq134"><alternatives><tex-math id="d33e4298">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}^{\textrm{m}}} &#x0003e; 0$$\end{document}</tex-math><mml:math id="d33e4303"><mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq134.gif"/></alternatives></inline-formula>, then an individual whose phenotype <italic>p</italic> does not perfectly match the optimum phenotype will perceive a force &#x0201c;pushing&#x0201d; it to disperse optimally. If <inline-formula id="IEq135"><alternatives><tex-math id="d33e4331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p &#x0003e; \textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e4336"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x0003e;</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq135.gif"/></alternatives></inline-formula>, the optimal dispersal will be in the direction of the environmental gradient so that the individual disperses to habitat locations with larger optimum phenotype values, which give the individual a better phenotype-environment match. Similarly, if <inline-formula id="IEq136"><alternatives><tex-math id="d33e4348">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p &#x0003c; \textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e4353"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x0003c;</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq136.gif"/></alternatives></inline-formula>, the optimal match will be achieved by the individual through dispersal in the opposite direction of the environmental gradient. Although not possessing a true interpretation as a potential&#x02014;unlike the dispersal potential energy <inline-formula id="IEq137"><alternatives><tex-math id="d33e4365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta (x,p)$$\end{document}</tex-math><mml:math id="d33e4370"><mml:mrow><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq115.gif"/></alternatives></inline-formula> given by (<xref rid="Equ10" ref-type="disp-formula">6</xref>), which indeed induces a conservative force <inline-formula id="IEq138"><alternatives><tex-math id="d33e4385">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\nabla _x\theta $$\end{document}</tex-math><mml:math id="d33e4390"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq20.gif"/></alternatives></inline-formula> in the advection term (<xref rid="Equ2" ref-type="disp-formula">1b</xref>)&#x02014;for ease of reference we refer to the term <inline-formula id="IEq139"><alternatives><tex-math id="d33e4404">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\big (p - \textrm{Q}\big ) /\textrm{V}$$\end{document}</tex-math><mml:math id="d33e4409"><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq139.gif"/></alternatives></inline-formula> in (<xref rid="Equ11" ref-type="disp-formula">7</xref>) as the <italic>phenotypic potential</italic> for optimal dispersal.</p><p id="Par42">A biological organism may not develop a perception of the dispersal force (<xref rid="Equ11" ref-type="disp-formula">7</xref>) in its exact mathematical sense. The phenotypic potential <inline-formula id="IEq140"><alternatives><tex-math id="d33e4436">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(p-\textrm{Q})/\textrm{V}$$\end{document}</tex-math><mml:math id="d33e4441"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq140.gif"/></alternatives></inline-formula> and the environmental gradient <inline-formula id="IEq141"><alternatives><tex-math id="d33e4455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e4460"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula> are perceived only approximately, and to the level needed for individuals&#x02019; decision and plan for dispersal. However, to make the derivation of the equations of our model feasible, we assume that the perceived valued of the phenotypic potential is equal to its exact mathematical value <inline-formula id="IEq142"><alternatives><tex-math id="d33e4469">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(p-\textrm{Q})/\textrm{V}$$\end{document}</tex-math><mml:math id="d33e4474"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq140.gif"/></alternatives></inline-formula>; see Remark <xref ref-type="sec" rid="FPar4">4</xref> below. Yet, our derivations allow for a more reasonable perception of the environmental gradient, which we denote by <inline-formula id="IEq143"><alternatives><tex-math id="d33e4492">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}$$\end{document}</tex-math><mml:math id="d33e4497"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq143.gif"/></alternatives></inline-formula> and describe in Remark <xref ref-type="sec" rid="FPar3">3</xref> below.</p><p id="Par43">Replacing the actual environmental gradient in (<xref rid="Equ11" ref-type="disp-formula">7</xref>) with its perceived value, we then write the individual&#x02019;s <italic>perceived dispersal force</italic> for phenotype-optimal dispersal as:<disp-formula id="Equ12"><label>8</label><alternatives><tex-math id="d33e4520">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} -\widetilde{\nabla _x\theta }(x,p) = \frac{p - \textrm{Q}(x)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}}(x), \end{aligned}$$\end{document}</tex-math><mml:math id="d33e4526" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>which is the dispersal force we substitute into (<xref rid="Equ2" ref-type="disp-formula">1b</xref>) to derive the equations of our model ((<xref rid="Equ14" ref-type="disp-formula">10</xref>)&#x02013;(<xref rid="Equ23" ref-type="disp-formula">12</xref>)) given in Sect.&#x000a0;<xref rid="Sec9" ref-type="sec">2.4</xref>.</p><sec id="FPar3"><title>[Style3 Style3]Remark 3</title><p id="Par44"><italic>(Perceived environmental gradient)</italic> The magnitude of the dispersal force perceived by an individual is unlikely to remain directly proportional to the magnitude of the environmental gradient <inline-formula id="IEq144"><alternatives><tex-math id="d33e4600">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e4605"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq44.gif"/></alternatives></inline-formula> when the gradient becomes increasingly steep. When there exists a phenotype-environment mismatch <inline-formula id="IEq145"><alternatives><tex-math id="d33e4626">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p \ne \textrm{Q}$$\end{document}</tex-math><mml:math id="d33e4631"><mml:mrow><mml:mi>p</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq145.gif"/></alternatives></inline-formula>, a sufficiently steep environmental gradient should be enough to generate a maximal force on the individual to disperse. Developing proportional sensitivity to steeper gradients would then be unnecessarily costly for the individual, as it would not change the individual&#x02019;s dispersal behavior any further. To approximately incorporate such information saturation in the individual&#x02019;s perception of the environmental gradient, we replace <inline-formula id="IEq146"><alternatives><tex-math id="d33e4638">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e4643"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula> in (<xref rid="Equ11" ref-type="disp-formula">7</xref>) by the following <italic>perceived gradient</italic>:<disp-formula id="Equ13"><label>9</label><alternatives><tex-math id="d33e4659">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \widetilde{\nabla _x\textrm{Q}}(x):= \frac{\Pi }{\Pi + \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}^{\textrm{m}}}} \, \nabla _x\textrm{Q}(x), \qquad x \in \Omega _{\delta }, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e4665" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mfrac><mml:mspace width="0.166667em"/><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq147"><alternatives><tex-math id="d33e4737">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pi $$\end{document}</tex-math><mml:math id="d33e4742"><mml:mi mathvariant="normal">&#x003a0;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq147.gif"/></alternatives></inline-formula> is a constant that denotes the maximum perceived magnitude of the environmental grtadient. When <inline-formula id="IEq148"><alternatives><tex-math id="d33e4747">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e4752"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq44.gif"/></alternatives></inline-formula> is much smaller than <inline-formula id="IEq149"><alternatives><tex-math id="d33e4773">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pi $$\end{document}</tex-math><mml:math id="d33e4778"><mml:mi mathvariant="normal">&#x003a0;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq147.gif"/></alternatives></inline-formula>, the perceived gradient approximately equals the actual gradient. When <inline-formula id="IEq150"><alternatives><tex-math id="d33e4783">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e4788"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq44.gif"/></alternatives></inline-formula> is much larger than <inline-formula id="IEq151"><alternatives><tex-math id="d33e4809">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pi $$\end{document}</tex-math><mml:math id="d33e4814"><mml:mi mathvariant="normal">&#x003a0;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq147.gif"/></alternatives></inline-formula>, the magnitude of the perceived gradient approximately saturates to the maximum value <inline-formula id="IEq152"><alternatives><tex-math id="d33e4820">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pi $$\end{document}</tex-math><mml:math id="d33e4825"><mml:mi mathvariant="normal">&#x003a0;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq147.gif"/></alternatives></inline-formula>, but its direction will always be the same as the direction of the actual gradient. The smaller habitat <inline-formula id="IEq153"><alternatives><tex-math id="d33e4830">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega _{\delta }$$\end{document}</tex-math><mml:math id="d33e4835"><mml:msub><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq153.gif"/></alternatives></inline-formula> specified in (<xref rid="Equ13" ref-type="disp-formula">9</xref>) includes all points of <inline-formula id="IEq154"><alternatives><tex-math id="d33e4845">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><mml:math id="d33e4850"><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq59.gif"/></alternatives></inline-formula> except those that are closer than a constant <inline-formula id="IEq155"><alternatives><tex-math id="d33e4855">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta $$\end{document}</tex-math><mml:math id="d33e4860"><mml:mi>&#x003b4;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq155.gif"/></alternatives></inline-formula> to the boundary of <inline-formula id="IEq156"><alternatives><tex-math id="d33e4864">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><mml:math id="d33e4869"><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq59.gif"/></alternatives></inline-formula>. This is to avoid the complexity of exposition here (due to the indefiniteness of the gradient at boundary points) and to allow for simpler boundary conditions. In Appendix <xref rid="Sec28" ref-type="sec">A</xref>, we provide details on how to smoothly extend <inline-formula id="IEq157"><alternatives><tex-math id="d33e4878">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}(x)$$\end{document}</tex-math><mml:math id="d33e4883"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq157.gif"/></alternatives></inline-formula> in (<xref rid="Equ13" ref-type="disp-formula">9</xref>) to the whole habitat <inline-formula id="IEq158"><alternatives><tex-math id="d33e4905">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><mml:math id="d33e4910"><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq59.gif"/></alternatives></inline-formula>, based on the assumption that individuals can sense the habitat boundary and avoid crossing it. Specifically, for the one- and two-dimensional habitats that we simulate in this work, we use the definitions (<xref rid="Equ38" ref-type="disp-formula">21</xref>) and (<xref rid="Equ39" ref-type="disp-formula">22</xref>) given in Appendix <xref rid="Sec28" ref-type="sec">A</xref> for <inline-formula id="IEq159"><alternatives><tex-math id="d33e4925">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}(x)$$\end{document}</tex-math><mml:math id="d33e4930"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq157.gif"/></alternatives></inline-formula> over the entire habitat <inline-formula id="IEq160"><alternatives><tex-math id="d33e4949">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><mml:math id="d33e4954"><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq59.gif"/></alternatives></inline-formula>. Denoting the units of space and trait by <inline-formula id="IEq161"><alternatives><tex-math id="d33e4959">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{X}$$\end{document}</tex-math><mml:math id="d33e4964"><mml:mi mathvariant="monospace">X</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq161.gif"/></alternatives></inline-formula> and <inline-formula id="IEq162"><alternatives><tex-math id="d33e4969">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{Q}$$\end{document}</tex-math><mml:math id="d33e4974"><mml:mi mathvariant="monospace">Q</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq43.gif"/></alternatives></inline-formula>, respectively, we assume in all numerical simulations that the individuals can perceive the habitat boundary when they get as close as <inline-formula id="IEq163"><alternatives><tex-math id="d33e4979">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta = 2 \, \texttt{X}$$\end{document}</tex-math><mml:math id="d33e4984"><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq163.gif"/></alternatives></inline-formula> to the boundary. Moreover, we set the maximum perceived gradient to be <inline-formula id="IEq164"><alternatives><tex-math id="d33e4995">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pi = 1 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e5000"><mml:mrow><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq164.gif"/></alternatives></inline-formula>, which still corresponds to a relatively steep environmental gradient, as we discussed in Section 3.2 of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>). In our simulations, we use the dispersal propensity parameter <inline-formula id="IEq165"><alternatives><tex-math id="d33e5018">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e5023"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> as an adjustment parameter for the species&#x02019; total rate of optimal dispersal. <inline-formula id="IEq166"><alternatives><tex-math id="d33e5027">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="d33e5032"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq87.gif"/></alternatives></inline-formula></p><p>We note that the perceived gradient <inline-formula id="IEq167"><alternatives><tex-math id="d33e5037">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}$$\end{document}</tex-math><mml:math id="d33e5042"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq143.gif"/></alternatives></inline-formula> can also be interpreted, in some sense, as the sensitivity of the individuals&#x02019; dispersal force to changes in habitat quality. In nature, individuals of a species may develop a perception of the environmental gradient not only by directly sensing their environment&#x02019;s conditions, but also by collecting information through exploration (Armsworth and Roughgarden <xref ref-type="bibr" rid="CR4">2005</xref>; Selonen and Hanski <xref ref-type="bibr" rid="CR107">2006</xref>) and collective behavior of their conspecifics. The diffusive movement term (<xref rid="Equ1" ref-type="disp-formula">1a</xref>) that we have included in our model can additionally capture such exploratory movements of the individuals for the purpose of gaining a better perception of their environment&#x02019;s gradient. Tracking the environmental gradient can also occur through taxis, that is, in response to environmental stimuli (guides) that are strongly correlated with gradient of the optimum trait. For instance, changes in temperature, chemical concentration, topography, wind strength and direction, water flow, or light intensity can effectively canalize the movement of individuals in the direction of the environmental gradient (Baguette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2013</xref>).</p></sec><sec id="FPar4"><title>[Style3 Style3]Remark 4</title><p id="Par46"><italic>(Perceived phenotypic potential)</italic> An individual with the ability to locate and disperse to a matching habitat most likely can develop a reasonably accurate self-assessment of the mismatch between its phenotype and the environmental optimum, <inline-formula id="IEq168"><alternatives><tex-math id="d33e5072">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p - \textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e5077"><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq168.gif"/></alternatives></inline-formula>, or equivalently, a perception of the phenotypic potential <inline-formula id="IEq169"><alternatives><tex-math id="d33e5089">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(p - \textrm{Q}(x)) / \textrm{V}$$\end{document}</tex-math><mml:math id="d33e5094"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq169.gif"/></alternatives></inline-formula> at every location <italic>x</italic> in the habitat. We can model the perceived value of the phenotypic potential as a function <inline-formula id="IEq170"><alternatives><tex-math id="d33e5116">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f( (p-\textrm{Q})/\textrm{V})$$\end{document}</tex-math><mml:math id="d33e5121"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq170.gif"/></alternatives></inline-formula>. For example, <italic>f</italic> could reasonably be a saturation function similar to what we considered for the magnitude of the environmental gradient in Remark <xref ref-type="sec" rid="FPar3">3</xref>. However, the presence of such a nonlinear function of <italic>p</italic> in our model of optimal dispersal makes the derivation of the final equations of the model infeasible, or unnecessarily complicated. An alternative choice without over-complicating the derivations would be in the form <inline-formula id="IEq171"><alternatives><tex-math id="d33e5150">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f( (p-\textrm{Q})/\textrm{V}) = (p - \widetilde{\textrm{Q}}(x)) / \textrm{V}$$\end{document}</tex-math><mml:math id="d33e5155"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mover accent="true"><mml:mtext>Q</mml:mtext><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq171.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq172"><alternatives><tex-math id="d33e5197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\textrm{Q}}(x) = h(\textrm{Q}(x))$$\end{document}</tex-math><mml:math id="d33e5202"><mml:mrow><mml:mover accent="true"><mml:mtext>Q</mml:mtext><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq172.gif"/></alternatives></inline-formula> gives the perceived value of the trait optimum as a function <italic>h</italic> of its actual value. This particularly means that we assume the individual&#x02019;s assessment of its own phenotype is exact. Substituting this perception of the phenotypic potential for the exact value <inline-formula id="IEq173"><alternatives><tex-math id="d33e5233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(p - \textrm{Q}(x)) / \textrm{V}$$\end{document}</tex-math><mml:math id="d33e5238"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq169.gif"/></alternatives></inline-formula> in (<xref rid="Equ12" ref-type="disp-formula">8</xref>) would simply result in replacing <inline-formula id="IEq174"><alternatives><tex-math id="d33e5261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e5266"><mml:mrow><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq40.gif"/></alternatives></inline-formula> with its perception <inline-formula id="IEq175"><alternatives><tex-math id="d33e5276">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\textrm{Q}}(x)$$\end{document}</tex-math><mml:math id="d33e5281"><mml:mrow><mml:mover accent="true"><mml:mtext>Q</mml:mtext><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq175.gif"/></alternatives></inline-formula> in the optimal dispersal terms (<xref rid="Equ15" ref-type="disp-formula">10b</xref>), (<xref rid="Equ21" ref-type="disp-formula">11e</xref>), and (<xref rid="Equ27" ref-type="disp-formula">12e</xref>) of the model equations (<xref rid="Equ14" ref-type="disp-formula">10</xref>)&#x02013;(<xref rid="Equ23" ref-type="disp-formula">12</xref>) given in Sect.&#x000a0;<xref rid="Sec9" ref-type="sec">2.4</xref>. However, since we assume the perception of <italic>p</italic> is exact and it is likely that the ability to perceive the environmental optimum <inline-formula id="IEq176"><alternatives><tex-math id="d33e5317">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e5322"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> evolves jointly with the self-perception of <italic>p</italic>, we choose to set <inline-formula id="IEq177"><alternatives><tex-math id="d33e5330">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\textrm{Q}}(x) = \textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e5335"><mml:mrow><mml:mover accent="true"><mml:mtext>Q</mml:mtext><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq177.gif"/></alternatives></inline-formula> in all of our equations. This means that throughout this work we always assume that the perception of the phenotypic potential is exact. <inline-formula id="IEq178"><alternatives><tex-math id="d33e5357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="d33e5362"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq87.gif"/></alternatives></inline-formula></p></sec></sec><sec id="Sec9"><title>Model Equations</title><p id="Par47">The basic equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>) and its components described above provide the ingredients that we need for deriving the equations of our model for the joint evolution of a species&#x02019; population density <italic>n</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) and the mean value <italic>q</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) and variance <italic>v</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) of a quantitative fitness-related trait within the species&#x02019; population. Assumption (iv) is a key assumption in developing our model, as it allows for an exact moment closure in deriving the equations of trait mean and trait variance. In this section, we only present the final equations of our model. The derivation of the equations is provided in detail in Appendix <xref rid="Sec29" ref-type="sec">B</xref>.</p><p id="Par48">Before presenting the equations of the model, we note that the definitions of all model parameters and their plausible ranges of values are given in Table <xref rid="Tab1" ref-type="table">1</xref>. Note that <inline-formula id="IEq179"><alternatives><tex-math id="d33e5408">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{D}(x) \in \mathbb {R}^{\textrm{m}\times \textrm{m}}$$\end{document}</tex-math><mml:math id="d33e5413"><mml:mrow><mml:mtext>D</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x02208;</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mtext>m</mml:mtext><mml:mo>&#x000d7;</mml:mo><mml:mtext>m</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq179.gif"/></alternatives></inline-formula>, whereas the rest of the parameters are scalar-valued. Also, <inline-formula id="IEq180"><alternatives><tex-math id="d33e5433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e5438"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula>, <inline-formula id="IEq181"><alternatives><tex-math id="d33e5442">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{U}$$\end{document}</tex-math><mml:math id="d33e5447"><mml:mtext>U</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq38.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq182"><alternatives><tex-math id="d33e5451">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e5456"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> are assumed to be constant throughout the habitat, whereas <inline-formula id="IEq183"><alternatives><tex-math id="d33e5461">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{D}$$\end{document}</tex-math><mml:math id="d33e5466"><mml:mtext>D</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq18.gif"/></alternatives></inline-formula>, <inline-formula id="IEq184"><alternatives><tex-math id="d33e5470">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e5475"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula>, <inline-formula id="IEq185"><alternatives><tex-math id="d33e5479">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}$$\end{document}</tex-math><mml:math id="d33e5484"><mml:mtext>K</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq52.gif"/></alternatives></inline-formula>, <inline-formula id="IEq186"><alternatives><tex-math id="d33e5488">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e5493"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq187"><alternatives><tex-math id="d33e5497">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e5502"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> can be variable in space. Although their dependence on <italic>t</italic> is not explicitly shown in the equations, all these model parameters can also vary in time. A discussion of the choice of parameter units and their plausible values is provided in Sect.&#x000a0;<xref rid="Sec10" ref-type="sec">2.5</xref> below.</p><p id="Par49">Now, letting <inline-formula id="IEq188"><alternatives><tex-math id="d33e5515">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _t$$\end{document}</tex-math><mml:math id="d33e5520"><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq71.gif"/></alternatives></inline-formula> denote the partial derivative with respect to <italic>t</italic>, our equation for the evolution of the species&#x02019; population density <italic>n</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) for all <inline-formula id="IEq189"><alternatives><tex-math id="d33e5539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \in \Omega $$\end{document}</tex-math><mml:math id="d33e5544"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq80.gif"/></alternatives></inline-formula> and <inline-formula id="IEq190"><alternatives><tex-math id="d33e5552">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \in [0,T]$$\end{document}</tex-math><mml:math id="d33e5557"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq190.gif"/></alternatives></inline-formula> is given as <disp-formula id="Equ14"><label>10a</label><alternatives><tex-math id="d33e5570">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _tn(x,t)&#x00026;= {{\,\textrm{div}\,}}\left( \textrm{D}(x) \nabla _xn(x,t) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5576" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>D</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ15"><label>10b</label><alternatives><tex-math id="d33e5623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad - {{\,\textrm{div}\,}}\left( \textrm{A}(x) n(x,t) \frac{q(x,t) - \textrm{Q}(x)}{\textrm{V}} \widetilde{\nabla _x\textrm{Q}}(x) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5629" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ16"><label>10c</label><alternatives><tex-math id="d33e5693">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad + \left( \textrm{R}(x) - \frac{\textrm{R}(x)}{\textrm{K}(x)} \sqrt{\frac{\textrm{V}}{v(x,t)+\textrm{V}}} \, n(x,t) \right. \nonumber \\&#x00026;\quad \left. - \frac{\textrm{S}}{2} \left[ \big (q(x,t) - \textrm{Q}(x)\big )^2 + v(x,t)\right] \right) n(x,t). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5699" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfenced open="("><mml:mtext>R</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mtext>R</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>K</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msqrt><mml:mfrac><mml:mtext>V</mml:mtext><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac></mml:msqrt><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mfenced close=")"><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:mfrac><mml:mfenced close="]" open="["><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mfenced><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula> Further, letting <inline-formula id="IEq191"><alternatives><tex-math id="d33e5815">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle \cdot \, , \, \cdot \right\rangle _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e5820"><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:mo>&#x000b7;</mml:mo><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mo>&#x000b7;</mml:mo></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq191.gif"/></alternatives></inline-formula> denote the standard inner product in <inline-formula id="IEq192"><alternatives><tex-math id="d33e5835">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb {R}^{\textrm{m}}$$\end{document}</tex-math><mml:math id="d33e5840"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq132.gif"/></alternatives></inline-formula>, our equations for the population&#x02019;s trait mean <italic>q</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) and trait variance <italic>v</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) are <disp-formula id="Equ17"><label>11a</label><alternatives><tex-math id="d33e5868">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _tq(x,t)&#x00026;= {{\,\textrm{div}\,}}\left( \textrm{D}(x) \nabla _xq(x,t) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5874" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>D</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ18"><label>11b</label><alternatives><tex-math id="d33e5921">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad + 2 \left\langle \nabla _x\log n(x,t) \, , \, \textrm{D}(x) \nabla _xq(x,t) \right\rangle _{\mathbb {R}^{\textrm{m}}} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5927" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>D</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ19"><label>11c</label><alternatives><tex-math id="d33e5983">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad - {{\,\textrm{div}\,}}\left( \textrm{A}(x) \frac{v(x,t)}{\textrm{V}} \widetilde{\nabla _x\textrm{Q}}(x) \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5989" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ20"><label>11d</label><alternatives><tex-math id="d33e6037">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad - \left\langle \nabla _x\log n(x,t) \, , \, \textrm{A}(x) \frac{v(x,t)}{\textrm{V}} \widetilde{\nabla _x\textrm{Q}}(x) \right\rangle _{\mathbb {R}^{\textrm{m}}} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6043" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ21"><label>11e</label><alternatives><tex-math id="d33e6111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad - \left\langle \nabla _xq(x,t) \, , \, \textrm{A}(x) \frac{q(x,t) - \textrm{Q}(x)}{\textrm{V}} \widetilde{\nabla _x\textrm{Q}}(x) \right\rangle _{\mathbb {R}^{\textrm{m}}} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6117" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ22"><label>11f</label><alternatives><tex-math id="d33e6190">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad - \textrm{S}\, \big ( q(x,t) - \textrm{Q}(x) \big ) v(x,t), \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6196" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mtext>S</mml:mtext><mml:mspace width="0.166667em"/><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula> and <disp-formula id="Equ23"><label>12a</label><alternatives><tex-math id="d33e6241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _tv(x,t)&#x00026;= {{\,\textrm{div}\,}}(\textrm{D}(x) \nabla _xv(x,t)) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6247" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>D</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ24"><label>12b</label><alternatives><tex-math id="d33e6297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad + 2 \left\langle \nabla _x\log n(x,t) \, , \, \textrm{D}(x) \nabla _xv(x,t) \right\rangle _{\mathbb {R}^{\textrm{m}}} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6303" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>D</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ25"><label>12c</label><alternatives><tex-math id="d33e6359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad + 2 \left\langle \nabla _xq(x,t) \, , \, \textrm{D}(x) \nabla _xq(x,t) \right\rangle _{\mathbb {R}^{\textrm{m}}} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6365" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>D</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ26"><label>12d</label><alternatives><tex-math id="d33e6419">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad - 2 \left\langle \nabla _xq(x,t) \, , \, \textrm{A}(x)\frac{v(x,t)}{\textrm{V}} \widetilde{\nabla _x\textrm{Q}}(x) \right\rangle _{\mathbb {R}^{\textrm{m}}} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6425" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ26.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ27"><label>12e</label><alternatives><tex-math id="d33e6493">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad - \left\langle \nabla _xv(x,t) \, , \, \textrm{A}(x)\frac{q(x,t) - \textrm{Q}(x)}{\textrm{V}} \widetilde{\nabla _x\textrm{Q}}(x) \right\rangle _{\mathbb {R}^{\textrm{m}}} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6499" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ27.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ28"><label>12f</label><alternatives><tex-math id="d33e6572">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;\quad + \frac{\textrm{R}(x)}{\textrm{K}(x)} \sqrt{\frac{\textrm{V}}{v(x,t) + \textrm{V}}} \, \frac{n(x,t) v^2(x,t)}{2\big ( v(x,t) + \textrm{V}\big )} - \textrm{S}v^2(x,t) + \textrm{U}. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6578" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mtext>R</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mtext>K</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:msqrt><mml:mfrac><mml:mtext>V</mml:mtext><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac></mml:msqrt><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mtext>S</mml:mtext><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>U</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ28.gif" position="anchor"/></alternatives></disp-formula> For our simulations of a one-dimensional habitat <inline-formula id="IEq193"><alternatives><tex-math id="d33e6676">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega = (a,b)$$\end{document}</tex-math><mml:math id="d33e6681"><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq193.gif"/></alternatives></inline-formula>, we assume no phenotype flux through the habitat boundary. Since the perceived environmental gradient <inline-formula id="IEq194"><alternatives><tex-math id="d33e6695">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}$$\end{document}</tex-math><mml:math id="d33e6700"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq143.gif"/></alternatives></inline-formula> given by (<xref rid="Equ38" ref-type="disp-formula">21</xref>) in Appendix <xref rid="Sec28" ref-type="sec">A</xref> has no component normal to the boundary, the advection term (<xref rid="Equ2" ref-type="disp-formula">1b</xref>) does not result in any phenotype flux through the boundary. Therefore, our no-flux boundary assumption simply implies the homogeneous Neumann (reflecting) boundary conditions<disp-formula id="Equ29"><label>13</label><alternatives><tex-math id="d33e6722">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _x n = 0, \quad \partial _x q = 0, \quad \partial _x v = 0, \qquad \text {on } \{a, b\}\times [0,T], \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6728" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mtext>on</mml:mtext><mml:mspace width="0.333333em"/><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ29.gif" position="anchor"/></alternatives></disp-formula>which is the boundary condition we discussed in Remark 1 and Appendix A.5 of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>). For the two-dimensional habitat <inline-formula id="IEq195"><alternatives><tex-math id="d33e6785">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega = (a_1,b_1) \times (a_2,b_2)$$\end{document}</tex-math><mml:math id="d33e6790"><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq195.gif"/></alternatives></inline-formula> that we simulate in this work, we set reflecting boundary condition at boundary lines <inline-formula id="IEq196"><alternatives><tex-math id="d33e6822">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1 = a_1$$\end{document}</tex-math><mml:math id="d33e6827"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq196.gif"/></alternatives></inline-formula> and <inline-formula id="IEq197"><alternatives><tex-math id="d33e6838">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1 = b_1$$\end{document}</tex-math><mml:math id="d33e6843"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq197.gif"/></alternatives></inline-formula>, and we assume that the habitat is extended periodically in the <inline-formula id="IEq198"><alternatives><tex-math id="d33e6855">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_2$$\end{document}</tex-math><mml:math id="d33e6860"><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq198.gif"/></alternatives></inline-formula>-direction.</p><p id="Par50">In comparison with the equations of the single-species model that we studied in Section 4 of our previous work, the inclusion of the optimal dispersal strategy in the present work results in the additional term (<xref rid="Equ15" ref-type="disp-formula">10b</xref>) in the equation for population density, the terms (<xref rid="Equ19" ref-type="disp-formula">11c</xref>)&#x02013;(<xref rid="Equ21" ref-type="disp-formula">11e</xref>) in the equation for trait mean, and the terms (<xref rid="Equ26" ref-type="disp-formula">12d</xref>) and (<xref rid="Equ27" ref-type="disp-formula">12e</xref>) in the equation for trait variance. As a result, all quantitative measures of population dynamics, such as population density, speed of range expansion, local adaptation rates at both the range center (core) and range margins, asymmetric core-to-edge gene flow, and the dynamics of intraspecific trait variance are expected to be affected by individuals&#x02019; ability to disperse optimally to matching habitats. We demonstrate such impacts under different evolutionary regimes in our computational studies presented in Sect.&#x000a0;<xref rid="Sec15" ref-type="sec">4</xref>.</p></sec><sec id="Sec10"><title>Units and Parameter Values</title><p id="Par51">We use the same units as we discussed in our previous work for the quantities included in our model. Specifically, we denote the unit of time by <inline-formula id="IEq199"><alternatives><tex-math id="d33e6891">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{T}$$\end{document}</tex-math><mml:math id="d33e6896"><mml:mi mathvariant="monospace">T</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq199.gif"/></alternatives></inline-formula> and we set <inline-formula id="IEq200"><alternatives><tex-math id="d33e6901">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e6906"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq200.gif"/></alternatives></inline-formula> to be equal to the mean generation time of the species. For a one-dimensional habitat, we choose the unit of space so that the diffusion coefficient <inline-formula id="IEq201"><alternatives><tex-math id="d33e6914">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{D}$$\end{document}</tex-math><mml:math id="d33e6919"><mml:mtext>D</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq18.gif"/></alternatives></inline-formula> of the population becomes unity. That is, denoting the unit of space by <inline-formula id="IEq202"><alternatives><tex-math id="d33e6923">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{X}$$\end{document}</tex-math><mml:math id="d33e6928"><mml:mi mathvariant="monospace">X</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq161.gif"/></alternatives></inline-formula>, we set <inline-formula id="IEq203"><alternatives><tex-math id="d33e6933">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \, \texttt{X}$$\end{document}</tex-math><mml:math id="d33e6938"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq203.gif"/></alternatives></inline-formula> to be the root mean square of the (random) dispersal distance of the population in <inline-formula id="IEq204"><alternatives><tex-math id="d33e6947">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e6952"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq204.gif"/></alternatives></inline-formula>, divided by <inline-formula id="IEq205"><alternatives><tex-math id="d33e6960">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt{2}$$\end{document}</tex-math><mml:math id="d33e6965"><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq205.gif"/></alternatives></inline-formula>. Estimates of the random component of the species&#x02019; dispersal can be obtained, for example, by measuring dispersal distance of a subpopulation of individuals that are well adapted to the environment at the core of the population. Due to their negligible phenotype-environment mismatch, such individuals do not perceive a significant force compelling directed dispersal. For multi-dimensional habitats, the same approach can be used to set the unit of space for each spatial dimension independently. Moreover, we denote the unit of measurement for population abundances by <inline-formula id="IEq206"><alternatives><tex-math id="d33e6970">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{N}$$\end{document}</tex-math><mml:math id="d33e6975"><mml:mi mathvariant="monospace">N</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq206.gif"/></alternatives></inline-formula>. Having set the unit of space, we set <inline-formula id="IEq207"><alternatives><tex-math id="d33e6980">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \, \texttt{N}$$\end{document}</tex-math><mml:math id="d33e6985"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq207.gif"/></alternatives></inline-formula> to be equal to the carrying capacity of the environment for <inline-formula id="IEq208"><alternatives><tex-math id="d33e6993">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \, \texttt{X}^{\textrm{m}}$$\end{document}</tex-math><mml:math id="d33e6998"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mtext>m</mml:mtext></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq208.gif"/></alternatives></inline-formula> unit of habitat volume. This results in the carrying capacity becoming equal to unity. Finally, we denote the unit of measurement for the quantitative trait by <inline-formula id="IEq209"><alternatives><tex-math id="d33e7008">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{Q}$$\end{document}</tex-math><mml:math id="d33e7013"><mml:mi mathvariant="monospace">Q</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq43.gif"/></alternatives></inline-formula>, and we set <inline-formula id="IEq210"><alternatives><tex-math id="d33e7019">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \, \texttt{Q}$$\end{document}</tex-math><mml:math id="d33e7024"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq210.gif"/></alternatives></inline-formula> to be equal to one standard deviation of the trait values at the core of the population. Further discussion of our choices of units is available in Section 3.1 of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>).</p><p id="Par52">Our suggestions of plausible ranges of values given in Table <xref rid="Tab1" ref-type="table">1</xref> are discussed in detail in Section 3.2 of our previous work, except for the new parameter <inline-formula id="IEq211"><alternatives><tex-math id="d33e7040">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e7045"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula>. The values specified as &#x0201c;typical&#x0201d; in Table <xref rid="Tab1" ref-type="table">1</xref> are the values we use as default parameter values in our numerical simulations unless otherwise stated. Due to the level of abstraction that is inevitably present in our model of optimal dispersal, finding a biologically reasonable range of values for the dispersal propensity parameter <inline-formula id="IEq212"><alternatives><tex-math id="d33e7052">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e7057"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> based on empirical measurements available in the literature is infeasible. Instead, we investigate a range from 0 to 10 <inline-formula id="IEq213"><alternatives><tex-math id="d33e7061">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e7066"><mml:mrow><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq213.gif"/></alternatives></inline-formula> by simulating the model with different values of <inline-formula id="IEq214"><alternatives><tex-math id="d33e7079">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e7084"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> and observing the resulting range of variation in the population density, speed of range expansion waves, and magnitude of the trait variance. In an extreme situation, for example, if the mean value of the trait in (<xref rid="Equ15" ref-type="disp-formula">10b</xref>) differs from <inline-formula id="IEq215"><alternatives><tex-math id="d33e7091">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e7096"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> by one phenotype utilization variance and the magnitude of the environmental gradient is sufficiently greater than the preset value <inline-formula id="IEq216"><alternatives><tex-math id="d33e7100">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pi = 1 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e7105"><mml:mrow><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq164.gif"/></alternatives></inline-formula>, then a maximum dispersal (advection) rate of approximately <inline-formula id="IEq217"><alternatives><tex-math id="d33e7120">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10 \, \texttt{X}/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e7125"><mml:mrow><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">X</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq217.gif"/></alternatives></inline-formula> is created in a one-dimensional habitat at propensity value <inline-formula id="IEq218"><alternatives><tex-math id="d33e7137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e7142"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq218.gif"/></alternatives></inline-formula>.</p></sec></sec><sec id="Sec11"><title>Interpretation of the Model Equations</title><p id="Par53">Before presenting our numerical results, we discuss the interpretation of each of the terms involved in the equations. Inspecting the equations provides useful mechanistic insight into the less-intuitive impacts of phenotype-optimal dispersal.</p><sec id="Sec12"><title>Population Density Equation</title><p id="Par54">The diffusion term given by (<xref rid="Equ14" ref-type="disp-formula">10a</xref>) in our model gives the rate of change in the population density of the species due to random dispersal. In addition to modeling exploratory movement of individuals for developing perceptions of the environment, as we discussed before, this diffusion term can also incorporate the effects of other uniformed movements, such as short-range movements to escape kin competition or inbreeding (Clobert et&#x000a0;al. <xref ref-type="bibr" rid="CR25">2009</xref>). Moreover, the presence of this random dispersal term in the equations further makes it possible for local populations to leave a locally optimal location and eventually settle in a location that globally maximizes their phenotype-environment match.</p><p id="Par55">The advection term (<xref rid="Equ15" ref-type="disp-formula">10b</xref>) incorporates changes in population density due to directed optimal dispersal. When the mean phenotypic potential for optimal dispersal, <inline-formula id="IEq219"><alternatives><tex-math id="d33e7177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q}) / \textrm{V}$$\end{document}</tex-math><mml:math id="d33e7182"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq219.gif"/></alternatives></inline-formula>, and the perceived environmental gradient <inline-formula id="IEq220"><alternatives><tex-math id="d33e7196">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}$$\end{document}</tex-math><mml:math id="d33e7201"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq143.gif"/></alternatives></inline-formula> are both non-zero, the population density undergoes a directional change. If <inline-formula id="IEq221"><alternatives><tex-math id="d33e7213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q}) &#x0003e;0$$\end{document}</tex-math><mml:math id="d33e7218"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq221.gif"/></alternatives></inline-formula>, the whole population moves in the direction of the environmental gradient. If <inline-formula id="IEq222"><alternatives><tex-math id="d33e7231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q}) &#x0003c;0$$\end{document}</tex-math><mml:math id="d33e7236"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq222.gif"/></alternatives></inline-formula>, the population moves in the opposite direction. In either case, the mean mismatch <inline-formula id="IEq223"><alternatives><tex-math id="d33e7250">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|q - \textrm{Q}|$$\end{document}</tex-math><mml:math id="d33e7255"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq223.gif"/></alternatives></inline-formula> is reduced through the directed movement.</p><p id="Par56">The term <inline-formula id="IEq224"><alternatives><tex-math id="d33e7268">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\frac{\textrm{S}}{2}(q-\textrm{Q})^2$$\end{document}</tex-math><mml:math id="d33e7273"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq224.gif"/></alternatives></inline-formula> in (<xref rid="Equ16" ref-type="disp-formula">10c</xref>) shows the effects of natural selection in reducing the population density when the trait mean <italic>q</italic> differs from the optimum <inline-formula id="IEq225"><alternatives><tex-math id="d33e7297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e7302"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula>. The term <inline-formula id="IEq226"><alternatives><tex-math id="d33e7306">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\frac{\textrm{S}}{2} v$$\end{document}</tex-math><mml:math id="d33e7311"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:mfrac><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq226.gif"/></alternatives></inline-formula> in (<xref rid="Equ16" ref-type="disp-formula">10c</xref>) captures the effect of the phenotypic load imposed by natural selection on the population growth, compared with a monomorphic population. Note that greater values of trait variance create stronger phenotypic loads. The term <inline-formula id="IEq227"><alternatives><tex-math id="d33e7324">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\frac{\textrm{R}}{\textrm{K}} \sqrt{\textrm{V}/ (v+ \textrm{V})} n$$\end{document}</tex-math><mml:math id="d33e7329"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>R</mml:mtext><mml:mtext>K</mml:mtext></mml:mfrac><mml:msqrt><mml:mrow><mml:mtext>V</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq227.gif"/></alternatives></inline-formula> in (<xref rid="Equ16" ref-type="disp-formula">10c</xref>) represents the decrease in population growth rate due to the average intraspecific competition between the individuals. Unlike the phenotypic load, the average intraspecific competition becomes weaker when the trait variance <italic>v</italic> becomes larger. This is because larger trait variance implies greater average difference between phenotypes and hence less competition load due to (<xref rid="Equ7" ref-type="disp-formula">4</xref>). Furthermore, when individuals&#x02019; phenotype (resource) utilization variance <inline-formula id="IEq228"><alternatives><tex-math id="d33e7359">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e7364"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> becomes smaller, that means when the individuals become more specialized, the average competition becomes weaker. This is because there is a lower chance that specialists will utilize the same resources. Note that competitive release at small values of <inline-formula id="IEq229"><alternatives><tex-math id="d33e7369">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e7374"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> can allow for population density to increase significantly above <inline-formula id="IEq230"><alternatives><tex-math id="d33e7378">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}$$\end{document}</tex-math><mml:math id="d33e7383"><mml:mtext>K</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq52.gif"/></alternatives></inline-formula>, which is the carrying capacity we define for sufficiently competitive (generalist) individuals with <inline-formula id="IEq231"><alternatives><tex-math id="d33e7387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}\gg 1$$\end{document}</tex-math><mml:math id="d33e7392"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>&#x0226b;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq53.gif"/></alternatives></inline-formula>.</p></sec><sec id="Sec13"><title>Trait Mean Equation</title><p id="Par57">The terms (<xref rid="Equ17" ref-type="disp-formula">11a</xref>) and (<xref rid="Equ18" ref-type="disp-formula">11b</xref>) show how random gene flow caused by diffusive dispersal affects the rate of change of trait mean, or equivalently, the local adaptation rate of the population. The divergence term in (<xref rid="Equ17" ref-type="disp-formula">11a</xref>) represents the homogenizing effect of random gene flow. Since population density changes sharply at the range margin, <inline-formula id="IEq232"><alternatives><tex-math id="d33e7412">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\log n$$\end{document}</tex-math><mml:math id="d33e7417"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq232.gif"/></alternatives></inline-formula> in (<xref rid="Equ18" ref-type="disp-formula">11b</xref>) is significantly larger near the edge of the population, compared with the core. Therefore, (<xref rid="Equ18" ref-type="disp-formula">11b</xref>) effectively models asymmetric core-to-edge gene flow caused by random dispersal. In the absence of optimal dispersal, such maladaptive gene flow can potentially result in gene swamping at marginal populations (Lenormand <xref ref-type="bibr" rid="CR72">2002</xref>; Kirkpatrick and Barton <xref ref-type="bibr" rid="CR63">1997</xref>).</p><p id="Par58">The terms (<xref rid="Equ19" ref-type="disp-formula">11c</xref>)&#x02013;(<xref rid="Equ21" ref-type="disp-formula">11e</xref>) capture the effects of individual-level optimal dispersal on population-level local adaptation. For the divergence term (<xref rid="Equ19" ref-type="disp-formula">11c</xref>), we can use the product rule for the divergence of a scalar field times a vector field<xref ref-type="fn" rid="Fn4">4</xref> (with the scalar field <italic>v</italic>) to write <disp-formula id="Equ30"><label>14a</label><alternatives><tex-math id="d33e7520">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} - {{\,\textrm{div}\,}}\left( \textrm{A}(x) \frac{v(x,t)}{\textrm{V}} \widetilde{\nabla _x\textrm{Q}}(x) \right) =&#x00026;-\left\langle \frac{\nabla _xv(x,t)}{\textrm{V}} \, , \, \textrm{A}(x) \widetilde{\nabla _x\textrm{Q}}(x) \right\rangle _{\mathbb {R}^{\textrm{m}}} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e7526" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ30.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ31"><label>14b</label><alternatives><tex-math id="d33e7624">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;- \frac{v(x,t)}{\textrm{V}} {{\,\textrm{div}\,}}\left( \textrm{A}(x)\widetilde{\nabla _x\textrm{Q}}(x) \right) . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e7630" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ31.gif" position="anchor"/></alternatives></disp-formula> The inner product term (<xref rid="Equ30" ref-type="disp-formula">14a</xref>) implies that, due to directed movements, the trait mean in a local population decreases when the gradient in population&#x02019;s trait variance is aligned, or makes an acute angle, with the gradient in trait optimum. The trait mean increases if the two gradients make an obtuse angle, or point in opposite directions. The simulation results provided in our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>, Figure 2) and the results given in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> below, as well as empirical observations (Takahashi et&#x000a0;al. <xref ref-type="bibr" rid="CR115">2016</xref>), show that trait variance during the range expansion of a species&#x02014;over a continuous habitat with linearly varying trait optimum&#x02014;decreases from core to edge. This means that, trait variance gradient will point in the same direction as of the environmental gradient on one side of the population&#x02019;s range, whereas it will point in the opposite direction on the other side. As a result, changes in the trait mean due to (<xref rid="Equ30" ref-type="disp-formula">14a</xref>) will be increasing on one side and decreasing on the other side. Such changes are often adaptive. For instance, due to (<xref rid="Equ30" ref-type="disp-formula">14a</xref>), the trait mean in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> will increase in the right half of the population&#x02019;s range, and will decrease in the left half. In both cases, the population gets better adapted to the environmental optimum trait.</p><p id="Par60">The component (<xref rid="Equ31" ref-type="disp-formula">14b</xref>) of (<xref rid="Equ19" ref-type="disp-formula">11c</xref>) shows that divergence in the perceived environmental gradient can indeed result in changes to the trait mean, even if population density and trait variance are spatially homogeneous. When <inline-formula id="IEq235"><alternatives><tex-math id="d33e7709">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}(x) $$\end{document}</tex-math><mml:math id="d33e7714"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq235.gif"/></alternatives></inline-formula> is constant, as we assume throughout this work, trait mean is decreased by (<xref rid="Equ31" ref-type="disp-formula">14b</xref>) if <inline-formula id="IEq236"><alternatives><tex-math id="d33e7727">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\textrm{div}\,}}\left( \widetilde{\nabla _x\textrm{Q}}(x) \right) &#x0003e; 0$$\end{document}</tex-math><mml:math id="d33e7732"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq236.gif"/></alternatives></inline-formula>. An illustration of the movement rates and directions that result in such a decrease in trait mean is provided in Figure S1. Similarly, trait mean increases when <inline-formula id="IEq237"><alternatives><tex-math id="d33e7759">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\textrm{div}\,}}\left( \widetilde{\nabla _x\textrm{Q}}(x) \right) &#x0003c; 0$$\end{document}</tex-math><mml:math id="d33e7764"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>&#x0003c;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq237.gif"/></alternatives></inline-formula>. Knowing that <inline-formula id="IEq238"><alternatives><tex-math id="d33e7790">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\textrm{div}\,}}\left( \widetilde{\nabla _x\textrm{Q}}(x) \right) $$\end{document}</tex-math><mml:math id="d33e7795"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq238.gif"/></alternatives></inline-formula> is in fact the (perceived) Laplacian of the trait optimum at <italic>x</italic>, we can also think of the effect of (<xref rid="Equ31" ref-type="disp-formula">14b</xref>) as changing the trait mean in an opposite direction to the local average change<xref ref-type="fn" rid="Fn5">5</xref> in the trait optimum. Depending on the value of the trait mean, and in particular on whether it is below the trait optimum or above it, such changes can be adaptive or maladaptive to the population. However, even if the pure effect of divergence in perceived environmental gradient appears to be maladaptive, its combined effect with the several other components of the optimal dispersal that are present in the model&#x02014;which jointly affect population density, trait mean, and trait variance&#x02014;can still be adaptive. In this work, however, we always assume that the environmental gradient is constant in both space and time. This implies that <inline-formula id="IEq244"><alternatives><tex-math id="d33e7962">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\textrm{div}\,}}\left( \widetilde{\nabla _x\textrm{Q}}(x) \right) = 0$$\end{document}</tex-math><mml:math id="d33e7967"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq244.gif"/></alternatives></inline-formula> in our simulations, except in the close vicinity of the habitat boundary. Therefore, (<xref rid="Equ31" ref-type="disp-formula">14b</xref>) does not have any impact on the local adaptation that we observe in our results due to phenotype-optimal dispersal.</p><p id="Par62">As with (<xref rid="Equ18" ref-type="disp-formula">11b</xref>), the presence of <inline-formula id="IEq245"><alternatives><tex-math id="d33e8002">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\log n$$\end{document}</tex-math><mml:math id="d33e8007"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq232.gif"/></alternatives></inline-formula> in (<xref rid="Equ20" ref-type="disp-formula">11d</xref>) implies that this term mainly represents the asymmetric core-to-edge effects of gene flow caused by directed dispersal. To understand whether the effects of (<xref rid="Equ20" ref-type="disp-formula">11d</xref>) are adaptive or maladaptive, we first note that (<xref rid="Equ20" ref-type="disp-formula">11d</xref>) can be rewritten by taking the scalar term <inline-formula id="IEq246"><alternatives><tex-math id="d33e8027">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}(x) \frac{v(x,t)}{\textrm{V}} \ge 0$$\end{document}</tex-math><mml:math id="d33e8032"><mml:mrow><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq246.gif"/></alternatives></inline-formula> out of the inner product, giving <inline-formula id="IEq247"><alternatives><tex-math id="d33e8056">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$- \textrm{A}(x) \frac{v(x,t)}{\textrm{V}} \left\langle \nabla _x\log n(x,t) \, , \, \widetilde{\nabla _x\textrm{Q}}(x) \right\rangle _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e8061"><mml:mrow><mml:mo>-</mml:mo><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq247.gif"/></alternatives></inline-formula>. Due to the population&#x02019;s adaptation to the environment during its range expansion, <inline-formula id="IEq248"><alternatives><tex-math id="d33e8123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xq$$\end{document}</tex-math><mml:math id="d33e8128"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq248.gif"/></alternatives></inline-formula> is expected to be aligned with <inline-formula id="IEq249"><alternatives><tex-math id="d33e8137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}$$\end{document}</tex-math><mml:math id="d33e8142"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq143.gif"/></alternatives></inline-formula>, which implies that (<xref rid="Equ20" ref-type="disp-formula">11d</xref>) and (<xref rid="Equ18" ref-type="disp-formula">11b</xref>) have opposite signs. As a result, the core-to-edge directed gene flow caused by phenotype-optimal dispersal will indeed be adaptive at the range margin, unlike the maladaptive effects of the asymmetric gene flow created by random dispersal. Therefore, (<xref rid="Equ20" ref-type="disp-formula">11d</xref>) represents one of the main effects of matching habitat choice on facilitating adaptation at range margins. Note that, (<xref rid="Equ20" ref-type="disp-formula">11d</xref>) further implies that larger values of trait variance makes such adaptive effects stronger.</p><p id="Par63">The inner product term (<xref rid="Equ21" ref-type="disp-formula">11e</xref>) shows how the mean phenotypic potential for optimal dispersal, <inline-formula id="IEq250"><alternatives><tex-math id="d33e8172">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q}) / \textrm{V}$$\end{document}</tex-math><mml:math id="d33e8177"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq219.gif"/></alternatives></inline-formula>, and the perceived environmental gradient directly cause local adaption. First note that (<xref rid="Equ21" ref-type="disp-formula">11e</xref>) can be rewritten as <inline-formula id="IEq251"><alternatives><tex-math id="d33e8194">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$- \textrm{A}(x) \frac{q(x,t) - \textrm{Q}(x)}{\textrm{V}} \left\langle \nabla _xq(x,t) \, , \, \widetilde{\nabla _x\textrm{Q}}(x) \right\rangle _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e8199"><mml:mrow><mml:mo>-</mml:mo><mml:mtext>A</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq251.gif"/></alternatives></inline-formula>. Due to the expected alignment between the directions of <inline-formula id="IEq252"><alternatives><tex-math id="d33e8267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xq$$\end{document}</tex-math><mml:math id="d33e8272"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq248.gif"/></alternatives></inline-formula> and <inline-formula id="IEq253"><alternatives><tex-math id="d33e8282">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}$$\end{document}</tex-math><mml:math id="d33e8287"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq143.gif"/></alternatives></inline-formula>, (<xref rid="Equ21" ref-type="disp-formula">11e</xref>) is then negative when <inline-formula id="IEq254"><alternatives><tex-math id="d33e8302">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q}) &#x0003e;0$$\end{document}</tex-math><mml:math id="d33e8307"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq221.gif"/></alternatives></inline-formula> and it is positive when <inline-formula id="IEq255"><alternatives><tex-math id="d33e8320">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q}) &#x0003c; 0$$\end{document}</tex-math><mml:math id="d33e8325"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq255.gif"/></alternatives></inline-formula>. In either case, the resulting change in trait mean due to (<xref rid="Equ21" ref-type="disp-formula">11e</xref>) is adaptive, that is, it decreases the magnitude of the mismatch <inline-formula id="IEq256"><alternatives><tex-math id="d33e8341">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|q - \textrm{Q}|$$\end{document}</tex-math><mml:math id="d33e8346"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq223.gif"/></alternatives></inline-formula>. Importantly, (<xref rid="Equ21" ref-type="disp-formula">11e</xref>) explicitly shows that the rate of population-level adaptation is higher when the mean phenotypic potential of individuals for optimal dispersal is greater and their perceived environmental gradient is steeper. Note that, as the population gradually adapts to the environment, the mean phenotypic potential for dispersal decreases asymptotically. This means that, the rate of adaption caused by (<xref rid="Equ21" ref-type="disp-formula">11e</xref>) decreases as the population gradually gets better adapted to the environment. Yet (due to the terms (<xref rid="Equ19" ref-type="disp-formula">11c</xref>) and (<xref rid="Equ20" ref-type="disp-formula">11d</xref>) we discussed above) the presence of trait variation in the population provides an additional adaptation force independent of the mean mismatch <inline-formula id="IEq257"><alternatives><tex-math id="d33e8370">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|q - \textrm{Q}|$$\end{document}</tex-math><mml:math id="d33e8375"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq223.gif"/></alternatives></inline-formula>, which works to enhance the overall rate of adaptation.</p><p id="Par64">Finally, the reaction term (<xref rid="Equ22" ref-type="disp-formula">11f</xref>) represents local adaptation by natural selection. When <inline-formula id="IEq258"><alternatives><tex-math id="d33e8391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q-\textrm{Q}) &#x0003e;0$$\end{document}</tex-math><mml:math id="d33e8396"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq258.gif"/></alternatives></inline-formula>, this term forces a decreasing change in <italic>q</italic>, which results in a decrease in <inline-formula id="IEq259"><alternatives><tex-math id="d33e8412">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|q-\textrm{Q}|$$\end{document}</tex-math><mml:math id="d33e8417"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq259.gif"/></alternatives></inline-formula> and enhanced local adaptation. Similarly, when <inline-formula id="IEq260"><alternatives><tex-math id="d33e8428">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q-\textrm{Q}) &#x0003c;0$$\end{document}</tex-math><mml:math id="d33e8433"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq260.gif"/></alternatives></inline-formula>, the trait mean <italic>q</italic> increases due to (<xref rid="Equ22" ref-type="disp-formula">11f</xref>), leading to a decrease in <inline-formula id="IEq261"><alternatives><tex-math id="d33e8453">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|q-\textrm{Q}|$$\end{document}</tex-math><mml:math id="d33e8458"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq259.gif"/></alternatives></inline-formula> and better adaptation. Importantly, (<xref rid="Equ22" ref-type="disp-formula">11f</xref>) demonstrates the crucial role of genetic variation in enabling adaptation by natural selection. The adaptation rate controlled by (<xref rid="Equ22" ref-type="disp-formula">11f</xref>) is directly proportional to the level of trait variance <italic>v</italic>. Larger values of <italic>v</italic> imply greater amounts of genetic variation for natural selection to act upon, and hence faster adaption rates by natural selection.</p></sec><sec id="Sec14"><title>Trait Variance Equation</title><p id="Par65">The terms (<xref rid="Equ23" ref-type="disp-formula">12a</xref>)&#x02013;(<xref rid="Equ25" ref-type="disp-formula">12c</xref>) represent the effects of random dispersal on rate of change of trait variance. Along with (<xref rid="Equ17" ref-type="disp-formula">11a</xref>), which tends to homogenize trait mean, the divergence term in (<xref rid="Equ23" ref-type="disp-formula">12a</xref>) tends to homogenize trait variance. Therefore, (<xref rid="Equ17" ref-type="disp-formula">11a</xref>) and (<xref rid="Equ23" ref-type="disp-formula">12a</xref>) together capture the homogenizing effects of random gene flow on population&#x02019;s phenotypes. As with what we described above for the trait mean equation, the presence of the term <inline-formula id="IEq262"><alternatives><tex-math id="d33e8505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\log n$$\end{document}</tex-math><mml:math id="d33e8510"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq232.gif"/></alternatives></inline-formula> in (<xref rid="Equ24" ref-type="disp-formula">12b</xref>) implies that (<xref rid="Equ24" ref-type="disp-formula">12b</xref>) mainly captures the effects of asymmetric core-to-edge random gene flow on trait variance. As our simulation results shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> below imply, <inline-formula id="IEq263"><alternatives><tex-math id="d33e8529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\log n$$\end{document}</tex-math><mml:math id="d33e8534"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq232.gif"/></alternatives></inline-formula> and <inline-formula id="IEq264"><alternatives><tex-math id="d33e8545">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xv$$\end{document}</tex-math><mml:math id="d33e8550"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq264.gif"/></alternatives></inline-formula> are often aligned with each other during the range expansion of a population. Therefore, (<xref rid="Equ24" ref-type="disp-formula">12b</xref>) is expected to be positive, and hence it tends to increase trait variance at range margins, as the range expands. This can explain a traveling-wave profile for trait variance, as we observe in our numerical simulations. The inner product term (<xref rid="Equ25" ref-type="disp-formula">12c</xref>) is always positive, and it depends on the magnitude of the gradient in trait mean. Since the population typically is well-adapted at its core, <inline-formula id="IEq265"><alternatives><tex-math id="d33e8565">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xq$$\end{document}</tex-math><mml:math id="d33e8570"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq248.gif"/></alternatives></inline-formula> closely follows <inline-formula id="IEq266"><alternatives><tex-math id="d33e8579">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e8584"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula> at central regions of the range. As a result, (<xref rid="Equ25" ref-type="disp-formula">12c</xref>) is the term which is responsible for inflating trait variance at the population&#x02019;s core; a well-known effect of random gene flow over an environmental gradient (Barton <xref ref-type="bibr" rid="CR7">2001</xref>; Garant et&#x000a0;al. <xref ref-type="bibr" rid="CR47">2007</xref>; Lenormand <xref ref-type="bibr" rid="CR72">2002</xref>). The steeper the environmental gradient, the larger the trait variance at central populations.</p><p id="Par66">The terms (<xref rid="Equ26" ref-type="disp-formula">12d</xref>) and (<xref rid="Equ27" ref-type="disp-formula">12e</xref>) give the effects of the non-random gene flow created by optimal dispersal on the rate of change of trait variance. Since <inline-formula id="IEq267"><alternatives><tex-math id="d33e8614">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xq$$\end{document}</tex-math><mml:math id="d33e8619"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq248.gif"/></alternatives></inline-formula> and <inline-formula id="IEq268"><alternatives><tex-math id="d33e8628">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e8633"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula> are expected to be in the same direction as the population adapts to the environment, (<xref rid="Equ26" ref-type="disp-formula">12d</xref>) typically takes negative values. Therefore, trait variance is reduced due to (<xref rid="Equ26" ref-type="disp-formula">12d</xref>). Since <inline-formula id="IEq269"><alternatives><tex-math id="d33e8649">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xq$$\end{document}</tex-math><mml:math id="d33e8654"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq248.gif"/></alternatives></inline-formula> follows <inline-formula id="IEq270"><alternatives><tex-math id="d33e8663">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e8668"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula> more closely in central regions, where the population is well-adapted to the environment, and since <italic>v</italic> is also larger in those regions, the reduction in trait variance caused by (<xref rid="Equ26" ref-type="disp-formula">12d</xref>) is significantly stronger at the well-adapted core of the population. The mismatch <inline-formula id="IEq271"><alternatives><tex-math id="d33e8683">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q-\textrm{Q})$$\end{document}</tex-math><mml:math id="d33e8688"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq271.gif"/></alternatives></inline-formula> and the gradient <inline-formula id="IEq272"><alternatives><tex-math id="d33e8700">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xv$$\end{document}</tex-math><mml:math id="d33e8705"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq264.gif"/></alternatives></inline-formula> in (<xref rid="Equ27" ref-type="disp-formula">12e</xref>) both take larger magnitudes near the range margins, where the population is not strongly well-adapted. As a result, (<xref rid="Equ27" ref-type="disp-formula">12e</xref>) mainly influences the trait variance at marginal populations. As discussed in our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>, Sect. 2.1), and shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> below, the decreasing core-to-edge profile of trait variance during range expansion over a constant environmental gradient (linearly changing <inline-formula id="IEq273"><alternatives><tex-math id="d33e8726">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e8731"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula>) is directly related to the spatial profile of the trait mean. Near the peripheral regions, over which maladaptive gene flow causes <italic>q</italic> to fall below the optimum <inline-formula id="IEq274"><alternatives><tex-math id="d33e8739">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e8744"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula>, trait variance decreases in the direction of the environmental gradient. That is, when <inline-formula id="IEq275"><alternatives><tex-math id="d33e8748">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q}) &#x0003c; 0$$\end{document}</tex-math><mml:math id="d33e8753"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq255.gif"/></alternatives></inline-formula>, we expect <inline-formula id="IEq276"><alternatives><tex-math id="d33e8766">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\langle \nabla _xv \, , \, \widetilde{\nabla _x\textrm{Q}} \right\rangle _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e8771"><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq276.gif"/></alternatives></inline-formula> to be negative. This implies that (<xref rid="Equ27" ref-type="disp-formula">12e</xref>) will be negative when <inline-formula id="IEq277"><alternatives><tex-math id="d33e8801">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q}) &#x0003c; 0$$\end{document}</tex-math><mml:math id="d33e8806"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq255.gif"/></alternatives></inline-formula>. Likewise, near the peripheral regions over which <inline-formula id="IEq278"><alternatives><tex-math id="d33e8820">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q}) &#x0003e; 0$$\end{document}</tex-math><mml:math id="d33e8825"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq278.gif"/></alternatives></inline-formula>, we observe <italic>v</italic> to be increasing in the direction of the environmental gradient. As a result, (<xref rid="Equ27" ref-type="disp-formula">12e</xref>) will also be negative when <inline-formula id="IEq279"><alternatives><tex-math id="d33e8844">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q}) &#x0003e; 0$$\end{document}</tex-math><mml:math id="d33e8849"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq278.gif"/></alternatives></inline-formula>. Therefore, in any case, (<xref rid="Equ27" ref-type="disp-formula">12e</xref>) tends to decrease the trait variance, predominantly within less-adapted marginal populations.</p><p id="Par67">The above discussion implies that the directed gene flow generated by phenotype-optimal dispersal reduces trait variance both within marginal and central populations. As we pointed out in the Introduction section, reducing phenotypic variation within local populations is in fact one of the most important predicted effects of matching habitat choice. The terms (<xref rid="Equ26" ref-type="disp-formula">12d</xref>) and (<xref rid="Equ27" ref-type="disp-formula">12e</xref>) in our model show how this reduction is controlled by the interaction between several factors, such as mean phenotypic potential for optimal dispersal <inline-formula id="IEq280"><alternatives><tex-math id="d33e8873">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q-\textrm{Q})/ \textrm{V}$$\end{document}</tex-math><mml:math id="d33e8878"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq280.gif"/></alternatives></inline-formula>, trait variance, perceived environmental gradient, and gradient in trait mean and variance.</p><p id="Par68">The first term in (<xref rid="Equ28" ref-type="disp-formula">12f</xref>) models the effects of intraspecific competition on the rate of change of trait variance. Note that this term is always nonnegative, implying that competition tends to increase trait variance. This is because competition reduces the fitness of individuals with close phenotype values, while it does not significantly affect the individuals with sufficiently different phenotypes. When <inline-formula id="IEq281"><alternatives><tex-math id="d33e8897">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}\rightarrow \infty $$\end{document}</tex-math><mml:math id="d33e8902"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>&#x0221e;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq281.gif"/></alternatives></inline-formula>, that is, when individuals become highly generalist, the competition term in (<xref rid="Equ28" ref-type="disp-formula">12f</xref>) vanishes to zero and causes no inflation in trait variance. This is because competition affects the fitness of highly generalist individuals almost uniformly, as these individuals almost equally utilize all available resources regardless of their phenotype. As a result, no phenotype variation is generated by the competition between them. When <inline-formula id="IEq282"><alternatives><tex-math id="d33e8913">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}\rightarrow 0$$\end{document}</tex-math><mml:math id="d33e8918"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq282.gif"/></alternatives></inline-formula>, that is, when individuals become highly specialist, the term <inline-formula id="IEq283"><alternatives><tex-math id="d33e8926">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt{\textrm{V}/ (v + \textrm{V})}$$\end{document}</tex-math><mml:math id="d33e8931"><mml:msqrt><mml:mrow><mml:mtext>V</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq283.gif"/></alternatives></inline-formula> in (<xref rid="Equ28" ref-type="disp-formula">12f</xref>) converges to zero. However, the competitive release gained by the population when <inline-formula id="IEq284"><alternatives><tex-math id="d33e8950">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}\rightarrow 0$$\end{document}</tex-math><mml:math id="d33e8955"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq282.gif"/></alternatives></inline-formula> allows for the maximum steady-state population density <italic>n</italic>, controlled by (<xref rid="Equ16" ref-type="disp-formula">10c</xref>), to take arbitrarily large values. As a result, the competition term in (<xref rid="Equ28" ref-type="disp-formula">12f</xref>) remains positive (non-zero) when <inline-formula id="IEq285"><alternatives><tex-math id="d33e8972">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}\rightarrow 0$$\end{document}</tex-math><mml:math id="d33e8977"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq282.gif"/></alternatives></inline-formula>. Our computations of spatially homogeneous steady-state values of trait variance imply that, when <inline-formula id="IEq286"><alternatives><tex-math id="d33e8986">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}\rightarrow 0$$\end{document}</tex-math><mml:math id="d33e8991"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq282.gif"/></alternatives></inline-formula>, trait variance increases to a finite value due to this non-zero competition term; see Figs.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b and S4b for <inline-formula id="IEq287"><alternatives><tex-math id="d33e9002">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0$$\end{document}</tex-math><mml:math id="d33e9007"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq287.gif"/></alternatives></inline-formula>.</p><p id="Par69">The term <inline-formula id="IEq288"><alternatives><tex-math id="d33e9016">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\textrm{S}v^2$$\end{document}</tex-math><mml:math id="d33e9021"><mml:mrow><mml:mo>-</mml:mo><mml:mtext>S</mml:mtext><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq288.gif"/></alternatives></inline-formula> in in (<xref rid="Equ28" ref-type="disp-formula">12f</xref>) represents the well-known effect of natural selection in eroding genetic variation by eliminating less-fit individuals. Note that, the larger the trait variance <italic>v</italic>, the stronger the effect of natural selection, and hence the higher the rate of reduction in <italic>v</italic>. Finally, the presence of the constant term <inline-formula id="IEq289"><alternatives><tex-math id="d33e9039">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{U}$$\end{document}</tex-math><mml:math id="d33e9044"><mml:mtext>U</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq38.gif"/></alternatives></inline-formula> in (<xref rid="Equ28" ref-type="disp-formula">12f</xref>) shows the effect of mutation, as a perpetual source of genetic variation within the population.</p></sec></sec><sec id="Sec15"><title>Results</title><p id="Par70">To determine when, if ever, and how phenotype-optimal dispersal markedly affects range dynamics and adaptation, we solve the equations of the model (<xref rid="Equ14" ref-type="disp-formula">10</xref>)&#x02013;(<xref rid="Equ23" ref-type="disp-formula">12</xref>) numerically using the parameter values given in Table <xref rid="Tab1" ref-type="table">1</xref>. Our discussion in Sect.&#x000a0;<xref rid="Sec11" ref-type="sec">3</xref> indicates how each of the eco-evolutionary forces incorporated into the model influences, separately, the species&#x02019; range evolution. However, numerical studies are necessary since intuition is inadequate for predicting how these forces interact to determine population density and trait moments dynamics. Moreover, a rigorous analytical study of our model is infeasible, due to its level of complexity.</p><p id="Par71">In all except one of our numerical studies we consider a one-dimensional continuous habitat with linearly changing environmental optimum phenotype. Our only study in a two-dimensional habitat investigates the effects of phenotype-optimal dispersal in the presence of habitat fragmentation. The details of the numerical scheme we use to compute the solutions are given in Appendix&#x000a0;<xref rid="Sec29" ref-type="sec">B</xref> of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>). A discussion of the challenges in numerical computation of the solutions can also be found in Section 6.5 of our previous work.</p><sec id="Sec16"><title>Adaptive Range Dynamics with Phenotype-Optimal Dispersal</title><p id="Par72">We first demonstrate how optimal dispersal changes the spatiotemporal population dynamics of a species. To isolate the effects of phenotype-optimal dispersal, we carry out pairs of numerical simulations that are identical except that only one incorporates this form of dispersal. Specifically, in one of the simulations we only consider random dispersal, which means that we set <inline-formula id="IEq290"><alternatives><tex-math id="d33e9080">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e9085"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq290.gif"/></alternatives></inline-formula>. In the other simulation we additionally include strong optimal dispersal, by setting <inline-formula id="IEq291"><alternatives><tex-math id="d33e9101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e9106"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq218.gif"/></alternatives></inline-formula>. The other parameters of the model remain the same in both simulations. Other than the trait optimum <inline-formula id="IEq292"><alternatives><tex-math id="d33e9122">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e9127"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula>, which is considered to be linearly increasing over <inline-formula id="IEq293"><alternatives><tex-math id="d33e9131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><mml:math id="d33e9136"><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq59.gif"/></alternatives></inline-formula>, the rest of the parameters are assumed to be constant. We consider a one-dimensional habitat <inline-formula id="IEq294"><alternatives><tex-math id="d33e9141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega = (-50\; \texttt{X},50\; \texttt{X}) \subset \mathbb {R}$$\end{document}</tex-math><mml:math id="d33e9146"><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>50</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">X</mml:mi><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02282;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq294.gif"/></alternatives></inline-formula> with the reflecting boundary conditions (<xref rid="Equ29" ref-type="disp-formula">13</xref>).</p><sec id="Sec17"><title>Range Evolution in Steep Environmental Gradients</title><p id="Par73">To make the effects of optimal dispersal strong enough to be clearly visible in our graphs, we consider a steep environmental gradient of <inline-formula id="IEq295"><alternatives><tex-math id="d33e9179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x \text {Q}= 1.5 \; \texttt {Q}/\texttt {X}$$\end{document}</tex-math><mml:math id="d33e9184"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq295.gif"/></alternatives></inline-formula>. We initially introduce the species at the center of the habitat with a density given as <inline-formula id="IEq296"><alternatives><tex-math id="d33e9202">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n(x,0) = 0.5 {{\,\textrm{sech}\,}}( |x| / \sqrt{2} )$$\end{document}</tex-math><mml:math id="d33e9207"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>sech</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq296.gif"/></alternatives></inline-formula>. We assume that the trait mean in this initial population varies linearly in space, with the constant gradient of <inline-formula id="IEq297"><alternatives><tex-math id="d33e9240">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xq(x,0) = 0.6\, \nabla _x\textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e9245"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.6</mml:mn><mml:mspace width="0.166667em"/><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq297.gif"/></alternatives></inline-formula>. We further assume that the initial population is perfectly adapted to the environment at the center, <inline-formula id="IEq298"><alternatives><tex-math id="d33e9276">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q(0,0) = \textrm{Q}(0)$$\end{document}</tex-math><mml:math id="d33e9281"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq298.gif"/></alternatives></inline-formula>, and has a constant trait variance of <inline-formula id="IEq299"><alternatives><tex-math id="d33e9300">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v(x,0) = 1 \; \texttt{Q}^2$$\end{document}</tex-math><mml:math id="d33e9305"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">Q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq299.gif"/></alternatives></inline-formula>. The results of our simulations over the computation time horizon of <inline-formula id="IEq300"><alternatives><tex-math id="d33e9326">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T = 40\; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e9331"><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq300.gif"/></alternatives></inline-formula> are shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Adaptive range dynamics of a species in a one-dimensional habitat with steep environmental gradient. Here, <inline-formula id="IEq301"><alternatives><tex-math id="d33e9350">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{m}= 1$$\end{document}</tex-math><mml:math id="d33e9355"><mml:mrow><mml:mtext>m</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq301.gif"/></alternatives></inline-formula>, <inline-formula id="IEq302"><alternatives><tex-math id="d33e9362">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e9367"><mml:mrow><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq40.gif"/></alternatives></inline-formula> is linear in <italic>x</italic> with a relatively steep gradient of <inline-formula id="IEq303"><alternatives><tex-math id="d33e9380">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 1.5 \; \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e9385"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq303.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq304"><alternatives><tex-math id="d33e9403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}(x)$$\end{document}</tex-math><mml:math id="d33e9408"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq27.gif"/></alternatives></inline-formula> is constant, taking different values in panels (<bold>a</bold>) and (<bold>b</bold>). The rest of the model parameters take the typical values given in Table <xref rid="Tab1" ref-type="table">1</xref>. In each of the panels, evolution of the population density <italic>n</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) is shown on the left, evolution of the trait mean <italic>q</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) is shown in the middle, and evolution of the trait variance <italic>v</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>) is shown on the right. Panel (<bold>a</bold>) shows the range expansion dynamics of a species without optimal dispersal, <inline-formula id="IEq305"><alternatives><tex-math id="d33e9460">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e9465"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq305.gif"/></alternatives></inline-formula>, whereas panel (<bold>b</bold>) shows the range expansion dynamics of the species with strong optimal dispersal, <inline-formula id="IEq306"><alternatives><tex-math id="d33e9484">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e9489"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq306.gif"/></alternatives></inline-formula>. In all graphs, curves are shown at every <inline-formula id="IEq307"><alternatives><tex-math id="d33e9505">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e9510"><mml:mrow><mml:mn>4</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq307.gif"/></alternatives></inline-formula>, and the thick orange curves indicate the initial curves at <inline-formula id="IEq308"><alternatives><tex-math id="d33e9518">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 0 \, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e9523"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq308.gif"/></alternatives></inline-formula>. In the insets of trait mean graphs, curves are shown at every <inline-formula id="IEq309"><alternatives><tex-math id="d33e9534">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e9539"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq309.gif"/></alternatives></inline-formula>. Arrows show the direction of evolution in time. In each graph, a sample curve at <inline-formula id="IEq310"><alternatives><tex-math id="d33e9547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 8 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e9552"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq310.gif"/></alternatives></inline-formula> is highlighted in red. Dashed lines indicate the effective edges of the population at <inline-formula id="IEq311"><alternatives><tex-math id="d33e9562">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 8 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e9567"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq310.gif"/></alternatives></inline-formula>, associated with the inflection points on the highlighted curve of population density. The solid black lines in the graphs of trait mean show the environmental trait optimum <inline-formula id="IEq312"><alternatives><tex-math id="d33e9577">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e9582"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula>. The curves of trait variance take large values outside the effective range of species. Such values are not biologically meaningful as they do not occur within the range of the species, and have been cut to smaller values for better visualization of the meaningful parts of the graphs</p></caption><graphic xlink:href="11538_2025_1445_Fig1_HTML" id="MO1"/></fig></p><p id="Par74">We observe that, with or without optimal dispersal, the species&#x02019; population density first grows to a maximum capacity&#x02014;determined by the environment&#x02019;s carrying capacity and the level of competitive release&#x02014;and then expands indefinitely in the form of a traveling wave. The population&#x02019;s trait mean converges to the optimum trait due to the adaptation caused both by natural selection and by phenotype-optimal dispersal, when it exists. The population&#x02019;s trait variance evolves a spatial profile that is decreasing from core to edge of the population. The maximum trait variance at the population core reaches a constant upper bound.</p><p id="Par75">Without optimal dispersal, the peripheral populations near the wavefronts are maladapted and exhibit low trait variance compared with the population near the range center (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>a). This maladaptation is mainly caused by asymmetric core-to-edge random gene flow, which decreases the trait mean below the optimum near the right edge and increases it above the optimum near the left edge. At the core, population density is almost uniform and hence gene flow is symmetric. This implies that random gene flow does not significantly affect the trait mean at central locations and local adaptation is maintained by natural selection. Since the environmental gradient is steep and the population is well-adapted to it at its core, random gene flow from adjacent areas generates large phenotypic variations among central individuals. Near the edges, however, the trait mean fails to follow the steep gradient in the optimum trait. As a result, trait variance decreases from core to edge in parallel with the decrease in gradient of the trait mean. Further descriptions of the profiles of trait mean and variance under random dispersal are available in Section 4.1 of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>).</p><p id="Par76">With optimal dispersal, both the rate and the extent of adaptation in central and peripheral populations are enhanced compared to the diffusion-only case (Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>b). The traveling-wave dynamics in the two cases are similar, but we note several differences. Comparing the insets in the graphs of trait mean in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>a, b, we see that phenotype-optimal dispersal significantly increases the local adaptation rate of the population. Convergence to the environmental optimum at the population&#x02019;s core occurs in almost one generation time with optimal dispersal, whereas the same level of adaptation takes more than ten generations to occur in the absence of optimal dispersal. The level of maladaptation at range margins is also substantially decreased by the directed gene flow created by phenotype-optimal dispersal. These are all consistent with the general predictions regarding the adaptive effects of matching habitat choice, such as those discussed in the Introduction section, or generated by inspecting the equations of our model. Importantly, by comparing the curves of trait variance in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>a, b, we also observe that the phenotypic assortment resulting from preferential movements under optimal dispersal significantly reduces trait variance within the population. Moreover, the curves of population density in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>a, b show that adaptation reinforced by optimal dispersal increases the overall range expansion speed of the population, especially at earlier stages of population establishment in the habitat. The maximum population density, however, is not notably affected by optimal dispersal at the environmental gradient we simulated in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>.</p></sec><sec id="Sec18"><title>Range Evolution with Specialized Individuals</title><p id="Par77">The phenotypic potential of individuals to disperse optimally (that is, <inline-formula id="IEq313"><alternatives><tex-math id="d33e9619">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(p-\textrm{Q}) / \textrm{V}$$\end{document}</tex-math><mml:math id="d33e9624"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq313.gif"/></alternatives></inline-formula> in (<xref rid="Equ12" ref-type="disp-formula">8</xref>)) is stronger when their phenotype utilization variance <inline-formula id="IEq314"><alternatives><tex-math id="d33e9641">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e9646"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> is smaller; meaning that the individuals have a higher degree of specialization. To see if phenotype-optimal dispersal by specialists can significantly influence the range dynamics when the environmental gradient is not very steep, we simulate our model with the relatively small value of <inline-formula id="IEq315"><alternatives><tex-math id="d33e9650">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}= 1 \; \texttt{Q}^2$$\end{document}</tex-math><mml:math id="d33e9655"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">Q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq315.gif"/></alternatives></inline-formula> under the typical gradient of <inline-formula id="IEq316"><alternatives><tex-math id="d33e9667">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 0.2 \; \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e9672"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq316.gif"/></alternatives></inline-formula>. The results are shown in supplementary Fig. S2. We observe similar effects to those shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>. That is, phenotype-optimal dispersal facilitates local adaptation of specialists on a within-generation timescale, reduces their average maladaptation at range margins, and reduces their within-population trait variance. However, unlike what we observed in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>, the population&#x02019;s range expansion speed is not considerably increased. Without optimal dispersal, we see in Figure S2a that the population density rises significantly above <inline-formula id="IEq317"><alternatives><tex-math id="d33e9697">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}= 1 \; \texttt{N}/ \texttt{X}$$\end{document}</tex-math><mml:math id="d33e9702"><mml:mrow><mml:mtext>K</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq317.gif"/></alternatives></inline-formula>. This is due to the population&#x02019;s ecological release gained by less-competitive specialists. However, phenotype-optimal dispersal limits the level of competitive release, as it counteracts the effects of smaller phenotype utilization variance (less competition) by significantly reducing phenotypic variation within the population. Phenotypically close individuals can still remain sufficiently competitive even when they are specialists and utilize fewer common resources. As a result, we see in Figure S2b that population density is still approximately bounded by the carrying capacity <inline-formula id="IEq318"><alternatives><tex-math id="d33e9716">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}= 1 \; \texttt{N}/ \texttt{X}$$\end{document}</tex-math><mml:math id="d33e9721"><mml:mrow><mml:mtext>K</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq317.gif"/></alternatives></inline-formula> when the specialist individuals disperse optimally.</p></sec></sec><sec id="Sec19"><title>When Does Phenotype-Optimal Dispersal Influence Adaptive Range Dynamics?</title><p id="Par78">The effects of phenotype-optimal dispersal are marked only when environmental gradients are very steep. The pronounced effects of optimal dispersal we observed in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> were obtained at the environmental gradient <inline-formula id="IEq319"><alternatives><tex-math id="d33e9742">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 1.5 \; \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e9747"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq303.gif"/></alternatives></inline-formula>. The steepness of the environmental gradient is in fact a key factor in determining whether or not phenotype-optimal dispersal will be sufficiently consequential in a species&#x02019; range evolution. The perceived force for optimal dispersal (<xref rid="Equ12" ref-type="disp-formula">8</xref>) is directly proportional to the (perceived) magnitude of the environmental gradient. Moreover, the phenotypic potential <inline-formula id="IEq320"><alternatives><tex-math id="d33e9768">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(p-\textrm{Q}) / \textrm{V}$$\end{document}</tex-math><mml:math id="d33e9773"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq313.gif"/></alternatives></inline-formula> in (<xref rid="Equ12" ref-type="disp-formula">8</xref>) is directly influenced by the level of phenotypic variation in the population, which in turn can be substantially inflated by random gene flow under steep environmental gradients. Estimates of realistic values for the slopes of environmental optimum gradients in nature, however, are not widely available in the literature&#x02014;noting that our choices of units for <inline-formula id="IEq321"><alternatives><tex-math id="d33e9791">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e9796"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula> requires joint measurements of optimal trait values, dispersal distance, and generation time. Yet, based on some available data, in our previous work we argued that a plausible range of values for <inline-formula id="IEq322"><alternatives><tex-math id="d33e9805">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e9810"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq322.gif"/></alternatives></inline-formula> could lie approximately between 0 and 2 <inline-formula id="IEq323"><alternatives><tex-math id="d33e9825">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e9830"><mml:mrow><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq323.gif"/></alternatives></inline-formula>, (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>, Sect. 3.2). This means that the gradient <inline-formula id="IEq324"><alternatives><tex-math id="d33e9843">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 1.5 \; \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e9848"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq303.gif"/></alternatives></inline-formula> used for the results shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> is very steep; for example, possibly associated with long-range dispersal of birds over elevational gradients. In supplementary Fig. S3, we show our simulation results for a shallower environmental gradient of <inline-formula id="IEq325"><alternatives><tex-math id="d33e9870">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 0.2 \; \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e9875"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq316.gif"/></alternatives></inline-formula>, which might be more typically observed in nature. We see that phenotype-optimal dispersal does not significantly affect the species&#x02019;s range dynamics in this case.</p><p id="Par79">Further simulations with varying levels of environmental gradient and individuals&#x02019; specialization confirmed that optimal dispersal was significantly consequential when gradients were very steep. In each of these simulations, we considered three different levels of optimal dispersal propensity, <inline-formula id="IEq326"><alternatives><tex-math id="d33e9895">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e9900"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq305.gif"/></alternatives></inline-formula> (no optimal dispersal), <inline-formula id="IEq327"><alternatives><tex-math id="d33e9916">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 4 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e9921"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq327.gif"/></alternatives></inline-formula> (medium optimal dispersal), and <inline-formula id="IEq328"><alternatives><tex-math id="d33e9937">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e9942"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq306.gif"/></alternatives></inline-formula> (strong optimal dispersal). We ran each simulation for a period of time long enough that the initial transient states passed. We used the computed curves near the end of each simulation to measure approximate speed and amplitude (peak value) of the traveling waves of population density, as well as maximum trait variance attained at the population&#x02019;s center. The results are shown in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Effects of optimal dispersal on range expansion waves and maximum intraspecific trait variance of a species. Here, <inline-formula id="IEq329"><alternatives><tex-math id="d33e9967">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{m}= 1$$\end{document}</tex-math><mml:math id="d33e9972"><mml:mrow><mml:mtext>m</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq301.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq330"><alternatives><tex-math id="d33e9979">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}(x)$$\end{document}</tex-math><mml:math id="d33e9984"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq27.gif"/></alternatives></inline-formula> takes three different constant values, <inline-formula id="IEq331"><alternatives><tex-math id="d33e9994">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e9999"><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq331.gif"/></alternatives></inline-formula>, <inline-formula id="IEq332"><alternatives><tex-math id="d33e10013">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e10018"><mml:mrow><mml:mn>4</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq332.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq333"><alternatives><tex-math id="d33e10032">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e10037"><mml:mrow><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq333.gif"/></alternatives></inline-formula>. The trait optimum <inline-formula id="IEq334"><alternatives><tex-math id="d33e10052">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}(x)$$\end{document}</tex-math><mml:math id="d33e10057"><mml:mrow><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq40.gif"/></alternatives></inline-formula> is linear in <italic>x</italic>, with variable gradient in panel (<bold>a</bold>) and constant gradient of <inline-formula id="IEq335"><alternatives><tex-math id="d33e10073">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 0.2 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e10078"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq335.gif"/></alternatives></inline-formula> in panel (<bold>b</bold>). The phenotype utilization variance takes the constant value <inline-formula id="IEq336"><alternatives><tex-math id="d33e10099">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}= 4 \, \texttt{Q}^2$$\end{document}</tex-math><mml:math id="d33e10104"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">Q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq336.gif"/></alternatives></inline-formula> in panel (<bold>a</bold>), and is variable in panel (<bold>b</bold>). The rest of the model parameters take their typical values given in Table <xref rid="Tab1" ref-type="table">1</xref>. In each panel, variations in the amplitude of the traveling waves are shown on the left, variations in the speed of the traveling waves of population density are shown in the middle, and variations in the maximum intraspecific trait variance are shown on the right. Panel (<bold>a</bold>) shows the effects of different levels of optimal dispersal at different magnitudes of the environmental gradient <inline-formula id="IEq337"><alternatives><tex-math id="d33e10129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e10134"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula>. Panel (<bold>b</bold>) shows the effects of different levels of optimal dispersal at different values of the individuals&#x02019; phenotype utilization variance <inline-formula id="IEq338"><alternatives><tex-math id="d33e10147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e10152"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="11538_2025_1445_Fig2_HTML" id="MO2"/></fig></p><p id="Par80">At extreme (unrealistic) gradients, optimal dispersal greatly enhances population density and lowers both (local) trait variance and extinction risk (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a). Similarly, a population&#x02019;s expansion at extremely steep gradients is much faster when the individuals disperse optimally. The intraspecific trait variance is also controlled to much lower and more reasonable levels by the assortment effects of optimal dispersal at extreme gradients. Note that the relatively sharp decline in the amplitude of the population density waves at extreme gradients is predominantly due to the phenotypic load <inline-formula id="IEq339"><alternatives><tex-math id="d33e10162">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\frac{\textrm{S}}{2} v$$\end{document}</tex-math><mml:math id="d33e10167"><mml:mrow><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:mfrac><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq226.gif"/></alternatives></inline-formula> in (<xref rid="Equ16" ref-type="disp-formula">10c</xref>) which increases as <italic>v</italic> increases with gradient. That is why significantly slower decline in wave amplitude is observed when optimal dispersal is strong and effectively controls the rise in trait variance to more moderate values.</p><p id="Par81">We note, however, that the large effects of optimal dispersal observed in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a occur mainly in extreme environmental gradients. Based on our previous discussions of plausible ranges of values of environmental gradients (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>, Sect. 3.2), such improvements mainly occur at exceedingly steep gradients which are unlikely to be biologically realistic. As the insets in the graphs of Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a show, when the gradient in trait optimum takes more reasonable values between 0 and 2 <inline-formula id="IEq340"><alternatives><tex-math id="d33e10193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e10198"><mml:mrow><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq323.gif"/></alternatives></inline-formula>, the improvements are much less pronounced. We observe significant changes in the expansion speed only at steep gradients greater than 1 <inline-formula id="IEq341"><alternatives><tex-math id="d33e10208">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e10213"><mml:mrow><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq323.gif"/></alternatives></inline-formula>. At more typically observed gradients below 1 <inline-formula id="IEq342"><alternatives><tex-math id="d33e10224">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e10229"><mml:mrow><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq323.gif"/></alternatives></inline-formula>, phenotype-optimal dispersal still facilitates local adaptation and significantly reduces within-population trait variance, but such effects appear to be less consequential for the population&#x02019;s range expansion capacity.</p><p id="Par82">In a typically shallow environmental gradient of <inline-formula id="IEq343"><alternatives><tex-math id="d33e10241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 0.2\;\texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e10246"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq343.gif"/></alternatives></inline-formula> with only diffusive dispersal (<inline-formula id="IEq344"><alternatives><tex-math id="d33e10264">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e10269"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq305.gif"/></alternatives></inline-formula>), increased specialization raises population density and trait variance (Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b). With optimal dispersal, both these quantities are regulated to lower levels. By contrast, Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b shows that phenotype-optimal dispersal does not significantly increase range expansion speed, even when the phenotype utilization variance in the population is small. To be more precise, in the absence of phenotype-optimal dispersal the competitive release afforded by small values of <inline-formula id="IEq345"><alternatives><tex-math id="d33e10291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e10296"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> results in significant increase in both population density and trait variance as <inline-formula id="IEq346"><alternatives><tex-math id="d33e10301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}\rightarrow 0$$\end{document}</tex-math><mml:math id="d33e10306"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq282.gif"/></alternatives></inline-formula>. The directed gene flow created by optimal dispersal, however, substantially depresses the effects of this competitive release. It controls the level of increase in trait variance to much lower values. As a result, competition remains strong even though small values of <inline-formula id="IEq347"><alternatives><tex-math id="d33e10314">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e10319"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> tend to release the individuals from competition. When optimal dispersal propensity is very strong (<inline-formula id="IEq348"><alternatives><tex-math id="d33e10323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e10328"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq306.gif"/></alternatives></inline-formula>,) the effect of competitive release is fully depressed and the amplitude of population density waves remains close to the carrying capacity <inline-formula id="IEq349"><alternatives><tex-math id="d33e10344">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}=1 \; \texttt{N}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e10349"><mml:mrow><mml:mtext>K</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq349.gif"/></alternatives></inline-formula> for all values of <inline-formula id="IEq350"><alternatives><tex-math id="d33e10363">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e10368"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula>. When <italic>n</italic> is controlled to almost constant values, decreasing <inline-formula id="IEq351"><alternatives><tex-math id="d33e10376">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e10381"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> in the first (competition) term in (<xref rid="Equ28" ref-type="disp-formula">12f</xref>) to zero will eliminate the inflating effects of competition on trait variance. As a result, with strong optimal dispersal, steady-state trait variance will converge to a value mainly controlled by random gene flow (term (<xref rid="Equ25" ref-type="disp-formula">12c</xref>) in our model) and mutation-section balance (term <inline-formula id="IEq352"><alternatives><tex-math id="d33e10391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\textrm{S}v^2 + \textrm{U}$$\end{document}</tex-math><mml:math id="d33e10396"><mml:mrow><mml:mo>-</mml:mo><mml:mtext>S</mml:mtext><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mtext>U</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq352.gif"/></alternatives></inline-formula> in (<xref rid="Equ28" ref-type="disp-formula">12f</xref>)). Since both <inline-formula id="IEq353"><alternatives><tex-math id="d33e10410">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{U}$$\end{document}</tex-math><mml:math id="d33e10415"><mml:mtext>U</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq38.gif"/></alternatives></inline-formula> and the environmental gradient are relatively small in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b, this value is relatively small. This explains the sharp decline we observe in the curves of trait variance in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>b as <inline-formula id="IEq354"><alternatives><tex-math id="d33e10426">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}\rightarrow 0$$\end{document}</tex-math><mml:math id="d33e10431"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq282.gif"/></alternatives></inline-formula>, both for <inline-formula id="IEq355"><alternatives><tex-math id="d33e10439">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e10444"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq306.gif"/></alternatives></inline-formula> and for <inline-formula id="IEq356"><alternatives><tex-math id="d33e10460">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 4 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e10465"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq327.gif"/></alternatives></inline-formula>.</p><p id="Par83">Finally, we note that our numerically obtained traveling wave amplitudes and trait variances are close to values that can be obtained analytically. The curves of wave amplitude and trait variance in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> were computed approximately, by running the simulations for a sufficiently long time and measuring the (almost steady) values of these quantities at the center of the population at the end of the simulation. These curves can be computed more accurately by solving the equations of the fully-adapted equilibrium population, similar to our computations in Section 4.2 of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>). To perform such analysis&#x02014;which importantly allows us to also derive equations for critical environmental gradients&#x02014;we first note that the range dynamics shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> suggests that, as <inline-formula id="IEq357"><alternatives><tex-math id="d33e10492">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \rightarrow \infty $$\end{document}</tex-math><mml:math id="d33e10497"><mml:mrow><mml:mi>t</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>&#x0221e;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq357.gif"/></alternatives></inline-formula>, the solutions eventually converge to an equilibrium. Except in the close vicinity of the habitat boundary (where we modify the perceived gradient as described in Appendix <xref rid="Sec28" ref-type="sec">A</xref>), the population density and trait variance at this equilibrium are spatially homogeneous and trait mean is equal to <inline-formula id="IEq358"><alternatives><tex-math id="d33e10509">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e10514"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula>. We denote this equilibrium state by <inline-formula id="IEq359"><alternatives><tex-math id="d33e10518">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(n^{*}, q^{*}, v^{*})$$\end{document}</tex-math><mml:math id="d33e10523"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>,</mml:mo><mml:mmultiscripts><mml:mi>q</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>,</mml:mo><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq359.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq360"><alternatives><tex-math id="d33e10551">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^{*}&#x0003e;0$$\end{document}</tex-math><mml:math id="d33e10556"><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq360.gif"/></alternatives></inline-formula> and <inline-formula id="IEq361"><alternatives><tex-math id="d33e10568">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v^{*} \ge 0$$\end{document}</tex-math><mml:math id="d33e10573"><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq361.gif"/></alternatives></inline-formula>. Sufficiently far from the habitat boundary, we have <inline-formula id="IEq362"><alternatives><tex-math id="d33e10585">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xn^{*} = 0$$\end{document}</tex-math><mml:math id="d33e10590"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq362.gif"/></alternatives></inline-formula>, <inline-formula id="IEq363"><alternatives><tex-math id="d33e10606">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q^{*} = \textrm{Q}$$\end{document}</tex-math><mml:math id="d33e10611"><mml:mrow><mml:mmultiscripts><mml:mi>q</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq363.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq364"><alternatives><tex-math id="d33e10624">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xv^{*} = 0$$\end{document}</tex-math><mml:math id="d33e10629"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq364.gif"/></alternatives></inline-formula>. Since we assume <inline-formula id="IEq365"><alternatives><tex-math id="d33e10645">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e10650"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> to be linear, we further have <inline-formula id="IEq366"><alternatives><tex-math id="d33e10654">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\textrm{div}\,}}(\nabla _xq^{*}) = 0$$\end{document}</tex-math><mml:math id="d33e10659"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>q</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq366.gif"/></alternatives></inline-formula>.</p><p id="Par84">For a one-dimensional habitat, <inline-formula id="IEq367"><alternatives><tex-math id="d33e10685">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{m}= 1$$\end{document}</tex-math><mml:math id="d33e10690"><mml:mrow><mml:mtext>m</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq301.gif"/></alternatives></inline-formula>, the algebraic derivations shown in Appendix <xref rid="Sec30" ref-type="sec">C</xref> result in the equilibrium equations<disp-formula id="Equ32"><label>15</label><alternatives><tex-math id="d33e10700">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n^{*} = \frac{\textrm{K}}{\textrm{R}} \sqrt{\frac{v^{*}+\textrm{V}}{\textrm{V}}} \left( \textrm{R}- \frac{\textrm{S}}{2} v^{*}\right) , \end{aligned}$$\end{document}</tex-math><mml:math id="d33e10706" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mfrac><mml:mtext>K</mml:mtext><mml:mtext>R</mml:mtext></mml:mfrac><mml:msqrt><mml:mfrac><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac></mml:msqrt><mml:mfenced close=")" open="("><mml:mtext>R</mml:mtext><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:mfrac><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ32.gif" position="anchor"/></alternatives></disp-formula>and<disp-formula id="Equ33"><label>16</label><alternatives><tex-math id="d33e10749">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 5\textrm{S}{v^{*}}^3&#x00026;+ \Big (4 \text {SV} - 2 \textrm{R}+ 8 ({\textrm{A}}/{\textrm{V}}) \Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ) \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 \Big ) {v^{*}}^2 \nonumber \\&#x00026;- 4 \Big ( \textrm{U}+ 2 \textrm{D} \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 - 2 ({\textrm{A}}/{\textrm{V}}) \Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ) \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 \textrm{V}\Big ) v^{*} \nonumber \\&#x00026;- 4 \Big ( \textrm{U}+ 2\textrm{D} \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 \Big ) \textrm{V}= 0, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e10755" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>5</mml:mn><mml:mtext>S</mml:mtext><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>3</mml:mn></mml:mmultiscripts></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mn>4</mml:mn><mml:mtext>SV</mml:mtext><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mtext>R</mml:mtext><mml:mo>+</mml:mo><mml:mn>8</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>A</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mmultiscripts></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mtext>U</mml:mtext><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mtext>D</mml:mtext><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>A</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mtext>V</mml:mtext><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mtext>U</mml:mtext><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mtext>D</mml:mtext><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ33.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq368"><alternatives><tex-math id="d33e10947">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ):= \frac{\Pi }{\Pi + \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}}$$\end{document}</tex-math><mml:math id="d33e10952"><mml:mrow><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq368.gif"/></alternatives></inline-formula>, as in (<xref rid="Equ13" ref-type="disp-formula">9</xref>). The cubic algebraic equation (<xref rid="Equ33" ref-type="disp-formula">16</xref>) has a positive root for all nonzero values of <inline-formula id="IEq369"><alternatives><tex-math id="d33e10998">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2$$\end{document}</tex-math><mml:math id="d33e11003"><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq369.gif"/></alternatives></inline-formula>. The graph of this root with respect to changes in the magnitude of the gradient <inline-formula id="IEq370"><alternatives><tex-math id="d33e11017">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}$$\end{document}</tex-math><mml:math id="d33e11022"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq370.gif"/></alternatives></inline-formula> is approximately a straight line with positive slope, as shown in supplementary Fig. S4a. Substituting this root into (<xref rid="Equ32" ref-type="disp-formula">15</xref>) for different values of <inline-formula id="IEq371"><alternatives><tex-math id="d33e11037">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}$$\end{document}</tex-math><mml:math id="d33e11042"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq370.gif"/></alternatives></inline-formula> provides a graph of <inline-formula id="IEq372"><alternatives><tex-math id="d33e11055">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^{*}$$\end{document}</tex-math><mml:math id="d33e11060"><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq372.gif"/></alternatives></inline-formula> with respect to <inline-formula id="IEq373"><alternatives><tex-math id="d33e11069">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}$$\end{document}</tex-math><mml:math id="d33e11074"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq370.gif"/></alternatives></inline-formula>. With the parameter values associated with Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>, this graph gives an approximate curve of wave amplitudes for each value of <inline-formula id="IEq374"><alternatives><tex-math id="d33e11089">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e11094"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula>, as shown in supplementary Fig. S4a. We observe very close agreement between the approximate curves shown in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref> and the accurate ones shown in Fig. S4.</p><sec id="FPar5"><title>[Style3 Style3]Remark 5</title><p id="Par85"><italic>(Critical environmental gradients)</italic> The results shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a imply that, for every value of <inline-formula id="IEq375"><alternatives><tex-math id="d33e11110">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e11115"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula>, there exists a <italic>critical environmental gradient</italic> magnitude at which the curves of wave amplitude and wave speed concurrently vanish to zero. That is, the population fails to survive beyond the critical gradient&#x02014;unless possibly marginally (with low density over a short range) at the vicinity of the habitat boundary. The equilibrium equations (<xref rid="Equ32" ref-type="disp-formula">15</xref>) and (<xref rid="Equ33" ref-type="disp-formula">16</xref>) allow us to derive a fairly simple equation for calculating the critical gradients in a one-dimensional space. Setting <inline-formula id="IEq376"><alternatives><tex-math id="d33e11129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^{*}=0$$\end{document}</tex-math><mml:math id="d33e11134"><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq376.gif"/></alternatives></inline-formula> in (<xref rid="Equ32" ref-type="disp-formula">15</xref>) gives <inline-formula id="IEq377"><alternatives><tex-math id="d33e11149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v^{*} = 2 \textrm{R}/\textrm{S}$$\end{document}</tex-math><mml:math id="d33e11154"><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mtext>R</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mtext>S</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq377.gif"/></alternatives></inline-formula>, which is a solution of (<xref rid="Equ33" ref-type="disp-formula">16</xref>) when the environmental gradient satisfies<disp-formula id="Equ34"><label>17</label><alternatives><tex-math id="d33e11173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 = \frac{4 \textrm{R}^2 - \text {SU}}{2 \Big ( \text {SD} - 2 \textrm{R}({\textrm{A}}/{\textrm{V}}) \Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ) \Big )}, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e11179" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mtext>SU</mml:mtext></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mtext>SD</mml:mtext><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mtext>R</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>A</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ34.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq378"><alternatives><tex-math id="d33e11247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ):= \frac{\Pi }{\Pi + \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}}$$\end{document}</tex-math><mml:math id="d33e11252"><mml:mrow><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq368.gif"/></alternatives></inline-formula> as we stated before. The solution of (<xref rid="Equ34" ref-type="disp-formula">17</xref>) gives the critical gradient magnitude, which we denote by <inline-formula id="IEq379"><alternatives><tex-math id="d33e11295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^{(\textrm{max})}$$\end{document}</tex-math><mml:math id="d33e11300"><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>max</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq379.gif"/></alternatives></inline-formula>. When dispersal is only random, that is <inline-formula id="IEq380"><alternatives><tex-math id="d33e11319">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0$$\end{document}</tex-math><mml:math id="d33e11324"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq287.gif"/></alternatives></inline-formula>, the critical gradient can be calculated as<disp-formula id="Equ35"><label>18</label><alternatives><tex-math id="d33e11331">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^{(\textrm{max})} = \sqrt{\frac{2\textrm{R}^2}{\text {SD}} - \frac{\textrm{U}}{2\textrm{D}} } \approx \sqrt{\frac{2\textrm{R}^2}{\text {SD}}}, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e11337" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>max</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mtext>SD</mml:mtext></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>U</mml:mtext><mml:mrow><mml:mn>2</mml:mn><mml:mtext>D</mml:mtext></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mo>&#x02248;</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mtext>SD</mml:mtext></mml:mfrac></mml:msqrt><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ35.gif" position="anchor"/></alternatives></disp-formula>which is the same formula we derived in our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>,&#x000a0;Remark 4). The approximation in (<xref rid="Equ35" ref-type="disp-formula">18</xref>) is made based on the fact that, typically, <inline-formula id="IEq381"><alternatives><tex-math id="d33e11394">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{U}\ll 4 \textrm{R}^2 / \textrm{S}$$\end{document}</tex-math><mml:math id="d33e11399"><mml:mrow><mml:mtext>U</mml:mtext><mml:mo>&#x0226a;</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mtext>R</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mtext>S</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq381.gif"/></alternatives></inline-formula>. <inline-formula id="IEq382"><alternatives><tex-math id="d33e11412">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="d33e11417"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq87.gif"/></alternatives></inline-formula></p></sec><sec id="FPar6"><title>[Style3 Style3]Remark 6</title><p id="Par86"><italic>(Slow growth rate, strong selection, and chance of survival)</italic> The critical gradient magnitude <inline-formula id="IEq383"><alternatives><tex-math id="d33e11426">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^{(\textrm{max})}$$\end{document}</tex-math><mml:math id="d33e11431"><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>max</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq379.gif"/></alternatives></inline-formula> can be used to predict the chance of survival of a species under steep environmental stress gradients. Larger values of <inline-formula id="IEq384"><alternatives><tex-math id="d33e11450">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^{(\textrm{max})}$$\end{document}</tex-math><mml:math id="d33e11455"><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>max</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq379.gif"/></alternatives></inline-formula> imply higher chance of survival (lower chance of extinction). In the absence of optimal dispersal, the critical gradient (<xref rid="Equ35" ref-type="disp-formula">18</xref>) implies that slowly-growing species (small <inline-formula id="IEq385"><alternatives><tex-math id="d33e11477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e11482"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula>) and species under strong selection (large <inline-formula id="IEq386"><alternatives><tex-math id="d33e11486">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e11491"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula>) are at higher risk of extinction. To see if phenotype-optimal dispersal is sufficiently effective in increasing the survival chance of such species, we use (<xref rid="Equ34" ref-type="disp-formula">17</xref>) to compute critical gradients for species with relatively slow growth rate (<inline-formula id="IEq387"><alternatives><tex-math id="d33e11499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}&#x0003c; 1 \; \texttt{T}^{-1}$$\end{document}</tex-math><mml:math id="d33e11504"><mml:mrow><mml:mtext>R</mml:mtext><mml:mo>&#x0003c;</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">T</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq387.gif"/></alternatives></inline-formula>) and species under relatively strong selection (<inline-formula id="IEq388"><alternatives><tex-math id="d33e11518">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}&#x0003e; 0.5 \; \texttt{Q}^{-2}/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e11523"><mml:mrow><mml:mtext>S</mml:mtext><mml:mo>&#x0003e;</mml:mo><mml:mn>0.5</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">Q</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq388.gif"/></alternatives></inline-formula>). The results are shown in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>. We first note that, in the absence of optimal dispersal, <inline-formula id="IEq389"><alternatives><tex-math id="d33e11544">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0 \; \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e11549"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq389.gif"/></alternatives></inline-formula>, these vulnerable classes of species are indeed at high risk of extinction within plausible ranges of values for <inline-formula id="IEq390"><alternatives><tex-math id="d33e11563">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}$$\end{document}</tex-math><mml:math id="d33e11568"><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq370.gif"/></alternatives></inline-formula> (that is, between 0 and 2 <inline-formula id="IEq391"><alternatives><tex-math id="d33e11581">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e11586"><mml:mrow><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq323.gif"/></alternatives></inline-formula> based on our estimates (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>, Sect. 3.2)). Phenotype-optimal dispersal appears to substantially increase the survival chance of the species. With strong optimal dispersal, <inline-formula id="IEq392"><alternatives><tex-math id="d33e11599">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {A}= 10 \; \texttt {Q}/ \texttt{X}$$\end{document}</tex-math><mml:math id="d33e11604"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq392.gif"/></alternatives></inline-formula>, for example, the species is unlikely to go extinct at plausible gradients (of course, excluding physical barriers), even with a very slow growth rate such as <inline-formula id="IEq393"><alternatives><tex-math id="d33e11618">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}= 0.2 \; \texttt{T}^{-1}$$\end{document}</tex-math><mml:math id="d33e11623"><mml:mrow><mml:mtext>R</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">T</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq393.gif"/></alternatives></inline-formula>, or under an exceedingly strong selection such as <inline-formula id="IEq394"><alternatives><tex-math id="d33e11637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}= 2 \; \texttt{Q}^{-2}/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e11642"><mml:mrow><mml:mtext>S</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">Q</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq394.gif"/></alternatives></inline-formula>. <inline-formula id="IEq395"><alternatives><tex-math id="d33e11660">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="d33e11665"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq87.gif"/></alternatives></inline-formula></p><p>
<fig id="Fig3"><label>Fig. 3</label><caption><p>Effects of optimal dispersal on survival chance of slowly-growing species and species under strong selection. The critical environmental gradient <inline-formula id="IEq396"><alternatives><tex-math id="d33e11676">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^{(\textrm{max})}$$\end{document}</tex-math><mml:math id="d33e11681"><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>max</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq379.gif"/></alternatives></inline-formula> is computed by solving (<xref rid="Equ34" ref-type="disp-formula">17</xref>) and is plotted in (<bold>a</bold>) versus the maximum growth rate <inline-formula id="IEq397"><alternatives><tex-math id="d33e11706">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e11711"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula>, and in (<bold>b</bold>) versus the strength of stabilizing selection <inline-formula id="IEq398"><alternatives><tex-math id="d33e11719">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e11724"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula>. The larger the critical gradient the higher the chance of survival of the species in steep environmental stress gradients. In each graph, computations are performed for six different values of <inline-formula id="IEq399"><alternatives><tex-math id="d33e11728">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e11733"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> in the range from <inline-formula id="IEq400"><alternatives><tex-math id="d33e11737">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e11742"><mml:mrow><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq400.gif"/></alternatives></inline-formula> to <inline-formula id="IEq401"><alternatives><tex-math id="d33e11756">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e11761"><mml:mrow><mml:mn>10</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq401.gif"/></alternatives></inline-formula>. Parameter <inline-formula id="IEq402"><alternatives><tex-math id="d33e11775">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e11780"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula> takes relatively small values in (<bold>a</bold>) and the constant value <inline-formula id="IEq403"><alternatives><tex-math id="d33e11788">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}= 2 \; \texttt{T}^{-1}$$\end{document}</tex-math><mml:math id="d33e11793"><mml:mrow><mml:mtext>R</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">T</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq403.gif"/></alternatives></inline-formula> in (<bold>b</bold>). Parameter <inline-formula id="IEq404"><alternatives><tex-math id="d33e11810">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e11815"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula> takes the constant value <inline-formula id="IEq405"><alternatives><tex-math id="d33e11819">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}= 0.2 \; \texttt{Q}^{-2}/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e11824"><mml:mrow><mml:mtext>S</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">Q</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq405.gif"/></alternatives></inline-formula> in (<bold>a</bold>) and relatively large values in (<bold>b</bold>). The rest of the model parameters take their typical values given in Table <xref rid="Tab1" ref-type="table">1</xref></p></caption><graphic xlink:href="11538_2025_1445_Fig3_HTML" id="MO3"/></fig>
</p></sec></sec><sec id="Sec20"><title>Phenotype-Optimal Dispersal Enhances Local Adaptation at Range Margins</title><p id="Par88">We now study more specifically how the mean adaptation rate, <inline-formula id="IEq406"><alternatives><tex-math id="d33e11858">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tq$$\end{document}</tex-math><mml:math id="d33e11863"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq406.gif"/></alternatives></inline-formula>, is affected by random and non-random (directed) components of gene flow, particularly at range margins (wavefronts). The sum of the terms (<xref rid="Equ17" ref-type="disp-formula">11a</xref>) and (<xref rid="Equ18" ref-type="disp-formula">11b</xref>) represents the contribution of random gene flow in determining the rate of change of trait mean, whereas the sum of the terms (<xref rid="Equ19" ref-type="disp-formula">11c</xref>)&#x02013;(<xref rid="Equ21" ref-type="disp-formula">11e</xref>) presents the contribution of directed gene flow. The sum of all terms (<xref rid="Equ17" ref-type="disp-formula">11a</xref>)&#x02013;(<xref rid="Equ21" ref-type="disp-formula">11e</xref>) determines how the trait mean is changed due to individuals&#x02019; dispersal, both random and directed. We illustrate the effects of each of these three contributions separately, using the same simulation layout we used for the results shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>b, and the same solutions of the model that we computed there. The resulting curves as the population expands its range over time are shown in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>. Due to symmetry, the curves are shown only for the right half of the habitat. Positive values in each curve at a point <italic>x</italic> imply that the corresponding component of gene flow represented by the curve tends to increase the trait mean <italic>q</italic> at <italic>x</italic>. Contrariwise, negative values imply a tendency to decrease <italic>q</italic>. Since the initial profile of trait mean at <inline-formula id="IEq407"><alternatives><tex-math id="d33e11909">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 0 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e11914"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq407.gif"/></alternatives></inline-formula>, as shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>b, is below the trait optimum <inline-formula id="IEq408"><alternatives><tex-math id="d33e11927">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e11932"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> over the right half of the habitat, positive values of the curves imply adaptive effects (increasing <italic>q</italic> toward <inline-formula id="IEq409"><alternatives><tex-math id="d33e11940">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e11945"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula>), and negative values imply maladaptive effects.<fig id="Fig4"><label>Fig. 4</label><caption><p>Effects of gene flow on local adaption of a species. Contribution of random gene flow to the rate of change of the trait mean, <inline-formula id="IEq410"><alternatives><tex-math id="d33e11955">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tq$$\end{document}</tex-math><mml:math id="d33e11960"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq406.gif"/></alternatives></inline-formula>, is shown on the left. The curves of this graph are computed as the sum of the terms (<xref rid="Equ17" ref-type="disp-formula">11a</xref>) and (<xref rid="Equ18" ref-type="disp-formula">11b</xref>), which capture the effects of random dispersal on <inline-formula id="IEq411"><alternatives><tex-math id="d33e11974">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tq$$\end{document}</tex-math><mml:math id="d33e11979"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq406.gif"/></alternatives></inline-formula>. In the middle, contribution of directed gene flow to <inline-formula id="IEq412"><alternatives><tex-math id="d33e11987">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tq$$\end{document}</tex-math><mml:math id="d33e11992"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq406.gif"/></alternatives></inline-formula> is shown. The directed gene flow is generated by optimal dispersal and its contribution is computed as the sum of the terms (<xref rid="Equ19" ref-type="disp-formula">11c</xref>)&#x02013;(<xref rid="Equ21" ref-type="disp-formula">11e</xref>). Contribution of the total (net) gene flow to <inline-formula id="IEq413"><alternatives><tex-math id="d33e12007">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tq$$\end{document}</tex-math><mml:math id="d33e12012"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq406.gif"/></alternatives></inline-formula>, that is, the sum of the curves shown in the middle and the left graphs, is shown on the right. The graphs correspond to the same simulation of a species&#x02019; range dynamics as in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>b, that is, when <inline-formula id="IEq414"><alternatives><tex-math id="d33e12023">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 1.5 \; \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e12028"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq303.gif"/></alternatives></inline-formula> and <inline-formula id="IEq415"><alternatives><tex-math id="d33e12046">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e12051"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq306.gif"/></alternatives></inline-formula>. In all graphs, the computed curves are shown only on the right half of the habitat. The curves extend symmetrically about the origin to the left half of the habitat. Moreover, the portion of each curve that lies outside the effective range of the species, that means over the regions where the population density rapidly vanishes to zero, has been made transparent. In all graphs, curves are shown at every <inline-formula id="IEq416"><alternatives><tex-math id="d33e12068">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12073"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq309.gif"/></alternatives></inline-formula>. The descriptions of the highlighted curves, arrows, and dashed lines are the same as those provided in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>b</p></caption><graphic xlink:href="11538_2025_1445_Fig4_HTML" id="MO4"/></fig></p><p id="Par89">Gene flow to range margins (wavefronts) induced by phenotype-optimal dispersal is always adaptive, but is of little consequence except at steep environmental gradients. At such gradients, optimal dispersal speeds up adaptation at both the range center and range margins, although a perfect match of trait mean and trait optimum is never achieved at the wavefront. To see this, we first note that Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>b showed rapid convergence of <italic>q</italic> to <inline-formula id="IEq417"><alternatives><tex-math id="d33e12094">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e12099"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> at the population&#x02019;s core, due to the strong effects of phenotype-optimal dispersal at the steep gradient <inline-formula id="IEq418"><alternatives><tex-math id="d33e12103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 1.5 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e12108"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq418.gif"/></alternatives></inline-formula>. This rapid convergence can also be clearly observed in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>. The rate of change in <italic>q</italic> quickly approaches zero at the core of the population after a couple of generations. At range margins, however, Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>b shows that adaptation never occurs perfectly. The core-to-edge random gene flow created by random dispersal is always maladaptive, whereas the directed gene flow generated by phenotype-optimal dispersal is always adaptive. Importantly, the total gene flow to range margins appears to be always adaptive, implying that phenotype-optimal dispersal not only compensates for the maladaptive effects of random movements, but also reverses their effects on local adaptation of the marginal populations. Similar observations apply when we analyze the adaptive/maladaptive effects of different components of gene flow associated with the simulation results shown in supplementary Fig. S3b, that is, when the environmental gradient is shallow (<inline-formula id="IEq419"><alternatives><tex-math id="d33e12136">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 0.2 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e12141"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq335.gif"/></alternatives></inline-formula>) but individuals are highly specialized (<inline-formula id="IEq420"><alternatives><tex-math id="d33e12159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}= 1 \; \texttt{Q}^2$$\end{document}</tex-math><mml:math id="d33e12164"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">Q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq315.gif"/></alternatives></inline-formula>). The resulting curves are shown in Fig.&#x000a0;S5. The difference in this case&#x02014;possibly because of the complicated interaction between the effects of optimal dispersal and competition&#x02014;is that convergence at the core shows overshooting dynamics, during which the curves of directed gene flow take negative values (but still adaptive) to decrease the overshot <italic>q</italic> back to <inline-formula id="IEq421"><alternatives><tex-math id="d33e12179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e12184"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula>.<fig id="Fig5"><label>Fig. 5</label><caption><p>Effects of directed gene flow on local adaption at the edge of a species&#x02019; range. The contribution of total (net) gene flow to the rate of change of the trait mean, <inline-formula id="IEq422"><alternatives><tex-math id="d33e12195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tq$$\end{document}</tex-math><mml:math id="d33e12200"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq406.gif"/></alternatives></inline-formula>, at the edge of a species&#x02019; range is shown in each graph for two different values of <inline-formula id="IEq423"><alternatives><tex-math id="d33e12208">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e12213"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula>. In (<bold>a</bold>), the species&#x02019; phenotype utilization variance takes its typical value of <inline-formula id="IEq424"><alternatives><tex-math id="d33e12220">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}= 4 \, \texttt{Q}^2$$\end{document}</tex-math><mml:math id="d33e12225"><mml:mrow><mml:mtext>V</mml:mtext><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">Q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq336.gif"/></alternatives></inline-formula>, and the magnitude of <inline-formula id="IEq425"><alternatives><tex-math id="d33e12237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e12242"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula> is made variable. In (<bold>b</bold>), the environmental gradient takes its typical value of <inline-formula id="IEq426"><alternatives><tex-math id="d33e12255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 0.2 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e12260"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq335.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq427"><alternatives><tex-math id="d33e12278">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e12283"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> is made variable. The rest of the model parameters take their typical values given in Table <xref rid="Tab1" ref-type="table">1</xref>, with <inline-formula id="IEq428"><alternatives><tex-math id="d33e12290">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{m}= 1$$\end{document}</tex-math><mml:math id="d33e12295"><mml:mrow><mml:mtext>m</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq301.gif"/></alternatives></inline-formula>. The data points in graphs (<bold>a</bold>) and (<bold>b</bold>) are obtained as follows. At each value of <inline-formula id="IEq429"><alternatives><tex-math id="d33e12309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e12314"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula> in (<bold>a</bold>) and each value of <inline-formula id="IEq430"><alternatives><tex-math id="d33e12326">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e12331"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula> in (<bold>b</bold>), a simulation is performed for a period of time long enough that the species&#x02019; range expansion dynamics reaches an approximate steady state. In each simulation, the contribution of the total gene flow to <inline-formula id="IEq431"><alternatives><tex-math id="d33e12338">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tq$$\end{document}</tex-math><mml:math id="d33e12343"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq406.gif"/></alternatives></inline-formula> is computed for the right half of the species&#x02019; range, as the sum of all terms (<xref rid="Equ17" ref-type="disp-formula">11a</xref>)&#x02013;(<xref rid="Equ21" ref-type="disp-formula">11e</xref>) in (<xref rid="Equ17" ref-type="disp-formula">11</xref>). The graphs shown on the right of Figs.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> and S5 show samples of such computation results. The value of the total gene flow contribution that is obtained at the edge of the species&#x02019; range at the end of each simulation is then shown in graphs (<bold>a</bold>) and (<bold>b</bold>)</p></caption><graphic xlink:href="11538_2025_1445_Fig5_HTML" id="MO5"/></fig></p><p id="Par90">The total gene flow to the wavefront remained adaptive in further simulations with shallower (i.e. more typical) environmental gradients and lower degrees of specialization (larger <inline-formula id="IEq432"><alternatives><tex-math id="d33e12374">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e12379"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula>). In these simulations, we repeated an analysis like that shown in Figs.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> and S5 for different slopes of the environmental gradient and different values of <inline-formula id="IEq433"><alternatives><tex-math id="d33e12386">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{V}$$\end{document}</tex-math><mml:math id="d33e12391"><mml:mtext>V</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq34.gif"/></alternatives></inline-formula>. The sample curves in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> show that the maximum adaptive (or maladaptive) effects of directed (or random) gene flow occur at the edge of the population. Therefore, we used the value of the total contribution of gene flow to <inline-formula id="IEq434"><alternatives><tex-math id="d33e12398">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tq$$\end{document}</tex-math><mml:math id="d33e12403"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq406.gif"/></alternatives></inline-formula>, computed at the edge of the population, as our reference for measuring the significance of phenotype-optimal dispersal in facilitating adaptation at range margins. The results are shown in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>. We see that the total gene flow remains adaptive to the range margins, even when the environmental gradient is fairly shallow or individuals are generalists. This implies that phenotype-optimal dispersal is quite effective in compensating for the maladaptive effects of core-to-edge random gene flow. Yet the curves shown in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>, along with our previous observations through Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>, suggest that the adaption facilitated by phenotype-optimal dispersal at range margins sufficiently enhances range expansion capacity of the population primarily when environmental gradients are steep (slopes greater than <inline-formula id="IEq435"><alternatives><tex-math id="d33e12421">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 1 \; \texttt{Q}/ \texttt{X}$$\end{document}</tex-math><mml:math id="d33e12426"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq435.gif"/></alternatives></inline-formula>).</p><p id="Par91">We note that the curves associated with <inline-formula id="IEq436"><alternatives><tex-math id="d33e12440">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0$$\end{document}</tex-math><mml:math id="d33e12445"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq287.gif"/></alternatives></inline-formula> are not shown in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>. In fact, with <inline-formula id="IEq437"><alternatives><tex-math id="d33e12455">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0$$\end{document}</tex-math><mml:math id="d33e12460"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq287.gif"/></alternatives></inline-formula> we only have random gene flow (random dispersal), the effect of which is already known to be maladaptive at any nonzero values of the environmental gradient. This means that the curves for <inline-formula id="IEq438"><alternatives><tex-math id="d33e12467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0$$\end{document}</tex-math><mml:math id="d33e12472"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq287.gif"/></alternatives></inline-formula> in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> would take negative values for all environmental gradients and utilization variances. The larger the gradient the more maladaptive effects of random gene flow.</p></sec><sec id="Sec21"><title>Phenotype-Optimal Dispersal Promotes Persistence Under Abrupt Environmental Fluctuations</title><p id="Par92">We carried out simulations with periodic abrupt environmental shifts, to test the prediction that phenotype-optimal dispersal could improve population survival under such shifts. Rapid adaptation of individuals within a single generation, as facilitated by adaptive dispersal strategies such as matching habitat choice, is predicted to be crucial to the survival of a population under climate change, particularly when changes are sharp and frequent (Edelaar and Bolnick <xref ref-type="bibr" rid="CR36">2019</xref>; Nicolaus and Edelaar <xref ref-type="bibr" rid="CR81">2018</xref>; Jacob et&#x000a0;al. <xref ref-type="bibr" rid="CR62">2017</xref>; Bonte et&#x000a0;al. <xref ref-type="bibr" rid="CR20">2012</xref>). To explore how phenotype-optimal dispersal will affect the range dynamics of a species under abrupt climatic changes, we simulate our model in a one-dimensional habitat with a steep trait optimum gradient of <inline-formula id="IEq439"><alternatives><tex-math id="d33e12498">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 1.5 \; \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e12503"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq303.gif"/></alternatives></inline-formula>, wherein the trait optimum periodically fluctuates (shifts) up and down with no change in its gradient. For this, we initialize our simulation at <inline-formula id="IEq440"><alternatives><tex-math id="d33e12522">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 0 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12527"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq407.gif"/></alternatives></inline-formula> with an established population at the center of the habitat. This initial population is obtained as the solution curves at <inline-formula id="IEq441"><alternatives><tex-math id="d33e12537">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 4 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12542"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq441.gif"/></alternatives></inline-formula> of a preliminary simulation similar to the one shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>, with <inline-formula id="IEq442"><alternatives><tex-math id="d33e12555">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n(x,0) = 0.8 {{\,\textrm{sech}\,}}( |x| / \sqrt{2} )$$\end{document}</tex-math><mml:math id="d33e12560"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>sech</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq442.gif"/></alternatives></inline-formula>, <inline-formula id="IEq443"><alternatives><tex-math id="d33e12593">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q(0,0) = \textrm{Q}(0)$$\end{document}</tex-math><mml:math id="d33e12598"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq298.gif"/></alternatives></inline-formula>, <inline-formula id="IEq444"><alternatives><tex-math id="d33e12617">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xq(x,0) = 0.7\, \nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e12622"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn><mml:mspace width="0.166667em"/><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq444.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq445"><alternatives><tex-math id="d33e12648">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v(x,0) = 1 \; \texttt{Q}^2$$\end{document}</tex-math><mml:math id="d33e12653"><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">Q</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq299.gif"/></alternatives></inline-formula>. The thick orange curves shown in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> indicate the initial populations. To simulate abrupt temporal fluctuations in the environment, we uniformly shift up the line of trait optimum <inline-formula id="IEq446"><alternatives><tex-math id="d33e12676">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e12681"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> by a certain fluctuation amplitude at the beginning of a fluctuation period, and then shift it back down by the same amplitude at the middle of the period. We repeat these fluctuations periodically, starting at <inline-formula id="IEq447"><alternatives><tex-math id="d33e12685">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 0 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12690"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq407.gif"/></alternatives></inline-formula>, with a relatively short period of <inline-formula id="IEq448"><alternatives><tex-math id="d33e12700">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12705"><mml:mrow><mml:mn>2</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq448.gif"/></alternatives></inline-formula>.<fig id="Fig6"><label>Fig. 6</label><caption><p>Range dynamics of a species under periodic abrupt fluctuations in the environmental trait optimum. Here, <inline-formula id="IEq449"><alternatives><tex-math id="d33e12719">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m = 1$$\end{document}</tex-math><mml:math id="d33e12724"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq449.gif"/></alternatives></inline-formula>, <inline-formula id="IEq450"><alternatives><tex-math id="d33e12731">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 1.5 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e12736"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq418.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq451"><alternatives><tex-math id="d33e12754">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e12759"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> takes different values in each graph. The rest of the model parameters take their typical values given in Table <xref rid="Tab1" ref-type="table">1</xref>. Graph (<bold>a</bold>) shows range dynamics without optimal dispersal, that is <inline-formula id="IEq452"><alternatives><tex-math id="d33e12770">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e12775"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq290.gif"/></alternatives></inline-formula>. Graph (<bold>b</bold>) shows range dynamics with strong optimal dispersal, <inline-formula id="IEq453"><alternatives><tex-math id="d33e12794">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e12799"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq218.gif"/></alternatives></inline-formula>. Graph (<bold>c</bold>) shows extinction of a species with the typical value <inline-formula id="IEq454"><alternatives><tex-math id="d33e12818">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 4 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e12823"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq454.gif"/></alternatives></inline-formula> due to high-amplitude environmental fluctuations. In all graphs, the period of abrupt fluctuations in the trait optimum is <inline-formula id="IEq455"><alternatives><tex-math id="d33e12839">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12844"><mml:mrow><mml:mn>2</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq455.gif"/></alternatives></inline-formula>. At the beginning of each period, the trait optimum <inline-formula id="IEq456"><alternatives><tex-math id="d33e12853">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e12858"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> is shifted up by a preset fluctuation amplitude and remains at this value for the first half of the period. Then, it is shifted down by the same amplitude to the initial value and remains at this value for the second half of the period. The fluctuation amplitude is set equal to <inline-formula id="IEq457"><alternatives><tex-math id="d33e12862">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5 \, \texttt{Q}$$\end{document}</tex-math><mml:math id="d33e12867"><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq457.gif"/></alternatives></inline-formula> in (<bold>a</bold>) and (<bold>b</bold>), and equal to <inline-formula id="IEq458"><alternatives><tex-math id="d33e12881">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$9 \, \texttt{Q}$$\end{document}</tex-math><mml:math id="d33e12886"><mml:mrow><mml:mn>9</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq458.gif"/></alternatives></inline-formula> in (<bold>c</bold>). The thick orange curves indicate the initial curves at <inline-formula id="IEq459"><alternatives><tex-math id="d33e12898">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 0 \, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12903"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq308.gif"/></alternatives></inline-formula> and arrows show the direction of evolution in time. In (<bold>a</bold>) and (<bold>b</bold>), curves are shown at every <inline-formula id="IEq460"><alternatives><tex-math id="d33e12919">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.5 \, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12924"><mml:mrow><mml:mn>1.5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq460.gif"/></alternatives></inline-formula>, and two sample curves are highlighted at <inline-formula id="IEq461"><alternatives><tex-math id="d33e12932">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 20 \, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12937"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq461.gif"/></alternatives></inline-formula> (in red) and <inline-formula id="IEq462"><alternatives><tex-math id="d33e12947">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 20.5 \, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12952"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>20.5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq462.gif"/></alternatives></inline-formula> (in blue). In (<bold>c</bold>), curves are shown at 20 logarithmically distributed time samples, with the first curve after the initial curve being shown at <inline-formula id="IEq463"><alternatives><tex-math id="d33e12966">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 0.1 \, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12971"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq463.gif"/></alternatives></inline-formula>. A sample curve at <inline-formula id="IEq464"><alternatives><tex-math id="d33e12981">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 20 \, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e12986"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq461.gif"/></alternatives></inline-formula> is also highlighted in red</p></caption><graphic xlink:href="11538_2025_1445_Fig6_HTML" id="MO6"/></fig></p><p id="Par93">With purely random dispersal plus environmental shifts, population density fluctuates, but is always significantly lower than the density in a constant environment. Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>a shows the simulation results for an environmental fluctuation amplitude of <inline-formula id="IEq465"><alternatives><tex-math id="d33e13003">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5 \; \texttt{Q}$$\end{document}</tex-math><mml:math id="d33e13008"><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq465.gif"/></alternatives></inline-formula>, when dispersal is only random, <inline-formula id="IEq466"><alternatives><tex-math id="d33e13016">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e13021"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq290.gif"/></alternatives></inline-formula>. The high level of maladaptation that is abruptly induced in the population at <inline-formula id="IEq467"><alternatives><tex-math id="d33e13037">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 0 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e13042"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq407.gif"/></alternatives></inline-formula>, when the optimum gradient is shifted up, quickly reduces both population density and expansion speed. Yet, directional natural selection acts on the large deviation of trait mean from the trait optimum, and the population gradually adapts to the new environmental optimum. However, since the period of the fluctuations is relatively short, the population will not fully recover its peak density before experiencing another abrupt change in the environment. The periodically repeated loss-and-recovery dynamics of the population density eventually reach a steady-state, at which the peak population density fluctuates between a fixed high and a fixed low value as the populations expands its range. The red and blue curves in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>a show samples of population density profiles at such high and low extremes.</p><p id="Par94">Strong phenotype-optimal dispersal, <inline-formula id="IEq468"><alternatives><tex-math id="d33e13057">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e13062"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq218.gif"/></alternatives></inline-formula>, enhances both range expansion speed and steady-state population density under the abrupt environmental fluctuations that we simulate here. The results are shown in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>b. This is because the large phenotype-environment mismatch perceived by individuals, immediately after an abrupt shift in the optimum phenotype, creates a strong phenotypic potential for the individuals to disperse to better-matching locations. As a result, the population can rapidly adapt to the new environmental optimum when a change occurs, and hence it loses much less of its density. However, in agreement with our observations in the previous studies described above, the significant effects of optimal dispersal that we observe here are in the presence of a steep environmental gradient of <inline-formula id="IEq469"><alternatives><tex-math id="d33e13081">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 1.5 \; \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e13086"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq303.gif"/></alternatives></inline-formula>. In shallower (more typical) gradients, as the supplementary Fig. S6 shows, the effects are much less noteworthy.<fig id="Fig7"><label>Fig. 7</label><caption><p>Steady-state mean population density of a species under periodic abrupt fluctuations in the environmental trait optimum. Here, <inline-formula id="IEq470"><alternatives><tex-math id="d33e13110">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m = 1$$\end{document}</tex-math><mml:math id="d33e13115"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq449.gif"/></alternatives></inline-formula>, <inline-formula id="IEq471"><alternatives><tex-math id="d33e13122">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}= 1.5 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e13127"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1.5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq418.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq472"><alternatives><tex-math id="d33e13145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e13150"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> takes different values in each graph. The same periodic abrupt fluctuations as described in Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> is applied to the trait optimum <inline-formula id="IEq473"><alternatives><tex-math id="d33e13157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e13162"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula>, with the typical amplitude of <inline-formula id="IEq474"><alternatives><tex-math id="d33e13167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5 \, \texttt{Q}$$\end{document}</tex-math><mml:math id="d33e13172"><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq457.gif"/></alternatives></inline-formula> in (<bold>b</bold>) and (<bold>c</bold>) and variable amplitude in (<bold>a</bold>). Except for <inline-formula id="IEq475"><alternatives><tex-math id="d33e13189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e13194"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula> and <inline-formula id="IEq476"><alternatives><tex-math id="d33e13198">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e13203"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula>, which are made variable in (<bold>b</bold>) and (<bold>c</bold>), respectively, the rest of the model parameters take their typical values given in Table <xref rid="Tab1" ref-type="table">1</xref>. At each value of the variable parameter shown at the horizontal axis of each graph, and each value od <inline-formula id="IEq477"><alternatives><tex-math id="d33e13217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e13222"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula>, the simulation is run for a sufficiently long period of time so that the amplitude of the fluctuations in population density of the species reaches a steady-state. The minimum and maximum values of such periodic fluctuations (peaks of the blue and red curves as shown in Figs.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>a, b) are calculated near the end of the simulation, and their average value is shown by different markers for each value of <inline-formula id="IEq478"><alternatives><tex-math id="d33e13229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e13234"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula>, along with an interpolated solid line. In (<bold>a</bold>), the steady-state mean value of the population density is shown with respect to changes in the amplitude of the abrupt fluctuations in <inline-formula id="IEq479"><alternatives><tex-math id="d33e13242">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e13247"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula>. In (<bold>b</bold>), the steady-state mean value of the population density is shown with respect to changes in the strength of stabilization selection, <inline-formula id="IEq480"><alternatives><tex-math id="d33e13254">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e13259"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula>. In (<bold>c</bold>), the steady-state mean value of the population density is shown with respect to changes in the maximum growth rate of the species, <inline-formula id="IEq481"><alternatives><tex-math id="d33e13266">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e13271"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="11538_2025_1445_Fig7_HTML" id="MO7"/></fig></p><p id="Par95">When environmental fluctuations are very large in amplitude, phenotype-optimal dispersal can allow survival when a purely diffusing population goes extinct. When the environmental shifts are too large, the density loss due to the excessive level of maladaptation after each shift will be too high to be fully recovered by the adaptation that occurs afterwards. As a result, the population will not be able to reach a persistent state and its density keeps decreasing due to the repeated changes in the environment. Eventually, the population becomes extinct. Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref>c shows an example of such extinction dynamics, when phenotype-optimal dispersal is still fairly strong, <inline-formula id="IEq482"><alternatives><tex-math id="d33e13281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 4 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e13286"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq454.gif"/></alternatives></inline-formula>, but environmental fluctuations occur with a large amplitude of <inline-formula id="IEq483"><alternatives><tex-math id="d33e13302">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$9 \, \texttt{Q}$$\end{document}</tex-math><mml:math id="d33e13307"><mml:mrow><mml:mn>9</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq458.gif"/></alternatives></inline-formula>. To see if phenotype-optimal dispersal increases the chance of survival when amplitude of the fluctuations is large, we repeat the simulation associated with Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> for different values of fluctuation amplitudes. For each value, we compute the average value of the fluctuations in population density when it reaches a steady-state, and show it in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>a. We see that when the amplitude of the environmental fluctuations is not very large, optimal dispersal does not significantly increase the sustained density of the population. At very large fluctuation amplitudes, however, optimal dispersal can greatly increase the survival chance of the species.</p><p id="Par96">Varying the strength <inline-formula id="IEq484"><alternatives><tex-math id="d33e13323">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e13328"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula> of natural selection shows that optimal dispersal increases mean population density substantially only under very strong selection. Strong natural selection amplifies the effects of maladaptation induced by abrupt environmental changes, as implied from the term <inline-formula id="IEq485"><alternatives><tex-math id="d33e13332">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\frac{\textrm{S}}{2} (q - \textrm{Q})^2$$\end{document}</tex-math><mml:math id="d33e13337"><mml:mrow><mml:mfrac><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq485.gif"/></alternatives></inline-formula> in (<xref rid="Equ16" ref-type="disp-formula">10c</xref>). As a result, when <inline-formula id="IEq486"><alternatives><tex-math id="d33e13357">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e13362"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula> is large, the population suffers from a greater density loss after each shift in the trait optimum. However, larger values of <inline-formula id="IEq487"><alternatives><tex-math id="d33e13366">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e13371"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula> expedite adaptation to the new environment, due to (<xref rid="Equ22" ref-type="disp-formula">11f</xref>). To see how these conflicting effects of stronger natural selection affect population density under environmental fluctuations, and whether or not phenotype-optimal dispersal can be sufficiently advantageous to ensure population survival, we repeat the simulation associated with Fig.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> for different values of <inline-formula id="IEq488"><alternatives><tex-math id="d33e13382">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{S}$$\end{document}</tex-math><mml:math id="d33e13387"><mml:mtext>S</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq36.gif"/></alternatives></inline-formula> and measure the steady-state average value of the fluctuations in population density. The results are shown in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>b. In general, we see that stronger natural selection reduces the sustained population density under the abrupt fluctuations we simulated. When stabilizing section is weak, as we typically observe in nature (Kingsolver et&#x000a0;al. <xref ref-type="bibr" rid="CR66">2001</xref>), phenotype-optimal dispersal does not substantially increase mean population density. However, under very strong stabilizing selection, we observe that the population&#x02019;s chance of survival is substantially increased if its individuals disperse optimally.</p><p id="Par97">Phenotype-optimal dispersal can allow a population with a low maximum intrinsic growth rate <inline-formula id="IEq489"><alternatives><tex-math id="d33e13399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e13404"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula> to persist under environmental fluctuations that would drive it to extinction if it carried out only diffusive dispersal. The maximum growth rate of the population is a key factor in accelerating population density recovery following density losses caused by environmental changes. Slowly growing populations will have a lower chance of recovering their full density before suffering another loss. To see how this impacts the population survival, we repeat our simulations for different values of <inline-formula id="IEq490"><alternatives><tex-math id="d33e13408">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e13413"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula> and show the steady-state average value of population density fluctuations in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>c. We see that slowly-growing populations maintain a significantly lower density under environmental fluctuations, compared with fast-growing populations. However, phenotype-optimal dispersal substantially increases the survival prospects of slowly-growing species. In particular, with the relatively large fluctuation amplitude of <inline-formula id="IEq491"><alternatives><tex-math id="d33e13420">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5 \; \texttt{Q}$$\end{document}</tex-math><mml:math id="d33e13425"><mml:mrow><mml:mn>5</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">Q</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq465.gif"/></alternatives></inline-formula> that we considered in our simulation, we observe that, when <inline-formula id="IEq492"><alternatives><tex-math id="d33e13433">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e13438"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula> takes a relatively low value of approximately <inline-formula id="IEq493"><alternatives><tex-math id="d33e13443">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \; \texttt{T}^{-1}$$\end{document}</tex-math><mml:math id="d33e13448"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">T</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq493.gif"/></alternatives></inline-formula>, a randomly dispersing population becomes extinct whereas a population with strong optimal dispersal can persist. We note that, with our choice of generation time as the unit of time <inline-formula id="IEq494"><alternatives><tex-math id="d33e13460">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\texttt{T}$$\end{document}</tex-math><mml:math id="d33e13465"><mml:mi mathvariant="monospace">T</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq199.gif"/></alternatives></inline-formula>, the maximum intrinsic growth rate is argued to be a demographic invariant within some homogeneous taxonomic groups (Niel and Lebreton <xref ref-type="bibr" rid="CR82">2005</xref>). In particular, a slow growth rate of <inline-formula id="IEq495"><alternatives><tex-math id="d33e13473">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}= 1 \; \texttt{T}^{-1}$$\end{document}</tex-math><mml:math id="d33e13478"><mml:mrow><mml:mtext>R</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">T</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq495.gif"/></alternatives></inline-formula> is observed in a variety of taxa such as birds, sharks, and mammals (Niel and Lebreton <xref ref-type="bibr" rid="CR82">2005</xref>; Dillingham et&#x000a0;al. <xref ref-type="bibr" rid="CR32">2016</xref>; Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>), which are often sufficiently mobile to evolve optimal dispersal strategies.</p></sec><sec id="Sec22"><title>Phenotype-Optimal Dispersal in Fragmented Habitats</title><p id="Par98">We next ask whether optimal dispersal can enhance survival and range expansion speed when the habitat is fragmented. In highly fragmented environments, the cost of randomly moving from one habitat patch to reach another patch is particularly high. Optimal habitat selection can also be harder in such environments, as optimal detection of matching habitat patches can be substantially imperfect and dispersal mortality can be higher (Cote et&#x000a0;al. <xref ref-type="bibr" rid="CR21">2017</xref>). However, the enhanced local adaptation facilitated by optimal dispersal can still be imagined to be sufficiently beneficial to compensate for such costs. Therefore, it is argued that habitat choice behavior and adaptive dispersal strategies should also be selected in fragmented landscapes, and might be essential for the persistence of populations in such environments (Cote et&#x000a0;al. <xref ref-type="bibr" rid="CR21">2017</xref>; Bonte et&#x000a0;al. <xref ref-type="bibr" rid="CR20">2012</xref>). Here, we investigate whether or not phenotype-optimal dispersal can be of particular importance to a population&#x02019;s adaptation and range expansion capacity when the available habitat is highly fragmented.</p><p id="Par99">We first specify our simulated fragmented environment. We consider a two-dimensional habitat <inline-formula id="IEq496"><alternatives><tex-math id="d33e13517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega = (-50, 50) \times (-50, 50)$$\end{document}</tex-math><mml:math id="d33e13522"><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq496.gif"/></alternatives></inline-formula>, with a trait optimum profile that changes linearly in the <inline-formula id="IEq497"><alternatives><tex-math id="d33e13547">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1-$$\end{document}</tex-math><mml:math id="d33e13552"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq497.gif"/></alternatives></inline-formula>direction (horizontal axis) and is constant in the <inline-formula id="IEq498"><alternatives><tex-math id="d33e13560">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_2-$$\end{document}</tex-math><mml:math id="d33e13565"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq498.gif"/></alternatives></inline-formula>direction (vertical axis). We set a relatively steep gradient of <inline-formula id="IEq499"><alternatives><tex-math id="d33e13573">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _{x_1} \textrm{Q}= 1 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e13578"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq499.gif"/></alternatives></inline-formula> in <inline-formula id="IEq500"><alternatives><tex-math id="d33e13597">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1-$$\end{document}</tex-math><mml:math id="d33e13602"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq497.gif"/></alternatives></inline-formula>direction. Since habitat loss directly affects the carrying capacity of the environment (Baguette et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2013</xref>), we simulate habitat fragmentation by setting a patchy profile for the carrying capacity parameter <inline-formula id="IEq501"><alternatives><tex-math id="d33e13614">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}(x)$$\end{document}</tex-math><mml:math id="d33e13619"><mml:mrow><mml:mtext>K</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq29.gif"/></alternatives></inline-formula>. This profile is shown in supplementary Fig. S7, and its specific pattern can also be approximately seen through the last frames (at <inline-formula id="IEq502"><alternatives><tex-math id="d33e13629">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 40 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e13634"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq502.gif"/></alternatives></inline-formula>) in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>. If patch sizes are large in both directions, relative to the average (random) dispersal distance per generation, the range dynamics inside each patch is expected to be similar to that in the continuous habitat cases we studied before. Therefore, to make the effects of fragmentation sufficiently pronounced, we consider relatively narrow patches of width <inline-formula id="IEq503"><alternatives><tex-math id="d33e13647">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \; \texttt{X}$$\end{document}</tex-math><mml:math id="d33e13652"><mml:mrow><mml:mn>2</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq503.gif"/></alternatives></inline-formula>&#x02014;noting that the random dispersal coefficient <inline-formula id="IEq504"><alternatives><tex-math id="d33e13660">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{D}$$\end{document}</tex-math><mml:math id="d33e13665"><mml:mtext>D</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq18.gif"/></alternatives></inline-formula> takes the typical value of <inline-formula id="IEq505"><alternatives><tex-math id="d33e13670">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 I_2 \; \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e13675"><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mspace width="0.277778em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq505.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq506"><alternatives><tex-math id="d33e13692">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_2$$\end{document}</tex-math><mml:math id="d33e13697"><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq506.gif"/></alternatives></inline-formula> denotes the <inline-formula id="IEq507"><alternatives><tex-math id="d33e13703">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2 \times 2$$\end{document}</tex-math><mml:math id="d33e13708"><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq507.gif"/></alternatives></inline-formula> identity matrix. We let the length of these rectangular patches take values between <inline-formula id="IEq508"><alternatives><tex-math id="d33e13715">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10 \; \texttt{X}$$\end{document}</tex-math><mml:math id="d33e13720"><mml:mrow><mml:mn>10</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq508.gif"/></alternatives></inline-formula> and <inline-formula id="IEq509"><alternatives><tex-math id="d33e13728">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$15 \; \texttt{X}$$\end{document}</tex-math><mml:math id="d33e13733"><mml:mrow><mml:mn>15</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq509.gif"/></alternatives></inline-formula>. On the right half of the habitat, we arrange the patches horizontally, so that they are stretched in the direction of the environmental gradient. On the left half of the habitat, we arrange the patches vertically so that they are stretched perpendicular to the environmental gradient. We consider this specific layout to further observe if the alignments of the patches with the environmental gradient can have a particular impact on the range expansion dynamics. We arrange the rectangular patches side-by-side, with no gap between them. However, over each patch, we smoothly decrease the value of <inline-formula id="IEq510"><alternatives><tex-math id="d33e13741">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}$$\end{document}</tex-math><mml:math id="d33e13746"><mml:mtext>K</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq52.gif"/></alternatives></inline-formula> from <inline-formula id="IEq511"><alternatives><tex-math id="d33e13751">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \; \texttt{N}/\texttt{X}^2$$\end{document}</tex-math><mml:math id="d33e13756"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq511.gif"/></alternatives></inline-formula> at the patch&#x02019;s center to <inline-formula id="IEq512"><alternatives><tex-math id="d33e13770">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.05 \; \texttt{N}/\texttt{X}^2$$\end{document}</tex-math><mml:math id="d33e13775"><mml:mrow><mml:mn>0.05</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq512.gif"/></alternatives></inline-formula> at the patch&#x02019;s edge. This leaves fairly inhabitable regions of low carrying capacity between patch cores, as shown in Fig. S7. Finally, we make an exception for the size of the patch located at the center of the habitat, and let it be large. We initialize the population in this central patch, so that it can get established before expanding through the highly fragmented areas.<fig id="Fig8"><label>Fig. 8</label><caption><p>Range expansion of a species in a fragmented two-dimensional habitat. Here, <inline-formula id="IEq513"><alternatives><tex-math id="d33e13795">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{m}= 2$$\end{document}</tex-math><mml:math id="d33e13800"><mml:mrow><mml:mtext>m</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq513.gif"/></alternatives></inline-formula>, the environmental gradient along the <inline-formula id="IEq514"><alternatives><tex-math id="d33e13807">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_2$$\end{document}</tex-math><mml:math id="d33e13812"><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq198.gif"/></alternatives></inline-formula>-axis is zero, and the environmental gradient along the <inline-formula id="IEq515"><alternatives><tex-math id="d33e13818">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1$$\end{document}</tex-math><mml:math id="d33e13823"><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq515.gif"/></alternatives></inline-formula>-axis is <inline-formula id="IEq516"><alternatives><tex-math id="d33e13829">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _{x_1} \textrm{Q}= 1 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e13834"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq499.gif"/></alternatives></inline-formula>. Habitat fragmentation is simulated by considering a patchy profile for the carrying capacity <inline-formula id="IEq517"><alternatives><tex-math id="d33e13853">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}$$\end{document}</tex-math><mml:math id="d33e13858"><mml:mtext>K</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq52.gif"/></alternatives></inline-formula>, as shown in supplementary Fig. S7. Parameter <inline-formula id="IEq518"><alternatives><tex-math id="d33e13863">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}$$\end{document}</tex-math><mml:math id="d33e13868"><mml:mtext>A</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq19.gif"/></alternatives></inline-formula> takes different values for the results shown in the upper and lower panels. The rest of the parameters take their typical values given in Table <xref rid="Tab1" ref-type="table">1</xref>. Four frames of the spatial profile of the species&#x02019; population density are shown in each panel as the species&#x02019; range evolves in time. The upper panel shows range expansion of a species with no optimal dispersal, <inline-formula id="IEq519"><alternatives><tex-math id="d33e13875">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e13880"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq290.gif"/></alternatives></inline-formula>, whereas the lower panel shows the range expansion of the species with strong optimal dispersal, <inline-formula id="IEq520"><alternatives><tex-math id="d33e13896">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e13901"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq218.gif"/></alternatives></inline-formula>. For comparison purposes, the same simulations but with constant carrying capacity of <inline-formula id="IEq521"><alternatives><tex-math id="d33e13917">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}= 1 \; \texttt{N}/ \texttt{X}^2$$\end{document}</tex-math><mml:math id="d33e13922"><mml:mrow><mml:mtext>K</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq521.gif"/></alternatives></inline-formula> are performed and the leftmost and rightmost edges of the population are indicated by blue bars in each plot. It should also be noted that the final (approximate steady-steady) profile of the phenotype-environment mismatch and trait variance at <inline-formula id="IEq522"><alternatives><tex-math id="d33e13938">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 40 \, \texttt{T}$$\end{document}</tex-math><mml:math id="d33e13943"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq522.gif"/></alternatives></inline-formula> are also shown in supplementary Figs. S8 and S9</p></caption><graphic xlink:href="11538_2025_1445_Fig8_HTML" id="MO8"/></fig></p><p id="Par100">When dispersal is entirely random, population density drops off significantly over the patches and mismatch between the trait mean and trait optimum grows sharply from the center to the edge of the patches. Figure&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref> shows the simulation results for a species with only randomly dispersing individuals (upper panel) and for a species with phenotype-optimal dispersal (lower panel). To make a comparison with range expansion in a continuous habitat, we also perform the simulations with a constant carrying capacity of <inline-formula id="IEq523"><alternatives><tex-math id="d33e13960">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{K}= 1 \; \texttt{N}/ \texttt{X}^2$$\end{document}</tex-math><mml:math id="d33e13965"><mml:mrow><mml:mtext>K</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq521.gif"/></alternatives></inline-formula> and indicate the leftmost and rightmost edges of the population by blue bars in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>. The population establishes itself in the central patch to its almost maximum capacity of approximately <inline-formula id="IEq524"><alternatives><tex-math id="d33e13984">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \; \texttt{N}/ \texttt{X}^2$$\end{document}</tex-math><mml:math id="d33e13989"><mml:mrow><mml:mn>1</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq524.gif"/></alternatives></inline-formula>. However, it spreads over the fragmented regions with much lower density. This is mainly due to a significant level of maladaptation that is maintained by the homogenizing effect of random gene flow. Figure S8 shows the phenotype-environment mismatch <inline-formula id="IEq525"><alternatives><tex-math id="d33e14003">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(q - \textrm{Q})$$\end{document}</tex-math><mml:math id="d33e14008"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq525.gif"/></alternatives></inline-formula> at the end of the simulations, when the mismatch has approximately reached a steady state over the whole habitat. The steady-state level of mismatch is low at the center of the patches. However, it increases rather sharply towards their edges. Since patches are relatively narrow, this results in a relatively high level of overall maladaptation over a large area of the patches, and hence the significant loss of population density.</p><p id="Par101">Phenotype-optimal dispersal raises the rate, though not the steady-state level, of adaptation within habitat patches. It thereby enhances the transient expansion dynamics of the population, as observed through the increased expansion speed in the lower panel of Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>. However, we observe that optimal dispersal does not significantly improve the steady-state level of adaptation (shown in Fig. S8) and population density within the patches. The maximum population density that we observe in patches of the fragmented region at <inline-formula id="IEq526"><alternatives><tex-math id="d33e14024">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 40 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e14029"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq502.gif"/></alternatives></inline-formula> is approximately <inline-formula id="IEq527"><alternatives><tex-math id="d33e14039">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.45 \; \texttt{N}/ \texttt{X}^2$$\end{document}</tex-math><mml:math id="d33e14044"><mml:mrow><mml:mn>0.45</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq527.gif"/></alternatives></inline-formula> when <inline-formula id="IEq528"><alternatives><tex-math id="d33e14058">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 10 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e14063"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq218.gif"/></alternatives></inline-formula>, which is only slightly larger than the maximum density of <inline-formula id="IEq529"><alternatives><tex-math id="d33e14079">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.41 \; \texttt{N}/ \texttt{X}^2$$\end{document}</tex-math><mml:math id="d33e14084"><mml:mrow><mml:mn>0.41</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq529.gif"/></alternatives></inline-formula> observed when <inline-formula id="IEq530"><alternatives><tex-math id="d33e14099">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0 \, \texttt{X}^2/\texttt{T}$$\end{document}</tex-math><mml:math id="d33e14104"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mspace width="0.166667em"/><mml:msup><mml:mi mathvariant="monospace">X</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq290.gif"/></alternatives></inline-formula>. This is because, due to the narrow widths of the patches, the directed gene flow created by phenotype-optimal dispersal is not sufficiently strong to effectively compensate for the maladaptive core-to-edge random gene flow within the patches.</p><p id="Par102">With phenotype-optimal dispersal, the rate of range expansion in the simulated fragmented habitat almost equals that in a continuous habitat; although the population density in the fragmented habitat remains significantly lower. This is implied by the locations of the blue bars in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>, which also coincide with the leftmost and rightmost edges of the population in the fragmented habitat. Notably, we do not observe any effects of phenotype-optimal dispersal that particularly enhance the range expansion capacity of the population when a habitat is fragmented, compared with the continuous habitat case.</p><p id="Par103">With phenotype-optimal dispersal, the maximum steady-state (<inline-formula id="IEq531"><alternatives><tex-math id="d33e14127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 40 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e14132"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq502.gif"/></alternatives></inline-formula>) population density on vertical patches is about 10 percent higher than the maximum density on horizontal patches. By contrast, when dispersal is only random, the particular layout of the patches&#x02014;horizontally arranged on the right and vertically arranged on the left&#x02014;does not result in any noticeable asymmetry in population&#x02019;s expansion to each side of the habitat. Slightly better adaptation, and lower trait variance are also observed under optimal dispersal within vertical patches. This can be explained by noting that the vertical patches in our simulation are stretched perpendicular to the gradient of the trait optimum. Therefore, optimal movements in the direction of the environmental gradient lead to a distribution of relatively close phenotypes along each of the vertical patches. Since the patches are also relatively narrow, the overall closeness of phenotypes in vertical patches decreases the maladaptive impacts of the random component of gene flow within the patches. As a result, population density can grow to (somewhat) higher levels within vertical patches.</p><p id="Par104">Finally, in fragmented as well as in continuous habitat, phenotype-optimal dispersal markedly reduces trait variation within the patches. Figure S9 shows the final profiles of trait variance at <inline-formula id="IEq532"><alternatives><tex-math id="d33e14144">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t = 40 \; \texttt{T}$$\end{document}</tex-math><mml:math id="d33e14149"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>40</mml:mn><mml:mspace width="0.277778em"/><mml:mi mathvariant="monospace">T</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq502.gif"/></alternatives></inline-formula>. In the presence of a steep environmental gradient, as we consider here, the reduced phenotypic variability within patches results in substantial increase in variability among the patches. Although not included in our model, it can be argued that this enhanced genetic differentiation between the patches contributes to reproductive isolation between the local populations. Large genetic differences between the patches can reduce the propensity of individuals to move between the patches, to avoid mating with individuals in a genetically novel population (Garant et&#x000a0;al. <xref ref-type="bibr" rid="CR47">2007</xref>; Bolnick and Otto <xref ref-type="bibr" rid="CR15">2013</xref>; Cote et&#x000a0;al. <xref ref-type="bibr" rid="CR21">2017</xref>; Benkman <xref ref-type="bibr" rid="CR12">2017</xref>). The reduced movements between the patches and reduced genetic variation within the patches can then promote the evolution of assortative mating, which further reinforces the reproductive isolation between the patches. This process can eventually lead to sympatric speciation in the habitat (Nicolaus and Edelaar <xref ref-type="bibr" rid="CR81">2018</xref>; Lenormand <xref ref-type="bibr" rid="CR72">2002</xref>; Garant et&#x000a0;al. <xref ref-type="bibr" rid="CR47">2007</xref>; Bolnick and Otto <xref ref-type="bibr" rid="CR15">2013</xref>).</p></sec></sec><sec id="Sec23"><title>Discussion</title><p id="Par105">Matching habitat choice has been hypothesized to have distinctive evolutionary effects on species&#x02019; range dynamics and genetic structure (Edelaar et&#x000a0;al. <xref ref-type="bibr" rid="CR41">2008</xref>; Nicolaus and Edelaar <xref ref-type="bibr" rid="CR81">2018</xref>; Edelaar and Bolnick <xref ref-type="bibr" rid="CR36">2019</xref>; Bolnick and Otto <xref ref-type="bibr" rid="CR15">2013</xref>; Jacob et&#x000a0;al. <xref ref-type="bibr" rid="CR62">2017</xref>). Because of the potentially complex interactions between matching habitat choice and other eco-evolutionary forces, intuitive or verbal predictions of its effects must be taken skeptically. We therefore proposed and numerically studied a deterministic PDE model incorporating a specific type of matching habitat choice we called phenotype-optimal dispersal, together with other eco-evolutionary forces. Our goal was to quantify the environmental and other conditions under which phenotype-optimal dispersal has substantial effects on the spatial dynamics of population density as well as of the mean and variance of a quantitative trait. To accomplish this, we compared the results of simulations incorporating a combination of phenotype-optimal and random (diffusive) dispersal with the results of simulations incorporating random dispersal only.</p><p id="Par106">A key novel aspect of our model, among studies of matching habitat choice, is that it is a deterministic continuum model, particularly suitable for modeling populations that disperse over (mostly) nonfragmented habitat. We also note that the strength of phenotype-optimal dispersal in our model depends on both phenotype-environment mismatch and environmental gradient. Dependence only on the phenotype-environment mismatch can result in redundant movements in shallow gradients which may be unlikely to evolve as a matching habitat choice strategy in nature. Our model also incorporates phenotype-dependent competition. Competition tends to inflate phenotypic variance. At the same time, matching habitat choice reduces local phenotypic variance, which should intensify competition. We used our model to study the nonintuitive range dynamics that results from the interaction between these two counteracting forces.</p><p id="Par107">Through our extensive computational investigations, we found effects of phenotype-optimal dispersal on diverse measures of persistence, range expansion, adaptation, and trait variance. These effects were generally important only in steep environmental gradients or when specialization was very pronounced, and in particular for slowly-growing species.</p><sec id="Sec24"><title>Implications for Adaptation, Range Dynamics, and Speciation</title><p id="Par108">In a static environment with steep gradient, we found as expected that phenotype-optimal dispersal facilitates rapid adaptation of the individuals (and the population) within a single generation. To the extent that the relevant trait is heritable and the environmental gradient monotone, this should improve the fitness of subsequent generations and cause adaptive evolution. Optimal dispersal also lowers phenotypic variance both at central and peripheral populations, reducing further the need for natural selection to eliminate unfit phenotypes. In light of these adaptive effects, it is noteworthy that we found the gene flow created in the presence of optimal dispersal always to be adaptive; see Figs.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> and <xref rid="Fig5" ref-type="fig">5</xref>. Specifically, the directed gene flow induced by optimal dispersal effectively compensates for the maladaptive (swamping) effects of asymmetric random gene flow at range margins. As a result, we found that (in steep environmental gradients) optimal dispersal increased the speeds of traveling waves modeling range expansion; see Figs.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>, and <xref rid="Fig2" ref-type="fig">2</xref>. It had little effects on peak population density behind the wavefront, but it significantly increased the growth rate of the population during transient states of population establishment. These effects also broadly persisted in fragmented habitats; see Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>.</p><p id="Par109">Genetic swamping of peripheral populations by the gene flow from central populations has been hypothesized, for a long time, as a major cause of range limits&#x02014;by destabilizing the migration-selection equilibrium at range margins (Haldane <xref ref-type="bibr" rid="CR52">1956</xref>; Mayr <xref ref-type="bibr" rid="CR79">1963</xref>; Kirkpatrick and Barton <xref ref-type="bibr" rid="CR63">1997</xref>; Sexton et&#x000a0;al. <xref ref-type="bibr" rid="CR111">2009</xref>; Lenormand <xref ref-type="bibr" rid="CR72">2002</xref>). This hypothesis has been challenged by several theoretical and empirical studies (Case and Taper <xref ref-type="bibr" rid="CR29">2000</xref>; Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>; Kottler et&#x000a0;al. <xref ref-type="bibr" rid="CR64">2021</xref>). We note that the present study also found no conditions&#x02014;even in fragmented habitat&#x02014;that led to a stable localized population (&#x0201c;range pinning&#x0201d;) in a linearly changing environment. Rather, populations either advanced without limit in a traveling wave or went extinct under violent environmental fluctuations. Indeed, our finding that gene flow to the wavefront was always adaptive provides further theoretical evidence that range pinning via genetic swamping should be rare in nature. This finding runs contrary to the prediction of Kirkpatrick and Barton (<xref ref-type="bibr" rid="CR63">1997</xref>) based on a PDE model with constant variance, but consistent with the predictions of Barton (<xref ref-type="bibr" rid="CR7">2001</xref>) with evolving variance, Case and Taper (<xref ref-type="bibr" rid="CR29">2000</xref>) with competition and constant variance, and of the authors with competition and evolving variance (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>). It is also consistent with the earlier observation of Holt (<xref ref-type="bibr" rid="CR59">1987</xref>) that habitat selection should often vitiate the swamping effects of gene flow as a constraint on the evolution of local adaptation. Empirical results reviewed by Kottler et&#x000a0;al. (<xref ref-type="bibr" rid="CR64">2021</xref>) have also found limited support for asymmetry in (total) center-to-edge gene flow, and very little evidence that such gene flow reduces mean fitness in edge populations.</p><p id="Par110">We also note that rapid adaptation due to phenotype-optimal dispersal is particularly important in temporally changing environments, as it remarkably enhances population persistence under sharp environmental fluctuations; see Figs.&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref> and S6. This can be specifically important for slowly-growing species, such as birds and mammals, since they cannot recover sufficiently fast from population losses due to sharp changes in the environment; see Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>. Therefore, our results support existing arguments for taking matching habitat choice into account when predicting the response of species to climate-induced environmental fluctuations (Pellerin et&#x000a0;al. <xref ref-type="bibr" rid="CR85">2019</xref>; Edelaar and Bolnick <xref ref-type="bibr" rid="CR36">2019</xref>; Nicolaus and Edelaar <xref ref-type="bibr" rid="CR81">2018</xref>; Edelaar and Bolnick <xref ref-type="bibr" rid="CR35">2012</xref>; Jacob et&#x000a0;al. <xref ref-type="bibr" rid="CR62">2017</xref>; Bonte et&#x000a0;al. <xref ref-type="bibr" rid="CR20">2012</xref>).</p><p id="Par111">It is worth noting that Pellerin et&#x000a0;al. (<xref ref-type="bibr" rid="CR85">2019</xref>) predict, based on their model, that climate change can result in contraction and fragmentation of the species&#x02019; range. By contrast, we do not see range contraction in our results even in the absence of phenotype-optimal dispersal (with pure random dispersal). Extinction by strong environmental fluctuations in our model is in the form of vanishing population density rather than contracting range. It is possible that the range contraction or fragmentation observed by Pellerin et&#x000a0;al. (<xref ref-type="bibr" rid="CR85">2019</xref>) could, to some extent, be due to the discrete patchy environment in their model and discrete movements of their individuals (they jump from one patch to the other at the end of each year). This provides an example, specifically in the context of matching habitat choice, of how range dynamics in continuous habitats can exhibit behavior unlike that in discrete habitat models.</p><p id="Par112">Finally, we note that in fragmented habitats, the reduced within-population trait variation and enhanced local adaptation resulting from optimal dispersal increased the level of trait variation between local populations. Thus our results provide further quantitative theoretical support for the predictions that matching habitat choice can drive reproductive isolation, promote assortative mating, and contribute to sympatric or parapatric speciation (Maynard Smith <xref ref-type="bibr" rid="CR80">1966</xref>; Endler <xref ref-type="bibr" rid="CR38">1977</xref>; Rice and Salt <xref ref-type="bibr" rid="CR99">1988</xref>, <xref ref-type="bibr" rid="CR100">1990</xref>; Rice and Hostert <xref ref-type="bibr" rid="CR93">1993</xref>; Holt <xref ref-type="bibr" rid="CR59">1987</xref>; Coyne <xref ref-type="bibr" rid="CR27">1992</xref>; Kirkpatrick and Ravign&#x000e9; <xref ref-type="bibr" rid="CR68">2002</xref>; Bolnick and Otto <xref ref-type="bibr" rid="CR15">2013</xref>; Nicolaus and Edelaar <xref ref-type="bibr" rid="CR81">2018</xref>; Edelaar et&#x000a0;al. <xref ref-type="bibr" rid="CR41">2008</xref>, <xref ref-type="bibr" rid="CR39">2023</xref>; Berner and Thibert-Plante <xref ref-type="bibr" rid="CR18">2015</xref>; Ravign&#x000e9; et&#x000a0;al. <xref ref-type="bibr" rid="CR92">2009</xref>).</p></sec><sec id="Sec25"><title>Environmental Gradients and the Evolution of Dispersal</title><p id="Par113">The effects of environmental gradients and random dispersal on species range evolution are interlinked. When dispersal is random, the presence of an environmental gradient makes the random core-to-edge gene flow maladaptive, thereby hindering local adaptation at range margins. Therefore, compared with range expansion in a homogeneous environment, the presence of an environmental gradient reduces range expansion speed. The steeper the gradient, the slower the range expansion speed; see Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a for <inline-formula id="IEq533"><alternatives><tex-math id="d33e14360">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0$$\end{document}</tex-math><mml:math id="d33e14365"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq287.gif"/></alternatives></inline-formula>. Fixing the environmental gradient at a nonzero constant value, the same effect is observed by increasing the dispersal rate. That is, the higher the dispersal, the stronger the effect of maladaptive gene flow, and the slower the range expansion speed (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>; Benning et&#x000a0;al. <xref ref-type="bibr" rid="CR11">2024</xref>). Although this observation is counterintuitive, as it may be expected that higher dispersal should increase expansion speed, it can be understood by the fact that the steepness of the environmental gradient and the rate of dispersal are linked through a rescaling of the geographic space. In fact, when dispersal is only random (<inline-formula id="IEq534"><alternatives><tex-math id="d33e14378">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0$$\end{document}</tex-math><mml:math id="d33e14383"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq287.gif"/></alternatives></inline-formula> in our model), a change <inline-formula id="IEq535"><alternatives><tex-math id="d33e14391">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt{\textrm{D}} \mapsto k \sqrt{\textrm{D}}$$\end{document}</tex-math><mml:math id="d33e14396"><mml:mrow><mml:msqrt><mml:mtext>D</mml:mtext></mml:msqrt><mml:mo>&#x021a6;</mml:mo><mml:mi>k</mml:mi><mml:msqrt><mml:mtext>D</mml:mtext></mml:msqrt></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq535.gif"/></alternatives></inline-formula> in the dispersal coefficient in the equation of our model (<xref rid="Equ14" ref-type="disp-formula">10</xref>)&#x02013;(<xref rid="Equ23" ref-type="disp-formula">12</xref>) can be absorbed by a rescaling <inline-formula id="IEq536"><alternatives><tex-math id="d33e14412">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x \mapsto x/k$$\end{document}</tex-math><mml:math id="d33e14417"><mml:mrow><mml:mi>x</mml:mi><mml:mo>&#x021a6;</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq536.gif"/></alternatives></inline-formula> of the space variable, and consequently an equivalent change <inline-formula id="IEq537"><alternatives><tex-math id="d33e14427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}\mapsto k \nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e14432"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo>&#x021a6;</mml:mo><mml:mi>k</mml:mi><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq537.gif"/></alternatives></inline-formula> in the environmental gradient (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>,&#x000a0;Remark 3).</p><p id="Par114">In the presence of an environmental gradient, the gene flow created by random dispersal increases local phenotypic variation. The steeper the gradient the higher the level of phenotypic variance; see Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a for <inline-formula id="IEq538"><alternatives><tex-math id="d33e14456">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0$$\end{document}</tex-math><mml:math id="d33e14461"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq287.gif"/></alternatives></inline-formula>. Our results show that, in extremely steep gradients, inflated phenotypic variation substantially intensifies the phenotypic load that selection imposes on a population&#x02019;s growth rate. As a result, the population density declines sharply with increases in the environmental gradient; see Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a for <inline-formula id="IEq539"><alternatives><tex-math id="d33e14471">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0$$\end{document}</tex-math><mml:math id="d33e14476"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq287.gif"/></alternatives></inline-formula>. In particular, the species fails to survive when the gradient exceeds a critical level given by (<xref rid="Equ35" ref-type="disp-formula">18</xref>). Based on the link we discussed above between the effects of dispersal and environmental gradient, the same pattern of changes in trait variance and population density as shown in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>a (with <inline-formula id="IEq540"><alternatives><tex-math id="d33e14490">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{A}= 0$$\end{document}</tex-math><mml:math id="d33e14495"><mml:mrow><mml:mtext>A</mml:mtext><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq287.gif"/></alternatives></inline-formula>) is also observed versus changes in <inline-formula id="IEq541"><alternatives><tex-math id="d33e14502">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sqrt{\textrm{D}}$$\end{document}</tex-math><mml:math id="d33e14507"><mml:msqrt><mml:mtext>D</mml:mtext></mml:msqrt></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq541.gif"/></alternatives></inline-formula>; see also Remark 3 by Shirani and Miller (<xref ref-type="bibr" rid="CR110">2022</xref>). That is, trait variance increase with increases in dispersal, and when dispersal is exceedingly large, population density declines sharply with increases in dispersal. Although the critical gradients we calculated are likely too steep to be plausible for the majority of species (unless possibly representing physical barriers), our results suggest that slowly-growing species under excessively strong selection are quite likely to experience such critical gradients in nature; see Remark <xref ref-type="sec" rid="FPar6">6</xref> and Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>. This means that, this class of (vulnerable) species are at high risk of extinction in steep environmental gradients if they disperse randomly over long distances.</p><p id="Par115">In light of the link between random dispersal and environmental gradients in hindering local adaption and reducing expansion speed, it is argued that dispersal is strongly selected against in presence of an environmental gradient (Holt <xref ref-type="bibr" rid="CR58">1985</xref>). Using an individual-based model that allows for the evolution of both a fitness-related (niche) trait and a trait that controls dispersal ability, Benning et&#x000a0;al. (<xref ref-type="bibr" rid="CR11">2024</xref>) have shown that the presence of an environmental gradient opposes the evolution of increased dispersal during invasions. If the gradient is steep, it can even result in the evolution of reduced dispersal. This in fact follows from the link between dispersal and environmental gradients we discussed above. Reduced random dispersal is equivalent to a reduced environmental gradient, and hence may be expected to cancel out the effects of steep gradients. However, this conclusion relies on an important assumption, that dispersal evolves as random movements. Although there are stochastic and extrinsic forces that influence dispersal (Lowe and McPeek <xref ref-type="bibr" rid="CR74">2014</xref>), it is not very realistic to assume species evolve random dispersal in steep environmental gradients. By contrast, our results suggests that steep environmental gradients indeed play a key role in evolution of increased phenotype-optimal (adaptive) dispersal, which can then effectively compensate for the disruptive effects of the gradients on local adaptation and range expansion. In view of our results and those of Benning et&#x000a0;al. (<xref ref-type="bibr" rid="CR11">2024</xref>), we can hence hypothesize that there may be different thresholds in the steepness of the gradients that promote evolution of different dispersal strategies. Significantly steep gradients beyond a threshold may promote the evolution of optimal (directed) dispersal. Moderately steep gradients below a threshold may instead lead to the evolution of reduced dispersal.</p></sec><sec id="Sec26"><title>Phenotype-Optimal Dispersal in Nature</title><p id="Par116">Currently, evidence for matching habitat choice in nature is limited. This may be partly because this mode of adaptation has been overlooked due to a primary focus on natural selection (Edelaar and Bolnick <xref ref-type="bibr" rid="CR36">2019</xref>). However, matching habitat choice may truly be rare because of, for example, high cost for its evolution, inability of species&#x02019; individuals to obtain information about their performance and matching habitats, dependence of adaptation on multiple uncorrelated traits, and movement restrictions imposed by strong territoriality (Edelaar et&#x000a0;al. <xref ref-type="bibr" rid="CR37">2017</xref>; Nicolaus and Edelaar <xref ref-type="bibr" rid="CR81">2018</xref>). Our finding that environmental gradients must be steep for phenotype-optimal dispersal to be consequential suggests an additional non-artifactual reason why this dispersal mode has rarely been observed. Further, we note that we did not explicitly include dispersal costs in our model. Such costs should make phenotype-optimal dispersal even less likely to evolve in shallow gradients. Yet we should note that our estimates of typical values for steepness of environmental gradients are based on limited data (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>, Sect. 3.2). This is because environmental trait optima and their gradient are hard to measure, and the available measurements are often based on different choices of units which make steepness comparisons almost impossible. Our particular choices of units (see Sect.&#x000a0;<xref rid="Sec10" ref-type="sec">2.5</xref>) can provide sufficient generality for future measurements, based on which better estimates for typical steepness of gradients can be obtained.</p><p id="Par117">The current scarcity of evidence for matching habitat choice may also be because efforts for finding such evidence have not been focused on the most promising taxa. As we discussed before, our results suggests that phenotype-optimal dispersal should be more prevalent among highly-mobile slowly-growing species which are possibly exposed to sharp, strong, and frequent changes in their environment. Based on this observation, nomadic birds (Benkman <xref ref-type="bibr" rid="CR12">2017</xref>) and long-range dispersing mammals such as seals, cougars, elephants, buffaloes, rhinoceros, giraffes, and wolves could be examples of species that might specifically benefit from evolving phenotype-optimal dispersal. Microorganisms that live in high chemical or temporal gradients may also optimally move to better matching environment through taxis.</p><p id="Par118">Matching habitat choice is not straightforward to detect in nature. Our results could suggest two preliminary considerations for planning of studies that aim to detect or rule out phenotype-optimal dispersal in the field or laboratory; see, for example, (Edelaar and Bolnick <xref ref-type="bibr" rid="CR35">2012</xref>; Camacho et&#x000a0;al. <xref ref-type="bibr" rid="CR28">2020</xref>). First, the impacts of gene flow on the fitness of individuals should specifically be observed at population&#x02019;s range margins. As we discussed before, phenotype-optimal dispersal results in adaptive gene flow to range margins, which is otherwise expected to be maladaptive when dispersal is predominantly random. Second, the level of trait variation should be observed at the core of the population. Phenotype-optimal dispersal can reduce trait variation to strikingly low levels that are unlikely to be maintained by realistically strong selection.</p><p id="Par119">Finally, our results provide a cautionary note. The microcosms (Jacob et&#x000a0;al. <xref ref-type="bibr" rid="CR62">2017</xref>) or microclimatic mosaic arenas (Karpestam et&#x000a0;al. <xref ref-type="bibr" rid="CR69">2012</xref>) that are usually constructed in experiments to detect directed dispersal behavior of a model species may have considerably steeper environmental gradients than those likely to prevail in the species&#x02019; natural habitat. Since our results identify a steep environmental gradient as a key factor for evolution of matching habitat choice, we note that researchers should ensure (when possible) that the difference between experimental and natural habitat gradients is insignificant, or use caution in interpreting the experimental results.</p></sec><sec id="Sec27"><title>Future Research Directions</title><p id="Par120">It is important to note that phenotype-optimal dispersal, the type of matching habitat choice modeled in the present work, incorporates only local environment sensing (assessment). Nonlocal environment sensing, in which an individual can assess the environment at some distance from its location, could readily be incorporated into extensions of our model. Such extensions would be worth studying in part because nonlocal sensing will reduce individuals&#x02019; exploratory movements and will increase the chance of settling in globally optimal habitat location. It may be plausible that with nonlocal sensing, the effects of matching habitat choice we have identified here would be significant over shallower environmental gradients. The present study suggests that with purely local environment sensing, matching habitat choice should not be a favored adaptive mechanism in many environments. Since we have performed all our studies in a linear environment, in which local and global sensing will have the same outcomes, we still suspect that our hypothesis remains valid even in case where individuals have nonlocal assessment capabilities. Studies with nonlocal sensing, possibly with nonlinear habitat gradients, would help test the robustness of our hypothesis more rigorously.</p><p id="Par121">Phenotypic adaptation to a heterogeneous environment can occur through several modes, including habitat choice, natural selection, and phenotypic plasticity. How strong each of these modes is relative to the others, how they interact, and under what conditions they are more favored are questions that are not yet fully addressed (Scheiner et&#x000a0;al. <xref ref-type="bibr" rid="CR103">2022</xref>; Edelaar and Bolnick <xref ref-type="bibr" rid="CR36">2019</xref>; Edelaar et&#x000a0;al. <xref ref-type="bibr" rid="CR37">2017</xref>). We included phenotype-optimal dispersal and selection in our model. We observed that strong optimal dispersal tends to reduce trait variation relatively fast, leaving less genetic variation for selection to act upon. When a population experiences a sharp change in the environment, it suffers from a strong selective load. We observed that optimal dispersal is quite effective in mitigating the effects of this load and facilitating rapid recovery. This implies that, in rapidly changing environments, natural selection can indeed increase the potential for evolution of phenotype-optimal dispersal. Detailed analysis of the interactions between natural selection and matching habitat choice, and further extensions to include other modes such as phenotypic plasticity, are important directions for future work. The extensive literature on the evolution of phenotypic plasticity and its effects on range dynamics (Schlichting and Pigliucci <xref ref-type="bibr" rid="CR112">1998</xref>; DeWitt and Scheiner <xref ref-type="bibr" rid="CR33">2004</xref>; Scheiner <xref ref-type="bibr" rid="CR104">1993</xref>; DeWitt et&#x000a0;al. <xref ref-type="bibr" rid="CR34">1998</xref>; Agrawal <xref ref-type="bibr" rid="CR3">2001</xref>; Pigliucci <xref ref-type="bibr" rid="CR86">2005</xref>; Ghalambor et&#x000a0;al. <xref ref-type="bibr" rid="CR51">2007</xref>; Chevin et&#x000a0;al. <xref ref-type="bibr" rid="CR26">2010</xref>; Chevin and Lande <xref ref-type="bibr" rid="CR24">2011</xref>; Scheiner et&#x000a0;al. <xref ref-type="bibr" rid="CR102">2012</xref>; Valladares et&#x000a0;al. <xref ref-type="bibr" rid="CR117">2014</xref>; Murren et&#x000a0;al. <xref ref-type="bibr" rid="CR78">2015</xref>; Forsman <xref ref-type="bibr" rid="CR44">2015</xref>; Chevin and Hoffmann <xref ref-type="bibr" rid="CR22">2017</xref>; Schmid et&#x000a0;al. <xref ref-type="bibr" rid="CR106">2019</xref>; Turko and Rossi <xref ref-type="bibr" rid="CR114">2022</xref>; Eriksson and Rafajlovi&#x00107; <xref ref-type="bibr" rid="CR40">2022</xref>) as well as the preliminary results on coevolution and comparison of phenotypic plasticity with matching habitat choice (Scheiner <xref ref-type="bibr" rid="CR105">2016</xref>; Edelaar et&#x000a0;al. <xref ref-type="bibr" rid="CR37">2017</xref>; Nicolaus and Edelaar <xref ref-type="bibr" rid="CR81">2018</xref>; Lowe and Addis <xref ref-type="bibr" rid="CR70">2019</xref>; Boyle and Start <xref ref-type="bibr" rid="CR16">2020</xref>) can help guide this topic of research.</p></sec></sec><sec id="Sec31" sec-type="supplementary-material"><title>Supplementary Information</title><p>Below is the link to the electronic supplementary material.<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="11538_2025_1445_MOESM1_ESM.zip"><caption><p>Supplementary file 1 (zip 3877 KB)</p></caption></media></supplementary-material></p></sec></body><back><app-group><app id="App1"><sec id="Sec28"><title>Perceived Environmental Gradient</title><p id="Par126">The perceived gradient partially defined in (<xref rid="Equ13" ref-type="disp-formula">9</xref>) over a smaller habitat <inline-formula id="IEq542"><alternatives><tex-math id="d33e14694">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega _{\delta }$$\end{document}</tex-math><mml:math id="d33e14699"><mml:msub><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq153.gif"/></alternatives></inline-formula> requires certain technical considerations near the boundary of the habitat so that it can be extended to the whole habitat <inline-formula id="IEq543"><alternatives><tex-math id="d33e14706">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><mml:math id="d33e14711"><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq59.gif"/></alternatives></inline-formula>. To include such an extension, we assume that the individuals of the species are able to perceive the boundary of the habitat once they become sufficiently close to it (closer than the constant <inline-formula id="IEq544"><alternatives><tex-math id="d33e14716">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta $$\end{document}</tex-math><mml:math id="d33e14721"><mml:mi>&#x003b4;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq155.gif"/></alternatives></inline-formula>), and they avoid crossing the boundary. This means that, we assume that the normal component of <inline-formula id="IEq545"><alternatives><tex-math id="d33e14725">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}$$\end{document}</tex-math><mml:math id="d33e14730"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq143.gif"/></alternatives></inline-formula> to the boundary of <inline-formula id="IEq546"><alternatives><tex-math id="d33e14743">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><mml:math id="d33e14748"><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq59.gif"/></alternatives></inline-formula> is zero. Over a neighborhood of width <inline-formula id="IEq547"><alternatives><tex-math id="d33e14753">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta $$\end{document}</tex-math><mml:math id="d33e14758"><mml:mi>&#x003b4;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq155.gif"/></alternatives></inline-formula> around the boundary, we smoothly extend the <inline-formula id="IEq548"><alternatives><tex-math id="d33e14762">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}$$\end{document}</tex-math><mml:math id="d33e14767"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq143.gif"/></alternatives></inline-formula> defined by (<xref rid="Equ13" ref-type="disp-formula">9</xref>) so that its normal component to the boundary gradually vanishes to zero. As a result, the extended <inline-formula id="IEq549"><alternatives><tex-math id="d33e14782">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}$$\end{document}</tex-math><mml:math id="d33e14787"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq143.gif"/></alternatives></inline-formula> will be tangential to the boundary of <inline-formula id="IEq550"><alternatives><tex-math id="d33e14799">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><mml:math id="d33e14804"><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq59.gif"/></alternatives></inline-formula>. For this, we first define the following cut-off function<disp-formula id="Equ36"><label>19</label><alternatives><tex-math id="d33e14810">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \chi _{\delta }(y) = {\left\{ \begin{array}{ll} \exp \left( \frac{y^2}{y^2 - \delta ^2}\right) , &#x00026; |y|&#x0003c;\delta \\ 0, &#x00026; |y| \ge \delta \end{array}\right. } \end{aligned}$$\end{document}</tex-math><mml:math id="d33e14816" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x003c7;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>&#x003b4;</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x0003c;</mml:mo><mml:mi>&#x003b4;</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mi>&#x003b4;</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ36.gif" position="anchor"/></alternatives></disp-formula>which smoothly declines from 1 at <inline-formula id="IEq551"><alternatives><tex-math id="d33e14879">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y=0$$\end{document}</tex-math><mml:math id="d33e14884"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq551.gif"/></alternatives></inline-formula> to 0 at <inline-formula id="IEq552"><alternatives><tex-math id="d33e14891">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|y| = \delta $$\end{document}</tex-math><mml:math id="d33e14896"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>=</mml:mo><mml:mi>&#x003b4;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq552.gif"/></alternatives></inline-formula>.</p><p id="Par127">Now, for a rectangular habitat <inline-formula id="IEq553"><alternatives><tex-math id="d33e14909">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega = (a_1, b_1) \times \dots \times (a_{\textrm{m}}, b_{\textrm{m}})$$\end{document}</tex-math><mml:math id="d33e14914"><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq553.gif"/></alternatives></inline-formula>, we extend (<xref rid="Equ13" ref-type="disp-formula">9</xref>) as<disp-formula id="Equ37"><label>20</label><alternatives><tex-math id="d33e14951">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \widetilde{\nabla _x\textrm{Q}}(x) := \frac{\Pi }{\Pi + \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}^{\textrm{m}}}} \Bigg ( \nabla _x\textrm{Q}(x)&#x00026;- \sum _{i=1}^{\textrm{m}} \chi _{\delta }(x_i-a_i) \partial ^+_{x_i} \textrm{Q}(x\vert _{a_i}) \hat{e}_i \nonumber \\&#x00026;- \sum _{i=1}^{\textrm{m}} \chi _{\delta }(x_i-b_i) \partial ^-_{x_i} \textrm{Q}(x\vert _{b_i}) \hat{e}_i \Bigg ), \qquad x \in \Omega . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e14957" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>m</mml:mtext></mml:munderover><mml:msub><mml:mi>&#x003c7;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>&#x02202;</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mtext>m</mml:mtext></mml:munderover><mml:msub><mml:mi>&#x003c7;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>&#x02202;</mml:mi><mml:mi>i</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ37.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq554"><alternatives><tex-math id="d33e15135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{e}_i$$\end{document}</tex-math><mml:math id="d33e15140"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq554.gif"/></alternatives></inline-formula> denotes the <italic>i</italic>th standard unit vector in <inline-formula id="IEq555"><alternatives><tex-math id="d33e15153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb {R}^{\textrm{m}}$$\end{document}</tex-math><mml:math id="d33e15158"><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq132.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq556"><alternatives><tex-math id="d33e15166">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x\vert _{c_i}:= (x_1, \dots , c_i, \dots , x_{\textrm{m}}) = x - (x_i - c_i) \hat{e}_i$$\end{document}</tex-math><mml:math id="d33e15171"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mtext>m</mml:mtext></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq556.gif"/></alternatives></inline-formula>. Moreover, <inline-formula id="IEq557"><alternatives><tex-math id="d33e15226">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial ^+_{x_i} \textrm{Q}(z)$$\end{document}</tex-math><mml:math id="d33e15231"><mml:mrow><mml:msubsup><mml:mi>&#x02202;</mml:mi><mml:mi>i</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq557.gif"/></alternatives></inline-formula> and <inline-formula id="IEq558"><alternatives><tex-math id="d33e15248">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial ^-_{x_i} \textrm{Q}(z)$$\end{document}</tex-math><mml:math id="d33e15253"><mml:mrow><mml:msubsup><mml:mi>&#x02202;</mml:mi><mml:mi>i</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq558.gif"/></alternatives></inline-formula> denote, respectively, the right-hand and left-hand partial derivatives of <inline-formula id="IEq559"><alternatives><tex-math id="d33e15270">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e15275"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> with respect to <inline-formula id="IEq560"><alternatives><tex-math id="d33e15279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_i$$\end{document}</tex-math><mml:math id="d33e15284"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq6.gif"/></alternatives></inline-formula> evaluated at a point <italic>z</italic>. The summation terms in (<xref rid="Equ37" ref-type="disp-formula">20</xref>) gradually remove the normal component of <inline-formula id="IEq561"><alternatives><tex-math id="d33e15297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e15302"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq128.gif"/></alternatives></inline-formula> to the boundaries <inline-formula id="IEq562"><alternatives><tex-math id="d33e15311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_i = a_i$$\end{document}</tex-math><mml:math id="d33e15316"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq562.gif"/></alternatives></inline-formula> and <inline-formula id="IEq563"><alternatives><tex-math id="d33e15327">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_i = b_i$$\end{document}</tex-math><mml:math id="d33e15332"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq563.gif"/></alternatives></inline-formula> over a <inline-formula id="IEq564"><alternatives><tex-math id="d33e15343">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta $$\end{document}</tex-math><mml:math id="d33e15348"><mml:mi>&#x003b4;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq155.gif"/></alternatives></inline-formula>-neighborhood of the boundaries, so that <inline-formula id="IEq565"><alternatives><tex-math id="d33e15353">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}(x)$$\end{document}</tex-math><mml:math id="d33e15358"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq157.gif"/></alternatives></inline-formula> eventually becomes completely tangent to the entire boundary of <inline-formula id="IEq566"><alternatives><tex-math id="d33e15377">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega $$\end{document}</tex-math><mml:math id="d33e15382"><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq59.gif"/></alternatives></inline-formula>. The removal of the normal components of the perceived gradient <inline-formula id="IEq567"><alternatives><tex-math id="d33e15387">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}}(x)$$\end{document}</tex-math><mml:math id="d33e15392"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq157.gif"/></alternatives></inline-formula> to habitat boundary automatically results in no phenotype flux through the boundary due to the directed dispersal term (<xref rid="Equ2" ref-type="disp-formula">1b</xref>). Therefore, the no-flux (reflecting) boundary conditions that we discussed in Remark 1 and Appendix A.5 of our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>) can also be applied to the model (<xref rid="Equ14" ref-type="disp-formula">10</xref>)&#x02013;(<xref rid="Equ23" ref-type="disp-formula">12</xref>) we present in this work. If a periodic boundary condition is considered across the <italic>j</italic>th spatial direction, then the terms associated with <inline-formula id="IEq568"><alternatives><tex-math id="d33e15427">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i=j$$\end{document}</tex-math><mml:math id="d33e15432"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq568.gif"/></alternatives></inline-formula> are excluded from the summation terms in (<xref rid="Equ37" ref-type="disp-formula">20</xref>). This is because imposing periodic boundary condition in a spatial direction is equivalent to considering a habitat that is periodically extended in that direction.</p><p id="Par128">For the one-dimensional habitats <inline-formula id="IEq569"><alternatives><tex-math id="d33e15444">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega = (a,b)$$\end{document}</tex-math><mml:math id="d33e15449"><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq193.gif"/></alternatives></inline-formula> used in the results presented in Figs.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref>&#x02013;<xref rid="Fig7" ref-type="fig">7</xref>, the perceived environmental gradient (<xref rid="Equ37" ref-type="disp-formula">20</xref>) can be written as<disp-formula id="Equ38"><label>21</label><alternatives><tex-math id="d33e15472">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \widetilde{\nabla _x\textrm{Q}}(x)&#x00026;:= \frac{\Pi }{\Pi + \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}}} \bigg ( \nabla _x\textrm{Q}(x) - \chi _{\delta }(x-a) \textrm{d}^+_{x} \textrm{Q}(a) - \chi _{\delta }(x-b) \textrm{d}^-_{x} \textrm{Q}(b) \bigg ), \nonumber \\&#x00026;\qquad x \in \Omega . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e15478" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>&#x003c7;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>&#x003c7;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="2em"/><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ38.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq570"><alternatives><tex-math id="d33e15604">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{d}^+_{x}\textrm{Q}(z)$$\end{document}</tex-math><mml:math id="d33e15609"><mml:mrow><mml:msubsup><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq570.gif"/></alternatives></inline-formula> and <inline-formula id="IEq571"><alternatives><tex-math id="d33e15624">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{d}^-_{x}\textrm{Q}(z)$$\end{document}</tex-math><mml:math id="d33e15629"><mml:mrow><mml:msubsup><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi><mml:mo>-</mml:mo></mml:msubsup><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq571.gif"/></alternatives></inline-formula> denote, respectively, the right-hand and left-hand derivatives of <inline-formula id="IEq572"><alternatives><tex-math id="d33e15644">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e15649"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> with respect to <italic>x</italic> evaluated at a point <italic>z</italic>. Note that <inline-formula id="IEq573"><alternatives><tex-math id="d33e15659">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}} = |\textrm{d}_x \textrm{Q}(x)|$$\end{document}</tex-math><mml:math id="d33e15664"><mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mtext>d</mml:mtext><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq573.gif"/></alternatives></inline-formula>.</p><p id="Par129">For the two-dimensional habitat <inline-formula id="IEq574"><alternatives><tex-math id="d33e15701">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega = (a_1,b_1) \times (a_2,b_2)$$\end{document}</tex-math><mml:math id="d33e15706"><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq195.gif"/></alternatives></inline-formula> used in the results presented in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref>, we considered reflecting boundary conditions at <inline-formula id="IEq575"><alternatives><tex-math id="d33e15741">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1 = a_1$$\end{document}</tex-math><mml:math id="d33e15746"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq196.gif"/></alternatives></inline-formula> and <inline-formula id="IEq576"><alternatives><tex-math id="d33e15757">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_1 = b_1$$\end{document}</tex-math><mml:math id="d33e15762"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq197.gif"/></alternatives></inline-formula>, and periodic boundary conditions across the <inline-formula id="IEq577"><alternatives><tex-math id="d33e15773">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_2$$\end{document}</tex-math><mml:math id="d33e15778"><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq198.gif"/></alternatives></inline-formula>-axis. Therefore, the perceived environmental gradient for this problem can be written as<disp-formula id="Equ39"><label>22</label><alternatives><tex-math id="d33e15785">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \widetilde{\nabla _x\textrm{Q}}(x) := \frac{\Pi }{\Pi + \left\| \nabla _x\textrm{Q}(x) \right\| _{\mathbb {R}^2}} \Bigg ( \nabla _x&#x00026;\textrm{Q}(x) - \chi _{\delta }(x_1-a_1) \left[ \begin{array}{c} \partial ^+_{x_1} \textrm{Q}\big ((a_1,x_2)\big )\\ 0 \end{array} \right] \nonumber \\&#x00026;- \chi _{\delta }(x_1-b_1) \left[ \begin{array}{c} \partial ^-_{x_1} \textrm{Q}\big ((b_1,x_2)\big )\\ 0 \end{array} \right] \Bigg ), \qquad x \in \Omega . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e15791" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>&#x003c7;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>&#x02202;</mml:mi><mml:mn>1</mml:mn><mml:mo>+</mml:mo></mml:msubsup><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>&#x003c7;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>&#x02202;</mml:mi><mml:mn>1</mml:mn><mml:mo>-</mml:mo></mml:msubsup><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="2em"/><mml:mi>x</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ39.gif" position="anchor"/></alternatives></disp-formula>In all of the numerical simulations presented in this work, we set the maximum perceived gradient to be <inline-formula id="IEq578"><alternatives><tex-math id="d33e15976">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Pi = 1 \, \texttt{Q}/\texttt{X}$$\end{document}</tex-math><mml:math id="d33e15981"><mml:mrow><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">Q</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq164.gif"/></alternatives></inline-formula>, and we assume the individuals can sense the habitat boundary at a distance smaller than or equal to <inline-formula id="IEq579"><alternatives><tex-math id="d33e15996">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta = 2 \, \texttt{X}$$\end{document}</tex-math><mml:math id="d33e16001"><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.166667em"/><mml:mi mathvariant="monospace">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq163.gif"/></alternatives></inline-formula>.</p></sec></app><app id="App2"><sec id="Sec29"><title>Model Derivation</title><p id="Par130">We use the basic equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>) to derive the equations of our model (<xref rid="Equ14" ref-type="disp-formula">10</xref>)&#x02013;(<xref rid="Equ23" ref-type="disp-formula">12</xref>). As the constructing components of the basic equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>), we use the intrinsic growth rate (<xref rid="Equ8" ref-type="disp-formula">5</xref>), the perceived dispersal force (<xref rid="Equ12" ref-type="disp-formula">8</xref>) which substitutes for <inline-formula id="IEq580"><alternatives><tex-math id="d33e16035">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\nabla _x\theta $$\end{document}</tex-math><mml:math id="d33e16040"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq20.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">1b</xref>), and the rate of mutational changes <inline-formula id="IEq581"><alternatives><tex-math id="d33e16053">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _t^{(\textrm{M})} \phi $$\end{document}</tex-math><mml:math id="d33e16058"><mml:mrow><mml:msubsup><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>M</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>&#x003d5;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq581.gif"/></alternatives></inline-formula> given by Equation (20) in our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>). Our derivation relies on the major assumptions (i)&#x02013;(viii) provided in Sect.&#x000a0;<xref rid="Sec6" ref-type="sec">2.1</xref>.</p><p id="Par131">The basic equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>) that we use to derive the equations of our model differs from the Equation (25) in our previous work (Shirani and Miller <xref ref-type="bibr" rid="CR110">2022</xref>) only in the inclusion of the optimal dispersal term (<xref rid="Equ2" ref-type="disp-formula">1b</xref>). As a result, applying the derivation steps that we perform below to the rest of the terms, (<xref rid="Equ1" ref-type="disp-formula">1a</xref>), (<xref rid="Equ3" ref-type="disp-formula">1c</xref>), and (<xref rid="Equ4" ref-type="disp-formula">1d</xref>), will give the terms (<xref rid="Equ14" ref-type="disp-formula">10a</xref>), (<xref rid="Equ16" ref-type="disp-formula">10c</xref>), (<xref rid="Equ17" ref-type="disp-formula">11a</xref>), (<xref rid="Equ18" ref-type="disp-formula">11b</xref>), (<xref rid="Equ21" ref-type="disp-formula">11e</xref>), (<xref rid="Equ22" ref-type="disp-formula">11f</xref>), (<xref rid="Equ23" ref-type="disp-formula">12a</xref>)&#x02013;(<xref rid="Equ25" ref-type="disp-formula">12c</xref>), and (<xref rid="Equ28" ref-type="disp-formula">12f</xref>), whose derivation can be obtained as a single-species version of our general multi-species model presented in our previous work; see, for example, Equations (12)&#x02013;(14) given in that work for a one-dimensional habitat. Therefore, we exclude the derivation of these terms from our work here, and refer the reader to our previous work for details of those derivations. In the following, we show the derivation of the new terms (<xref rid="Equ15" ref-type="disp-formula">10b</xref>), (<xref rid="Equ19" ref-type="disp-formula">11c</xref>)&#x02013;(<xref rid="Equ21" ref-type="disp-formula">11e</xref>), (<xref rid="Equ26" ref-type="disp-formula">12d</xref>) and (<xref rid="Equ27" ref-type="disp-formula">12e</xref>) that model the effects of optimal dispersal.</p><p id="Par132">We first substitute (<xref rid="Equ12" ref-type="disp-formula">8</xref>) into the basic equation (<xref rid="Equ1" ref-type="disp-formula">1</xref>) to write<disp-formula id="Equ40"><label>23</label><alternatives><tex-math id="d33e16151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n(t+\tau ) \phi (t+\tau ,p) - n(t) \phi (t,p) = - \tau {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t)\phi (t,p) \frac{p - \textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) + \dots , \nonumber \\ \end{aligned}$$\end{document}</tex-math><mml:math id="d33e16157" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ40.gif" position="anchor"/></alternatives></disp-formula>where &#x0201c;<inline-formula id="IEq582"><alternatives><tex-math id="d33e16251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dots $$\end{document}</tex-math><mml:math id="d33e16256"><mml:mo>&#x022ef;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq582.gif"/></alternatives></inline-formula>&#x0201d; denotes the terms we have excluded from our derivation, as stated above. Note that, for simplicity of exposition, in writing (<xref rid="Equ40" ref-type="disp-formula">23</xref>) and the rest of the derivations that follow, we do not explicitly show the dependence of the variables and parameters on <italic>x</italic>.</p><p id="Par133">Now, we integrate both sides of (<xref rid="Equ40" ref-type="disp-formula">23</xref>) with respect to <italic>p</italic> over <inline-formula id="IEq583"><alternatives><tex-math id="d33e16275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb {R}$$\end{document}</tex-math><mml:math id="d33e16280"><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq583.gif"/></alternatives></inline-formula> to obtain<disp-formula id="Equ41"><label>24</label><alternatives><tex-math id="d33e16285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n(t+\tau ) - n(t) = - \tau {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{q(t) - \textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) + \dots . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e16291" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ41.gif" position="anchor"/></alternatives></disp-formula>Dividing both sides of (<xref rid="Equ41" ref-type="disp-formula">24</xref>) by <inline-formula id="IEq584"><alternatives><tex-math id="d33e16362">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau $$\end{document}</tex-math><mml:math id="d33e16367"><mml:mi>&#x003c4;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq584.gif"/></alternatives></inline-formula> and taking the limit as <inline-formula id="IEq585"><alternatives><tex-math id="d33e16371">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \rightarrow 0$$\end{document}</tex-math><mml:math id="d33e16376"><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq17.gif"/></alternatives></inline-formula> yields (<xref rid="Equ14" ref-type="disp-formula">10</xref>).</p><p id="Par134">To derive (<xref rid="Equ17" ref-type="disp-formula">11</xref>), we multiply both sides of (<xref rid="Equ40" ref-type="disp-formula">23</xref>) by <italic>p</italic> and integrate the result with respect to <italic>p</italic> over <inline-formula id="IEq586"><alternatives><tex-math id="d33e16401">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathbb {R}$$\end{document}</tex-math><mml:math id="d33e16406"><mml:mi mathvariant="double-struck">R</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq583.gif"/></alternatives></inline-formula>. Noting that <inline-formula id="IEq587"><alternatives><tex-math id="d33e16412">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\int _{\mathbb {R}} p^2 \phi (t,p) \textrm{d}p = v(t) + q^2(t)$$\end{document}</tex-math><mml:math id="d33e16417"><mml:mrow><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>d</mml:mtext><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq587.gif"/></alternatives></inline-formula>, we obtain<disp-formula id="Equ70"><alternatives><tex-math id="d33e16458">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n(t+\tau ) q(t+\tau ) - n(t) q(t) = - \tau {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{v(t) + q^2(t) - q(t)\textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) + \dots . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e16463" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ70.gif" position="anchor"/></alternatives></disp-formula>which, after dividing by <inline-formula id="IEq588"><alternatives><tex-math id="d33e16564">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau $$\end{document}</tex-math><mml:math id="d33e16569"><mml:mi>&#x003c4;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq584.gif"/></alternatives></inline-formula> and taking the limit as <inline-formula id="IEq589"><alternatives><tex-math id="d33e16573">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \rightarrow 0$$\end{document}</tex-math><mml:math id="d33e16578"><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq17.gif"/></alternatives></inline-formula>, gives<disp-formula id="Equ42"><label>25</label><alternatives><tex-math id="d33e16586">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _t(n(t) q(t))= - {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{v(t) + q^2(t) - q(t)\textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) + \dots . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e16592" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ42.gif" position="anchor"/></alternatives></disp-formula>Now, we use the product rule on the left-hand side of (<xref rid="Equ42" ref-type="disp-formula">25</xref>) and substitute (<xref rid="Equ14" ref-type="disp-formula">10</xref>) into the result to obtain<disp-formula id="Equ43"><label>26</label><alternatives><tex-math id="d33e16687">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _tq(t)= \frac{1}{n(t)}&#x00026;\left[ - {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{v(t) + q^2(t) - q(t)\textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \right. \nonumber \\&#x00026;\quad + q(t) {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{q(t) - \textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \Bigg ] + \dots . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e16693" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mfenced open="["><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mrow><mml:mo maxsize="2.470em" minsize="2.470em" stretchy="true">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ43.gif" position="anchor"/></alternatives></disp-formula>Denoting the first term within the brackets in (<xref rid="Equ43" ref-type="disp-formula">26</xref>) by [(<xref rid="Equ43" ref-type="disp-formula">26</xref>).1st], we can write <disp-formula id="Equ44"><label>27a</label><alternatives><tex-math id="d33e16838">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {[}(26).1\text {st}] :=&#x00026;- {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{v(t) + q^2(t) - q(t)\textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e16844" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>26</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo><mml:mn>1</mml:mn><mml:mtext>st</mml:mtext><mml:mo stretchy="false">]</mml:mo><mml:mo>:</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ44.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ45"><label>27b</label><alternatives><tex-math id="d33e16921">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} =&#x00026;- {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{q(t) \big (q(t)-\textrm{Q}\big )}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) - {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{v(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e16927" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ45.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ46"><label>27c</label><alternatives><tex-math id="d33e17019">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} =&#x00026;- q(t) {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{q(t)-\textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) - \left\langle \nabla _xq(t) \, , \, \textrm{A}\, n(t) \frac{q(t)-\textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right\rangle _{\mathbb {R}^{\textrm{m}}} \nonumber \\&#x00026;- n(t) {{\,\textrm{div}\,}}\left( \textrm{A}\, \frac{v(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) - \left\langle \nabla _xn(t) \, , \, \textrm{A}\, \frac{v(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right\rangle _{\mathbb {R}^{\textrm{m}}}, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e17025" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ46.gif" position="anchor"/></alternatives></disp-formula> where the product rule for divergence of a scalar field times a vector field has been applied to each of the two divergence terms of (<xref rid="Equ45" ref-type="disp-formula">27b</xref>) to obtain (<xref rid="Equ46" ref-type="disp-formula">27c</xref>). For this, <italic>q</italic>(<italic>t</italic>) has been considered as the scalar field in the first divergence term in (<xref rid="Equ45" ref-type="disp-formula">27b</xref>), and <italic>n</italic>(<italic>t</italic>) has been considered as the scalar field in the second divergence term. Now, we substitute the result into (<xref rid="Equ43" ref-type="disp-formula">26</xref>) for the first term within the brackets and obtain (<xref rid="Equ17" ref-type="disp-formula">11</xref>).</p><p id="Par135">Finally, to derive (<xref rid="Equ23" ref-type="disp-formula">12</xref>), we first note that<disp-formula id="Equ47"><label>28</label><alternatives><tex-math id="d33e17248">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} v(t+\tau )= &#x00026;  \int _{\mathbb {R}} (p-q(t+\tau ))^2 \phi (t+\tau ,p) \,\textrm{d}p\nonumber \\= &#x00026;  \int _{\mathbb {R}} p^2 \phi (t+\tau ,p) \, \textrm{d}p - q^2(t+\tau ,p). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e17254" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>d</mml:mtext><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>d</mml:mtext><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ47.gif" position="anchor"/></alternatives></disp-formula>We multiply both sides of (<xref rid="Equ47" ref-type="disp-formula">28</xref>) by <inline-formula id="IEq590"><alternatives><tex-math id="d33e17355">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n(t+\tau )$$\end{document}</tex-math><mml:math id="d33e17360"><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq590.gif"/></alternatives></inline-formula> and use (<xref rid="Equ40" ref-type="disp-formula">23</xref>) to write<disp-formula id="Equ71"><alternatives><tex-math id="d33e17376">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n(t+\tau ) v(t+\tau )&#x00026;= \int _{\mathbb {R}} p^2 n(t+\tau ) \phi (t+\tau ,p) \, \textrm{d}p - n(t+\tau ) q^2(t+\tau ,p)\\&#x00026;= - \tau \int _{\mathbb {R}} p^2 {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t)\phi (t,p) \frac{p - \textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \, \textrm{d}p \\&#x00026;\quad + n(t) \int _{\mathbb {R}} p^2 \phi (t,p) \, \textrm{d}p - n(t+\tau ) q^2(t+\tau ) + \dots \\&#x00026;= - \tau {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \left[ \int _{\mathbb {R}} \frac{p^3 - p \textrm{Q}}{\textrm{V}} \phi (t,p) \, \textrm{d}p \right] \widetilde{\nabla _x\textrm{Q}}\right) \\&#x00026;\quad + n(t) \big ( v(t) + q^2(t) \big ) - n(t+\tau ) q^2(t+\tau ) + \dots \\&#x00026;= - \tau {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{3 v(t) q(t) + q^3(t) - v(t) \textrm{Q}- q^2(t) \textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \\&#x00026;\quad + n(t) v(t) - \left( n(t+\tau ) q^2(t+\tau ) - n(t) q^2(t) \right) + \dots . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e17381" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>d</mml:mtext><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mspace width="0.166667em"/><mml:mtext>d</mml:mtext><mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:msup><mml:mi>p</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>d</mml:mtext><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfenced close="]" open="["><mml:msub><mml:mo>&#x0222b;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mi>&#x003d5;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>d</mml:mtext><mml:mi>p</mml:mi></mml:mfenced><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>Q</mml:mtext><mml:mo>-</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ71.gif" position="anchor"/></alternatives></disp-formula>Next, we subtract <italic>n</italic>(<italic>t</italic>)<italic>v</italic>(<italic>t</italic>) from both sides of the above equation, divide both sides by <inline-formula id="IEq591"><alternatives><tex-math id="d33e17851">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau $$\end{document}</tex-math><mml:math id="d33e17856"><mml:mi>&#x003c4;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq584.gif"/></alternatives></inline-formula>, and take the limit as <inline-formula id="IEq592"><alternatives><tex-math id="d33e17861">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau \rightarrow 0$$\end{document}</tex-math><mml:math id="d33e17866"><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq17.gif"/></alternatives></inline-formula>. We obtain<disp-formula id="Equ48"><label>29</label><alternatives><tex-math id="d33e17874">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \partial _t(n(t)v(t)) =&#x00026;- {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{3 v(t) q(t) - v(t) \textrm{Q}+ q^2(t) (q(t) - \textrm{Q})}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \nonumber \\&#x00026;- \partial _t\left( n(t) q^2(t)\right) + \dots . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e17880" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mn>3</mml:mn><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>Q</mml:mtext><mml:mo>+</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ48.gif" position="anchor"/></alternatives></disp-formula>If we use the product rule to write <inline-formula id="IEq593"><alternatives><tex-math id="d33e18019">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _t(n(t)v(t)) = n(t) \partial _tv(t) + v(t) \partial _tn(t)$$\end{document}</tex-math><mml:math id="d33e18024"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq593.gif"/></alternatives></inline-formula>, wherein <inline-formula id="IEq594"><alternatives><tex-math id="d33e18087">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tn(t)$$\end{document}</tex-math><mml:math id="d33e18092"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq594.gif"/></alternatives></inline-formula> is given by (<xref rid="Equ14" ref-type="disp-formula">10</xref>), and split the divergence term in (<xref rid="Equ48" ref-type="disp-formula">29</xref>) into three terms, we can write <disp-formula id="Equ49"><label>30a</label><alternatives><tex-math id="d33e18113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} n(t) \partial _tv(t) =&#x00026;\, v(t) {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{q(t) - \textrm{Q}}{\textrm{V}} \widetilde{\nabla _x\textrm{Q}} \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e18119" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="0.166667em"/><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ49.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ50"><label>30b</label><alternatives><tex-math id="d33e18188">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;-{{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{2 v(t) q(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e18194" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ50.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ51"><label>30c</label><alternatives><tex-math id="d33e18242">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;-{{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{v(t) (q(t) - \textrm{Q})}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e18248" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ51.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ52"><label>30d</label><alternatives><tex-math id="d33e18302">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;-{{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{ q^2(t) (q(t) - \textrm{Q})}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e18308" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ52.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ53"><label>30e</label><alternatives><tex-math id="d33e18366">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;- \partial _t\left( n(t) q^2(t)\right) + \dots . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e18372" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ53.gif" position="anchor"/></alternatives></disp-formula> Note that, in the derivation of (<xref rid="Equ49" ref-type="disp-formula">30</xref>), the terms involving (<xref rid="Equ14" ref-type="disp-formula">10a</xref>) and (<xref rid="Equ16" ref-type="disp-formula">10c</xref>) are absorbed into the &#x0201c;<inline-formula id="IEq595"><alternatives><tex-math id="d33e18414">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\dots $$\end{document}</tex-math><mml:math id="d33e18419"><mml:mo>&#x022ef;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq582.gif"/></alternatives></inline-formula>&#x0201d; in (<xref rid="Equ53" ref-type="disp-formula">30e</xref>). This is because these terms are not associated with the model of phenotype-optimal dispersal and, as we stated above at the beginning of this section, they are handled in the derivations following the same steps taken in our previous work.</p><p id="Par136">Now, for (<xref rid="Equ50" ref-type="disp-formula">30b</xref>), we use the product rule for divergence of a scalar field times a vector field, with the scalar field <italic>n</italic>(<italic>t</italic>)<italic>q</italic>(<italic>t</italic>), along with the product rule for <inline-formula id="IEq596"><alternatives><tex-math id="d33e18444">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _x\big ( n(t) q(t) \big )$$\end{document}</tex-math><mml:math id="d33e18449"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq596.gif"/></alternatives></inline-formula>, to write<disp-formula id="Equ54"><label>31</label><alternatives><tex-math id="d33e18477">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} (\hbox {30b}) =&#x00026;-2\, n(t) q(t) {{\,\textrm{div}\,}}\left( \textrm{A}\, \frac{v(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) - 2 \left\langle \nabla _x\big (n(t) q(t) \big ) \, , \, \textrm{A}\, \frac{v(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right\rangle _{\mathbb {R}^{\textrm{m}}} \nonumber \\ =&#x00026;-2\, n(t) q(t) {{\,\textrm{div}\,}}\left( \textrm{A}\, \frac{v(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) - 2 \left\langle q(t) \nabla _xn(t) \, , \, \textrm{A}\, \frac{v(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right\rangle _{\mathbb {R}^{\textrm{m}}} \nonumber \\&#x00026;- 2 \left\langle n(t) \nabla _xq(t) \, , \, \textrm{A}\, \frac{v(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right\rangle _{\mathbb {R}^{\textrm{m}}}. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e18483" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>30b</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ54.gif" position="anchor"/></alternatives></disp-formula>Similarly, applying the product rule for the divergence in (<xref rid="Equ52" ref-type="disp-formula">30d</xref>), keeping in mind <inline-formula id="IEq597"><alternatives><tex-math id="d33e18765">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q^2(t)$$\end{document}</tex-math><mml:math id="d33e18770"><mml:mrow><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq597.gif"/></alternatives></inline-formula> as the scalar field, and noting <inline-formula id="IEq598"><alternatives><tex-math id="d33e18783">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xq^2(t) = 2 q(t) \nabla _xq(t)$$\end{document}</tex-math><mml:math id="d33e18788"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq598.gif"/></alternatives></inline-formula>, we have<disp-formula id="Equ55"><label>32</label><alternatives><tex-math id="d33e18825">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} (\hbox {30d})&#x00026;= -q^2(t) {{\,\text {div}\,}}\left( \text {A}\, n(t) \frac{ q(t) - \text {Q}}{\text {V}} \, \widetilde{\nabla _x\text {Q}} \right) \nonumber \\ &#x00026;\quad -2 \left\langle q(t) \nabla _xq(t) \, , \, \text {A}\, n(t) \frac{ q(t) - \text {Q}}{\text {V}} \, \widetilde{\nabla _x\text {Q}} \right\rangle _{\mathbb {R}^{\text {m}}}, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e18831" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>30d</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ55.gif" position="anchor"/></alternatives></disp-formula>For (<xref rid="Equ53" ref-type="disp-formula">30e</xref>), we use (<xref rid="Equ14" ref-type="disp-formula">10</xref>) and (<xref rid="Equ17" ref-type="disp-formula">11</xref>) to write<disp-formula id="Equ56"><label>33</label><alternatives><tex-math id="d33e18970">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} (\hbox {30e})&#x00026;= \, q^2(t) \partial _tn(t) + 2 n(t) q(t) \partial _tq(t) \nonumber \\&#x00026;= \, q^2(t) {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) \frac{ q(t) - \textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) + 2\, n(t) q(t) {{\,\textrm{div}\,}}\left( \textrm{A}\, \frac{ v(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) \nonumber \\&#x00026;\quad + 2 \left\langle q(t) \nabla _xn(t) \, , \, \textrm{A}\, \frac{ v(t)}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right\rangle _{\mathbb {R}^{\textrm{m}}}\nonumber \\&#x00026;\quad + 2 \left\langle q(t) \nabla _xq(t) \, , \, \textrm{A}\, n(t) \frac{ q(t) - \textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right\rangle _{\mathbb {R}^{\textrm{m}}} + \dots . \end{aligned}$$\end{document}</tex-math><mml:math id="d33e18976" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>30e</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mspace width="0.166667em"/><mml:msup><mml:mi>q</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub><mml:mo>+</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ56.gif" position="anchor"/></alternatives></disp-formula>Note that, in writing the first inner product term in (<xref rid="Equ56" ref-type="disp-formula">33</xref>), we used <inline-formula id="IEq599"><alternatives><tex-math id="d33e19265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n(t) \nabla _x\log n(t) = \nabla _xn(t)$$\end{document}</tex-math><mml:math id="d33e19270"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq599.gif"/></alternatives></inline-formula>. Moreover, similar to what we noted above, we have absorbed into the &#x0201c;...&#x0201d; in (<xref rid="Equ56" ref-type="disp-formula">33</xref>) all those terms that do not correspond to the model of phenotype-optimal dispersal in (<xref rid="Equ14" ref-type="disp-formula">10</xref>) and (<xref rid="Equ17" ref-type="disp-formula">11</xref>).</p><p id="Par137">Finally, denoting the right-hand side of (<xref rid="Equ49" ref-type="disp-formula">30a</xref>) by (<xref rid="Equ49" ref-type="disp-formula">30a</xref>).RHS and using the product rule for divergence (with the scalar field <italic>v</italic>(<italic>t</italic>)), we can write<disp-formula id="Equ57"><label>34</label><alternatives><tex-math id="d33e19329">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} (\hbox {30a}).\text {RHS} = {{\,\textrm{div}\,}}\left( \textrm{A}\, n(t) v(t) \frac{ q(t) - \textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right) - \left\langle \nabla _xv(t) \, , \, \textrm{A}\, n(t) \frac{ q(t) - \textrm{Q}}{\textrm{V}} \, \widetilde{\nabla _x\textrm{Q}} \right\rangle _{\mathbb {R}^{\textrm{m}}}. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e19335" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>30a</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mtext>RHS</mml:mtext><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mfenced close=")" open="("><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mspace width="0.166667em"/><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ57.gif" position="anchor"/></alternatives></disp-formula>We then obtain (<xref rid="Equ23" ref-type="disp-formula">12</xref>) by substituting (<xref rid="Equ54" ref-type="disp-formula">31</xref>), (<xref rid="Equ55" ref-type="disp-formula">32</xref>), (<xref rid="Equ56" ref-type="disp-formula">33</xref>), and (<xref rid="Equ57" ref-type="disp-formula">34</xref>) into (<xref rid="Equ49" ref-type="disp-formula">30</xref>) and simplifying the result. This completes the derivation of the model.</p></sec></app><app id="App3"><sec id="Sec30"><title>Equations of Fully-Adapted Equilibrium Population</title><p id="Par138">Here, we show the derivation of the equilibrium equations (<xref rid="Equ32" ref-type="disp-formula">15</xref>) and (<xref rid="Equ33" ref-type="disp-formula">16</xref>) for a one-dimensional geographic space, <inline-formula id="IEq600"><alternatives><tex-math id="d33e19478">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{m}= 1$$\end{document}</tex-math><mml:math id="d33e19483"><mml:mrow><mml:mtext>m</mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq301.gif"/></alternatives></inline-formula>. As noted before, except in the close vicinity of the habitat boundary, the equilibrium population density <inline-formula id="IEq601"><alternatives><tex-math id="d33e19490">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^{*}$$\end{document}</tex-math><mml:math id="d33e19495"><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq372.gif"/></alternatives></inline-formula> and the equilibrium trait variance <inline-formula id="IEq602"><alternatives><tex-math id="d33e19504">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v^{*}$$\end{document}</tex-math><mml:math id="d33e19509"><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq602.gif"/></alternatives></inline-formula> are spatially homogeneous, and the equilibrium trait mean <inline-formula id="IEq603"><alternatives><tex-math id="d33e19519">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q^{*}$$\end{document}</tex-math><mml:math id="d33e19524"><mml:mmultiscripts><mml:mi>q</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq603.gif"/></alternatives></inline-formula> is equal to the trait optimum. Therefore, sufficiently far from the habitat boundary, we have <inline-formula id="IEq604"><alternatives><tex-math id="d33e19533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xn^{*} = 0$$\end{document}</tex-math><mml:math id="d33e19538"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq362.gif"/></alternatives></inline-formula>, <inline-formula id="IEq605"><alternatives><tex-math id="d33e19554">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q^{*} = \textrm{Q}$$\end{document}</tex-math><mml:math id="d33e19559"><mml:mrow><mml:mmultiscripts><mml:mi>q</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq363.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq606"><alternatives><tex-math id="d33e19571">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xv^{*} = 0$$\end{document}</tex-math><mml:math id="d33e19576"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq364.gif"/></alternatives></inline-formula>. Further, <inline-formula id="IEq607"><alternatives><tex-math id="d33e19592">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\textrm{div}\,}}(\nabla _xq^{*}) = {{\,\textrm{div}\,}}(\nabla _x\textrm{Q}) = 0$$\end{document}</tex-math><mml:math id="d33e19597"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>q</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq607.gif"/></alternatives></inline-formula> due to the assumption that <inline-formula id="IEq608"><alternatives><tex-math id="d33e19637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e19642"><mml:mtext>Q</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq57.gif"/></alternatives></inline-formula> is linear.</p><p id="Par139">Now, with <inline-formula id="IEq609"><alternatives><tex-math id="d33e19648">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xn^{*} = 0$$\end{document}</tex-math><mml:math id="d33e19653"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq362.gif"/></alternatives></inline-formula> and <inline-formula id="IEq610"><alternatives><tex-math id="d33e19669">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q^{*} = \textrm{Q}$$\end{document}</tex-math><mml:math id="d33e19674"><mml:mrow><mml:mmultiscripts><mml:mi>q</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq363.gif"/></alternatives></inline-formula>, the equation for the evolution of the population density (<xref rid="Equ14" ref-type="disp-formula">10</xref>) gives the equilibrium equation satisfying <inline-formula id="IEq611"><alternatives><tex-math id="d33e19689">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tn^{*} = 0$$\end{document}</tex-math><mml:math id="d33e19694"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq611.gif"/></alternatives></inline-formula> as,<disp-formula id="Equ72"><alternatives><tex-math id="d33e19709">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 0 = \left( \textrm{R}- \frac{\textrm{R}}{\textrm{K}} \sqrt{\frac{\textrm{V}}{v^{*} + \textrm{V}}} \, n^{*} - \frac{\textrm{S}}{2} v^{*} \right) n^{*}, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e19714" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mtext>R</mml:mtext><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>R</mml:mtext><mml:mtext>K</mml:mtext></mml:mfrac><mml:msqrt><mml:mfrac><mml:mtext>V</mml:mtext><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac></mml:msqrt><mml:mspace width="0.166667em"/><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:mfrac><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mfenced><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ72.gif" position="anchor"/></alternatives></disp-formula>which, noting that <inline-formula id="IEq612"><alternatives><tex-math id="d33e19767">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^{*}&#x0003e;0$$\end{document}</tex-math><mml:math id="d33e19772"><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq360.gif"/></alternatives></inline-formula>, immediately gives (<xref rid="Equ32" ref-type="disp-formula">15</xref>).</p><p id="Par140">Next, to obtain the equilibrium equation for trait variance, satisfying <inline-formula id="IEq613"><alternatives><tex-math id="d33e19789">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\partial _tv^{*} = 0$$\end{document}</tex-math><mml:math id="d33e19794"><mml:mrow><mml:msub><mml:mi>&#x02202;</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq613.gif"/></alternatives></inline-formula>, we use the variance equation (<xref rid="Equ23" ref-type="disp-formula">12</xref>) with <inline-formula id="IEq614"><alternatives><tex-math id="d33e19812">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xn^{*} = 0$$\end{document}</tex-math><mml:math id="d33e19817"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq362.gif"/></alternatives></inline-formula>, <inline-formula id="IEq615"><alternatives><tex-math id="d33e19833">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$q^{*} = \textrm{Q}$$\end{document}</tex-math><mml:math id="d33e19838"><mml:mrow><mml:mmultiscripts><mml:mi>q</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq363.gif"/></alternatives></inline-formula>, <inline-formula id="IEq616"><alternatives><tex-math id="d33e19850">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\nabla _xv^{*} = 0$$\end{document}</tex-math><mml:math id="d33e19855"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq364.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq617"><alternatives><tex-math id="d33e19872">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\textrm{div}\,}}(\nabla _xq^{*}) =0$$\end{document}</tex-math><mml:math id="d33e19877"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mmultiscripts><mml:mi>q</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq617.gif"/></alternatives></inline-formula> to write<disp-formula id="Equ58"><label>35</label><alternatives><tex-math id="d33e19901">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 0= &#x00026;  2 \left\langle \nabla _x\textrm{Q} \, , \, \text {DQ} \right\rangle _{\mathbb {R}} - 2 \left\langle \nabla _x\textrm{Q} \, , \, \textrm{A}\frac{v^{*}}{\textrm{V}} \widetilde{\nabla _x\textrm{Q}} \right\rangle _{\mathbb {R}}\nonumber \\ &#x00026;  + \frac{\textrm{R}}{\textrm{K}} \sqrt{\frac{\textrm{V}}{v^{*} + \textrm{V}}} \, \frac{n^{*} {v^{*}}^2}{2\big ( v^{*} + \textrm{V}\big )} - \textrm{S}{v^{*}}^2 + \textrm{U}. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e19907" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>DQ</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mmultiscripts><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mtext>A</mml:mtext><mml:mfrac><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mtext>V</mml:mtext></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi><mml:mrow/></mml:mmultiscripts></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mtext>R</mml:mtext><mml:mtext>K</mml:mtext></mml:mfrac><mml:msqrt><mml:mfrac><mml:mtext>V</mml:mtext><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac></mml:msqrt><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mmultiscripts></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mtext>S</mml:mtext><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>U</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ58.gif" position="anchor"/></alternatives></disp-formula>Away from the habitat boundary, in <inline-formula id="IEq618"><alternatives><tex-math id="d33e20037">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Omega _{\delta }$$\end{document}</tex-math><mml:math id="d33e20042"><mml:msub><mml:mi mathvariant="normal">&#x003a9;</mml:mi><mml:mi>&#x003b4;</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq153.gif"/></alternatives></inline-formula>, we have <inline-formula id="IEq619"><alternatives><tex-math id="d33e20049">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widetilde{\nabla _x\textrm{Q}} = \Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ) \nabla _x\textrm{Q}$$\end{document}</tex-math><mml:math id="d33e20054"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow><mml:mo stretchy="true">~</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq619.gif"/></alternatives></inline-formula> where <inline-formula id="IEq620"><alternatives><tex-math id="d33e20090">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ):= \frac{\Pi }{\Pi + \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}}$$\end{document}</tex-math><mml:math id="d33e20095"><mml:mrow><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mrow><mml:mi mathvariant="normal">&#x003a0;</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq368.gif"/></alternatives></inline-formula>. Therefore, noting that in a one-dimensional space <inline-formula id="IEq621"><alternatives><tex-math id="d33e20134">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{D}$$\end{document}</tex-math><mml:math id="d33e20139"><mml:mtext>D</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq18.gif"/></alternatives></inline-formula> becomes a scalar, we can rewrite (<xref rid="Equ58" ref-type="disp-formula">35</xref>) as<disp-formula id="Equ59"><label>36</label><alternatives><tex-math id="d33e20147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 0= &#x00026;  2 \textrm{D} \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 - 2 (\textrm{A}/\textrm{V}) \Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ) \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 v^{*} \nonumber \\ &#x00026;  + \frac{\textrm{R}}{\textrm{K}} \sqrt{\frac{\textrm{V}}{v^{*} + \textrm{V}}} \, \frac{n^{*} {v^{*}}^2}{2\big ( v^{*} + \textrm{V}\big )} - \textrm{S}{v^{*}}^2 + \textrm{U}. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e20153" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>2</mml:mn><mml:mtext>D</mml:mtext><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>A</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mtext>R</mml:mtext><mml:mtext>K</mml:mtext></mml:mfrac><mml:msqrt><mml:mfrac><mml:mtext>V</mml:mtext><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac></mml:msqrt><mml:mspace width="0.166667em"/><mml:mfrac><mml:mrow><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mmultiscripts></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mtext>S</mml:mtext><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>U</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ59.gif" position="anchor"/></alternatives></disp-formula>Substituting (<xref rid="Equ32" ref-type="disp-formula">15</xref>) for <inline-formula id="IEq622"><alternatives><tex-math id="d33e20298">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^{*}$$\end{document}</tex-math><mml:math id="d33e20303"><mml:mmultiscripts><mml:mi>n</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq372.gif"/></alternatives></inline-formula> in (<xref rid="Equ59" ref-type="disp-formula">36</xref>) yields<disp-formula id="Equ73"><alternatives><tex-math id="d33e20315">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 0= &#x00026;  2 \textrm{D} \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 - 2 (\textrm{A}/\textrm{V}) \Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ) \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 v^{*} \\ &#x00026;  + \left( \textrm{R}- \frac{\textrm{S}}{2} v ^{*}\right) \frac{{v^{*}}^2}{2\big ( v^{*} + \textrm{V}\big )} - \textrm{S}{v^{*}}^2 + \textrm{U}, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e20320" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>0</mml:mn><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>2</mml:mn><mml:mtext>D</mml:mtext><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>A</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mtext>R</mml:mtext><mml:mo>-</mml:mo><mml:mfrac><mml:mtext>S</mml:mtext><mml:mn>2</mml:mn></mml:mfrac><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mfenced><mml:mfrac><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mtext>S</mml:mtext><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>U</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ73.gif" position="anchor"/></alternatives></disp-formula>which can be written as<disp-formula id="Equ74"><alternatives><tex-math id="d33e20452">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 0&#x00026;= \textrm{U}+ 2 \textrm{D} \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 - 2 (\textrm{A}/\textrm{V}) \Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ) \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 v^{*} \\&#x00026;\quad +\frac{(2\textrm{R}- \textrm{S}v^{*}) {v^{*}}^2 - 4 \textrm{S}{v^{*}}^2 (v^{*} + \textrm{V}) }{4\big ( v^{*} + \textrm{V}\big )}. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e20457" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mtext>U</mml:mtext><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mtext>D</mml:mtext><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>A</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mtext>R</mml:mtext><mml:mo>-</mml:mo><mml:mtext>S</mml:mtext><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mtext>S</mml:mtext><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ74.gif" position="anchor"/></alternatives></disp-formula>Combining the fractions and setting the numerator equal to zero gives,<disp-formula id="Equ75"><alternatives><tex-math id="d33e20606">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 0&#x00026;= 4 \Big (\textrm{U}+ 2 \textrm{D} \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 \Big ) \big ( v^{*} + \textrm{V}\big ) - 8 (\textrm{A}/\textrm{V}) \Upsilon \big ( \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}} \big ) \left\| \nabla _x\textrm{Q} \right\| _{\mathbb {R}}^2 v^{*} \big ( v^{*} + \textrm{V}\big )\\&#x00026;\quad - 5 \textrm{S}{v^{*}}^3 + (2 \textrm{R}- 4 \text {SV}) {v^{*}}^2. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e20611" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mtext>U</mml:mtext><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mtext>D</mml:mtext><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mn>8</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>A</mml:mtext><mml:mo stretchy="false">/</mml:mo><mml:mtext>V</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">&#x003a5;</mml:mi><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:msub><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mi mathvariant="double-struck">R</mml:mi></mml:msub><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:msubsup><mml:mfenced close="&#x02225;" open="&#x02225;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext></mml:mfenced><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mtext>V</mml:mtext><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mn>5</mml:mn><mml:mtext>S</mml:mtext><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>3</mml:mn></mml:mmultiscripts><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mtext>R</mml:mtext><mml:mo>-</mml:mo><mml:mn>4</mml:mn><mml:mtext>SV</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mmultiscripts><mml:mrow><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mmultiscripts><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ75.gif" position="anchor"/></alternatives></disp-formula>Now, simplifying this equation and writing it as a cubic polynomial in <inline-formula id="IEq623"><alternatives><tex-math id="d33e20760">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v^{*}$$\end{document}</tex-math><mml:math id="d33e20765"><mml:mmultiscripts><mml:mi>v</mml:mi><mml:mrow/><mml:mrow><mml:mrow/><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq602.gif"/></alternatives></inline-formula> gives (<xref rid="Equ33" ref-type="disp-formula">16</xref>).</p></sec></app></app-group><fn-group><fn id="Fn1"><label>1</label><p id="Par19">We use the term &#x0201c;intrinsic&#x0201d; growth rate for the logistic growth rate <italic>g</italic>(<italic>x</italic>,&#x000a0;<italic>t</italic>,&#x000a0;<italic>p</italic>), given by (<xref rid="Equ8" ref-type="disp-formula">5</xref>), to distinguish this component of the population&#x02019;s instantaneous growth rate in our model from the other components contributed by dispersal and mutations. This makes our interpretation of the intrinsic growth rate slightly different from an alternative definition that specifies it as the growth rate of the population as its density goes to zero. In our model, this alternative definition is specified as the &#x0201c;maximum&#x0201d; intrinsic growth rate, denoted by the parameter <inline-formula id="IEq11"><alternatives><tex-math id="d33e933">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\textrm{R}$$\end{document}</tex-math><mml:math id="d33e938"><mml:mtext>R</mml:mtext></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq11.gif"/></alternatives></inline-formula> in (<xref rid="Equ8" ref-type="disp-formula">5</xref>).</p></fn><fn id="Fn2"><label>2</label><p id="Par39">We note that <inline-formula id="IEq118"><alternatives><tex-math id="d33e3667">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi _p$$\end{document}</tex-math><mml:math id="d33e3672"><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq90.gif"/></alternatives></inline-formula> itself (instead of its first-order approximation) does not serve as a fully meaningful scalar potential energy function. Setting <inline-formula id="IEq119"><alternatives><tex-math id="d33e3678">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta (x,p) = - \sqrt{2\pi \textrm{V}} \psi _p(\textrm{Q}(x))$$\end{document}</tex-math><mml:math id="d33e3683"><mml:mrow><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mtext>V</mml:mtext></mml:mrow></mml:msqrt><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq119.gif"/></alternatives></inline-formula> would induce a dispersal force <inline-formula id="IEq120"><alternatives><tex-math id="d33e3718">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\nabla _x\theta $$\end{document}</tex-math><mml:math id="d33e3723"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq20.gif"/></alternatives></inline-formula> as<disp-formula id="Equ68"><alternatives><tex-math id="d33e3733">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} -\nabla _x\theta (p,x) = \sqrt{2\pi \text {V}} \nabla _x\psi _p(\text {Q}(x)) = \frac{p - \text {Q}(x)}{\text {V}} \exp \left( - \frac{\big (p - \text {Q}(x)\big )^2}{2 \text {V}} \right) \nabla _x\text {Q}(x). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e3738" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mtext>V</mml:mtext></mml:mrow></mml:msqrt><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:msub><mml:mi>&#x003c8;</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>V</mml:mtext></mml:mfrac><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mtext>V</mml:mtext></mml:mrow></mml:mfrac></mml:mfenced><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mtext>Q</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1445_Article_Equ68.gif" position="anchor"/></alternatives></disp-formula>Therefore, when phenotype-environment mismatch <inline-formula id="IEq121"><alternatives><tex-math id="d33e3835">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|p - \textrm{Q}(x)\big | \rightarrow \infty $$\end{document}</tex-math><mml:math id="d33e3840"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mtext>Q</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mrow><mml:mo maxsize="1.2em" minsize="1.2em" stretchy="true">|</mml:mo></mml:mrow><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>&#x0221e;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq121.gif"/></alternatives></inline-formula>, the dispersal force <inline-formula id="IEq122"><alternatives><tex-math id="d33e3861">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-\nabla _x\theta (p,x) \rightarrow 0$$\end{document}</tex-math><mml:math id="d33e3866"><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq122.gif"/></alternatives></inline-formula>, which does not make sense.</p></fn><fn id="Fn3"><label>3</label><p id="Par40">Note that, as stated in Assumption (vi) and described in Remark <xref ref-type="sec" rid="FPar2">2</xref>, in writing the phenotype utilization distribution (<xref rid="Equ6" ref-type="disp-formula">3</xref>) we assume an identification between the resource axis and the phenotype axis.</p></fn><fn id="Fn4"><label>4</label><p id="Par59">We recall the product rule for divergence of a scalar field times a vector field as <inline-formula id="IEq233"><alternatives><tex-math id="d33e7454">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\,\textrm{div}\,}}(\beta B) = \beta {{\,\textrm{div}\,}}(B) + \left\langle \nabla _x\beta \, , \, B \right\rangle _{\mathbb {R}^{\textrm{m}}}$$\end{document}</tex-math><mml:math id="d33e7459"><mml:mrow><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mfenced close="&#x0232a;" open="&#x02329;"><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mspace width="0.166667em"/><mml:mo>,</mml:mo><mml:mspace width="0.166667em"/><mml:mi>B</mml:mi></mml:mfenced><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mtext>m</mml:mtext></mml:msup></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq233.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq234"><alternatives><tex-math id="d33e7503">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta $$\end{document}</tex-math><mml:math id="d33e7508"><mml:mi>&#x003b2;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq234.gif"/></alternatives></inline-formula> denotes a scalar field and <italic>B</italic> denotes a vector field.</p></fn><fn id="Fn5"><label>5</label><p id="Par61">The Laplacian <inline-formula id="IEq239"><alternatives><tex-math id="d33e7828">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta f(x):= {{\,\textrm{div}\,}}(\nabla _xf(x))$$\end{document}</tex-math><mml:math id="d33e7833"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mspace width="0.166667em"/><mml:mtext>div</mml:mtext><mml:mspace width="0.166667em"/></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi mathvariant="normal">&#x02207;</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq239.gif"/></alternatives></inline-formula> of a function <italic>f</italic> at a point <italic>x</italic> is essentially equal to the average of the differences <inline-formula id="IEq240"><alternatives><tex-math id="d33e7873">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(y) - f(x)$$\end{document}</tex-math><mml:math id="d33e7878"><mml:mrow><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>-</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq240.gif"/></alternatives></inline-formula> when <italic>y</italic> takes all values over a small ball <inline-formula id="IEq241"><alternatives><tex-math id="d33e7899">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {B}(x)$$\end{document}</tex-math><mml:math id="d33e7904"><mml:mrow><mml:mi mathvariant="script">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq241.gif"/></alternatives></inline-formula> centered at <italic>x</italic>. In other words, <inline-formula id="IEq242"><alternatives><tex-math id="d33e7918">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta f(x)$$\end{document}</tex-math><mml:math id="d33e7923"><mml:mrow><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:mi>f</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq242.gif"/></alternatives></inline-formula> essentially gives the amount by which the average value of <italic>f</italic> over <inline-formula id="IEq243"><alternatives><tex-math id="d33e7938">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathcal {B}(x)$$\end{document}</tex-math><mml:math id="d33e7943"><mml:mrow><mml:mi mathvariant="script">B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1445_Article_IEq241.gif"/></alternatives></inline-formula> differs from <italic>f</italic>(<italic>x</italic>).</p></fn><fn><p><bold>Publisher's Note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn><fn><p><bold>Change history</bold></p><p>5/19/2025</p><p id="Par200">ESM file and code of availability have been updated.</p></fn></fn-group><ack><title>Acknowledgements</title><p>The authors would like to thank the anonymous reviewers of this paper for their time, thoughtful comments, and helpful suggestions. The authors would also like to thank Pim Edelaar and Daniel Weissman for their helpful comments and suggestions.</p></ack><notes notes-type="data-availability"><title>Availability of data and materials</title><p>This manuscript has no associated data. The implementation of the numerical simulations in MATLAB R2024b is available on <ext-link ext-link-type="uri" xlink:href="https://github.com/Farshad-Shirani/2025-BMB-FS-JRM">https://github.com/Farshad-Shirani/2025-BMB-FS-JRM</ext-link>.</p></notes><notes><title>Declarations</title><notes id="FPar7" notes-type="COI-statement"><title>Conflict of interest</title><p id="Par124">The authors declare no conflict of interest.</p></notes><notes id="FPar8"><title>Ethics approval</title><p id="Par125">Not applicable.</p></notes></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><citation-alternatives><element-citation id="ec-CR1" publication-type="journal"><person-group person-group-type="author"><name><surname>Angert</surname><given-names>AL</given-names></name><name><surname>Bontrager</surname><given-names>MG</given-names></name><name><surname>&#x000c5;gren</surname><given-names>J</given-names></name></person-group><article-title>What do we really know about adaptation at range edges?</article-title><source>Annu Rev Ecol Evol Syst</source><year>2020</year><volume>51</volume><issue>1</issue><fpage>341</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1146/annurev-ecolsys-012120-091002</pub-id></element-citation><mixed-citation id="mc-CR1" publication-type="journal">Angert AL, Bontrager MG, &#x000c5;gren J (2020) What do we really know about adaptation at range edges? Annu Rev Ecol Evol Syst 51(1):341&#x02013;361. 10.1146/annurev-ecolsys-012120-091002</mixed-citation></citation-alternatives></ref><ref id="CR2"><citation-alternatives><element-citation id="ec-CR2" publication-type="journal"><person-group person-group-type="author"><name><surname>Ackerly</surname><given-names>DD</given-names></name><name><surname>Cornwell</surname><given-names>WK</given-names></name></person-group><article-title>A trait-based approach to community assembly: partitioning of species trait values into within- and among-community components</article-title><source>Ecol Lett</source><year>2007</year><volume>10</volume><issue>2</issue><fpage>135</fpage><lpage>145</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2006.01006.x</pub-id><pub-id pub-id-type="pmid">17257101</pub-id>
</element-citation><mixed-citation id="mc-CR2" publication-type="journal">Ackerly DD, Cornwell WK (2007) A trait-based approach to community assembly: partitioning of species trait values into within- and among-community components. Ecol Lett 10(2):135&#x02013;145. 10.1111/j.1461-0248.2006.01006.x<pub-id pub-id-type="pmid">17257101</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR3"><citation-alternatives><element-citation id="ec-CR3" publication-type="journal"><person-group person-group-type="author"><name><surname>Agrawal</surname><given-names>AA</given-names></name></person-group><article-title>Phenotypic plasticity in the interactions and evolution of species</article-title><source>Science</source><year>2001</year><volume>294</volume><issue>5541</issue><fpage>321</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1126/science.1060701</pub-id><pub-id pub-id-type="pmid">11598291</pub-id>
</element-citation><mixed-citation id="mc-CR3" publication-type="journal">Agrawal AA (2001) Phenotypic plasticity in the interactions and evolution of species. Science 294(5541):321&#x02013;326. 10.1126/science.1060701<pub-id pub-id-type="pmid">11598291</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR4"><citation-alternatives><element-citation id="ec-CR4" publication-type="journal"><person-group person-group-type="author"><name><surname>Armsworth</surname><given-names>PR</given-names></name><name><surname>Roughgarden</surname><given-names>JE</given-names></name></person-group><article-title>The impact of directed versus random movement on population dynamics and biodiversity patterns</article-title><source>Am Nat</source><year>2005</year><volume>165</volume><issue>4</issue><fpage>449</fpage><lpage>465</lpage><pub-id pub-id-type="doi">10.1086/428595</pub-id><pub-id pub-id-type="pmid">15791537</pub-id>
</element-citation><mixed-citation id="mc-CR4" publication-type="journal">Armsworth PR, Roughgarden JE (2005) The impact of directed versus random movement on population dynamics and biodiversity patterns. Am Nat 165(4):449&#x02013;465. 10.1086/428595<pub-id pub-id-type="pmid">15791537</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR5"><citation-alternatives><element-citation id="ec-CR5" publication-type="journal"><person-group person-group-type="author"><name><surname>Armsworth</surname><given-names>PR</given-names></name><name><surname>Roughgarden</surname><given-names>JE</given-names></name></person-group><article-title>The structure of clines with fitness-dependent dispersal</article-title><source>Am Nat</source><year>2008</year><volume>172</volume><issue>5</issue><fpage>648</fpage><lpage>657</lpage><pub-id pub-id-type="doi">10.1086/591685</pub-id><pub-id pub-id-type="pmid">18828744</pub-id>
</element-citation><mixed-citation id="mc-CR5" publication-type="journal">Armsworth PR, Roughgarden JE (2008) The structure of clines with fitness-dependent dispersal. Am Nat 172(5):648&#x02013;657. 10.1086/591685<pub-id pub-id-type="pmid">18828744</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR6"><citation-alternatives><element-citation id="ec-CR6" publication-type="journal"><person-group person-group-type="author"><name><surname>Armsworth</surname><given-names>PR</given-names></name></person-group><article-title>Conditional dispersal, clines, and the evolution of dispersiveness</article-title><source>Thyroid Res</source><year>2009</year><volume>2</volume><issue>2</issue><fpage>105</fpage><lpage>117</lpage><pub-id pub-id-type="doi">10.1007/s12080-008-0032-2</pub-id></element-citation><mixed-citation id="mc-CR6" publication-type="journal">Armsworth PR (2009) Conditional dispersal, clines, and the evolution of dispersiveness. Thyroid Res 2(2):105&#x02013;117. 10.1007/s12080-008-0032-2</mixed-citation></citation-alternatives></ref><ref id="CR7"><citation-alternatives><element-citation id="ec-CR7" publication-type="book"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>N</given-names></name></person-group><person-group person-group-type="editor"><name><surname>Silvertown</surname><given-names>J</given-names></name><name><surname>Antonovics</surname><given-names>J</given-names></name></person-group><article-title>Adaptation at the edge of a species range</article-title><source>Integrating ecology and evolution in a spatial context</source><year>2001</year><publisher-loc>Oxford</publisher-loc><publisher-name>Blackwell</publisher-name><fpage>365</fpage><lpage>392</lpage></element-citation><mixed-citation id="mc-CR7" publication-type="book">Barton N (2001) Adaptation at the edge of a species range. In: Silvertown J, Antonovics J (eds) Integrating ecology and evolution in a spatial context. Blackwell, Oxford, pp 365&#x02013;392</mixed-citation></citation-alternatives></ref><ref id="CR8"><citation-alternatives><element-citation id="ec-CR8" publication-type="journal"><person-group person-group-type="author"><name><surname>Bowler</surname><given-names>DE</given-names></name><name><surname>Benton</surname><given-names>TG</given-names></name></person-group><article-title>Causes and consequences of animal dispersal strategies: relating individual behaviour to spatial dynamics</article-title><source>Biol Rev</source><year>2005</year><volume>80</volume><issue>2</issue><fpage>205</fpage><lpage>225</lpage><pub-id pub-id-type="doi">10.1017/S1464793104006645</pub-id><pub-id pub-id-type="pmid">15921049</pub-id>
</element-citation><mixed-citation id="mc-CR8" publication-type="journal">Bowler DE, Benton TG (2005) Causes and consequences of animal dispersal strategies: relating individual behaviour to spatial dynamics. Biol Rev 80(2):205&#x02013;225. 10.1017/S1464793104006645<pub-id pub-id-type="pmid">15921049</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR9"><citation-alternatives><element-citation id="ec-CR9" publication-type="journal"><person-group person-group-type="author"><name><surname>Baguette</surname><given-names>M</given-names></name><name><surname>Blanchet</surname><given-names>S</given-names></name><name><surname>Legrand</surname><given-names>D</given-names></name><name><surname>Stevens</surname><given-names>VM</given-names></name><name><surname>Turlure</surname><given-names>C</given-names></name></person-group><article-title>Individual dispersal, landscape connectivity and ecological networks</article-title><source>Biol Rev</source><year>2013</year><volume>88</volume><issue>2</issue><fpage>310</fpage><lpage>326</lpage><pub-id pub-id-type="doi">10.1111/brv.12000</pub-id><pub-id pub-id-type="pmid">23176626</pub-id>
</element-citation><mixed-citation id="mc-CR9" publication-type="journal">Baguette M, Blanchet S, Legrand D, Stevens VM, Turlure C (2013) Individual dispersal, landscape connectivity and ecological networks. Biol Rev 88(2):310&#x02013;326. 10.1111/brv.12000<pub-id pub-id-type="pmid">23176626</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR10"><citation-alternatives><element-citation id="ec-CR10" publication-type="journal"><person-group person-group-type="author"><name><surname>Bestion</surname><given-names>E</given-names></name><name><surname>Clobert</surname><given-names>J</given-names></name><name><surname>Cote</surname><given-names>J</given-names></name></person-group><article-title>Dispersal response to climate change: scaling down to intraspecific variation</article-title><source>Ecol Lett</source><year>2015</year><volume>18</volume><issue>11</issue><fpage>1226</fpage><lpage>1233</lpage><pub-id pub-id-type="doi">10.1111/ele.12502</pub-id></element-citation><mixed-citation id="mc-CR10" publication-type="journal">Bestion E, Clobert J, Cote J (2015) Dispersal response to climate change: scaling down to intraspecific variation. Ecol Lett 18(11):1226&#x02013;1233. 10.1111/ele.12502</mixed-citation></citation-alternatives></ref><ref id="CR11"><citation-alternatives><element-citation id="ec-CR11" publication-type="journal"><person-group person-group-type="author"><name><surname>Benning</surname><given-names>JW</given-names></name><name><surname>Clark</surname><given-names>EI</given-names></name><name><surname>Hufbauer</surname><given-names>RA</given-names></name><name><surname>Weiss-Lehman</surname><given-names>C</given-names></name></person-group><article-title>Environmental gradients mediate dispersal evolution during biological invasions</article-title><source>Ecol Lett</source><year>2024</year><volume>27</volume><issue>7</issue><fpage>14472</fpage><pub-id pub-id-type="doi">10.1111/ele.14472</pub-id></element-citation><mixed-citation id="mc-CR11" publication-type="journal">Benning JW, Clark EI, Hufbauer RA, Weiss-Lehman C (2024) Environmental gradients mediate dispersal evolution during biological invasions. Ecol Lett 27(7):14472. 10.1111/ele.14472</mixed-citation></citation-alternatives></ref><ref id="CR12"><citation-alternatives><element-citation id="ec-CR12" publication-type="journal"><person-group person-group-type="author"><name><surname>Benkman</surname><given-names>CW</given-names></name></person-group><article-title>Matching habitat choice in nomadic crossbills appears most pronounced when food is most limiting</article-title><source>Evolution</source><year>2017</year><volume>71</volume><issue>3</issue><fpage>778</fpage><lpage>785</lpage><pub-id pub-id-type="doi">10.1111/evo.13146</pub-id><pub-id pub-id-type="pmid">27925171</pub-id>
</element-citation><mixed-citation id="mc-CR12" publication-type="journal">Benkman CW (2017) Matching habitat choice in nomadic crossbills appears most pronounced when food is most limiting. Evolution 71(3):778&#x02013;785. 10.1111/evo.13146<pub-id pub-id-type="pmid">27925171</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR13"><citation-alternatives><element-citation id="ec-CR13" publication-type="journal"><person-group person-group-type="author"><name><surname>Barton</surname><given-names>NH</given-names></name><name><surname>Etheridge</surname><given-names>AM</given-names></name><name><surname>V&#x000e9;ber</surname><given-names>A</given-names></name></person-group><article-title>The infinitesimal model: definition, derivation, and implications</article-title><source>Theor Popul Biol</source><year>2017</year><volume>118</volume><fpage>50</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1016/j.tpb.2017.06.001</pub-id><pub-id pub-id-type="pmid">28709925</pub-id>
</element-citation><mixed-citation id="mc-CR13" publication-type="journal">Barton NH, Etheridge AM, V&#x000e9;ber A (2017) The infinitesimal model: definition, derivation, and implications. Theor Popul Biol 118:50&#x02013;73. 10.1016/j.tpb.2017.06.001<pub-id pub-id-type="pmid">28709925</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR14"><citation-alternatives><element-citation id="ec-CR14" publication-type="journal"><person-group person-group-type="author"><name><surname>Baines</surname><given-names>CB</given-names></name><name><surname>Ferzoco</surname><given-names>I</given-names></name><name><surname>McCauley</surname><given-names>SJ</given-names></name></person-group><article-title>Phenotype-by-environment interactions influence dispersal</article-title><source>J Anim Ecol</source><year>2019</year><volume>88</volume><issue>8</issue><fpage>1263</fpage><lpage>1274</lpage><pub-id pub-id-type="doi">10.1111/1365-2656.13008</pub-id><pub-id pub-id-type="pmid">31077361</pub-id>
</element-citation><mixed-citation id="mc-CR14" publication-type="journal">Baines CB, Ferzoco I, McCauley SJ (2019) Phenotype-by-environment interactions influence dispersal. J Anim Ecol 88(8):1263&#x02013;1274. 10.1111/1365-2656.13008<pub-id pub-id-type="pmid">31077361</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR15"><citation-alternatives><element-citation id="ec-CR15" publication-type="journal"><person-group person-group-type="author"><name><surname>Bolnick</surname><given-names>DI</given-names></name><name><surname>Otto</surname><given-names>SP</given-names></name></person-group><article-title>The magnitude of local adaptation under genotype-dependent dispersal</article-title><source>Ecol Evol</source><year>2013</year><volume>3</volume><issue>14</issue><fpage>4722</fpage><lpage>4735</lpage><pub-id pub-id-type="doi">10.1002/ece3.850</pub-id><pub-id pub-id-type="pmid">24363900</pub-id>
</element-citation><mixed-citation id="mc-CR15" publication-type="journal">Bolnick DI, Otto SP (2013) The magnitude of local adaptation under genotype-dependent dispersal. Ecol Evol 3(14):4722&#x02013;4735. 10.1002/ece3.850<pub-id pub-id-type="pmid">24363900</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR16"><citation-alternatives><element-citation id="ec-CR16" publication-type="journal"><person-group person-group-type="author"><name><surname>Boyle</surname><given-names>J</given-names></name><name><surname>Start</surname><given-names>D</given-names></name></person-group><article-title>Plasticity and habitat choice match colour to function in an ambush bug</article-title><source>Funct Ecol</source><year>2020</year><volume>34</volume><issue>4</issue><fpage>822</fpage><lpage>829</lpage><pub-id pub-id-type="doi">10.1111/1365-2435.13528</pub-id></element-citation><mixed-citation id="mc-CR16" publication-type="journal">Boyle J, Start D (2020) Plasticity and habitat choice match colour to function in an ambush bug. Funct Ecol 34(4):822&#x02013;829. 10.1111/1365-2435.13528</mixed-citation></citation-alternatives></ref><ref id="CR17"><citation-alternatives><element-citation id="ec-CR17" publication-type="journal"><person-group person-group-type="author"><name><surname>Brown</surname><given-names>JH</given-names></name><name><surname>Stevens</surname><given-names>GC</given-names></name><name><surname>Kaufman</surname><given-names>DM</given-names></name></person-group><article-title>The geographic range: size, shape, boundaries, and internal structure</article-title><source>Annu Rev Ecol Evol Syst</source><year>1996</year><volume>27</volume><fpage>597</fpage><lpage>623</lpage><pub-id pub-id-type="doi">10.1146/annurev.ecolsys.27.1.597</pub-id></element-citation><mixed-citation id="mc-CR17" publication-type="journal">Brown JH, Stevens GC, Kaufman DM (1996) The geographic range: size, shape, boundaries, and internal structure. Annu Rev Ecol Evol Syst 27:597&#x02013;623. 10.1146/annurev.ecolsys.27.1.597</mixed-citation></citation-alternatives></ref><ref id="CR18"><citation-alternatives><element-citation id="ec-CR18" publication-type="journal"><person-group person-group-type="author"><name><surname>Berner</surname><given-names>D</given-names></name><name><surname>Thibert-Plante</surname><given-names>X</given-names></name></person-group><article-title>How mechanisms of habitat preference evolve and promote divergence with gene flow</article-title><source>J Evol Biol</source><year>2015</year><volume>28</volume><issue>9</issue><fpage>1641</fpage><lpage>1655</lpage><pub-id pub-id-type="doi">10.1111/jeb.12683</pub-id><pub-id pub-id-type="pmid">26119841</pub-id>
</element-citation><mixed-citation id="mc-CR18" publication-type="journal">Berner D, Thibert-Plante X (2015) How mechanisms of habitat preference evolve and promote divergence with gene flow. J Evol Biol 28(9):1641&#x02013;1655. 10.1111/jeb.12683<pub-id pub-id-type="pmid">26119841</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR19"><citation-alternatives><element-citation id="ec-CR19" publication-type="journal"><person-group person-group-type="author"><name><surname>Bridle</surname><given-names>JR</given-names></name><name><surname>Vines</surname><given-names>TH</given-names></name></person-group><article-title>Limits to evolution at range margins: When and why does adaptation fail?</article-title><source>Trends Ecol Evol</source><year>2007</year><volume>22</volume><issue>3</issue><fpage>140</fpage><lpage>147</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2006.11.002</pub-id><pub-id pub-id-type="pmid">17113679</pub-id>
</element-citation><mixed-citation id="mc-CR19" publication-type="journal">Bridle JR, Vines TH (2007) Limits to evolution at range margins: When and why does adaptation fail? Trends Ecol Evol 22(3):140&#x02013;147. 10.1016/j.tree.2006.11.002<pub-id pub-id-type="pmid">17113679</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR20"><citation-alternatives><element-citation id="ec-CR20" publication-type="journal"><person-group person-group-type="author"><name><surname>Bonte</surname><given-names>D</given-names></name><name><surname>Van Dyck</surname><given-names>H</given-names></name><name><surname>Bullock</surname><given-names>JM</given-names></name><name><surname>Coulon</surname><given-names>A</given-names></name><name><surname>Delgado</surname><given-names>M</given-names></name><name><surname>Gibbs</surname><given-names>M</given-names></name><name><surname>Lehouck</surname><given-names>V</given-names></name><name><surname>Matthysen</surname><given-names>E</given-names></name><name><surname>Mustin</surname><given-names>K</given-names></name><name><surname>Saastamoinen</surname><given-names>M</given-names></name><name><surname>Schtickzelle</surname><given-names>N</given-names></name><name><surname>Stevens</surname><given-names>VM</given-names></name><name><surname>Vandewoestijne</surname><given-names>S</given-names></name><name><surname>Baguette</surname><given-names>M</given-names></name><name><surname>Barton</surname><given-names>K</given-names></name><name><surname>Benton</surname><given-names>TG</given-names></name><name><surname>Chaput-Bardy</surname><given-names>A</given-names></name><name><surname>Clobert</surname><given-names>J</given-names></name><name><surname>Dytham</surname><given-names>C</given-names></name><name><surname>Hovestadt</surname><given-names>T</given-names></name><name><surname>Meier</surname><given-names>CM</given-names></name><name><surname>Palmer</surname><given-names>S</given-names></name><name><surname>Turlure</surname><given-names>C</given-names></name><name><surname>Travis</surname><given-names>J</given-names></name></person-group><article-title>Costs of dispersal</article-title><source>Biol Rev</source><year>2012</year><volume>87</volume><issue>2</issue><fpage>290</fpage><lpage>312</lpage><pub-id pub-id-type="doi">10.1111/j.1469-185X.2011.00201.x</pub-id><pub-id pub-id-type="pmid">21929715</pub-id>
</element-citation><mixed-citation id="mc-CR20" publication-type="journal">Bonte D, Van Dyck H, Bullock JM, Coulon A, Delgado M, Gibbs M, Lehouck V, Matthysen E, Mustin K, Saastamoinen M, Schtickzelle N, Stevens VM, Vandewoestijne S, Baguette M, Barton K, Benton TG, Chaput-Bardy A, Clobert J, Dytham C, Hovestadt T, Meier CM, Palmer S, Turlure C, Travis J (2012) Costs of dispersal. Biol Rev 87(2):290&#x02013;312. 10.1111/j.1469-185X.2011.00201.x<pub-id pub-id-type="pmid">21929715</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR21"><citation-alternatives><element-citation id="ec-CR21" publication-type="journal"><person-group person-group-type="author"><name><surname>Cote</surname><given-names>J</given-names></name><name><surname>Bestion</surname><given-names>E</given-names></name><name><surname>Jacob</surname><given-names>S</given-names></name><name><surname>Travis</surname><given-names>J</given-names></name><name><surname>Legrand</surname><given-names>D</given-names></name><name><surname>Baguette</surname><given-names>M</given-names></name></person-group><article-title>Evolution of dispersal strategies and dispersal syndromes in fragmented landscapes</article-title><source>Ecography</source><year>2017</year><volume>40</volume><issue>1</issue><fpage>56</fpage><lpage>73</lpage><pub-id pub-id-type="doi">10.1111/ecog.02538</pub-id></element-citation><mixed-citation id="mc-CR21" publication-type="journal">Cote J, Bestion E, Jacob S, Travis J, Legrand D, Baguette M (2017) Evolution of dispersal strategies and dispersal syndromes in fragmented landscapes. Ecography 40(1):56&#x02013;73. 10.1111/ecog.02538</mixed-citation></citation-alternatives></ref><ref id="CR22"><citation-alternatives><element-citation id="ec-CR22" publication-type="journal"><person-group person-group-type="author"><name><surname>Chevin</surname><given-names>L-M</given-names></name><name><surname>Hoffmann</surname><given-names>AA</given-names></name></person-group><article-title>Evolution of phenotypic plasticity in extreme environments</article-title><source>Philos Trans R Soc B Biol Sci</source><year>2017</year><volume>372</volume><issue>1723</issue><fpage>20160138</fpage><pub-id pub-id-type="doi">10.1098/rstb.2016.0138</pub-id></element-citation><mixed-citation id="mc-CR22" publication-type="journal">Chevin L-M, Hoffmann AA (2017) Evolution of phenotypic plasticity in extreme environments. Philos Trans R Soc B Biol Sci 372(1723):20160138. 10.1098/rstb.2016.0138</mixed-citation></citation-alternatives></ref><ref id="CR23"><citation-alternatives><element-citation id="ec-CR23" publication-type="journal"><person-group person-group-type="author"><name><surname>Case</surname><given-names>TJ</given-names></name><name><surname>Holt</surname><given-names>RD</given-names></name><name><surname>McPeek</surname><given-names>MA</given-names></name><name><surname>Keitt</surname><given-names>TH</given-names></name></person-group><article-title>The community context of species&#x02019; borders: ecological and evolutionary perspectives</article-title><source>Oikos</source><year>2005</year><volume>108</volume><issue>1</issue><fpage>28</fpage><lpage>46</lpage><pub-id pub-id-type="doi">10.1111/j.0030-1299.2005.13148.x</pub-id></element-citation><mixed-citation id="mc-CR23" publication-type="journal">Case TJ, Holt RD, McPeek MA, Keitt TH (2005) The community context of species&#x02019; borders: ecological and evolutionary perspectives. Oikos 108(1):28&#x02013;46. 10.1111/j.0030-1299.2005.13148.x</mixed-citation></citation-alternatives></ref><ref id="CR24"><citation-alternatives><element-citation id="ec-CR24" publication-type="journal"><person-group person-group-type="author"><name><surname>Chevin</surname><given-names>L-M</given-names></name><name><surname>Lande</surname><given-names>R</given-names></name></person-group><article-title>Adaptation to marginal habitats by evolution of increased phenotypic plasticity</article-title><source>J Evol Biol</source><year>2011</year><volume>24</volume><issue>7</issue><fpage>1462</fpage><lpage>1476</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2011.02279.x</pub-id><pub-id pub-id-type="pmid">21545421</pub-id>
</element-citation><mixed-citation id="mc-CR24" publication-type="journal">Chevin L-M, Lande R (2011) Adaptation to marginal habitats by evolution of increased phenotypic plasticity. J Evol Biol 24(7):1462&#x02013;1476. 10.1111/j.1420-9101.2011.02279.x<pub-id pub-id-type="pmid">21545421</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR25"><citation-alternatives><element-citation id="ec-CR25" publication-type="journal"><person-group person-group-type="author"><name><surname>Clobert</surname><given-names>J</given-names></name><name><surname>Le Galliard</surname><given-names>J-F</given-names></name><name><surname>Cote</surname><given-names>J</given-names></name><name><surname>Meylan</surname><given-names>S</given-names></name><name><surname>Massot</surname><given-names>M</given-names></name></person-group><article-title>Informed dispersal, heterogeneity in animal dispersal syndromes and the dynamics of spatially structured populations</article-title><source>Ecol Lett</source><year>2009</year><volume>12</volume><issue>3</issue><fpage>197</fpage><lpage>209</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2008.01267.x</pub-id><pub-id pub-id-type="pmid">19170731</pub-id>
</element-citation><mixed-citation id="mc-CR25" publication-type="journal">Clobert J, Le Galliard J-F, Cote J, Meylan S, Massot M (2009) Informed dispersal, heterogeneity in animal dispersal syndromes and the dynamics of spatially structured populations. Ecol Lett 12(3):197&#x02013;209. 10.1111/j.1461-0248.2008.01267.x<pub-id pub-id-type="pmid">19170731</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR26"><citation-alternatives><element-citation id="ec-CR26" publication-type="journal"><person-group person-group-type="author"><name><surname>Chevin</surname><given-names>L-M</given-names></name><name><surname>Lande</surname><given-names>R</given-names></name><name><surname>Mace</surname><given-names>GM</given-names></name></person-group><article-title>Adaptation, plasticity, and extinction in a changing environment: towards a predictive theory</article-title><source>PLoS Biol</source><year>2010</year><volume>8</volume><issue>4</issue><fpage>1000357</fpage><pub-id pub-id-type="doi">10.1371/journal.pbio.1000357</pub-id></element-citation><mixed-citation id="mc-CR26" publication-type="journal">Chevin L-M, Lande R, Mace GM (2010) Adaptation, plasticity, and extinction in a changing environment: towards a predictive theory. PLoS Biol 8(4):1000357. 10.1371/journal.pbio.1000357</mixed-citation></citation-alternatives></ref><ref id="CR27"><citation-alternatives><element-citation id="ec-CR27" publication-type="journal"><person-group person-group-type="author"><name><surname>Coyne</surname><given-names>JA</given-names></name></person-group><article-title>Genetics and speciation</article-title><source>Nature</source><year>1992</year><volume>355</volume><issue>6360</issue><fpage>511</fpage><lpage>515</lpage><pub-id pub-id-type="doi">10.1038/355511a0</pub-id><pub-id pub-id-type="pmid">1741030</pub-id>
</element-citation><mixed-citation id="mc-CR27" publication-type="journal">Coyne JA (1992) Genetics and speciation. Nature 355(6360):511&#x02013;515. 10.1038/355511a0<pub-id pub-id-type="pmid">1741030</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR28"><citation-alternatives><element-citation id="ec-CR28" publication-type="journal"><person-group person-group-type="author"><name><surname>Camacho</surname><given-names>C</given-names></name><name><surname>Sanabria-Fern&#x000e1;ndez</surname><given-names>A</given-names></name><name><surname>Ba&#x000f1;os-Villalba</surname><given-names>A</given-names></name><name><surname>Edelaar</surname><given-names>P</given-names></name></person-group><article-title>Experimental evidence that matching habitat choice drives local adaptation in a wild population</article-title><source>Proc R Soc B Biol Sci</source><year>2020</year><volume>287</volume><issue>1927</issue><fpage>20200721</fpage><pub-id pub-id-type="doi">10.1098/rspb.2020.0721</pub-id></element-citation><mixed-citation id="mc-CR28" publication-type="journal">Camacho C, Sanabria-Fern&#x000e1;ndez A, Ba&#x000f1;os-Villalba A, Edelaar P (2020) Experimental evidence that matching habitat choice drives local adaptation in a wild population. Proc R Soc B Biol Sci 287(1927):20200721. 10.1098/rspb.2020.0721</mixed-citation></citation-alternatives></ref><ref id="CR29"><citation-alternatives><element-citation id="ec-CR29" publication-type="journal"><person-group person-group-type="author"><name><surname>Case</surname><given-names>TJ</given-names></name><name><surname>Taper</surname><given-names>ML</given-names></name></person-group><article-title>Interspecific competition, environmental gradients, gene flow, and the coevolution of species&#x02019; borders</article-title><source>Am Nat</source><year>2000</year><volume>155</volume><issue>5</issue><fpage>583</fpage><lpage>605</lpage><pub-id pub-id-type="doi">10.1086/303351</pub-id><pub-id pub-id-type="pmid">10777432</pub-id>
</element-citation><mixed-citation id="mc-CR29" publication-type="journal">Case TJ, Taper ML (2000) Interspecific competition, environmental gradients, gene flow, and the coevolution of species&#x02019; borders. Am Nat 155(5):583&#x02013;605. 10.1086/303351<pub-id pub-id-type="pmid">10777432</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR30"><citation-alternatives><element-citation id="ec-CR30" publication-type="journal"><person-group person-group-type="author"><name><surname>Dreiss</surname><given-names>AN</given-names></name><name><surname>Antoniazza</surname><given-names>S</given-names></name><name><surname>Burri</surname><given-names>R</given-names></name><name><surname>Fumagalli</surname><given-names>L</given-names></name><name><surname>Sonnay</surname><given-names>C</given-names></name><name><surname>Frey</surname><given-names>C</given-names></name><name><surname>Goudet</surname><given-names>J</given-names></name><name><surname>Roulin</surname><given-names>A</given-names></name></person-group><article-title>Local adaptation and matching habitat choice in female barn owls with respect to melanic coloration</article-title><source>J Evol Biol</source><year>2012</year><volume>25</volume><issue>1</issue><fpage>103</fpage><lpage>114</lpage><pub-id pub-id-type="doi">10.1111/j.1420-9101.2011.02407.x</pub-id><pub-id pub-id-type="pmid">22070193</pub-id>
</element-citation><mixed-citation id="mc-CR30" publication-type="journal">Dreiss AN, Antoniazza S, Burri R, Fumagalli L, Sonnay C, Frey C, Goudet J, Roulin A (2012) Local adaptation and matching habitat choice in female barn owls with respect to melanic coloration. J Evol Biol 25(1):103&#x02013;114. 10.1111/j.1420-9101.2011.02407.x<pub-id pub-id-type="pmid">22070193</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR31"><citation-alternatives><element-citation id="ec-CR31" publication-type="journal"><person-group person-group-type="author"><name><surname>Duckworth</surname><given-names>RA</given-names></name><name><surname>Badyaev</surname><given-names>AV</given-names></name></person-group><article-title>Coupling of dispersal and aggression facilitates the rapid range expansion of a passerine bird</article-title><source>Proc Natl Acad Sci</source><year>2007</year><volume>104</volume><issue>38</issue><fpage>15017</fpage><lpage>15022</lpage><pub-id pub-id-type="doi">10.1073/pnas.0706174104</pub-id><pub-id pub-id-type="pmid">17827278</pub-id>
</element-citation><mixed-citation id="mc-CR31" publication-type="journal">Duckworth RA, Badyaev AV (2007) Coupling of dispersal and aggression facilitates the rapid range expansion of a passerine bird. Proc Natl Acad Sci 104(38):15017&#x02013;15022. 10.1073/pnas.0706174104<pub-id pub-id-type="pmid">17827278</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR32"><citation-alternatives><element-citation id="ec-CR32" publication-type="journal"><person-group person-group-type="author"><name><surname>Dillingham</surname><given-names>PW</given-names></name><name><surname>Moore</surname><given-names>JE</given-names></name><name><surname>Fletcher</surname><given-names>D</given-names></name><name><surname>Cort&#x000e9;s</surname><given-names>E</given-names></name><name><surname>Curtis</surname><given-names>KA</given-names></name><name><surname>James</surname><given-names>KC</given-names></name><name><surname>Lewison</surname><given-names>RL</given-names></name></person-group><article-title>Improved estimation of intrinsic growth rmax for long-lived species: integrating matrix models and allometry</article-title><source>Ecol Appl</source><year>2016</year><volume>26</volume><issue>1</issue><fpage>322</fpage><lpage>333</lpage><pub-id pub-id-type="doi">10.1890/14-1990</pub-id><pub-id pub-id-type="pmid">27039528</pub-id>
</element-citation><mixed-citation id="mc-CR32" publication-type="journal">Dillingham PW, Moore JE, Fletcher D, Cort&#x000e9;s E, Curtis KA, James KC, Lewison RL (2016) Improved estimation of intrinsic growth rmax for long-lived species: integrating matrix models and allometry. Ecol Appl 26(1):322&#x02013;333. 10.1890/14-1990<pub-id pub-id-type="pmid">27039528</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR33"><citation-alternatives><element-citation id="ec-CR33" publication-type="book"><person-group person-group-type="author"><name><surname>DeWitt</surname><given-names>TJ</given-names></name><name><surname>Scheiner</surname><given-names>SM</given-names></name></person-group><source>Phenotypic plasticity: functional and conceptual approaches</source><year>2004</year><publisher-loc>New York</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation><mixed-citation id="mc-CR33" publication-type="book">DeWitt TJ, Scheiner SM (2004) Phenotypic plasticity: functional and conceptual approaches. Oxford University Press, New York</mixed-citation></citation-alternatives></ref><ref id="CR34"><citation-alternatives><element-citation id="ec-CR34" publication-type="journal"><person-group person-group-type="author"><name><surname>DeWitt</surname><given-names>TJ</given-names></name><name><surname>Sih</surname><given-names>A</given-names></name><name><surname>Wilson</surname><given-names>DS</given-names></name></person-group><article-title>Costs and limits of phenotypic plasticity</article-title><source>Trends Ecol Evol</source><year>1998</year><volume>13</volume><issue>2</issue><fpage>77</fpage><lpage>81</lpage><pub-id pub-id-type="doi">10.1016/S0169-5347(97)01274-3</pub-id><pub-id pub-id-type="pmid">21238209</pub-id>
</element-citation><mixed-citation id="mc-CR34" publication-type="journal">DeWitt TJ, Sih A, Wilson DS (1998) Costs and limits of phenotypic plasticity. Trends Ecol Evol 13(2):77&#x02013;81. 10.1016/S0169-5347(97)01274-3<pub-id pub-id-type="pmid">21238209</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR35"><citation-alternatives><element-citation id="ec-CR35" publication-type="journal"><person-group person-group-type="author"><name><surname>Edelaar</surname><given-names>P</given-names></name><name><surname>Bolnick</surname><given-names>DI</given-names></name></person-group><article-title>Non-random gene flow: an underappreciated force in evolution and ecology</article-title><source>Trends Ecol Evol</source><year>2012</year><volume>27</volume><issue>12</issue><fpage>659</fpage><lpage>665</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2012.07.009</pub-id><pub-id pub-id-type="pmid">22884295</pub-id>
</element-citation><mixed-citation id="mc-CR35" publication-type="journal">Edelaar P, Bolnick DI (2012) Non-random gene flow: an underappreciated force in evolution and ecology. Trends Ecol Evol 27(12):659&#x02013;665. 10.1016/j.tree.2012.07.009<pub-id pub-id-type="pmid">22884295</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR36"><citation-alternatives><element-citation id="ec-CR36" publication-type="journal"><person-group person-group-type="author"><name><surname>Edelaar</surname><given-names>P</given-names></name><name><surname>Bolnick</surname><given-names>DI</given-names></name></person-group><article-title>Appreciating the multiple processes increasing individual or population fitness</article-title><source>Trends Ecol Evol</source><year>2019</year><volume>34</volume><issue>5</issue><fpage>435</fpage><lpage>446</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2019.02.001</pub-id><pub-id pub-id-type="pmid">30850175</pub-id>
</element-citation><mixed-citation id="mc-CR36" publication-type="journal">Edelaar P, Bolnick DI (2019) Appreciating the multiple processes increasing individual or population fitness. Trends Ecol Evol 34(5):435&#x02013;446. 10.1016/j.tree.2019.02.001<pub-id pub-id-type="pmid">30850175</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR37"><citation-alternatives><element-citation id="ec-CR37" publication-type="journal"><person-group person-group-type="author"><name><surname>Edelaar</surname><given-names>P</given-names></name><name><surname>Jovani</surname><given-names>R</given-names></name><name><surname>Gomez-Mestre</surname><given-names>I</given-names></name></person-group><article-title>Should I change or should I go? Phenotypic plasticity and matching habitat choice in the adaptation to environmental heterogeneity</article-title><source>Am Nat</source><year>2017</year><volume>190</volume><issue>4</issue><fpage>506</fpage><lpage>520</lpage><pub-id pub-id-type="doi">10.1086/693345</pub-id><pub-id pub-id-type="pmid">28937819</pub-id>
</element-citation><mixed-citation id="mc-CR37" publication-type="journal">Edelaar P, Jovani R, Gomez-Mestre I (2017) Should I change or should I go? Phenotypic plasticity and matching habitat choice in the adaptation to environmental heterogeneity. Am Nat 190(4):506&#x02013;520. 10.1086/693345<pub-id pub-id-type="pmid">28937819</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR38"><citation-alternatives><element-citation id="ec-CR38" publication-type="book"><person-group person-group-type="author"><name><surname>Endler</surname><given-names>JA</given-names></name></person-group><source>Geographic variation, speciation, and clines</source><year>1977</year><publisher-loc>Princeton</publisher-loc><publisher-name>Princeton University Press</publisher-name></element-citation><mixed-citation id="mc-CR38" publication-type="book">Endler JA (1977) Geographic variation, speciation, and clines. Princeton University Press, Princeton</mixed-citation></citation-alternatives></ref><ref id="CR39"><citation-alternatives><element-citation id="ec-CR39" publication-type="journal"><person-group person-group-type="author"><name><surname>Edelaar</surname><given-names>P</given-names></name><name><surname>Otsuka</surname><given-names>J</given-names></name><name><surname>Luque</surname><given-names>VJ</given-names></name></person-group><article-title>A generalised approach to the study and understanding of adaptive evolution</article-title><source>Biol Rev</source><year>2023</year><volume>98</volume><issue>1</issue><fpage>352</fpage><lpage>375</lpage><pub-id pub-id-type="doi">10.1111/brv.12910</pub-id><pub-id pub-id-type="pmid">36223883</pub-id>
</element-citation><mixed-citation id="mc-CR39" publication-type="journal">Edelaar P, Otsuka J, Luque VJ (2023) A generalised approach to the study and understanding of adaptive evolution. Biol Rev 98(1):352&#x02013;375. 10.1111/brv.12910<pub-id pub-id-type="pmid">36223883</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR40"><citation-alternatives><element-citation id="ec-CR40" publication-type="journal"><person-group person-group-type="author"><name><surname>Eriksson</surname><given-names>M</given-names></name><name><surname>Rafajlovi&#x00107;</surname><given-names>M</given-names></name></person-group><article-title>The role of phenotypic plasticity in the establishment of range margins</article-title><source>Philos Trans R Soc B Biol Sci</source><year>2022</year><volume>377</volume><issue>1846</issue><fpage>20210012</fpage><pub-id pub-id-type="doi">10.1098/rstb.2021.0012</pub-id></element-citation><mixed-citation id="mc-CR40" publication-type="journal">Eriksson M, Rafajlovi&#x00107; M (2022) The role of phenotypic plasticity in the establishment of range margins. Philos Trans R Soc B Biol Sci 377(1846):20210012. 10.1098/rstb.2021.0012</mixed-citation></citation-alternatives></ref><ref id="CR41"><citation-alternatives><element-citation id="ec-CR41" publication-type="journal"><person-group person-group-type="author"><name><surname>Edelaar</surname><given-names>P</given-names></name><name><surname>Siepielski</surname><given-names>AM</given-names></name><name><surname>Clobert</surname><given-names>J</given-names></name></person-group><article-title>Matching habitat choice causes directed gene flow: a neglected dimension in evolution and ecology</article-title><source>Evolution</source><year>2008</year><volume>62</volume><issue>10</issue><fpage>2462</fpage><lpage>2472</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.2008.00459.x</pub-id><pub-id pub-id-type="pmid">18637835</pub-id>
</element-citation><mixed-citation id="mc-CR41" publication-type="journal">Edelaar P, Siepielski AM, Clobert J (2008) Matching habitat choice causes directed gene flow: a neglected dimension in evolution and ecology. Evolution 62(10):2462&#x02013;2472. 10.1111/j.1558-5646.2008.00459.x<pub-id pub-id-type="pmid">18637835</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR42"><citation-alternatives><element-citation id="ec-CR42" publication-type="journal"><person-group person-group-type="author"><name><surname>Fronhofer</surname><given-names>EA</given-names></name><name><surname>Altermatt</surname><given-names>F</given-names></name></person-group><article-title>Eco-evolutionary feedbacks during experimental range expansions</article-title><source>Nat Commun</source><year>2015</year><volume>6</volume><issue>1</issue><fpage>6844</fpage><pub-id pub-id-type="doi">10.1038/ncomms7844</pub-id><pub-id pub-id-type="pmid">25902302</pub-id>
</element-citation><mixed-citation id="mc-CR42" publication-type="journal">Fronhofer EA, Altermatt F (2015) Eco-evolutionary feedbacks during experimental range expansions. Nat Commun 6(1):6844. 10.1038/ncomms7844<pub-id pub-id-type="pmid">25902302</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR43"><citation-alternatives><element-citation id="ec-CR43" publication-type="journal"><person-group person-group-type="author"><name><surname>Felsenstein</surname><given-names>J</given-names></name></person-group><article-title>Theoretical population genetics of variable selection and migration</article-title><source>Annu Rev Genet</source><year>1976</year><volume>10</volume><fpage>253</fpage><lpage>280</lpage><pub-id pub-id-type="doi">10.1146/annurev.ge.10.120176.001345</pub-id><pub-id pub-id-type="pmid">797310</pub-id>
</element-citation><mixed-citation id="mc-CR43" publication-type="journal">Felsenstein J (1976) Theoretical population genetics of variable selection and migration. Annu Rev Genet 10:253&#x02013;280. 10.1146/annurev.ge.10.120176.001345<pub-id pub-id-type="pmid">797310</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR44"><citation-alternatives><element-citation id="ec-CR44" publication-type="journal"><person-group person-group-type="author"><name><surname>Forsman</surname><given-names>A</given-names></name></person-group><article-title>Rethinking phenotypic plasticity and its consequences for individuals, populations and species</article-title><source>Heredity</source><year>2015</year><volume>115</volume><issue>4</issue><fpage>276</fpage><lpage>284</lpage><pub-id pub-id-type="doi">10.1038/hdy.2014.92</pub-id><pub-id pub-id-type="pmid">25293873</pub-id>
</element-citation><mixed-citation id="mc-CR44" publication-type="journal">Forsman A (2015) Rethinking phenotypic plasticity and its consequences for individuals, populations and species. Heredity 115(4):276&#x02013;284. 10.1038/hdy.2014.92<pub-id pub-id-type="pmid">25293873</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR45"><citation-alternatives><element-citation id="ec-CR45" publication-type="book"><person-group person-group-type="author"><name><surname>Fretwell</surname><given-names>SD</given-names></name></person-group><source>Populations in a seasonal environment</source><year>1972</year><publisher-loc>Princeton</publisher-loc><publisher-name>Princeton University Press</publisher-name></element-citation><mixed-citation id="mc-CR45" publication-type="book">Fretwell SD (1972) Populations in a seasonal environment. Princeton University Press, Princeton</mixed-citation></citation-alternatives></ref><ref id="CR46"><citation-alternatives><element-citation id="ec-CR46" publication-type="book"><person-group person-group-type="author"><name><surname>Gaston</surname><given-names>KJ</given-names></name><etal/></person-group><source>The structure and dynamics of geographic ranges</source><year>2003</year><publisher-loc>Oxford</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation><mixed-citation id="mc-CR46" publication-type="book">Gaston KJ et al (2003) The structure and dynamics of geographic ranges. Oxford University Press, Oxford</mixed-citation></citation-alternatives></ref><ref id="CR47"><citation-alternatives><element-citation id="ec-CR47" publication-type="journal"><person-group person-group-type="author"><name><surname>Garant</surname><given-names>D</given-names></name><name><surname>Forde</surname><given-names>SE</given-names></name><name><surname>Hendry</surname><given-names>AP</given-names></name></person-group><article-title>The multifarious effects of dispersal and gene flow on contemporary adaptation</article-title><source>Funct Ecol</source><year>2007</year><volume>21</volume><issue>3</issue><fpage>434</fpage><lpage>443</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2435.2006.01228.x</pub-id></element-citation><mixed-citation id="mc-CR47" publication-type="journal">Garant D, Forde SE, Hendry AP (2007) The multifarious effects of dispersal and gene flow on contemporary adaptation. Funct Ecol 21(3):434&#x02013;443. 10.1111/j.1365-2435.2006.01228.x</mixed-citation></citation-alternatives></ref><ref id="CR48"><citation-alternatives><element-citation id="ec-CR48" publication-type="journal"><person-group person-group-type="author"><name><surname>Gomulkiewicz</surname><given-names>R</given-names></name><name><surname>Holt</surname><given-names>RD</given-names></name><name><surname>Barfield</surname><given-names>M</given-names></name></person-group><article-title>The effects of density dependence and immigration on local adaptation and niche evolution in a black-hole sink environment</article-title><source>Theor Popul Biol</source><year>1999</year><volume>55</volume><issue>3</issue><fpage>283</fpage><lpage>296</lpage><pub-id pub-id-type="doi">10.1006/tpbi.1998.1405</pub-id><pub-id pub-id-type="pmid">10366553</pub-id>
</element-citation><mixed-citation id="mc-CR48" publication-type="journal">Gomulkiewicz R, Holt RD, Barfield M (1999) The effects of density dependence and immigration on local adaptation and niche evolution in a black-hole sink environment. Theor Popul Biol 55(3):283&#x02013;296. 10.1006/tpbi.1998.1405<pub-id pub-id-type="pmid">10366553</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR49"><citation-alternatives><element-citation id="ec-CR49" publication-type="journal"><person-group person-group-type="author"><name><surname>Godsoe</surname><given-names>W</given-names></name><name><surname>Holland</surname><given-names>NJ</given-names></name><name><surname>Cosner</surname><given-names>C</given-names></name><name><surname>Kendall</surname><given-names>BE</given-names></name><name><surname>Brett</surname><given-names>A</given-names></name><name><surname>Jankowski</surname><given-names>J</given-names></name><name><surname>Holt</surname><given-names>RD</given-names></name></person-group><article-title>Interspecific interactions and range limits: contrasts among interaction types</article-title><source>Thyroid Res</source><year>2017</year><volume>10</volume><issue>2</issue><fpage>167</fpage><lpage>179</lpage><pub-id pub-id-type="doi">10.1007/s12080-016-0319-7</pub-id></element-citation><mixed-citation id="mc-CR49" publication-type="journal">Godsoe W, Holland NJ, Cosner C, Kendall BE, Brett A, Jankowski J, Holt RD (2017) Interspecific interactions and range limits: contrasts among interaction types. Thyroid Res 10(2):167&#x02013;179. 10.1007/s12080-016-0319-7</mixed-citation></citation-alternatives></ref><ref id="CR50"><citation-alternatives><element-citation id="ec-CR50" publication-type="journal"><person-group person-group-type="author"><name><surname>Garant</surname><given-names>D</given-names></name><name><surname>Kruuk</surname><given-names>L</given-names></name><name><surname>Wilkin</surname><given-names>TA</given-names></name><name><surname>McCleery</surname><given-names>RH</given-names></name><name><surname>Sheldon</surname><given-names>BC</given-names></name></person-group><article-title>Evolution driven by differential dispersal within a wild bird population</article-title><source>Nature</source><year>2005</year><volume>433</volume><issue>7021</issue><fpage>60</fpage><lpage>65</lpage><pub-id pub-id-type="doi">10.1038/nature03051</pub-id><pub-id pub-id-type="pmid">15635409</pub-id>
</element-citation><mixed-citation id="mc-CR50" publication-type="journal">Garant D, Kruuk L, Wilkin TA, McCleery RH, Sheldon BC (2005) Evolution driven by differential dispersal within a wild bird population. Nature 433(7021):60&#x02013;65. 10.1038/nature03051<pub-id pub-id-type="pmid">15635409</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR51"><citation-alternatives><element-citation id="ec-CR51" publication-type="journal"><person-group person-group-type="author"><name><surname>Ghalambor</surname><given-names>CK</given-names></name><name><surname>McKay</surname><given-names>JK</given-names></name><name><surname>Carroll</surname><given-names>SP</given-names></name><name><surname>Reznick</surname><given-names>DN</given-names></name></person-group><article-title>Adaptive versus non-adaptive phenotypic plasticity and the potential for contemporary adaptation in new environments</article-title><source>Funct Ecol</source><year>2007</year><volume>21</volume><issue>3</issue><fpage>394</fpage><lpage>407</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2435.2007.01283.x</pub-id></element-citation><mixed-citation id="mc-CR51" publication-type="journal">Ghalambor CK, McKay JK, Carroll SP, Reznick DN (2007) Adaptive versus non-adaptive phenotypic plasticity and the potential for contemporary adaptation in new environments. Funct Ecol 21(3):394&#x02013;407. 10.1111/j.1365-2435.2007.01283.x</mixed-citation></citation-alternatives></ref><ref id="CR52"><citation-alternatives><element-citation id="ec-CR52" publication-type="journal"><person-group person-group-type="author"><name><surname>Haldane</surname><given-names>J</given-names></name></person-group><article-title>The relation between density regulation and natural selection</article-title><source>Proc R Soc Lond Ser B Biol Sci</source><year>1956</year><volume>145</volume><issue>920</issue><fpage>306</fpage><lpage>308</lpage><pub-id pub-id-type="doi">10.1098/rspb.1956.0039</pub-id><pub-id pub-id-type="pmid">13359386</pub-id>
</element-citation><mixed-citation id="mc-CR52" publication-type="journal">Haldane J (1956) The relation between density regulation and natural selection. Proc R Soc Lond Ser B Biol Sci 145(920):306&#x02013;308. 10.1098/rspb.1956.0039<pub-id pub-id-type="pmid">13359386</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR53"><citation-alternatives><element-citation id="ec-CR53" publication-type="journal"><person-group person-group-type="author"><name><surname>Hoffmann</surname><given-names>AA</given-names></name><name><surname>Blows</surname><given-names>MW</given-names></name></person-group><article-title>Species borders: ecological and evolutionary perspectives</article-title><source>Trends Ecol Evol</source><year>1994</year><volume>9</volume><issue>6</issue><fpage>223</fpage><lpage>227</lpage><pub-id pub-id-type="doi">10.1016/0169-5347(94)90248-8</pub-id><pub-id pub-id-type="pmid">21236827</pub-id>
</element-citation><mixed-citation id="mc-CR53" publication-type="journal">Hoffmann AA, Blows MW (1994) Species borders: ecological and evolutionary perspectives. Trends Ecol Evol 9(6):223&#x02013;227. 10.1016/0169-5347(94)90248-8<pub-id pub-id-type="pmid">21236827</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR54"><citation-alternatives><element-citation id="ec-CR54" publication-type="journal"><person-group person-group-type="author"><name><surname>Haddad</surname><given-names>NM</given-names></name><name><surname>Brudvig</surname><given-names>LA</given-names></name><name><surname>Clobert</surname><given-names>J</given-names></name><name><surname>Davies</surname><given-names>KF</given-names></name><name><surname>Gonzalez</surname><given-names>A</given-names></name><name><surname>Holt</surname><given-names>RD</given-names></name><name><surname>Lovejoy</surname><given-names>TE</given-names></name><name><surname>Sexton</surname><given-names>JO</given-names></name><name><surname>Austin</surname><given-names>MP</given-names></name><name><surname>Collins</surname><given-names>CD</given-names></name><name><surname>Cook</surname><given-names>WM</given-names></name><name><surname>Damschen</surname><given-names>EI</given-names></name><name><surname>Ewers</surname><given-names>RM</given-names></name><name><surname>Foster</surname><given-names>BL</given-names></name><name><surname>Jenkins</surname><given-names>CN</given-names></name><name><surname>King</surname><given-names>AJ</given-names></name><name><surname>Laurance</surname><given-names>WF</given-names></name><name><surname>Levey</surname><given-names>DJ</given-names></name><name><surname>Margules</surname><given-names>CR</given-names></name><name><surname>Melbourne</surname><given-names>BA</given-names></name><name><surname>Nicholls</surname><given-names>AO</given-names></name><name><surname>Orrock</surname><given-names>JL</given-names></name><name><surname>Song</surname><given-names>D-X</given-names></name><name><surname>Townshend</surname><given-names>JR</given-names></name></person-group><article-title>Habitat fragmentation and its lasting impact on earth&#x02019;s ecosystems</article-title><source>Sci Adv</source><year>2015</year><volume>1</volume><issue>2</issue><fpage>1500052</fpage><pub-id pub-id-type="doi">10.1126/sciadv.1500052</pub-id></element-citation><mixed-citation id="mc-CR54" publication-type="journal">Haddad NM, Brudvig LA, Clobert J, Davies KF, Gonzalez A, Holt RD, Lovejoy TE, Sexton JO, Austin MP, Collins CD, Cook WM, Damschen EI, Ewers RM, Foster BL, Jenkins CN, King AJ, Laurance WF, Levey DJ, Margules CR, Melbourne BA, Nicholls AO, Orrock JL, Song D-X, Townshend JR (2015) Habitat fragmentation and its lasting impact on earth&#x02019;s ecosystems. Sci Adv 1(2):1500052. 10.1126/sciadv.1500052</mixed-citation></citation-alternatives></ref><ref id="CR55"><citation-alternatives><element-citation id="ec-CR55" publication-type="journal"><person-group person-group-type="author"><name><surname>Hedrick</surname><given-names>PW</given-names></name></person-group><article-title>Genetic polymorphism in heterogeneous environments: a decade later</article-title><source>Annu Rev Ecol Evol Syst</source><year>1986</year><volume>17</volume><fpage>535</fpage><lpage>566</lpage><pub-id pub-id-type="doi">10.1146/annurev.es.17.110186.002535</pub-id></element-citation><mixed-citation id="mc-CR55" publication-type="journal">Hedrick PW (1986) Genetic polymorphism in heterogeneous environments: a decade later. Annu Rev Ecol Evol Syst 17:535&#x02013;566. 10.1146/annurev.es.17.110186.002535</mixed-citation></citation-alternatives></ref><ref id="CR56"><citation-alternatives><element-citation id="ec-CR56" publication-type="journal"><person-group person-group-type="author"><name><surname>Holt</surname><given-names>RD</given-names></name><name><surname>Gomulkiewicz</surname><given-names>R</given-names></name></person-group><article-title>How does immigration influence local adaptation? A reexamination of a familiar paradigm</article-title><source>Am Nat</source><year>1997</year><volume>149</volume><issue>3</issue><fpage>563</fpage><lpage>572</lpage><pub-id pub-id-type="doi">10.1086/286005</pub-id></element-citation><mixed-citation id="mc-CR56" publication-type="journal">Holt RD, Gomulkiewicz R (1997) How does immigration influence local adaptation? A reexamination of a familiar paradigm. Am Nat 149(3):563&#x02013;572. 10.1086/286005</mixed-citation></citation-alternatives></ref><ref id="CR57"><citation-alternatives><element-citation id="ec-CR57" publication-type="journal"><person-group person-group-type="author"><name><surname>Holt</surname><given-names>RD</given-names></name><name><surname>Keitt</surname><given-names>TH</given-names></name></person-group><article-title>Species&#x02019; borders: a unifying theme in ecology</article-title><source>Oikos</source><year>2005</year><volume>108</volume><issue>1</issue><fpage>3</fpage><lpage>6</lpage><pub-id pub-id-type="doi">10.1111/j.0030-1299.2005.13145.x</pub-id></element-citation><mixed-citation id="mc-CR57" publication-type="journal">Holt RD, Keitt TH (2005) Species&#x02019; borders: a unifying theme in ecology. Oikos 108(1):3&#x02013;6. 10.1111/j.0030-1299.2005.13145.x</mixed-citation></citation-alternatives></ref><ref id="CR58"><citation-alternatives><element-citation id="ec-CR58" publication-type="journal"><person-group person-group-type="author"><name><surname>Holt</surname><given-names>RD</given-names></name></person-group><article-title>Population dynamics in two-patch environments: some anomalous consequences of an optimal habitat distribution</article-title><source>Theor Popul Biol</source><year>1985</year><volume>28</volume><issue>2</issue><fpage>181</fpage><lpage>208</lpage><pub-id pub-id-type="doi">10.1016/0040-5809(85)90027-9</pub-id></element-citation><mixed-citation id="mc-CR58" publication-type="journal">Holt RD (1985) Population dynamics in two-patch environments: some anomalous consequences of an optimal habitat distribution. Theor Popul Biol 28(2):181&#x02013;208. 10.1016/0040-5809(85)90027-9</mixed-citation></citation-alternatives></ref><ref id="CR59"><citation-alternatives><element-citation id="ec-CR59" publication-type="journal"><person-group person-group-type="author"><name><surname>Holt</surname><given-names>RD</given-names></name></person-group><article-title>Population dynamics and evolutionary processes: the manifold roles of habitat selection</article-title><source>Evol Ecol</source><year>1987</year><volume>1</volume><issue>4</issue><fpage>331</fpage><lpage>347</lpage><pub-id pub-id-type="doi">10.1007/BF02071557</pub-id></element-citation><mixed-citation id="mc-CR59" publication-type="journal">Holt RD (1987) Population dynamics and evolutionary processes: the manifold roles of habitat selection. Evol Ecol 1(4):331&#x02013;347. 10.1007/BF02071557</mixed-citation></citation-alternatives></ref><ref id="CR60"><citation-alternatives><element-citation id="ec-CR60" publication-type="journal"><person-group person-group-type="author"><name><surname>Jacob</surname><given-names>S</given-names></name><name><surname>Bestion</surname><given-names>E</given-names></name><name><surname>Legrand</surname><given-names>D</given-names></name><name><surname>Clobert</surname><given-names>J</given-names></name><name><surname>Cote</surname><given-names>J</given-names></name></person-group><article-title>Habitat matching and spatial heterogeneity of phenotypes: implications for metapopulation and metacommunity functioning</article-title><source>Evol Ecol</source><year>2015</year><volume>29</volume><issue>6</issue><fpage>851</fpage><lpage>871</lpage><pub-id pub-id-type="doi">10.1007/s10682-015-9776-5</pub-id></element-citation><mixed-citation id="mc-CR60" publication-type="journal">Jacob S, Bestion E, Legrand D, Clobert J, Cote J (2015) Habitat matching and spatial heterogeneity of phenotypes: implications for metapopulation and metacommunity functioning. Evol Ecol 29(6):851&#x02013;871. 10.1007/s10682-015-9776-5</mixed-citation></citation-alternatives></ref><ref id="CR61"><citation-alternatives><element-citation id="ec-CR61" publication-type="journal"><person-group person-group-type="author"><name><surname>Jaenike</surname><given-names>J</given-names></name><name><surname>Holt</surname><given-names>RD</given-names></name></person-group><article-title>Genetic variation for habitat preference: evidence and explanations</article-title><source>Am Nat</source><year>1991</year><volume>137</volume><fpage>67</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1086/285140</pub-id></element-citation><mixed-citation id="mc-CR61" publication-type="journal">Jaenike J, Holt RD (1991) Genetic variation for habitat preference: evidence and explanations. Am Nat 137:67&#x02013;90. 10.1086/285140</mixed-citation></citation-alternatives></ref><ref id="CR62"><citation-alternatives><element-citation id="ec-CR62" publication-type="journal"><person-group person-group-type="author"><name><surname>Jacob</surname><given-names>S</given-names></name><name><surname>Legrand</surname><given-names>D</given-names></name><name><surname>Chaine</surname><given-names>AS</given-names></name><name><surname>Bonte</surname><given-names>D</given-names></name><name><surname>Schtickzelle</surname><given-names>N</given-names></name><name><surname>Huet</surname><given-names>M</given-names></name><name><surname>Clobert</surname><given-names>J</given-names></name></person-group><article-title>Gene flow favours local adaptation under habitat choice in ciliate microcosms</article-title><source>Nat Ecol Evol</source><year>2017</year><volume>1</volume><issue>9</issue><fpage>1407</fpage><lpage>1410</lpage><pub-id pub-id-type="doi">10.1038/s41559-017-0269-5</pub-id><pub-id pub-id-type="pmid">29046550</pub-id>
</element-citation><mixed-citation id="mc-CR62" publication-type="journal">Jacob S, Legrand D, Chaine AS, Bonte D, Schtickzelle N, Huet M, Clobert J (2017) Gene flow favours local adaptation under habitat choice in ciliate microcosms. Nat Ecol Evol 1(9):1407&#x02013;1410. 10.1038/s41559-017-0269-5<pub-id pub-id-type="pmid">29046550</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR63"><citation-alternatives><element-citation id="ec-CR63" publication-type="journal"><person-group person-group-type="author"><name><surname>Kirkpatrick</surname><given-names>M</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>Evolution of a species&#x02019; range</article-title><source>Am Nat</source><year>1997</year><volume>150</volume><issue>1</issue><fpage>1</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1086/286054</pub-id><pub-id pub-id-type="pmid">18811273</pub-id>
</element-citation><mixed-citation id="mc-CR63" publication-type="journal">Kirkpatrick M, Barton NH (1997) Evolution of a species&#x02019; range. Am Nat 150(1):1&#x02013;23. 10.1086/286054<pub-id pub-id-type="pmid">18811273</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR64"><citation-alternatives><element-citation id="ec-CR64" publication-type="journal"><person-group person-group-type="author"><name><surname>Kottler</surname><given-names>EJ</given-names></name><name><surname>Dickman</surname><given-names>EE</given-names></name><name><surname>Sexton</surname><given-names>JP</given-names></name><name><surname>Emery</surname><given-names>NC</given-names></name><name><surname>Franks</surname><given-names>SJ</given-names></name></person-group><article-title>Draining the swamping hypothesis: little evidence that gene flow reduces fitness at range edges</article-title><source>Trends Ecol Evol</source><year>2021</year><volume>36</volume><issue>6</issue><fpage>533</fpage><lpage>544</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2021.02.004</pub-id><pub-id pub-id-type="pmid">33745756</pub-id>
</element-citation><mixed-citation id="mc-CR64" publication-type="journal">Kottler EJ, Dickman EE, Sexton JP, Emery NC, Franks SJ (2021) Draining the swamping hypothesis: little evidence that gene flow reduces fitness at range edges. Trends Ecol Evol 36(6):533&#x02013;544. 10.1016/j.tree.2021.02.004<pub-id pub-id-type="pmid">33745756</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR65"><citation-alternatives><element-citation id="ec-CR65" publication-type="journal"><person-group person-group-type="author"><name><surname>Kawecki</surname><given-names>TJ</given-names></name><name><surname>Ebert</surname><given-names>D</given-names></name></person-group><article-title>Conceptual issues in local adaptation</article-title><source>Ecol Lett</source><year>2004</year><volume>7</volume><issue>12</issue><fpage>1225</fpage><lpage>1241</lpage><pub-id pub-id-type="doi">10.1111/j.1461-0248.2004.00684.x</pub-id></element-citation><mixed-citation id="mc-CR65" publication-type="journal">Kawecki TJ, Ebert D (2004) Conceptual issues in local adaptation. Ecol Lett 7(12):1225&#x02013;1241. 10.1111/j.1461-0248.2004.00684.x</mixed-citation></citation-alternatives></ref><ref id="CR66"><citation-alternatives><element-citation id="ec-CR66" publication-type="journal"><person-group person-group-type="author"><name><surname>Kingsolver</surname><given-names>JC</given-names></name><name><surname>Hoekstra</surname><given-names>HE</given-names></name><name><surname>Hoekstra</surname><given-names>JM</given-names></name><name><surname>Berrigan</surname><given-names>D</given-names></name><name><surname>Vignieri</surname><given-names>SN</given-names></name><name><surname>Hill</surname><given-names>CE</given-names></name><name><surname>Hoang</surname><given-names>A</given-names></name><name><surname>Gibert</surname><given-names>P</given-names></name><name><surname>Beerli</surname><given-names>P</given-names></name></person-group><article-title>The strength of phenotypic selection in natural populations</article-title><source>Am Nat</source><year>2001</year><volume>157</volume><issue>3</issue><fpage>245</fpage><lpage>261</lpage><pub-id pub-id-type="doi">10.1086/319193</pub-id><pub-id pub-id-type="pmid">18707288</pub-id>
</element-citation><mixed-citation id="mc-CR66" publication-type="journal">Kingsolver JC, Hoekstra HE, Hoekstra JM, Berrigan D, Vignieri SN, Hill CE, Hoang A, Gibert P, Beerli P (2001) The strength of phenotypic selection in natural populations. Am Nat 157(3):245&#x02013;261. 10.1086/319193<pub-id pub-id-type="pmid">18707288</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR67"><citation-alternatives><element-citation id="ec-CR67" publication-type="journal"><person-group person-group-type="author"><name><surname>Keitt</surname><given-names>TH</given-names></name><name><surname>Lewis</surname><given-names>MA</given-names></name><name><surname>Holt</surname><given-names>RD</given-names></name></person-group><article-title>Allee effects, invasion pinning, and species&#x02019; borders</article-title><source>Am Nat</source><year>2001</year><volume>157</volume><issue>2</issue><fpage>203</fpage><lpage>216</lpage><pub-id pub-id-type="doi">10.1086/318633</pub-id><pub-id pub-id-type="pmid">18707272</pub-id>
</element-citation><mixed-citation id="mc-CR67" publication-type="journal">Keitt TH, Lewis MA, Holt RD (2001) Allee effects, invasion pinning, and species&#x02019; borders. Am Nat 157(2):203&#x02013;216. 10.1086/318633<pub-id pub-id-type="pmid">18707272</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR68"><citation-alternatives><element-citation id="ec-CR68" publication-type="journal"><person-group person-group-type="author"><name><surname>Kirkpatrick</surname><given-names>M</given-names></name><name><surname>Ravign&#x000e9;</surname><given-names>V</given-names></name></person-group><article-title>Speciation by natural and sexual selection: models and experiments</article-title><source>Am Nat</source><year>2002</year><volume>159</volume><issue>S3</issue><fpage>22</fpage><lpage>35</lpage><pub-id pub-id-type="doi">10.1086/338370</pub-id></element-citation><mixed-citation id="mc-CR68" publication-type="journal">Kirkpatrick M, Ravign&#x000e9; V (2002) Speciation by natural and sexual selection: models and experiments. Am Nat 159(S3):22&#x02013;35. 10.1086/338370</mixed-citation></citation-alternatives></ref><ref id="CR69"><citation-alternatives><element-citation id="ec-CR69" publication-type="journal"><person-group person-group-type="author"><name><surname>Karpestam</surname><given-names>E</given-names></name><name><surname>Wennersten</surname><given-names>L</given-names></name><name><surname>Forsman</surname><given-names>A</given-names></name></person-group><article-title>Matching habitat choice by experimentally mismatched phenotypes</article-title><source>Evol Ecol</source><year>2012</year><volume>26</volume><issue>4</issue><fpage>893</fpage><lpage>907</lpage><pub-id pub-id-type="doi">10.1007/s10682-011-9530-6</pub-id></element-citation><mixed-citation id="mc-CR69" publication-type="journal">Karpestam E, Wennersten L, Forsman A (2012) Matching habitat choice by experimentally mismatched phenotypes. Evol Ecol 26(4):893&#x02013;907. 10.1007/s10682-011-9530-6</mixed-citation></citation-alternatives></ref><ref id="CR70"><citation-alternatives><element-citation id="ec-CR70" publication-type="journal"><person-group person-group-type="author"><name><surname>Lowe</surname><given-names>WH</given-names></name><name><surname>Addis</surname><given-names>BR</given-names></name></person-group><article-title>Matching habitat choice and plasticity contribute to phenotype-environment covariation in a stream salamander</article-title><source>Ecology</source><year>2019</year><volume>100</volume><issue>5</issue><fpage>02661</fpage><pub-id pub-id-type="doi">10.1002/ecy.2661</pub-id></element-citation><mixed-citation id="mc-CR70" publication-type="journal">Lowe WH, Addis BR (2019) Matching habitat choice and plasticity contribute to phenotype-environment covariation in a stream salamander. Ecology 100(5):02661. 10.1002/ecy.2661</mixed-citation></citation-alternatives></ref><ref id="CR71"><citation-alternatives><element-citation id="ec-CR71" publication-type="journal"><person-group person-group-type="author"><name><surname>Louthan</surname><given-names>AM</given-names></name><name><surname>Doak</surname><given-names>DF</given-names></name><name><surname>Angert</surname><given-names>AL</given-names></name></person-group><article-title>Where and when do species interactions set range limits?</article-title><source>Trends Ecol Evol</source><year>2015</year><volume>30</volume><issue>12</issue><fpage>780</fpage><lpage>792</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2015.09.011</pub-id><pub-id pub-id-type="pmid">26525430</pub-id>
</element-citation><mixed-citation id="mc-CR71" publication-type="journal">Louthan AM, Doak DF, Angert AL (2015) Where and when do species interactions set range limits? Trends Ecol Evol 30(12):780&#x02013;792. 10.1016/j.tree.2015.09.011<pub-id pub-id-type="pmid">26525430</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR72"><citation-alternatives><element-citation id="ec-CR72" publication-type="journal"><person-group person-group-type="author"><name><surname>Lenormand</surname><given-names>T</given-names></name></person-group><article-title>Gene flow and the limits to natural selection</article-title><source>Trends Ecol Evol</source><year>2002</year><volume>17</volume><issue>4</issue><fpage>183</fpage><lpage>189</lpage><pub-id pub-id-type="doi">10.1016/S0169-5347(02)02497-7</pub-id></element-citation><mixed-citation id="mc-CR72" publication-type="journal">Lenormand T (2002) Gene flow and the limits to natural selection. Trends Ecol Evol 17(4):183&#x02013;189. 10.1016/S0169-5347(02)02497-7</mixed-citation></citation-alternatives></ref><ref id="CR73"><citation-alternatives><element-citation id="ec-CR73" publication-type="journal"><person-group person-group-type="author"><name><surname>Levins</surname><given-names>R</given-names></name></person-group><article-title>Theory of fitness in a heterogeneous environment. II. Developmental flexibility and niche selection</article-title><source>Am Nat</source><year>1963</year><volume>97</volume><issue>893</issue><fpage>75</fpage><lpage>90</lpage><pub-id pub-id-type="doi">10.1086/282258</pub-id></element-citation><mixed-citation id="mc-CR73" publication-type="journal">Levins R (1963) Theory of fitness in a heterogeneous environment. II. Developmental flexibility and niche selection. Am Nat 97(893):75&#x02013;90. 10.1086/282258</mixed-citation></citation-alternatives></ref><ref id="CR74"><citation-alternatives><element-citation id="ec-CR74" publication-type="journal"><person-group person-group-type="author"><name><surname>Lowe</surname><given-names>WH</given-names></name><name><surname>McPeek</surname><given-names>MA</given-names></name></person-group><article-title>Is dispersal neutral?</article-title><source>Trends Ecol Evol</source><year>2014</year><volume>29</volume><issue>8</issue><fpage>444</fpage><lpage>450</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2014.05.009</pub-id><pub-id pub-id-type="pmid">24962790</pub-id>
</element-citation><mixed-citation id="mc-CR74" publication-type="journal">Lowe WH, McPeek MA (2014) Is dispersal neutral? Trends Ecol Evol 29(8):444&#x02013;450. 10.1016/j.tree.2014.05.009<pub-id pub-id-type="pmid">24962790</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR75"><citation-alternatives><element-citation id="ec-CR75" publication-type="journal"><person-group person-group-type="author"><name><surname>Lustenhouwer</surname><given-names>N</given-names></name><name><surname>Moerman</surname><given-names>F</given-names></name><name><surname>Altermatt</surname><given-names>F</given-names></name><name><surname>Bassar</surname><given-names>RD</given-names></name><name><surname>Bocedi</surname><given-names>G</given-names></name><name><surname>Bonte</surname><given-names>D</given-names></name><name><surname>Dey</surname><given-names>S</given-names></name><name><surname>Fronhofer</surname><given-names>EA</given-names></name><name><surname>Rocha</surname><given-names>EG</given-names></name><name><surname>Giometto</surname><given-names>A</given-names></name><name><surname>Lancaster</surname><given-names>LT</given-names></name><name><surname>Prather</surname><given-names>RB</given-names><suffix>Jr</suffix></name><name><surname>Saastamoinen</surname><given-names>M</given-names></name><name><surname>Travis</surname><given-names>J</given-names></name><name><surname>Urquhart</surname><given-names>CA</given-names></name><name><surname>Weiss-Lehman</surname><given-names>C</given-names></name><name><surname>Williams</surname><given-names>JL</given-names></name><name><surname>B&#x000f6;rger</surname><given-names>L</given-names></name><name><surname>Berger</surname><given-names>D</given-names></name></person-group><article-title>Experimental evolution of dispersal: unifying theory, experiments and natural systems</article-title><source>J Anim Ecol</source><year>2023</year><volume>92</volume><issue>6</issue><fpage>1113</fpage><lpage>1123</lpage><pub-id pub-id-type="doi">10.1111/1365-2656.13930</pub-id><pub-id pub-id-type="pmid">37087688</pub-id>
</element-citation><mixed-citation id="mc-CR75" publication-type="journal">Lustenhouwer N, Moerman F, Altermatt F, Bassar RD, Bocedi G, Bonte D, Dey S, Fronhofer EA, Rocha EG, Giometto A, Lancaster LT, Prather RB Jr, Saastamoinen M, Travis J, Urquhart CA, Weiss-Lehman C, Williams JL, B&#x000f6;rger L, Berger D (2023) Experimental evolution of dispersal: unifying theory, experiments and natural systems. J Anim Ecol 92(6):1113&#x02013;1123. 10.1111/1365-2656.13930<pub-id pub-id-type="pmid">37087688</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR76"><citation-alternatives><element-citation id="ec-CR76" publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>T</given-names></name><name><surname>Angert</surname><given-names>AL</given-names></name><name><surname>Brown</surname><given-names>CD</given-names></name><name><surname>Lee-Yaw</surname><given-names>JA</given-names></name><name><surname>Lewis</surname><given-names>M</given-names></name><name><surname>Lutscher</surname><given-names>F</given-names></name><name><surname>Marculis</surname><given-names>NG</given-names></name><name><surname>Melbourne</surname><given-names>BA</given-names></name><name><surname>Shaw</surname><given-names>AK</given-names></name><name><surname>Sz&#x00171;cs</surname><given-names>M</given-names></name><name><surname>Tabares</surname><given-names>O</given-names></name><name><surname>Usui</surname><given-names>T</given-names></name><name><surname>Weiss-Lehman</surname><given-names>C</given-names></name><name><surname>Williams</surname><given-names>JL</given-names></name></person-group><article-title>Eco-evolutionary dynamics of range expansion</article-title><source>Ecology</source><year>2020</year><volume>101</volume><issue>10</issue><fpage>03139</fpage><pub-id pub-id-type="doi">10.1002/ecy.3139</pub-id></element-citation><mixed-citation id="mc-CR76" publication-type="journal">Miller T, Angert AL, Brown CD, Lee-Yaw JA, Lewis M, Lutscher F, Marculis NG, Melbourne BA, Shaw AK, Sz&#x00171;cs M, Tabares O, Usui T, Weiss-Lehman C, Williams JL (2020) Eco-evolutionary dynamics of range expansion. Ecology 101(10):03139. 10.1002/ecy.3139</mixed-citation></citation-alternatives></ref><ref id="CR77"><citation-alternatives><element-citation id="ec-CR77" publication-type="book"><person-group person-group-type="author"><name><surname>MacArthur</surname><given-names>RH</given-names></name></person-group><source>Geographical ecology</source><year>1972</year><publisher-loc>New York</publisher-loc><publisher-name>Harper &#x00026; Row</publisher-name></element-citation><mixed-citation id="mc-CR77" publication-type="book">MacArthur RH (1972) Geographical ecology. Harper &#x00026; Row, New York</mixed-citation></citation-alternatives></ref><ref id="CR78"><citation-alternatives><element-citation id="ec-CR78" publication-type="journal"><person-group person-group-type="author"><name><surname>Murren</surname><given-names>CJ</given-names></name><name><surname>Auld</surname><given-names>JR</given-names></name><name><surname>Callahan</surname><given-names>H</given-names></name><name><surname>Ghalambor</surname><given-names>CK</given-names></name><name><surname>Handelsman</surname><given-names>CA</given-names></name><name><surname>Heskel</surname><given-names>MA</given-names></name><name><surname>Kingsolver</surname><given-names>JG</given-names></name><name><surname>Maclean</surname><given-names>HJ</given-names></name><name><surname>Masel</surname><given-names>J</given-names></name><name><surname>Maughan</surname><given-names>H</given-names></name><name><surname>Pfennig</surname><given-names>DW</given-names></name><name><surname>Relyea</surname><given-names>RA</given-names></name><name><surname>Seiter</surname><given-names>S</given-names></name><name><surname>Snell-Rood</surname><given-names>E</given-names></name><name><surname>Steiner</surname><given-names>UK</given-names></name><name><surname>Schlichting</surname><given-names>CD</given-names></name></person-group><article-title>Constraints on the evolution of phenotypic plasticity: limits and costs of phenotype and plasticity</article-title><source>Heredity</source><year>2015</year><volume>115</volume><issue>4</issue><fpage>293</fpage><lpage>301</lpage><pub-id pub-id-type="doi">10.1038/hdy.2015.8</pub-id><pub-id pub-id-type="pmid">25690179</pub-id>
</element-citation><mixed-citation id="mc-CR78" publication-type="journal">Murren CJ, Auld JR, Callahan H, Ghalambor CK, Handelsman CA, Heskel MA, Kingsolver JG, Maclean HJ, Masel J, Maughan H, Pfennig DW, Relyea RA, Seiter S, Snell-Rood E, Steiner UK, Schlichting CD (2015) Constraints on the evolution of phenotypic plasticity: limits and costs of phenotype and plasticity. Heredity 115(4):293&#x02013;301. 10.1038/hdy.2015.8<pub-id pub-id-type="pmid">25690179</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR79"><citation-alternatives><element-citation id="ec-CR79" publication-type="book"><person-group person-group-type="author"><name><surname>Mayr</surname><given-names>E</given-names></name></person-group><source>Animal species and evolution</source><year>1963</year><publisher-loc>Cambridge</publisher-loc><publisher-name>Harvard University Press</publisher-name></element-citation><mixed-citation id="mc-CR79" publication-type="book">Mayr E (1963) Animal species and evolution. Harvard University Press, Cambridge</mixed-citation></citation-alternatives></ref><ref id="CR80"><citation-alternatives><element-citation id="ec-CR80" publication-type="journal"><person-group person-group-type="author"><name><surname>Maynard Smith</surname><given-names>J</given-names></name></person-group><article-title>Sympatric speciation</article-title><source>Am Nat</source><year>1966</year><volume>100</volume><issue>916</issue><fpage>637</fpage><lpage>650</lpage><pub-id pub-id-type="doi">10.1086/282457</pub-id></element-citation><mixed-citation id="mc-CR80" publication-type="journal">Maynard Smith J (1966) Sympatric speciation. Am Nat 100(916):637&#x02013;650. 10.1086/282457</mixed-citation></citation-alternatives></ref><ref id="CR81"><citation-alternatives><element-citation id="ec-CR81" publication-type="journal"><person-group person-group-type="author"><name><surname>Nicolaus</surname><given-names>M</given-names></name><name><surname>Edelaar</surname><given-names>P</given-names></name></person-group><article-title>Comparing the consequences of natural selection, adaptive phenotypic plasticity, and matching habitat choice for phenotype-environment matching, population genetic structure, and reproductive isolation in meta-populations</article-title><source>Ecol Evol</source><year>2018</year><volume>8</volume><issue>8</issue><fpage>3815</fpage><lpage>3827</lpage><pub-id pub-id-type="doi">10.1002/ece3.3816</pub-id><pub-id pub-id-type="pmid">29721259</pub-id>
</element-citation><mixed-citation id="mc-CR81" publication-type="journal">Nicolaus M, Edelaar P (2018) Comparing the consequences of natural selection, adaptive phenotypic plasticity, and matching habitat choice for phenotype-environment matching, population genetic structure, and reproductive isolation in meta-populations. Ecol Evol 8(8):3815&#x02013;3827. 10.1002/ece3.3816<pub-id pub-id-type="pmid">29721259</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR82"><citation-alternatives><element-citation id="ec-CR82" publication-type="journal"><person-group person-group-type="author"><name><surname>Niel</surname><given-names>C</given-names></name><name><surname>Lebreton</surname><given-names>J</given-names></name></person-group><article-title>Using demographic invariants to detect overharvested bird populations from incomplete data</article-title><source>Conserv Biol</source><year>2005</year><volume>19</volume><issue>3</issue><fpage>826</fpage><lpage>835</lpage><pub-id pub-id-type="doi">10.1111/j.1523-1739.2005.00310.x</pub-id></element-citation><mixed-citation id="mc-CR82" publication-type="journal">Niel C, Lebreton J (2005) Using demographic invariants to detect overharvested bird populations from incomplete data. Conserv Biol 19(3):826&#x02013;835. 10.1111/j.1523-1739.2005.00310.x</mixed-citation></citation-alternatives></ref><ref id="CR83"><citation-alternatives><element-citation id="ec-CR83" publication-type="book"><person-group person-group-type="author"><name><surname>Okubo</surname><given-names>A</given-names></name><name><surname>Levin</surname><given-names>SA</given-names></name></person-group><source>Diffusion and ecological problems: modern perspectives</source><year>2001</year><publisher-loc>New York</publisher-loc><publisher-name>Springer</publisher-name></element-citation><mixed-citation id="mc-CR83" publication-type="book">Okubo A, Levin SA (2001) Diffusion and ecological problems: modern perspectives. Springer, New York</mixed-citation></citation-alternatives></ref><ref id="CR84"><citation-alternatives><element-citation id="ec-CR84" publication-type="journal"><person-group person-group-type="author"><name><surname>Polechov&#x000e1;</surname><given-names>J</given-names></name><name><surname>Barton</surname><given-names>NH</given-names></name></person-group><article-title>Speciation through competition: a critical review</article-title><source>Evolution</source><year>2005</year><volume>59</volume><issue>6</issue><fpage>1194</fpage><lpage>1210</lpage><pub-id pub-id-type="doi">10.1111/j.0014-3820.2005.tb01771.x</pub-id><pub-id pub-id-type="pmid">16050097</pub-id>
</element-citation><mixed-citation id="mc-CR84" publication-type="journal">Polechov&#x000e1; J, Barton NH (2005) Speciation through competition: a critical review. Evolution 59(6):1194&#x02013;1210. 10.1111/j.0014-3820.2005.tb01771.x<pub-id pub-id-type="pmid">16050097</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR85"><citation-alternatives><element-citation id="ec-CR85" publication-type="journal"><person-group person-group-type="author"><name><surname>Pellerin</surname><given-names>F</given-names></name><name><surname>Cote</surname><given-names>J</given-names></name><name><surname>Bestion</surname><given-names>E</given-names></name><name><surname>Aguil&#x000e9;e</surname><given-names>R</given-names></name></person-group><article-title>Matching habitat choice promotes species persistence under climate change</article-title><source>Oikos</source><year>2019</year><volume>128</volume><issue>2</issue><fpage>221</fpage><lpage>234</lpage><pub-id pub-id-type="doi">10.1111/oik.05309</pub-id></element-citation><mixed-citation id="mc-CR85" publication-type="journal">Pellerin F, Cote J, Bestion E, Aguil&#x000e9;e R (2019) Matching habitat choice promotes species persistence under climate change. Oikos 128(2):221&#x02013;234. 10.1111/oik.05309</mixed-citation></citation-alternatives></ref><ref id="CR86"><citation-alternatives><element-citation id="ec-CR86" publication-type="journal"><person-group person-group-type="author"><name><surname>Pigliucci</surname><given-names>M</given-names></name></person-group><article-title>Evolution of phenotypic plasticity: Where are we going now?</article-title><source>Trends Ecol Evol</source><year>2005</year><volume>20</volume><issue>9</issue><fpage>481</fpage><lpage>486</lpage><pub-id pub-id-type="doi">10.1016/j.tree.2005.06.001</pub-id><pub-id pub-id-type="pmid">16701424</pub-id>
</element-citation><mixed-citation id="mc-CR86" publication-type="journal">Pigliucci M (2005) Evolution of phenotypic plasticity: Where are we going now? Trends Ecol Evol 20(9):481&#x02013;486. 10.1016/j.tree.2005.06.001<pub-id pub-id-type="pmid">16701424</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR87"><citation-alternatives><element-citation id="ec-CR87" publication-type="journal"><person-group person-group-type="author"><name><surname>Pease</surname><given-names>CM</given-names></name><name><surname>Lande</surname><given-names>R</given-names></name><name><surname>Bull</surname><given-names>J</given-names></name></person-group><article-title>A model of population growth, dispersal and evolution in a changing environment</article-title><source>Ecology</source><year>1989</year><volume>70</volume><issue>6</issue><fpage>1657</fpage><lpage>1664</lpage><pub-id pub-id-type="doi">10.2307/1938100</pub-id></element-citation><mixed-citation id="mc-CR87" publication-type="journal">Pease CM, Lande R, Bull J (1989) A model of population growth, dispersal and evolution in a changing environment. Ecology 70(6):1657&#x02013;1664. 10.2307/1938100</mixed-citation></citation-alternatives></ref><ref id="CR88"><citation-alternatives><element-citation id="ec-CR88" publication-type="journal"><person-group person-group-type="author"><name><surname>Ponchon</surname><given-names>A</given-names></name><name><surname>Travis</surname><given-names>J</given-names></name></person-group><article-title>Informed dispersal based on prospecting impacts the rate and shape of range expansions</article-title><source>Ecography</source><year>2022</year><volume>2022</volume><issue>5</issue><fpage>06190</fpage><pub-id pub-id-type="doi">10.1111/ecog.06190</pub-id></element-citation><mixed-citation id="mc-CR88" publication-type="journal">Ponchon A, Travis J (2022) Informed dispersal based on prospecting impacts the rate and shape of range expansions. Ecography 2022(5):06190. 10.1111/ecog.06190</mixed-citation></citation-alternatives></ref><ref id="CR89"><citation-alternatives><element-citation id="ec-CR89" publication-type="journal"><person-group person-group-type="author"><name><surname>Pulliam</surname><given-names>HR</given-names></name></person-group><article-title>On the relationship between niche and distribution</article-title><source>Ecol Lett</source><year>2000</year><volume>3</volume><issue>4</issue><fpage>349</fpage><lpage>361</lpage><pub-id pub-id-type="doi">10.1046/j.1461-0248.2000.00143.x</pub-id></element-citation><mixed-citation id="mc-CR89" publication-type="journal">Pulliam HR (2000) On the relationship between niche and distribution. Ecol Lett 3(4):349&#x02013;361. 10.1046/j.1461-0248.2000.00143.x</mixed-citation></citation-alternatives></ref><ref id="CR90"><citation-alternatives><element-citation id="ec-CR90" publication-type="journal"><person-group person-group-type="author"><name><surname>Rafajlovi&#x00107;</surname><given-names>M</given-names></name><name><surname>Alexander</surname><given-names>JM</given-names></name><name><surname>Butlin</surname><given-names>RK</given-names></name><name><surname>Johannesson</surname><given-names>K</given-names></name></person-group><article-title>Introduction to the theme issue &#x02018;species&#x02019; ranges in the face of changing environments&#x02019;</article-title><source>Philos Trans R Soc B Biol Sci</source><year>2022</year><volume>377</volume><issue>1848</issue><fpage>20210002</fpage><pub-id pub-id-type="doi">10.1098/rstb.2021.0002</pub-id></element-citation><mixed-citation id="mc-CR90" publication-type="journal">Rafajlovi&#x00107; M, Alexander JM, Butlin RK, Johannesson K (2022) Introduction to the theme issue &#x02018;species&#x02019; ranges in the face of changing environments&#x02019;. Philos Trans R Soc B Biol Sci 377(1848):20210002. 10.1098/rstb.2021.0002</mixed-citation></citation-alternatives></ref><ref id="CR91"><citation-alternatives><element-citation id="ec-CR91" publication-type="journal"><person-group person-group-type="author"><name><surname>Rausher</surname><given-names>MD</given-names></name></person-group><article-title>The evolution of habitat preference in subdivided populations</article-title><source>Evolution</source><year>1984</year><volume>38</volume><issue>3</issue><fpage>596</fpage><lpage>608</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.1984.tb00325.x</pub-id><pub-id pub-id-type="pmid">28555965</pub-id>
</element-citation><mixed-citation id="mc-CR91" publication-type="journal">Rausher MD (1984) The evolution of habitat preference in subdivided populations. Evolution 38(3):596&#x02013;608. 10.1111/j.1558-5646.1984.tb00325.x<pub-id pub-id-type="pmid">28555965</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR92"><citation-alternatives><element-citation id="ec-CR92" publication-type="journal"><person-group person-group-type="author"><name><surname>Ravign&#x000e9;</surname><given-names>V</given-names></name><name><surname>Dieckmann</surname><given-names>U</given-names></name><name><surname>Olivieri</surname><given-names>I</given-names></name></person-group><article-title>Live where you thrive: joint evolution of habitat choice and local adaptation facilitates specialization and promotes diversity</article-title><source>Am Nat</source><year>2009</year><volume>174</volume><issue>4</issue><fpage>141</fpage><lpage>169</lpage><pub-id pub-id-type="doi">10.1086/605369</pub-id><pub-id pub-id-type="pmid">19456261</pub-id>
</element-citation><mixed-citation id="mc-CR92" publication-type="journal">Ravign&#x000e9; V, Dieckmann U, Olivieri I (2009) Live where you thrive: joint evolution of habitat choice and local adaptation facilitates specialization and promotes diversity. Am Nat 174(4):141&#x02013;169. 10.1086/605369<pub-id pub-id-type="pmid">19456261</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR93"><citation-alternatives><element-citation id="ec-CR93" publication-type="journal"><person-group person-group-type="author"><name><surname>Rice</surname><given-names>WR</given-names></name><name><surname>Hostert</surname><given-names>EE</given-names></name></person-group><article-title>Laboratory experiments on speciation: What have we learned in 40 years?</article-title><source>Evolution</source><year>1993</year><volume>47</volume><issue>6</issue><fpage>1637</fpage><lpage>1653</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.1993.tb01257.x</pub-id><pub-id pub-id-type="pmid">28568007</pub-id>
</element-citation><mixed-citation id="mc-CR93" publication-type="journal">Rice WR, Hostert EE (1993) Laboratory experiments on speciation: What have we learned in 40 years? Evolution 47(6):1637&#x02013;1653. 10.1111/j.1558-5646.1993.tb01257.x<pub-id pub-id-type="pmid">28568007</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR94"><citation-alternatives><element-citation id="ec-CR94" publication-type="journal"><person-group person-group-type="author"><name><surname>Ravign&#x000e9;</surname><given-names>V</given-names></name><name><surname>Olivieri</surname><given-names>I</given-names></name><name><surname>Dieckmann</surname><given-names>U</given-names></name></person-group><article-title>Implications of habitat choice for protected polymorphisms</article-title><source>Evol Ecol Res</source><year>2004</year><volume>6</volume><fpage>125</fpage><lpage>145</lpage></element-citation><mixed-citation id="mc-CR94" publication-type="journal">Ravign&#x000e9; V, Olivieri I, Dieckmann U (2004) Implications of habitat choice for protected polymorphisms. Evol Ecol Res 6:125&#x02013;145</mixed-citation></citation-alternatives></ref><ref id="CR95"><citation-alternatives><element-citation id="ec-CR95" publication-type="journal"><person-group person-group-type="author"><name><surname>Ronce</surname><given-names>O</given-names></name></person-group><article-title>How does it feel to be like a rolling stone? ten questions about dispersal evolution</article-title><source>Annu Rev Ecol Evol Syst</source><year>2007</year><volume>38</volume><issue>1</issue><fpage>231</fpage><lpage>253</lpage><pub-id pub-id-type="doi">10.1146/annurev.ecolsys.38.091206.095611</pub-id></element-citation><mixed-citation id="mc-CR95" publication-type="journal">Ronce O (2007) How does it feel to be like a rolling stone? ten questions about dispersal evolution. Annu Rev Ecol Evol Syst 38(1):231&#x02013;253. 10.1146/annurev.ecolsys.38.091206.095611</mixed-citation></citation-alternatives></ref><ref id="CR96"><citation-alternatives><element-citation id="ec-CR96" publication-type="journal"><person-group person-group-type="author"><name><surname>Rosenzweig</surname><given-names>ML</given-names></name></person-group><article-title>A theory of habitat selection</article-title><source>Ecology</source><year>1981</year><volume>62</volume><issue>2</issue><fpage>327</fpage><lpage>335</lpage><pub-id pub-id-type="doi">10.2307/1936707</pub-id></element-citation><mixed-citation id="mc-CR96" publication-type="journal">Rosenzweig ML (1981) A theory of habitat selection. Ecology 62(2):327&#x02013;335. 10.2307/1936707</mixed-citation></citation-alternatives></ref><ref id="CR97"><citation-alternatives><element-citation id="ec-CR97" publication-type="book"><person-group person-group-type="author"><name><surname>Roughgarden</surname><given-names>J</given-names></name></person-group><source>Theory of population genetics and evolutionary ecology: an introduction</source><year>1979</year><publisher-loc>New York</publisher-loc><publisher-name>Macmillan</publisher-name></element-citation><mixed-citation id="mc-CR97" publication-type="book">Roughgarden J (1979) Theory of population genetics and evolutionary ecology: an introduction. Macmillan, New York</mixed-citation></citation-alternatives></ref><ref id="CR98"><citation-alternatives><element-citation id="ec-CR98" publication-type="journal"><person-group person-group-type="author"><name><surname>Ruxton</surname><given-names>GD</given-names></name><name><surname>Rohani</surname><given-names>P</given-names></name></person-group><article-title>Fitness-dependent dispersal in metapopulations and its consequences for persistence and synchrony</article-title><source>J Anim Ecol</source><year>1999</year><volume>68</volume><issue>3</issue><fpage>530</fpage><lpage>539</lpage><pub-id pub-id-type="doi">10.1046/j.1365-2656.1999.00300.x</pub-id></element-citation><mixed-citation id="mc-CR98" publication-type="journal">Ruxton GD, Rohani P (1999) Fitness-dependent dispersal in metapopulations and its consequences for persistence and synchrony. J Anim Ecol 68(3):530&#x02013;539. 10.1046/j.1365-2656.1999.00300.x</mixed-citation></citation-alternatives></ref><ref id="CR99"><citation-alternatives><element-citation id="ec-CR99" publication-type="journal"><person-group person-group-type="author"><name><surname>Rice</surname><given-names>WR</given-names></name><name><surname>Salt</surname><given-names>GW</given-names></name></person-group><article-title>Speciation via disruptive selection on habitat preference: experimental evidence</article-title><source>Am Nat</source><year>1988</year><volume>131</volume><issue>6</issue><fpage>911</fpage><lpage>917</lpage><pub-id pub-id-type="doi">10.1086/284831</pub-id></element-citation><mixed-citation id="mc-CR99" publication-type="journal">Rice WR, Salt GW (1988) Speciation via disruptive selection on habitat preference: experimental evidence. Am Nat 131(6):911&#x02013;917. 10.1086/284831</mixed-citation></citation-alternatives></ref><ref id="CR100"><citation-alternatives><element-citation id="ec-CR100" publication-type="journal"><person-group person-group-type="author"><name><surname>Rice</surname><given-names>WR</given-names></name><name><surname>Salt</surname><given-names>GW</given-names></name></person-group><article-title>The evolution of reproductive isolation as a correlated character under sympatric conditions</article-title><source>Evolution</source><year>1990</year><volume>44</volume><issue>5</issue><fpage>1140</fpage><lpage>1152</lpage><pub-id pub-id-type="doi">10.1111/j.1558-5646.1990.tb05221.x</pub-id><pub-id pub-id-type="pmid">28563894</pub-id>
</element-citation><mixed-citation id="mc-CR100" publication-type="journal">Rice WR, Salt GW (1990) The evolution of reproductive isolation as a correlated character under sympatric conditions. Evolution 44(5):1140&#x02013;1152. 10.1111/j.1558-5646.1990.tb05221.x<pub-id pub-id-type="pmid">28563894</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR101"><citation-alternatives><element-citation id="ec-CR101" publication-type="journal"><person-group person-group-type="author"><name><surname>Saastamoinen</surname><given-names>M</given-names></name><name><surname>Bocedi</surname><given-names>G</given-names></name><name><surname>Cote</surname><given-names>J</given-names></name><name><surname>Legrand</surname><given-names>D</given-names></name><name><surname>Guillaume</surname><given-names>F</given-names></name><name><surname>Wheat</surname><given-names>CW</given-names></name><name><surname>Fronhofer</surname><given-names>EA</given-names></name><name><surname>Garcia</surname><given-names>C</given-names></name><name><surname>Henry</surname><given-names>R</given-names></name><name><surname>Husby</surname><given-names>A</given-names></name><name><surname>Baguette</surname><given-names>M</given-names></name><name><surname>Bonte</surname><given-names>D</given-names></name><name><surname>Coulon</surname><given-names>A</given-names></name><name><surname>Kokko</surname><given-names>H</given-names></name><name><surname>Matthysen</surname><given-names>E</given-names></name><name><surname>Niitep&#x000f5;ld</surname><given-names>K</given-names></name><name><surname>Nonaka</surname><given-names>E</given-names></name><name><surname>Stevens</surname><given-names>VM</given-names></name><name><surname>Travis</surname><given-names>J</given-names></name><name><surname>Donohue</surname><given-names>K</given-names></name><name><surname>Bullock</surname><given-names>JM</given-names></name><name><surname>Mar Delgado</surname><given-names>M</given-names></name></person-group><article-title>Genetics of dispersal</article-title><source>Biol Rev</source><year>2018</year><volume>93</volume><issue>1</issue><fpage>574</fpage><lpage>599</lpage><pub-id pub-id-type="doi">10.1111/brv.12356</pub-id><pub-id pub-id-type="pmid">28776950</pub-id>
</element-citation><mixed-citation id="mc-CR101" publication-type="journal">Saastamoinen M, Bocedi G, Cote J, Legrand D, Guillaume F, Wheat CW, Fronhofer EA, Garcia C, Henry R, Husby A, Baguette M, Bonte D, Coulon A, Kokko H, Matthysen E, Niitep&#x000f5;ld K, Nonaka E, Stevens VM, Travis J, Donohue K, Bullock JM, Mar Delgado M (2018) Genetics of dispersal. Biol Rev 93(1):574&#x02013;599. 10.1111/brv.12356<pub-id pub-id-type="pmid">28776950</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR102"><citation-alternatives><element-citation id="ec-CR102" publication-type="journal"><person-group person-group-type="author"><name><surname>Scheiner</surname><given-names>SM</given-names></name><name><surname>Barfield</surname><given-names>M</given-names></name><name><surname>Holt</surname><given-names>RD</given-names></name></person-group><article-title>The genetics of phenotypic plasticity. XI. Joint evolution of plasticity and dispersal rate.</article-title><source>Ecol Evol</source><year>2012</year><volume>2</volume><issue>8</issue><fpage>2027</fpage><lpage>2039</lpage><pub-id pub-id-type="doi">10.1002/ece3.327</pub-id><pub-id pub-id-type="pmid">22957203</pub-id>
</element-citation><mixed-citation id="mc-CR102" publication-type="journal">Scheiner SM, Barfield M, Holt RD (2012) The genetics of phenotypic plasticity. XI. Joint evolution of plasticity and dispersal rate. Ecol Evol 2(8):2027&#x02013;2039. 10.1002/ece3.327<pub-id pub-id-type="pmid">22957203</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR103"><citation-alternatives><element-citation id="ec-CR103" publication-type="journal"><person-group person-group-type="author"><name><surname>Scheiner</surname><given-names>SM</given-names></name><name><surname>Barfield</surname><given-names>M</given-names></name><name><surname>Holt</surname><given-names>RD</given-names></name></person-group><article-title>Do i build or do i move? Adaptation by habitat construction versus habitat choice</article-title><source>Evolution</source><year>2022</year><volume>76</volume><issue>3</issue><fpage>414</fpage><lpage>428</lpage><pub-id pub-id-type="doi">10.1111/evo.14355</pub-id><pub-id pub-id-type="pmid">34534361</pub-id>
</element-citation><mixed-citation id="mc-CR103" publication-type="journal">Scheiner SM, Barfield M, Holt RD (2022) Do i build or do i move? Adaptation by habitat construction versus habitat choice. Evolution 76(3):414&#x02013;428. 10.1111/evo.14355<pub-id pub-id-type="pmid">34534361</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR104"><citation-alternatives><element-citation id="ec-CR104" publication-type="journal"><person-group person-group-type="author"><name><surname>Scheiner</surname><given-names>SM</given-names></name></person-group><article-title>Genetics and evolution of phenotypic plasticity</article-title><source>Annu Rev Ecol Evol Syst</source><year>1993</year><volume>24</volume><fpage>35</fpage><lpage>68</lpage><pub-id pub-id-type="doi">10.1146/annurev.es.24.110193.000343</pub-id></element-citation><mixed-citation id="mc-CR104" publication-type="journal">Scheiner SM (1993) Genetics and evolution of phenotypic plasticity. Annu Rev Ecol Evol Syst 24:35&#x02013;68. 10.1146/annurev.es.24.110193.000343</mixed-citation></citation-alternatives></ref><ref id="CR105"><citation-alternatives><element-citation id="ec-CR105" publication-type="journal"><person-group person-group-type="author"><name><surname>Scheiner</surname><given-names>SM</given-names></name></person-group><article-title>Habitat choice and temporal variation alter the balance between adaptation by genetic differentiation, a jack-of-all-trades strategy, and phenotypic plasticity</article-title><source>Am Nat</source><year>2016</year><volume>187</volume><issue>5</issue><fpage>633</fpage><lpage>646</lpage><pub-id pub-id-type="doi">10.1086/685812</pub-id><pub-id pub-id-type="pmid">27104995</pub-id>
</element-citation><mixed-citation id="mc-CR105" publication-type="journal">Scheiner SM (2016) Habitat choice and temporal variation alter the balance between adaptation by genetic differentiation, a jack-of-all-trades strategy, and phenotypic plasticity. Am Nat 187(5):633&#x02013;646. 10.1086/685812<pub-id pub-id-type="pmid">27104995</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR106"><citation-alternatives><element-citation id="ec-CR106" publication-type="journal"><person-group person-group-type="author"><name><surname>Schmid</surname><given-names>M</given-names></name><name><surname>Dallo</surname><given-names>R</given-names></name><name><surname>Guillaume</surname><given-names>F</given-names></name></person-group><article-title>Species&#x02019; range dynamics affect the evolution of spatial variation in plasticity under environmental change</article-title><source>Am Nat</source><year>2019</year><volume>193</volume><issue>6</issue><fpage>798</fpage><lpage>813</lpage><pub-id pub-id-type="doi">10.1086/703171</pub-id><pub-id pub-id-type="pmid">31094605</pub-id>
</element-citation><mixed-citation id="mc-CR106" publication-type="journal">Schmid M, Dallo R, Guillaume F (2019) Species&#x02019; range dynamics affect the evolution of spatial variation in plasticity under environmental change. Am Nat 193(6):798&#x02013;813. 10.1086/703171<pub-id pub-id-type="pmid">31094605</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR107"><citation-alternatives><element-citation id="ec-CR107" publication-type="journal"><person-group person-group-type="author"><name><surname>Selonen</surname><given-names>V</given-names></name><name><surname>Hanski</surname><given-names>IK</given-names></name></person-group><article-title>Habitat exploration and use in dispersing juvenile flying squirrels</article-title><source>J Anim Ecol</source><year>2006</year><volume>75</volume><issue>6</issue><fpage>1440</fpage><lpage>1449</lpage><pub-id pub-id-type="doi">10.1111/j.1365-2656.2006.01168.x</pub-id><pub-id pub-id-type="pmid">17032376</pub-id>
</element-citation><mixed-citation id="mc-CR107" publication-type="journal">Selonen V, Hanski IK (2006) Habitat exploration and use in dispersing juvenile flying squirrels. J Anim Ecol 75(6):1440&#x02013;1449. 10.1111/j.1365-2656.2006.01168.x<pub-id pub-id-type="pmid">17032376</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR108"><citation-alternatives><element-citation id="ec-CR108" publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Gene flow in natural populations</article-title><source>Annu Rev Ecol Evol Syst</source><year>1985</year><volume>16</volume><fpage>393</fpage><lpage>430</lpage><pub-id pub-id-type="doi">10.1146/annurev.es.16.110185.002141</pub-id></element-citation><mixed-citation id="mc-CR108" publication-type="journal">Slatkin M (1985) Gene flow in natural populations. Annu Rev Ecol Evol Syst 16:393&#x02013;430. 10.1146/annurev.es.16.110185.002141</mixed-citation></citation-alternatives></ref><ref id="CR109"><citation-alternatives><element-citation id="ec-CR109" publication-type="journal"><person-group person-group-type="author"><name><surname>Slatkin</surname><given-names>M</given-names></name></person-group><article-title>Gene flow and the geographic structure of natural populations</article-title><source>Science</source><year>1987</year><volume>236</volume><issue>4803</issue><fpage>787</fpage><lpage>792</lpage><pub-id pub-id-type="doi">10.1126/science.3576198</pub-id><pub-id pub-id-type="pmid">3576198</pub-id>
</element-citation><mixed-citation id="mc-CR109" publication-type="journal">Slatkin M (1987) Gene flow and the geographic structure of natural populations. Science 236(4803):787&#x02013;792. 10.1126/science.3576198<pub-id pub-id-type="pmid">3576198</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR110"><citation-alternatives><element-citation id="ec-CR110" publication-type="journal"><person-group person-group-type="author"><name><surname>Shirani</surname><given-names>F</given-names></name><name><surname>Miller</surname><given-names>JR</given-names></name></person-group><article-title>Competition, trait variance dynamics, and the evolution of a species&#x02019; range</article-title><source>Bull Math Biol</source><year>2022</year><volume>84</volume><issue>3</issue><fpage>37</fpage><pub-id pub-id-type="doi">10.1007/s11538-022-00990-z</pub-id><pub-id pub-id-type="pmid">35099649</pub-id>
</element-citation><mixed-citation id="mc-CR110" publication-type="journal">Shirani F, Miller JR (2022) Competition, trait variance dynamics, and the evolution of a species&#x02019; range. Bull Math Biol 84(3):37. 10.1007/s11538-022-00990-z<pub-id pub-id-type="pmid">35099649</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR111"><citation-alternatives><element-citation id="ec-CR111" publication-type="journal"><person-group person-group-type="author"><name><surname>Sexton</surname><given-names>JP</given-names></name><name><surname>McIntyre</surname><given-names>PJ</given-names></name><name><surname>Angert</surname><given-names>AL</given-names></name><name><surname>Rice</surname><given-names>KJ</given-names></name></person-group><article-title>Evolution and ecology of species range limits</article-title><source>Annu Rev Ecol Evol Syst</source><year>2009</year><volume>40</volume><issue>1</issue><fpage>415</fpage><lpage>436</lpage><pub-id pub-id-type="doi">10.1146/annurev.ecolsys.110308.120317</pub-id></element-citation><mixed-citation id="mc-CR111" publication-type="journal">Sexton JP, McIntyre PJ, Angert AL, Rice KJ (2009) Evolution and ecology of species range limits. Annu Rev Ecol Evol Syst 40(1):415&#x02013;436. 10.1146/annurev.ecolsys.110308.120317</mixed-citation></citation-alternatives></ref><ref id="CR112"><citation-alternatives><element-citation id="ec-CR112" publication-type="book"><person-group person-group-type="author"><name><surname>Schlichting</surname><given-names>C</given-names></name><name><surname>Pigliucci</surname><given-names>M</given-names></name></person-group><source>Phenotypic evolution: a reaction norm perspective</source><year>1998</year><publisher-loc>Sunderland, MA</publisher-loc><publisher-name>Sinauer Associates Inc</publisher-name></element-citation><mixed-citation id="mc-CR112" publication-type="book">Schlichting C, Pigliucci M (1998) Phenotypic evolution: a reaction norm perspective. Sinauer Associates Inc, Sunderland, MA</mixed-citation></citation-alternatives></ref><ref id="CR113"><citation-alternatives><element-citation id="ec-CR113" publication-type="journal"><person-group person-group-type="author"><name><surname>Travis</surname><given-names>J</given-names></name><name><surname>Mustin</surname><given-names>K</given-names></name><name><surname>Barto&#x00144;</surname><given-names>KA</given-names></name><name><surname>Benton</surname><given-names>TG</given-names></name><name><surname>Clobert</surname><given-names>J</given-names></name><name><surname>Delgado</surname><given-names>MM</given-names></name><name><surname>Dytham</surname><given-names>C</given-names></name><name><surname>Hovestadt</surname><given-names>T</given-names></name><name><surname>Palmer</surname><given-names>S</given-names></name><name><surname>Van Dyck</surname><given-names>H</given-names></name><name><surname>Bonte</surname><given-names>D</given-names></name></person-group><article-title>Modelling dispersal: an eco-evolutionary framework incorporating emigration, movement, settlement behaviour and the multiple costs involved</article-title><source>Methods Ecol Evol</source><year>2012</year><volume>3</volume><issue>4</issue><fpage>628</fpage><lpage>641</lpage><pub-id pub-id-type="doi">10.1111/j.2041-210X.2012.00193.x</pub-id></element-citation><mixed-citation id="mc-CR113" publication-type="journal">Travis J, Mustin K, Barto&#x00144; KA, Benton TG, Clobert J, Delgado MM, Dytham C, Hovestadt T, Palmer S, Van Dyck H, Bonte D (2012) Modelling dispersal: an eco-evolutionary framework incorporating emigration, movement, settlement behaviour and the multiple costs involved. Methods Ecol Evol 3(4):628&#x02013;641. 10.1111/j.2041-210X.2012.00193.x</mixed-citation></citation-alternatives></ref><ref id="CR114"><citation-alternatives><element-citation id="ec-CR114" publication-type="journal"><person-group person-group-type="author"><name><surname>Turko</surname><given-names>AJ</given-names></name><name><surname>Rossi</surname><given-names>GS</given-names></name></person-group><article-title>Habitat choice promotes and constrains phenotypic plasticity</article-title><source>Biol Let</source><year>2022</year><volume>18</volume><issue>1</issue><fpage>20210468</fpage><pub-id pub-id-type="doi">10.1098/rsbl.2021.0468</pub-id><pub-id pub-id-type="pmid">35042396</pub-id>
</element-citation><mixed-citation id="mc-CR114" publication-type="journal">Turko AJ, Rossi GS (2022) Habitat choice promotes and constrains phenotypic plasticity. Biol Let 18(1):20210468. 10.1098/rsbl.2021.0468<pub-id pub-id-type="pmid">35042396</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR115"><citation-alternatives><element-citation id="ec-CR115" publication-type="journal"><person-group person-group-type="author"><name><surname>Takahashi</surname><given-names>Y</given-names></name><name><surname>Suyama</surname><given-names>Y</given-names></name><name><surname>Matsuki</surname><given-names>Y</given-names></name><name><surname>Funayama</surname><given-names>R</given-names></name><name><surname>Nakayama</surname><given-names>K</given-names></name><name><surname>Kawata</surname><given-names>M</given-names></name></person-group><article-title>Lack of genetic variation prevents adaptation at the geographic range margin in a damselfly</article-title><source>Mol Ecol</source><year>2016</year><volume>25</volume><issue>18</issue><fpage>4450</fpage><lpage>4460</lpage><pub-id pub-id-type="doi">10.1111/mec.13782</pub-id><pub-id pub-id-type="pmid">27501054</pub-id>
</element-citation><mixed-citation id="mc-CR115" publication-type="journal">Takahashi Y, Suyama Y, Matsuki Y, Funayama R, Nakayama K, Kawata M (2016) Lack of genetic variation prevents adaptation at the geographic range margin in a damselfly. Mol Ecol 25(18):4450&#x02013;4460. 10.1111/mec.13782<pub-id pub-id-type="pmid">27501054</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR116"><citation-alternatives><element-citation id="ec-CR116" publication-type="journal"><person-group person-group-type="author"><name><surname>Violle</surname><given-names>C</given-names></name><name><surname>Jiang</surname><given-names>L</given-names></name></person-group><article-title>Towards a trait-based quantification of species niche</article-title><source>J Plant Ecol</source><year>2009</year><volume>2</volume><issue>2</issue><fpage>87</fpage><lpage>93</lpage><pub-id pub-id-type="doi">10.1093/jpe/rtp007</pub-id></element-citation><mixed-citation id="mc-CR116" publication-type="journal">Violle C, Jiang L (2009) Towards a trait-based quantification of species niche. J Plant Ecol 2(2):87&#x02013;93. 10.1093/jpe/rtp007</mixed-citation></citation-alternatives></ref><ref id="CR117"><citation-alternatives><element-citation id="ec-CR117" publication-type="journal"><person-group person-group-type="author"><name><surname>Valladares</surname><given-names>F</given-names></name><name><surname>Matesanz</surname><given-names>S</given-names></name><name><surname>Guilhaumon</surname><given-names>F</given-names></name><name><surname>Ara&#x000fa;jo</surname><given-names>MB</given-names></name><name><surname>Balaguer</surname><given-names>L</given-names></name><name><surname>Benito-Garz&#x000f3;n</surname><given-names>M</given-names></name><name><surname>Cornwell</surname><given-names>W</given-names></name><name><surname>Gianoli</surname><given-names>E</given-names></name><name><surname>Kleunen</surname><given-names>M</given-names></name><name><surname>Naya</surname><given-names>DE</given-names></name><name><surname>Nicotra</surname><given-names>AB</given-names></name><name><surname>Poorter</surname><given-names>H</given-names></name><name><surname>Zavala</surname><given-names>MA</given-names></name></person-group><article-title>The effects of phenotypic plasticity and local adaptation on forecasts of species range shifts under climate change</article-title><source>Ecol Lett</source><year>2014</year><volume>17</volume><issue>11</issue><fpage>1351</fpage><lpage>1364</lpage><pub-id pub-id-type="doi">10.1111/ele.12348</pub-id><pub-id pub-id-type="pmid">25205436</pub-id>
</element-citation><mixed-citation id="mc-CR117" publication-type="journal">Valladares F, Matesanz S, Guilhaumon F, Ara&#x000fa;jo MB, Balaguer L, Benito-Garz&#x000f3;n M, Cornwell W, Gianoli E, Kleunen M, Naya DE, Nicotra AB, Poorter H, Zavala MA (2014) The effects of phenotypic plasticity and local adaptation on forecasts of species range shifts under climate change. Ecol Lett 17(11):1351&#x02013;1364. 10.1111/ele.12348<pub-id pub-id-type="pmid">25205436</pub-id>
</mixed-citation></citation-alternatives></ref></ref-list></back></article>