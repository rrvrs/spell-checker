<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="en" article-type="research-article"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Sensors (Basel)</journal-id><journal-id journal-id-type="iso-abbrev">Sensors (Basel)</journal-id><journal-id journal-id-type="publisher-id">sensors</journal-id><journal-title-group><journal-title>Sensors (Basel, Switzerland)</journal-title></journal-title-group><issn pub-type="epub">1424-8220</issn><publisher><publisher-name>MDPI</publisher-name></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmid">40006243</article-id><article-id pub-id-type="pmc">PMC11859693</article-id><article-id pub-id-type="doi">10.3390/s25041015</article-id><article-id pub-id-type="publisher-id">sensors-25-01015</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>An Electro-Magnetic Log (EML) Integrated Navigation Algorithm Based on Hidden Markov Model (HMM) and Cross-Noise Linear Kalman Filter</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-3252-8331</contrib-id><name><surname>Zhang</surname><given-names>Haosu</given-names></name><xref rid="af1-sensors-25-01015" ref-type="aff">1</xref><xref rid="af2-sensors-25-01015" ref-type="aff">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0009-0000-4037-2544</contrib-id><name><surname>Yang</surname><given-names>Liang</given-names></name><xref rid="af1-sensors-25-01015" ref-type="aff">1</xref><xref rid="af2-sensors-25-01015" ref-type="aff">2</xref></contrib><contrib contrib-type="author"><name><surname>Zhang</surname><given-names>Lei</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Data curation" vocab-term-identifier="https://credit.niso.org/contributor-roles/data-curation/">Data curation</role><role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Visualization" vocab-term-identifier="https://credit.niso.org/contributor-roles/visualization/">Visualization</role><xref rid="af3-sensors-25-01015" ref-type="aff">3</xref></contrib><contrib contrib-type="author"><name><surname>Du</surname><given-names>Yong</given-names></name><xref rid="af4-sensors-25-01015" ref-type="aff">4</xref></contrib><contrib contrib-type="author"><name><surname>Chen</surname><given-names>Chaoqi</given-names></name><xref rid="af1-sensors-25-01015" ref-type="aff">1</xref></contrib><contrib contrib-type="author"><name><surname>Mu</surname><given-names>Wei</given-names></name><role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Validation" vocab-term-identifier="https://credit.niso.org/contributor-roles/validation/">Validation</role><role vocab="credit" vocab-identifier="https://credit.niso.org/" vocab-term="Supervision" vocab-term-identifier="https://credit.niso.org/contributor-roles/supervision/">Supervision</role><xref rid="af1-sensors-25-01015" ref-type="aff">1</xref></contrib><contrib contrib-type="author"><name><surname>Xu</surname><given-names>Lingji</given-names></name><xref rid="af1-sensors-25-01015" ref-type="aff">1</xref><xref rid="af2-sensors-25-01015" ref-type="aff">2</xref><xref rid="c1-sensors-25-01015" ref-type="corresp">*</xref></contrib></contrib-group><contrib-group><contrib contrib-type="editor"><name><surname>Stateczny</surname><given-names>Andrzej</given-names></name><role>Academic Editor</role></contrib></contrib-group><aff id="af1-sensors-25-01015"><label>1</label>Southern Marine Science and Engineering Guangdong Laboratory (Zhuhai), Zhuhai 519000, China; <email>zhanghs7@mail.sysu.edu.cn</email> (H.Z.); <email>yangliang7@mail2.sysu.edu.cn</email> (L.Y.); <email>chenchq26@mail2.sysu.edu.cn</email> (C.C.); <email>muwei@sml-zhuhai.cn</email> (W.M.)</aff><aff id="af2-sensors-25-01015"><label>2</label>School of Ocean Engineering and Technology, Sun Yat-Sen University, Zhuhai 519000, China</aff><aff id="af3-sensors-25-01015"><label>3</label>State Power Investment Group (Zhuhai Hengqin) Thermoelectric Co., Ltd., Zhuhai 519000, China; <email>zhanglei30@spic.com.cn</email></aff><aff id="af4-sensors-25-01015"><label>4</label>Wuhan National Laboratory for Optoelectronics, Huazhong Institute of Electro-Optics, Wuhan 430223, China; <email>duyong_duli@163.com</email></aff><author-notes><corresp id="c1-sensors-25-01015"><label>*</label>Correspondence: <email>xulj26@mail.sysu.edu.cn</email></corresp></author-notes><pub-date pub-type="epub"><day>08</day><month>2</month><year>2025</year></pub-date><pub-date pub-type="collection"><month>2</month><year>2025</year></pub-date><volume>25</volume><issue>4</issue><elocation-id>1015</elocation-id><history><date date-type="received"><day>27</day><month>11</month><year>2024</year></date><date date-type="rev-recd"><day>19</day><month>1</month><year>2025</year></date><date date-type="accepted"><day>28</day><month>1</month><year>2025</year></date></history><permissions><copyright-statement>&#x000a9; 2025 by the authors.</copyright-statement><copyright-year>2025</copyright-year><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p></license></permissions><abstract><p>In this paper, an EML (electro-magnetic log) integrated navigation algorithm based on the HMM (hidden Markov model) and CNLKF (cross-noise linear Kalman filter) is proposed, which is suitable for SINS (strapdown inertial navigation system)/EML/GNSS (global navigation satellite system) integrated navigation systems for small or medium-sized AUV (autonomous underwater vehicle). The algorithm employs the following five techniques: &#x02460; the HMM-based pre-processing algorithm of EML data; &#x02461; the CNLKF-based fusion algorithm of SINS/EML information; &#x02462; the MALKF (modified adaptive linear Kalman filter)-based algorithm of GNSS-based calibration; &#x02463; the estimation algorithm of the current speed based on output from MALKF and GNSS; &#x02464; the feedback correction of LKF (linear Kalman filter). The principle analysis of the algorithm, the modeling process, and the flow chart of the algorithm are given in this paper. The sea trial of a small-sized AUV shows that the endpoint positioning error of the proposed/traditional algorithm by this paper is 20.5 m/712.1 m. The speed of the water current could be relatively accurately estimated by the proposed algorithm. Therefore, the algorithm has the advantages of high accuracy, strong anti-interference ability (it can effectively shield the outliers of EML and GNSS), strong adaptability to complex environments, and high engineering practicality. In addition, compared with the traditional DVL (Doppler velocity log), EML has the advantages of great concealment, low cost, light weight, small size, and low power consumption.</p></abstract><kwd-group><kwd>inertial navigation system</kwd><kwd>Kalman filter (KF)-integrated navigation</kwd><kwd>AUV</kwd><kwd>ocean current estimation</kwd></kwd-group><funding-group><award-group><funding-source>Southern Marine Science and Engineering Guangdong Laboratory (Zhuhai)</funding-source><award-id>SML2023SP232</award-id></award-group><award-group><funding-source>2023 Zhuhai Industry University Research Cooperation Project&#x02014;Development and Industrialization of Multi beam Pipeline Inspection Sonar</funding-source><award-id>2320004002794</award-id></award-group><award-group><funding-source>Guangdong Basic and Applied Basic Research Foundation</funding-source><award-id>2022A1515110891</award-id></award-group><funding-statement>This work is funded by Southern Marine Science and Engineering Guangdong Laboratory (Zhuhai) (SML2023SP232), 2023 Zhuhai Industry University Research Cooperation Project&#x02014;Development and Industrialization of Multi beam Pipeline Inspection Sonar (2320004002794), and Guangdong Basic and Applied Basic Research Foundation (2022A1515110891).</funding-statement></funding-group></article-meta></front><body><sec sec-type="intro" id="sec1-sensors-25-01015"><title>1. Introduction</title><p>The continuous utilization and depletion of terrestrial resources have led people to turn their attention to the exploitation of the ocean, which contains a series of resources needed for production and life, providing a solution to the urgent need for resource shortage. Along with the growing demand for the exploitation of marine resources, more advanced and smarter marine equipment has become an indispensable tool for competition in the marine field. In the past two decades, AUV has been proven to be efficient in performing complex underwater tasks. AUV integrates technologies including hydro-acoustic communication, intelligent control, sensors, and others. It has the advantages of good autonomy, good flexibility, and a wide range of activities, and it plays an important strategic role in the fields of ocean exploration and underwater rescue. The AUV&#x02019;s ability to accomplish tasks is limited by the underwater navigation system, which is the core technology for AUV development [<xref rid="B1-sensors-25-01015" ref-type="bibr">1</xref>,<xref rid="B2-sensors-25-01015" ref-type="bibr">2</xref>,<xref rid="B3-sensors-25-01015" ref-type="bibr">3</xref>]. Different from navigation technology on land, underwater navigation needs to solve the difficult problems of long working time, harsh working environment, high concealment, and so on.</p><p>The most commonly and earliest navigation method applied to AUV is dead reckoning (DR), whose core principle is to determine its own position by integrating the AUV&#x02019;s velocity in real time. The disadvantage of this method is low accuracy. In addition to the DR method, AUVs can also employ an inertial navigation system (INS) for pure inertial calculation, which is based on Newton&#x02019;s third law and uses an inertial measurement unit (IMU) to measure the angular velocity of the AUV&#x02019;s rotation around its three axes and the linear acceleration along three axes. The measured acceleration is integrated over time to obtain velocity in three directions, and then the velocity and position vectors of the AUV are derived from data measured by IMU. The most commonly used navigation equipment is the strapdown inertial navigation system (SINS), which consists of a three-axis gyro, a three-axis accelerometer, a calculation circuit board, internal brackets, and a shell. The SINS is fixed directly on the carrier. Due to the measurement noises of the gyro and accelerometer in the SINS, the positioning error gradually increases over time. Therefore, for practical application, underwater velocimetry equipped for integrated navigation is required [<xref rid="B1-sensors-25-01015" ref-type="bibr">1</xref>,<xref rid="B2-sensors-25-01015" ref-type="bibr">2</xref>,<xref rid="B3-sensors-25-01015" ref-type="bibr">3</xref>]. Underwater velocimetry devices include a Doppler velocity log (DVL), acoustic correlation log (ACL), differential pressure sensor speedometer (DPSS), tune odometry (ODO), electro-magnetic log (EML), etc. The advantages of DVL and ACL are high accuracy of measurement and the ability to measure the 3D velocity vector of AUV relative to the ground. The combination of SINS/DVL is currently the mainstream underwater navigation method. The achievements of its research are very fruitful, e.g., the Doppler water track aided navigation [<xref rid="B4-sensors-25-01015" ref-type="bibr">4</xref>], the analysis of navigation key techniques [<xref rid="B5-sensors-25-01015" ref-type="bibr">5</xref>], a coupled method based on improved dual adaptive factors [<xref rid="B6-sensors-25-01015" ref-type="bibr">6</xref>], an algorithm using the velocity filter [<xref rid="B7-sensors-25-01015" ref-type="bibr">7</xref>], the performance for sensor selection [<xref rid="B8-sensors-25-01015" ref-type="bibr">8</xref>], hardware design [<xref rid="B9-sensors-25-01015" ref-type="bibr">9</xref>], the gain of compensation adaptive filtering [<xref rid="B10-sensors-25-01015" ref-type="bibr">10</xref>], a method based on the improved adaptive filter [<xref rid="B11-sensors-25-01015" ref-type="bibr">11</xref>], a hybrid approach based on an improved AR (auto regressive) model and MAA (motion attitude assist) [<xref rid="B12-sensors-25-01015" ref-type="bibr">12</xref>], an algorithm using an indirect feedback Kalman [<xref rid="B13-sensors-25-01015" ref-type="bibr">13</xref>], and a tightly coupled method using the regeneration of partial DVL measurements [<xref rid="B14-sensors-25-01015" ref-type="bibr">14</xref>]. In addition to DVL, other devices can also be added to the SINS/DVL-integrated system to form a tightly coupled system, e.g., the SINS/DVL/PS (pressure sensor) method based on RIMM (robust interacting multiple models) [<xref rid="B15-sensors-25-01015" ref-type="bibr">15</xref>], SINS/DVL/PS navigation with limited DVL measurements [<xref rid="B16-sensors-25-01015" ref-type="bibr">16</xref>].</p><p>Many scholars have proposed various improvement algorithms for such a mainstream navigation system, such as the fusion method with a cross-correlated process and measurement noise [<xref rid="B17-sensors-25-01015" ref-type="bibr">17</xref>], optimal Kalman fusion with cross-correlated sensor noises [<xref rid="B18-sensors-25-01015" ref-type="bibr">18</xref>], and a calibration method based on particle swarm optimization [<xref rid="B19-sensors-25-01015" ref-type="bibr">19</xref>]. Among these improvement algorithms, adaptive filter (AF) is a very important type. Besides the previous papers [<xref rid="B10-sensors-25-01015" ref-type="bibr">10</xref>,<xref rid="B11-sensors-25-01015" ref-type="bibr">11</xref>], adaptive H-infinite KF [<xref rid="B20-sensors-25-01015" ref-type="bibr">20</xref>] was also proposed. Such a navigation system often employs USBL (ultra-short baseline, acoustic positioning system) [<xref rid="B21-sensors-25-01015" ref-type="bibr">21</xref>] for the calibration or estimation of current speed [<xref rid="B22-sensors-25-01015" ref-type="bibr">22</xref>]. A GNSS (global navigation satellite system) is also commonly used for the calibration of SINS in a robot or vehicle [<xref rid="B23-sensors-25-01015" ref-type="bibr">23</xref>].</p><p>These are many research findings of studies on SINS/DVL-integrated navigation systems. An advantage of DVL and ACL is high precision. However, they also have many disadvantages, including high price, large size, heavy weight, complicated installation, outliers in measurement output, etc. In order to solve the shortcomings of DVL, several new velocity measuring devices have been proposed as follows: DSPP is a low-cost instrument that can measure the velocity reference to water of the AUV based on Bernoulli&#x02019;s principle and can be used for underwater integrated navigation [<xref rid="B24-sensors-25-01015" ref-type="bibr">24</xref>,<xref rid="B25-sensors-25-01015" ref-type="bibr">25</xref>]. The RMP (revolutions per minute) measured by the PT (propeller tachometer) or ODO can also be used for underwater integrated navigation [<xref rid="B26-sensors-25-01015" ref-type="bibr">26</xref>,<xref rid="B27-sensors-25-01015" ref-type="bibr">27</xref>]. The EML is a device that works base on the Hall effect to measure forward velocity through water [<xref rid="B28-sensors-25-01015" ref-type="bibr">28</xref>,<xref rid="B29-sensors-25-01015" ref-type="bibr">29</xref>,<xref rid="B30-sensors-25-01015" ref-type="bibr">30</xref>]. These three devices have the common advantages of good concealment (no signals such as acoustic waves are emitted outward), low price, small size, light weight, easy installation, and so on, among which EML is the most accurate and widely used. However, the current SINS/EML algorithm has a great scope for improvement in terms of accuracy and anti-interference capability.</p><p>Due to the measurement principle, DPSS, PT/ODO, and EML can only measure velocity through water. In contrast, the integrated navigation requires velocity over ground, and there is a difference between these two speeds in the presence of water currents. Therefore, the high-accuracy SINS/EML-integrated navigation algorithm must consider water currents. Additionally, while the AUV is sailing in the intermediate water layer, the acoustic waves of DVL or ACL cannot detect the bottom of the water. In this case, the water currents should also be taken into account. There are lots of studies on current estimation and compensation. In addition to the above literature [<xref rid="B22-sensors-25-01015" ref-type="bibr">22</xref>], there are many other methods, including a model-based high-gain observer [<xref rid="B31-sensors-25-01015" ref-type="bibr">31</xref>], a high-gain observer for current estimation [<xref rid="B32-sensors-25-01015" ref-type="bibr">32</xref>], localization in a field with a spatiotemporally varying water current [<xref rid="B33-sensors-25-01015" ref-type="bibr">33</xref>], and current compensation using an RBF neural network [<xref rid="B34-sensors-25-01015" ref-type="bibr">34</xref>].</p><p>Besides these studies, there are also many other advanced algorithms that can be used for underwater integrated navigation, including a multi-sensor fusion by the augmentation of the RBF neural network [<xref rid="B35-sensors-25-01015" ref-type="bibr">35</xref>], an adaptive navigation algorithm with deep learning [<xref rid="B36-sensors-25-01015" ref-type="bibr">36</xref>], an EKF (extended Kalman filter) for an autonomous underwater glider [<xref rid="B37-sensors-25-01015" ref-type="bibr">37</xref>], and a UKF (unscented Kalman filter) [<xref rid="B38-sensors-25-01015" ref-type="bibr">38</xref>,<xref rid="B39-sensors-25-01015" ref-type="bibr">39</xref>].</p><p>For solving the problems of current mainstream navigation systems with low stealth (emitting acoustic waves outward) and high cost, the EML is introduced in this paper to take the place of the DVL or ACL. In order to overcome the disadvantages of EML, such as the inability to measure the velocity to the ground, the existence of outliers, and the low accuracy of navigation combined with SINS, the algorithm in this paper employed the following five techniques: &#x02460; pre-processing of EML data with HMM- &#x02461; SINS/EML-integrated navigation based on CNLKF; &#x02462; calibration on the water surface based on MALKF and GNSS&#x02019;s output as a measurement; &#x02463; current estimation on the water surface with MALKF and GNSS&#x02019;s output; &#x02464; utilization of the feedback correction method for improving the accuracy of the LKF model. The sea trial of small-sized AUVs shows that the endpoint positioning error rate of this algorithm is 0.134%, and the positioning error is 20.5 m at endpoint, while the error rate of the traditional algorithm is 4.64% and the positioning error is 712.1 m. In the calculation of the error rate, the accurate voyaging distance is estimated by longitude and latitude measurements from GNSS. The maximum error of eastward (northward) current estimation of this algorithm is less than 0.14 m/s (0.095 m/s) with the currents measured by drifting buoys as benchmarks. Compared with the commonly used DVL (Doppler velocity log), EML has the advantages of high concealment, low cost, light weight, small size, and low power consumption. Therefore, the algorithm has the advantages of high accuracy, strong anti-interference ability (it can effectively shield the outliers of EML and GNSS), strong adaptability to adapt complex environment, and high engineering practicality.</p><p>The theoretical framework and process of the algorithm are given in <xref rid="sec2-sensors-25-01015" ref-type="sec">Section 2</xref> of this paper, and results of the trial are given in <xref rid="sec3-sensors-25-01015" ref-type="sec">Section 3</xref>. Then, in <xref rid="sec4-sensors-25-01015" ref-type="sec">Section 4</xref>, the conclusion of the paper and prospects of following developments are given.</p></sec><sec id="sec2-sensors-25-01015"><title>2. Algorithm</title><p>The basic principle of the algorithm is shown in <xref rid="sensors-25-01015-f001" ref-type="fig">Figure 1</xref>. For the sake of simplicity, SINS is abbreviated as INS. The definitions of INS, EML, HMM, CNLKF, MALKF, and GNSS in <xref rid="sensors-25-01015-f001" ref-type="fig">Figure 1</xref> were explained earlier. FOF and SOF in <xref rid="sensors-25-01015-f001" ref-type="fig">Figure 1</xref> denote first-order filter and second-order filter, respectively. The four frames chosen in this paper are defined as follows:<list list-type="simple"><list-item><label>&#x02460;</label><p><italic toggle="yes">b</italic>-frame: the carrier-frame, right-front-upper frame of carrier or IMU strapped to carrier. The origin of the frame is the rotation center or gravity center of the carrier. The rotation center is the center point of the carrier when it is turning. Three axes are noted as <italic toggle="yes">x</italic>, <italic toggle="yes">y</italic>, and <italic toggle="yes">z</italic>, respectively.</p></list-item><list-item><label>&#x02461;</label><p><italic toggle="yes">n</italic>-frame: the orthogonal frame aligned with East-North-Up (ENU) geodetic axes. The origin of the frame is the rotation center or gravity center of the carrier. The three axes are noted as <italic toggle="yes">E</italic>, <italic toggle="yes">N</italic>, and <italic toggle="yes">U</italic>, respectively.</p></list-item><list-item><label>&#x02462;</label><p><italic toggle="yes">e</italic>-frame: the earth-centered earth-fixed (ECEF) orthogonal frame. The origin of the coordinate is the center of earth or the rotation center of the carrier.</p></list-item><list-item><label>&#x02463;</label><p><italic toggle="yes">i</italic>-frame: the earth-centered fixed orthogonal frame, which is non-rotating during the alignment and navigation stages.</p></list-item></list></p><p>The <inline-formula><mml:math id="mm1" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm2" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm3" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm4" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm5" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref rid="sensors-25-01015-f001" ref-type="fig">Figure 1</xref> are velocity along the <italic toggle="yes">y</italic>-axis (forward velocity) calculated by INS, the forward velocity measured by EML, the forward velocity from EML after HMM filtering, the velocity vector of HMM in the <italic toggle="yes">n</italic>-frame (obtained by the velocity vector in the <italic toggle="yes">b</italic>-frame and attitude transformation matrix), and the estimated current vector in the <italic toggle="yes">n</italic>-frame, respectively. <inline-formula><mml:math id="mm6" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the attitude transformation matrix from the <italic toggle="yes">b</italic>-frame to the <italic toggle="yes">n</italic>-frame. <inline-formula><mml:math id="mm7" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm8" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are specified in the following Equations (5) and (21), respectively. <inline-formula><mml:math id="mm9" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:mi>L</mml:mi><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm10" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm11" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are the velocity vector from CNLKF, the vector output by MALKF, and the compensated vector from HMM (current compensation is performed with the relationship <inline-formula><mml:math id="mm12" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>), respectively. The horizontal and depth channels of the AUV are decoupled, and the depth channel is generally damped by the depth gauge (DG). The upward component of <inline-formula><mml:math id="mm13" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is generally small. Thus, only the components in the horizontal plane in <inline-formula><mml:math id="mm14" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> should be considered. <inline-formula><mml:math id="mm15" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm16" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are the velocity vector and position vector in the <italic toggle="yes">n</italic>-frame obtained from GNSS (generally calculated by <inline-formula><mml:math id="mm17" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> from GNSS and <inline-formula><mml:math id="mm18" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>). These two vectors are only available when the AUV is on the water surface (indicated by dashed lines in <xref rid="sensors-25-01015-f001" ref-type="fig">Figure 1</xref>). <inline-formula><mml:math id="mm19" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm20" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b4;</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> are latitude and latitude errors. <inline-formula><mml:math id="mm21" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm22" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are the earth&#x02019;s rotation angular velocity vector and the navigation system&#x02019;s rotation angular velocity vector in the <italic toggle="yes">n</italic>-frame. <inline-formula><mml:math id="mm23" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm24" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are the calculated errors of <inline-formula><mml:math id="mm25" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm26" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively, which are specified in Equation (33) below. The navigation information in <xref rid="sensors-25-01015-f001" ref-type="fig">Figure 1</xref> refers to parameters that need to be output except for velocities. It should be noted that <inline-formula><mml:math id="mm27" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm28" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm29" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are all velocities through water; <inline-formula><mml:math id="mm30" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm31" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:mi>L</mml:mi><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm32" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm33" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm34" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are all velocities over ground. In the following, the calculation process is described in detail.</p><p>The velocities from INS and EML are fused by HMM to obtain the velocity (<inline-formula><mml:math id="mm35" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>) through water with effectively suppressed noise. <inline-formula><mml:math id="mm36" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> can be obtained from <inline-formula><mml:math id="mm37" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm38" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm39" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm40" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. By combining <inline-formula><mml:math id="mm41" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and other navigation parameters, the CNLKF (FOF) model can be established, from which the velocity vector <inline-formula><mml:math id="mm42" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:mi>L</mml:mi><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and other navigation information (position, acceleration, attitude angle, attitude angular velocity, etc.) can be obtained. Until the first calibration by GNSS, <inline-formula><mml:math id="mm43" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is unknown, and we can assume that it is 0 or an empirical value. If the AUV could not receive information from GNSS, the <inline-formula><mml:math id="mm44" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>N</mml:mi><mml:mi>L</mml:mi><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> from CNLKF (FOF) and other navigation information are used as the final outputs. When the AUV emerges from underwater and receives GNSS signals, the navigation information from CNLKF (FOF) is used to establish the MALKF (SOF) model, and the measurement of GNSS is used to perform the recursive operation of MALKF to obtain <inline-formula><mml:math id="mm45" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and other navigation parameters as the final outputs. Additionally, the estimated <inline-formula><mml:math id="mm46" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is obtained by subtracting <inline-formula><mml:math id="mm47" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> from <inline-formula><mml:math id="mm48" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Superimposing <inline-formula><mml:math id="mm49" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="mm50" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> to obtain <inline-formula><mml:math id="mm51" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> can effectively improve the accuracy of the integrated navigation.</p><p>This current velocity is used for compensation until the next calibration by GNSS. Since variation of current speed is generally not drastic, such correction can ensure a certain level of accuracy of integrated navigation. In addition, to further improve the navigation accuracy, the algorithm employs the following feedback correction technique: the velocity over ground and errors <inline-formula><mml:math id="mm52" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm53" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> calculated based on latitude <italic toggle="yes">L</italic> are fed back into a specific force equation and LKF model. The frequency of GNSS-based calibration depends on the period of current variation. Constant or slowly varying currents require calibration at long intervals, while currents with a short varying period of change require frequent calibrations.</p><p>The inputs of the algorithm include the measurement data from EML, INS, and GNSS, while the outputs consist of navigation information (such as the position, velocity, attitude angles, and angular velocities of the platform) and the estimated ocean current. The algorithm incorporates three filters: HMM, CNLKF, and MALKF. The y-axis velocity of the platform, as measured by EML and INS, serves as the input to the HMM. After a coordinate transformation, the velocity output from the HMM is combined with the estimated ocean current fed back from the MALKF to form the input to the CNLKF. Additionally, the navigation information from the INS is also input to the CNLKF. The outputs of the CNLKF, together with the navigation information from the INS and the GNSS measurement data, are then fed into the MALKF. The MALKF outputs the navigation information estimated by the proposed algorithm. Finally, by subtracting the HMM velocity output (after coordinate transformation) from the MALKF velocity output, the 3D ocean current vector can be estimated. In summary, the output of CNLKF (FOF) will be taken as final outputs when <inline-formula><mml:math id="mm54" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm55" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are not received. In contrast, when <inline-formula><mml:math id="mm56" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm57" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">p</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are received, the MALKF (SOF) is activated, and its output is taken as the final output.</p><p>The proposed algorithm introduces a filtering framework that, although comprising three filters, functions as an integrated system. Each filter is designed to handle the type of data it is most suited to the process, ensuring high accuracy and computational efficiency. The HMM is responsible for preprocessing the measurement data from the EML. The CNLKF integrates data from the HMM and the INS, while the MALKF combines data from the CNLKF and the GNSS, estimates the ocean current, and feeds back model parameters to improve the accuracy of the CNLKF. If a single filter were used to process and integrate all the data simultaneously, it would inevitably result in low computational speed, reduced processing efficiency, and decreased accuracy. The EML has advantages such as low cost, small size, and low power consumption. However, its limitations, including high measurement noise and frequent outliers, restrict its broader application. This study proposes utilizing the HMM to preprocess EML data, reducing its measurement noise, eliminating outliers, and improving the quality of the EML data. Consequently, this preprocessing enhances the accuracy of integrated navigation using EML and INS.</p><sec id="sec2dot1-sensors-25-01015"><title>2.1. Working Principle of EML</title><p>When the AUV is sailing, the water flows through the EML in the direction opposite to the AUV&#x02019;s movement. Then, the water flows between the two electrodes <italic toggle="yes">a</italic> and <italic toggle="yes">b</italic> (As shown in <xref rid="sensors-25-01015-f002" ref-type="fig">Figure 2</xref>), cutting magnetic induction lines and causing the two electrodes to generate an induced electromotive force, as shown as follows in Equations (1a) and (1b):<disp-formula id="FD1-sensors-25-01015"><label>(1a)</label><mml:math id="mm58" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>&#x003a6;</mml:mi><mml:mi>B</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>l</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mfenced><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="FD2-sensors-25-01015"><label>(1b)</label><mml:math id="mm59" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>B</mml:mi><mml:mo>&#x000d7;</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>&#x000d7;</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm60" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the magnitude of the induced electromotive force, <italic toggle="yes">&#x003a6;<sub>B</sub></italic> denotes the magnitude of the magnetic flux, <italic toggle="yes">B</italic> is the strength of the magnetic field, and <italic toggle="yes">l</italic> is the height of the cross section of the magnetic field. In addition, <inline-formula><mml:math id="mm61" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm62" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> denote the forward velocity of the AUV (the <italic toggle="yes">y</italic> component represents the forward direction) and the <italic toggle="yes">y</italic>-axis component of the current velocity vector, respectively. If there is no current, <inline-formula><mml:math id="mm63" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> can be calculated by dividing the induced electromotive force by <italic toggle="yes">B</italic> &#x000d7; <italic toggle="yes">l</italic>. However, due to the presence of current in the real environment, the EML cannot measure velocity over ground.</p></sec><sec id="sec2dot2-sensors-25-01015"><title>2.2. HMM Algorithm</title><p>The error of EML measurement does not accumulate over time, but the measurement is noisy and contains outliers. The velocity calculated from the INS is less noisy, and it contains few outliers, but the error accumulates over time (because of the zero drift of the gyro and accelerometer). In this paper, the above two velocities were fused based on the HMM filter. The error of velocity from the HMM does not accumulate over time, and the noise can be effectively suppressed. Based on this fusion, most of the outliers can be effectively removed and replaced. The expressions of these velocities are as follows:<disp-formula id="FD3-sensors-25-01015"><label>(2a)</label><mml:math id="mm64" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>b</mml:mi></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>b</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>b</mml:mi></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02248;</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>b</mml:mi></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In Equation (2a), <inline-formula><mml:math id="mm65" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm66" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm67" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm68" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm69" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> are the velocity vector from the EML (obtained by expanding the forward velocity measured by the EML into a velocity vector), the velocity vector solved by the INS and the vector from the HMM (obtained by the relationship <inline-formula><mml:math id="mm70" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>), the vector (generally unknown and can be obtained based on methods like calibration by GNSS, measurement of current, a priori information of the current, etc.) of current speed and the real velocity vector (generally unknown and it can be estimated by <inline-formula><mml:math id="mm71" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm72" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>) of the AUV in the <italic toggle="yes">b</italic>-frame, respectively. <inline-formula><mml:math id="mm73" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm74" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm75" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are noises of EML, INS, and HMM, respectively. They are given by the correlation: <inline-formula><mml:math id="mm76" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02248;</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x0003c;</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Since the EML can only measure the forward velocity, which is critical to the accuracy of integrated navigation, it is the focus of this study. The expressions for forward velocity are shown as follows in Equation (2b):<disp-formula id="FD4-sensors-25-01015"><label>(2b)</label><mml:math id="mm77" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02248;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm78" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm79" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm80" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm81" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm82" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are the y-axis components of <inline-formula><mml:math id="mm83" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm84" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm85" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm86" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm87" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively.</p><p>The principle of the HMM algorithm is shown in Equation (2a). <inline-formula><mml:math id="mm88" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is measured by the EML. <inline-formula><mml:math id="mm89" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is derived by the INS. <inline-formula><mml:math id="mm90" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is obtained from the HMM. <inline-formula><mml:math id="mm91" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is generally unknown and can be obtained by calibration based on the GNSS, measurements of currents, etc. <inline-formula><mml:math id="mm92" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is unknown, and it can be estimated from <inline-formula><mml:math id="mm93" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm94" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. The model of the HMM is shown as follows in Equation (3):<disp-formula id="FD5-sensors-25-01015"><label>(3)</label><mml:math id="mm95" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm96" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm97" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are system noise and measurement noise, respectively. <inline-formula><mml:math id="mm98" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm99" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are state vector and measurement vector, respectively, and their components are <inline-formula><mml:math id="mm100" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm101" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="mm102" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm103" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are state transition matrix and measurement matrix, respectively. Assuming that the elements composing these two matrices are <inline-formula><mml:math id="mm104" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm105" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively, the following correlations are obtained: <inline-formula><mml:math id="mm106" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>,<inline-formula><mml:math id="mm107" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:msubsup><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>&#x02211;</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm108" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x000a0;</mml:mo><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. The specific values of <inline-formula><mml:math id="mm109" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm110" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are chosen empirically. For EML and INS of common accuracy, the recommended values are: <inline-formula><mml:math id="mm111" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">F</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mn>0.4</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mn>0.4</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm112" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mn>0.5</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>. The initial values of <inline-formula><mml:math id="mm113" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm114" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are set by the technical index of inertial sensors in the INS and the measurement accuracy of the EML.</p><p>The recursive algorithm of the HMM model is similar to that of KF, as shown in the following equation:<disp-formula id="FD6-sensors-25-01015"><label>(4)</label><mml:math id="mm115" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>K</mml:mi></mml:mstyle><mml:mrow><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>K</mml:mi></mml:mstyle><mml:mrow><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm116" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the one-step prediction state variable; <inline-formula><mml:math id="mm117" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the gain matrix; <inline-formula><mml:math id="mm118" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the measurement noise matrix; <inline-formula><mml:math id="mm119" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm120" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are both one-step prediction variance matrices; <inline-formula><mml:math id="mm121" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the variance matrix; <inline-formula><mml:math id="mm122" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Q</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the system noise matrix. The above process and algorithm can be used to obtain <inline-formula><mml:math id="mm123" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> or <inline-formula><mml:math id="mm124" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>.</p></sec><sec id="sec2dot3-sensors-25-01015"><title>2.3. Pure Inertial Solution Algorithm</title><p>The pure inertial solution algorithm is basic knowledge in the field of inertial navigation. Hence, it is not elaborated on here. Next, we introduce the attitude angles used in this article. The attitude angle is defined as:<disp-formula id="FD7-sensors-25-01015"><label>(5)</label><mml:math id="mm125" display="block" overflow="scroll"><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi mathvariant="bold">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mi>&#x003c8;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>sin</mml:mi><mml:mi>&#x003c8;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mi>&#x003c8;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mi>&#x003c8;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>sin</mml:mi><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>sin</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000a0;</mml:mo><mml:mo>&#x000a0;</mml:mo><mml:mo>&#x000a0;</mml:mo><mml:mo>&#x000a0;</mml:mo><mml:mo>&#x000a0;</mml:mo><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mi>&#x003c8;</mml:mi><mml:mi>cos</mml:mi><mml:mi>&#x003b3;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>sin</mml:mi><mml:mi>&#x003c8;</mml:mi><mml:mi>sin</mml:mi><mml:mi>&#x003b8;</mml:mi><mml:mi>sin</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>sin</mml:mi><mml:mi>&#x003c8;</mml:mi><mml:mi>cos</mml:mi><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mi>&#x003c8;</mml:mi><mml:mi>sin</mml:mi><mml:mi>&#x003b3;</mml:mi><mml:mo>+</mml:mo><mml:mi>sin</mml:mi><mml:mi>&#x003c8;</mml:mi><mml:mi>sin</mml:mi><mml:mi>&#x003b8;</mml:mi><mml:mi>cos</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mi>&#x003c8;</mml:mi><mml:mi>cos</mml:mi><mml:mi>&#x003b3;</mml:mi><mml:mo>+</mml:mo><mml:mi>cos</mml:mi><mml:mi>&#x003c8;</mml:mi><mml:mi>sin</mml:mi><mml:mi>&#x003b8;</mml:mi><mml:mi>sin</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mi>&#x003c8;</mml:mi><mml:mi>cos</mml:mi><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mi>&#x003c8;</mml:mi><mml:mi>sin</mml:mi><mml:mi>&#x003b3;</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>cos</mml:mi><mml:mi>&#x003c8;</mml:mi><mml:mi>sin</mml:mi><mml:mi>&#x003b8;</mml:mi><mml:mi>cos</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>cos</mml:mi><mml:mi>&#x003b8;</mml:mi><mml:mi>sin</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>sin</mml:mi><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>cos</mml:mi><mml:mi>&#x003b8;</mml:mi><mml:mi>cos</mml:mi><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>As mentioned earlier, the geographic frame &#x0201c;East-North-Up (E-N-U)&#x0201d; is selected as the navigation frame of the INS, and it is denoted as the <italic toggle="yes">n</italic>-frame. The <italic toggle="yes">n</italic>-frame is obtained by rotating the <italic toggle="yes">b</italic>-frame with an angle of <inline-formula><mml:math id="mm126" overflow="scroll"><mml:mrow><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:math></inline-formula> around the <italic toggle="yes">y</italic>-axis, then <inline-formula><mml:math id="mm127" overflow="scroll"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:math></inline-formula> around the <italic toggle="yes">x</italic>-axis, and next <inline-formula><mml:math id="mm128" overflow="scroll"><mml:mrow><mml:mi>&#x003c8;</mml:mi></mml:mrow></mml:math></inline-formula> around the <italic toggle="yes">z</italic>-axis.</p><p>Then, the attitude differential equation with the <italic toggle="yes">n</italic>-frame as the frame is: <inline-formula><mml:math id="mm129" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mfenced><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x000d7;</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>, where matrix <inline-formula><mml:math id="mm130" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> represents the attitude conversion matrix from the <italic toggle="yes">b</italic>-frame to <italic toggle="yes">n</italic>-frame. The symbol <inline-formula><mml:math id="mm131" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mi>D</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, such as <inline-formula><mml:math id="mm132" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, denotes the projection of motion vector <italic toggle="yes">A</italic> of frame <italic toggle="yes">C</italic> with respect to frame <italic toggle="yes">B</italic> in frame <italic toggle="yes">D</italic>. <inline-formula><mml:math id="mm133" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x000d7;</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is an antisymmetric matrix expanded from vector <inline-formula><mml:math id="mm134" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Since the output of the gyro is the angular velocity <inline-formula><mml:math id="mm135" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> of the b-frame with respect to the i-frame, and angular velocity vector <inline-formula><mml:math id="mm136" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> cannot be directly measured, the following transformation is required: <inline-formula><mml:math id="mm137" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mfenced><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x000d7;</mml:mo></mml:mrow></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mfenced><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x000d7;</mml:mo></mml:mrow></mml:mfenced><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="mm138" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> denotes the rotation of the <italic toggle="yes">n</italic>-frame with respect to the <italic toggle="yes">i</italic>-frame, which contains two components: the rotation of the <italic toggle="yes">n</italic>-frame caused by the earth&#x02019;s rotation and the rotation of the <italic toggle="yes">n</italic>-frame due to the curvature of the earth&#x02019;s surface as the INS moves near the earth&#x02019;s surface. Hence, we can obtain: <inline-formula><mml:math id="mm139" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm140" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="italic">cos</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="italic">sin</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm141" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mi mathvariant="italic">tan</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="mm142" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the angular velocity of the earth&#x02019;s rotation, <inline-formula><mml:math id="mm143" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> = 7.292115 &#x000d7; 10<sup>&#x02212;5</sup> rad/s, and <inline-formula><mml:math id="mm144" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm145" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi></mml:mrow></mml:math></inline-formula> are the geographic latitude and altitude, respectively (for AUV, <italic toggle="yes">h</italic> is generally taken as a negative value, representing the depth of descent relative to the horizontal plane). In this paper, we chose a three-sample algorithm to solve the equation about <inline-formula><mml:math id="mm146" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. The following presents the specific force equation for solving the velocity and position, as shown: <inline-formula><mml:math id="mm147" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>sf</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:mfenced><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>&#x000d7;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="mm148" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>f</mml:mi><mml:mrow><mml:mi>sf</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the specific force measured by the accelerometer; <inline-formula><mml:math id="mm149" overflow="scroll"><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x000d7;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the Coriolis acceleration generated due to the vehicle&#x02019;s motion and the earth&#x02019;s rotation; <inline-formula><mml:math id="mm150" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x000d7;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the centripetal acceleration to earth due to the vehicle&#x02019;s motion; <inline-formula><mml:math id="mm151" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is the gravitational acceleration; <inline-formula><mml:math id="mm152" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mfenced><mml:mrow><mml:mn>2</mml:mn><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>&#x000d7;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> is collectively denoted as the detrimental acceleration. The specific force equation about <inline-formula><mml:math id="mm153" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> shows that the geometric motion acceleration <inline-formula><mml:math id="mm154" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> of the AUV in the <italic toggle="yes">n</italic>-frame can be obtained only after the detrimental acceleration is deducted from the accelerometer output. Velocity can be obtained by integrating the acceleration once and the position once more. Therefore, the specific force equation is the basic equation for the inertial navigation solution.</p><p>The differential equations for the position (latitude, longitude, and altitude) of the INS are as follows: <inline-formula><mml:math id="mm155" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>L</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:msubsup><mml:mi>v</mml:mi><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mover><mml:mrow><mml:mo>&#x000a0;</mml:mo><mml:mi>&#x003bb;</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">sec</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:msubsup><mml:mi>v</mml:mi><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mover><mml:mrow><mml:mo>&#x000a0;</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>U</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. We can rewrite them in matrix form as: <inline-formula><mml:math id="mm156" overflow="scroll"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="mm157" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>L</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>&#x003bb;</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>h</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm158" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="italic">sec</mml:mi><mml:mi>L</mml:mi><mml:mo>/</mml:mo><mml:mfenced><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula>. In which, <inline-formula><mml:math id="mm159" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the mean radius of the earth, and value <inline-formula><mml:math id="mm160" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> = 6,378,137 m can be taken. The above equation is the one used in the pure inertia solution.</p></sec><sec id="sec2dot4-sensors-25-01015"><title>2.4. Integrated Navigation Algorithm Based on CNLKF</title><p>In the following, the CNLKF model is discussed. We define the state vector <bold>X</bold> as follows: <inline-formula><mml:math id="mm161" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>U</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003d5;</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003d5;</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003d5;</mml:mi><mml:mi>U</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mi>U</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mo>&#x02207;</mml:mo><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mo>&#x02207;</mml:mo><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mo>&#x02207;</mml:mo><mml:mi>U</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. Here, <inline-formula><mml:math id="mm162" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003d5;</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm163" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003d5;</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm164" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003d5;</mml:mi><mml:mi>U</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote the attitude error in east, north, and up directions. <inline-formula><mml:math id="mm165" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm166" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm167" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi>U</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote the velocity error in the east, north, and up directions. <inline-formula><mml:math id="mm168" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mi>&#x003bb;</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm169" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm170" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> denote the errors of longitude, latitude, and altitude. <inline-formula><mml:math id="mm171" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm172" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm173" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b5;</mml:mi><mml:mi>U</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote constant zero biases of the gyro. <inline-formula><mml:math id="mm174" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mo>&#x02207;</mml:mo><mml:mi>E</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm175" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mo>&#x02207;</mml:mo><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm176" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mo>&#x02207;</mml:mo><mml:mi>U</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> denote zero biases of the accelerometer.</p><p>The discrete LKF model of the integrated navigation system covered in this paper is shown as follows:<disp-formula id="FD8-sensors-25-01015"><label>(6)</label><mml:math id="mm177" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">&#x003a6;</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">&#x00393;</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="mm178" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm179" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm180" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003a6;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm181" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x00393;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm182" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are the state vector, measurement vector, one-step transition state matrix, system noise assignment matrix, and measurement matrix, respectively. All these variables/parameters can be obtained by discretizing the time-continuous variables/parameters. Discrete period (<italic toggle="yes">T</italic>) is generally consistent with the sampling period of IMU, taken as 1&#x02013;10 ms (5 ms is chosen in this article). While discretizing, the truncation term is generally taken to be 3rd or 5th order. <inline-formula><mml:math id="mm183" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003a6;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm184" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x00393;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>/</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are easy to find in textbooks for major inertial navigation. In the following CNLKF algorithm, <inline-formula><mml:math id="mm185" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm186" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">H</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are introduced. The EML is usually mounted on the head of the AUV, with its head exposed out of the AUV&#x02019;s shell. The three axes of the EML form a reference frame called <italic toggle="yes">em</italic>-frame. The moving velocity of the AUV is measured by the EML in <italic toggle="yes">em</italic>-frame. The projection of the velocity vector <inline-formula><mml:math id="mm187" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> measured by the EML in the <italic toggle="yes">n</italic>-frame is shown as follows:<disp-formula id="FD9-sensors-25-01015"><label>(7)</label><mml:math id="mm188" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi mathvariant="bold">v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm189" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is calculated as <inline-formula><mml:math id="mm190" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="mm191" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is measured velocity by the EML along the y-axis of the em-frame. <inline-formula><mml:math id="mm192" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is calculated by <inline-formula><mml:math id="mm193" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="mm194" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the attitude transition matrix between the em-frame and b-frame. The three installation error angles between the em-frame and b-frame can be guaranteed to be small by the precision installation of EML. <inline-formula><mml:math id="mm195" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is approximately equal to the unit matrix. Therefore, there is a correlation: <inline-formula><mml:math id="mm196" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02248;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. Each time the EML is installed, <inline-formula><mml:math id="mm197" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> needs to be accurately calibrated by voyaging the trial to obtain installation error angles, which are compensated by Equation (7). In this paper, it is assumed that the mounting error angles are obtained by precise calibration experiments. Hence, <inline-formula><mml:math id="mm198" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>m</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is known. If the measurement errors are considered, the following correlations are given:<disp-formula id="FD10-sensors-25-01015"><label>(8a)</label><mml:math id="mm199" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo stretchy="false">&#x002dc;</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>b</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="FD11-sensors-25-01015"><label>(8b)</label><mml:math id="mm200" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The superscript &#x0201c;<inline-formula><mml:math id="mm201" overflow="scroll"><mml:mrow><mml:mo>~</mml:mo></mml:mrow></mml:math></inline-formula>&#x0201d; above the equations represents the measurement of a vector. <inline-formula><mml:math id="mm202" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm203" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> are defined in the previous Equation (2a). <inline-formula><mml:math id="mm204" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the real velocity reference to water of the AUV, as shown in the following equation:<disp-formula id="FD12-sensors-25-01015"><label>(8c)</label><mml:math id="mm205" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>b</mml:mi></mml:msup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>C</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p><inline-formula><mml:math id="mm206" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is the measurement error of the EML, which satisfies the constraint shown in Equation (8d):<disp-formula id="FD13-sensors-25-01015"><label>(8d)</label><mml:math id="mm207" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mover accent="true"><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The <italic toggle="yes">n</italic>-frame for calculation is denoted as the <italic toggle="yes">n</italic>&#x02032;-frame. If the calculation error of <inline-formula><mml:math id="mm208" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> in Equation (7) is considered, then it is obtained that:<disp-formula id="FD14-sensors-25-01015"><label>(9a)</label><mml:math id="mm209" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>n</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:mo mathvariant="bold">&#x003d5;</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="FD15-sensors-25-01015"><label>(9b)</label><mml:math id="mm210" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>n</mml:mi><mml:msup><mml:mi>n</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:msubsup><mml:mo>&#x02248;</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:mo mathvariant="bold">&#x003d5;</mml:mo><mml:mo>&#x000d7;</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The superscript &#x0201c;^&#x0201d; in the equations indicates the calculated value. <inline-formula><mml:math id="mm211" overflow="scroll"><mml:mrow><mml:mi>&#x003d5;</mml:mi></mml:mrow></mml:math></inline-formula> is the misalignment angle vector. With these above correlations, it is possible to derive correlations for <inline-formula><mml:math id="mm212" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> as follows:<disp-formula id="FD16-sensors-25-01015"><label>(10)</label><mml:math id="mm213" display="block" overflow="scroll"><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>&#x002dc;</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:mo mathvariant="bold">&#x003d5;</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x02248;</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">&#x003d5;</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">&#x003d5;</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>The small second-order term <inline-formula><mml:math id="mm214" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced><mml:mrow><mml:mi>&#x003d5;</mml:mi><mml:mo>&#x000d7;</mml:mo></mml:mrow></mml:mfenced><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> can be neglected. Therefore, the velocity error vector caused by calculated error of <inline-formula><mml:math id="mm215" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> can be expressed as follows:<disp-formula id="FD17-sensors-25-01015"><label>(11)</label><mml:math id="mm216" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo mathvariant="bold">&#x003d5;</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mrow><mml:mi>E</mml:mi><mml:mi>M</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The above equation shows that the velocity error contains not only the measurement error described by the measurement noise, but also the SINS misalignment angle described by the process noise and the variance of state variables. In this way, the measurement noise is coupled into process noise (as shown as follows in Equation (12)):<disp-formula id="FD18-sensors-25-01015"><label>(12)</label><mml:math id="mm217" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:mi>j</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>Cross</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm218" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is the Kronecker symbol defined as follows:<disp-formula id="FD19-sensors-25-01015"><label>(13)</label><mml:math id="mm219" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b4;</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02260;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>For traditional LKF, the assumption that the measurement noise and process noise are independent of each other no longer holds. When such cross-coupling noise is obvious and it is unreasonably ignored, the accuracy of integrated navigation will be low. The prediction error of the state vector, estimation error of the state vector, and prediction error of the measurement vector are defined as <inline-formula><mml:math id="mm220" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm221" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm222" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, respectively. Subsequently, the variance and covariance can be calculated according to the following procedure. The covariance of predictions of the state vector and the measurement noise can be constructed as:<disp-formula id="FD20-sensors-25-01015"><label>(14)</label><mml:math id="mm223" display="block" overflow="scroll"><mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>v</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a6;</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a6;</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a6;</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">&#x002dc;</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>W</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>V</mml:mi></mml:mstyle><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>The variance of the prediction of the state vector can be erected as:<disp-formula id="FD21-sensors-25-01015"><label>(15)</label><mml:math id="mm224" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a6;</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>&#x003a6;</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The covariance of the prediction of the state vector and measurement vector can be set up as:<disp-formula id="FD22-sensors-25-01015"><label>(16)</label><mml:math id="mm225" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The variance of prediction of the measurement vector is shown as:<disp-formula id="FD23-sensors-25-01015"><label>(17)</label><mml:math id="mm226" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The gain matrix can be constructed as follows:<disp-formula id="FD24-sensors-25-01015"><label>(18)</label><mml:math id="mm227" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>K</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The variance of the state vector can be set up as:<disp-formula id="FD25-sensors-25-01015"><label>(19)</label><mml:math id="mm228" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mfenced><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>K</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>I</mml:mi></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>K</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>K</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>K</mml:mi></mml:mstyle><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Here, <inline-formula><mml:math id="mm229" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm230" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are similar to <inline-formula><mml:math id="mm231" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm232" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in standard LKF. Equations (15)&#x02013;(19) constitute LKF for handling cross-coupling noise. In this filter, <inline-formula><mml:math id="mm233" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm234" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are calculated in the same way as conventional LKF. The difference between CNLKF (as shown by Equations (15)&#x02013;(19)) and standard LKF shows that the introduced cross-coupling noise will affect <inline-formula><mml:math id="mm235" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm236" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm237" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, but it has no effect on <inline-formula><mml:math id="mm238" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm239" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">P</mml:mi><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. In conventional LKF, <inline-formula><mml:math id="mm240" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> determines the estimation accuracy of <inline-formula><mml:math id="mm241" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm242" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, while <inline-formula><mml:math id="mm243" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm244" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are used to estimate <inline-formula><mml:math id="mm245" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>. In Equation (18), cross-noise term <inline-formula><mml:math id="mm246" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> appears in both the numerator and denominator. In conventional LKF, the noise term <inline-formula><mml:math id="mm247" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> appears only in the denominator, and the effect of <inline-formula><mml:math id="mm248" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is not considered. The method shown in Equation (18) is in principle more reasonable and more accurate.</p><p>Based on the state vector <inline-formula><mml:math id="mm249" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and the measurement vector <inline-formula><mml:math id="mm250" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">Z</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> described above, the cross-noise term <inline-formula><mml:math id="mm251" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> in Equation (12) is a non-negative definite matrix whose dimension is 15 &#x000d7; 3. As described in this section, the attitude misalignment angle will result in an error of the projected velocity. The expression of <inline-formula><mml:math id="mm252" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is:<disp-formula id="FD26-sensors-25-01015"><label>(20a)</label><mml:math id="mm253" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mn>33</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mn>12</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm254" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mn>11</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm255" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm256" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi><mml:mn>33</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are cross-coupling values. In the following, the setting of initial values of the CNLKF is discussed. Based on the factory report of the inertial sensor in our experiment, the zero bias of the gyro (accelerometer) is 0.008&#x000b0;/h (20 &#x003bc;g). The initial position of the AUV is 110.42296&#x000b0; longitude and 21.23709&#x000b0; latitude. In general, the velocity measurement error of the EML is less than 0.1 m/s. The measurement noise of the EML set in this algorithm is (0.1 m/s)<sup>2</sup>, and the cross-coupling value is (0.02 m/s)<sup>2</sup>. Based on experience, the initial values and parameters of the CNLKF are set as shown in Equation (20b).<disp-formula id="FD27-sensors-25-01015"><label>(20b)</label><mml:math id="mm257" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mi>T</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>P</mml:mi></mml:mstyle><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.25</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.25</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.25</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>7.62</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>7.62</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>3.048</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>9.85</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>9.85</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>2.12</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>2.12</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>2.12</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mn>8.64</mml:mn></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mn>8.64</mml:mn></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mn>8.64</mml:mn></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Q</mml:mi></mml:mstyle><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mn>3.84</mml:mn></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mn>3.84</mml:mn></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mrow><mml:mn>3.84</mml:mn></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1.95</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1.95</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1.95</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>2.28</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>2.28</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:mi>rad</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.01</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="false">]</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.01</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.01</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.01</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>4.0</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>4.0</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>4.0</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mn>12</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Since this algorithm dose not employ adaptive LKF and does not consider variations of <bold>R</bold><italic toggle="yes"><sub>k</sub></italic> and <bold>Q</bold><italic toggle="yes"><sub>k</sub></italic> during recursion process, it is assumed that <bold>R</bold><italic toggle="yes"><sub>k</sub></italic> = <bold>R</bold><sub>0</sub>, <bold>Q</bold><italic toggle="yes"><sub>k</sub></italic> = <bold>Q</bold><sub>0</sub>.</p><p>While the AUV is sailing underwater, it receives only the measured velocity from the EML. The INS performs CNLKF (FOF), and it works in the integrated mode of INS/HMM (or INS/EML). The observation vector in such a mode is as follows:<disp-formula id="FD28-sensors-25-01015"><label>(21)</label><mml:math id="mm258" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>U</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>U</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm259" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is calculated as follows: <inline-formula><mml:math id="mm260" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. The specific calculation process for the ocean current velocity <inline-formula><mml:math id="mm261" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is presented in the previous <xref rid="sensors-25-01015-f001" ref-type="fig">Figure 1</xref>. The ocean current velocity is obtained by subtracting the velocity vector output by the MALKF from the velocity vector output by the HMM after coordinate transformation, and <inline-formula><mml:math id="mm262" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> is calculated as follows: <inline-formula><mml:math id="mm263" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="mm264" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> contains three components: <inline-formula><mml:math id="mm265" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msubsup><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>U</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. The measurement matrix is as follows:<disp-formula id="FD29-sensors-25-01015"><label>(22)</label><mml:math id="mm266" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Before performing the first GNSS-based calibration, Equations (21) and (22) are used as the observation equations for integrated navigation. The above equations in this section are the model and calculation formula of CNLKF.</p><p>Therefore, for the parameters <bold>X</bold><sub>0</sub>, <bold>P</bold><sub>0</sub>, <bold>Q</bold><sub>k</sub>, and <bold>R</bold><sub>k</sub> of conventional LKF, the setting of initial values is basically the same as Equation (20b), except that <inline-formula><mml:math id="mm267" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is replaced by the following expression:<disp-formula id="FD30-sensors-25-01015"><label>(23)</label><mml:math id="mm268" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mn>15</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p></sec><sec id="sec2dot5-sensors-25-01015"><title>2.5. MALKF-Based GNSS-Based Calibration Algorithm</title><p>In traditional LKF, the fixed system noise and measurement noise variance matrix is generally used. The large/small measurement noise represents low/high reliability of measurement. When the AUV is on the water surface, the stability of the GNSS signal is poor due to the influence of waves, wind, and currents. Occasionally, the measurement noise changes dramatically. In this case, the conventional processing method of fixed measurement noise signifies a large error of integrated navigation. The actual GNSS noise is much larger than the setting constant value of <bold>R</bold><sub>0</sub>. To ensure the accuracy of integrated navigation, the measurement noise is required to be automatically adjusted during filtering based on real-time measurement. In this paper, an innovative MALKF is employed for GNSS-based calibration to solve the problems of the unstable GNSS signal and the outliers. The algorithm estimates the measurement noise in real time based on an innovation sequence. The innovation sequence is defined as:<disp-formula id="FD31-sensors-25-01015"><label>(24)</label><mml:math id="mm269" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mo mathvariant="bold">&#x003b5;</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">Z</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">V</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The KF is optimal choice when innovation sequence is zero-mean Gaussian white noise. Taking the variance on both sides of the above equation, it is obtained that:<disp-formula id="FD32-sensors-25-01015"><label>(25)</label><mml:math id="mm270" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mo mathvariant="bold">&#x003b5;</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mo mathvariant="bold">&#x003b5;</mml:mo><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">P</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold">H</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Thus, the measurement noise <bold><italic toggle="yes">R</italic></bold><italic toggle="yes"><sub>k</sub></italic> can be obtained with the innovation sequence, as shown by Equation (26).<disp-formula id="FD33-sensors-25-01015"><label>(26)</label><mml:math id="mm271" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:msub><mml:mo mathvariant="bold">&#x003b5;</mml:mo><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mo mathvariant="bold">&#x003b5;</mml:mo><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="bold">H</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">P</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold">H</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Only elements on the diagonal are retained in the calculation. In practice, a moving data window is usually employed online to estimate the measurement noise, and the average of the previous <italic toggle="yes">m</italic> moments of measurement noise is set as the current noise:<disp-formula id="FD34-sensors-25-01015"><label>(27)</label><mml:math id="mm272" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>m</mml:mi></mml:mfrac></mml:mstyle><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>In the above equation, <italic toggle="yes">m</italic> is the length of the moving average window. If GNSS&#x02019;s measurement is abnormal, it switches to be MALKF described above. The overall algorithm process of this filtering is shown in <xref rid="sensors-25-01015-f003" ref-type="fig">Figure 3</xref>. When GNSS data are normal, the INS works in the mode of an ordinary LKF and uses the moving data window to estimate measurement noise in real time. When the GNSS data are judged to be abnormal by <italic toggle="yes">&#x003c7;</italic><sup>2</sup>-test, it switches to the adaptive filtering mode to reduce the impact of outliers from the GNSS on the accuracy of integrated navigation.</p><p><xref rid="sensors-25-01015-f003" ref-type="fig">Figure 3</xref> shows the detailed flow chart of MALKF. As shown in the figure, the adaptive LKF operation is performed when the GNSS measurement is anomalous, and the conventional LKF operation is conducted when the GNSS measurement is normal. It can greatly improve the stability and robustness of KF during GNSS-based calibration. Even the outlier from GNSS does not cause a large positioning error or large estimation error of current speed. In order to ensure the stability of KF, it switches to the adaptive LKF only when an abnormal GNSS measurement is reliably identified by the <italic toggle="yes">&#x003c7;</italic><sup>2</sup>-test.<disp-formula id="FD35-sensors-25-01015"><label>(28)</label><mml:math id="mm273" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="bold">H</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold">P</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mi mathvariant="bold">H</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The parameter <inline-formula><mml:math id="mm274" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> is introduced to describe whether the GNSS measurement is an outlier, as shown in Equation (29a):<disp-formula id="FD36-sensors-25-01015"><label>(29a)</label><mml:math id="mm275" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo mathvariant="bold">&#x003b5;</mml:mo><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">A</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo mathvariant="bold">&#x003b5;</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm276" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003b3;</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> satisfies <inline-formula><mml:math id="mm277" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mi>&#x003c7;</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>-distribution, as shown in the following equation:<disp-formula id="FD37-sensors-25-01015"><label>(29b)</label><mml:math id="mm278" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>abnormal</mml:mi><mml:mo>:</mml:mo><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="normal">normal</mml:mi><mml:mo>:</mml:mo><mml:mi>&#x003b3;</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The parameter <italic toggle="yes">T<sub>D</sub></italic> can be set according to the rate of false alarm.</p><p>When the AUV on the water surface can receive both measurements from the GNSS (position) and EML (velocity), INS performs MALKF (SOF). In this case, the INS works in the integrated mode of INS/GNSS/EML (or INS/GNSS/HMM). The observation vector in such a mode is as follows:<disp-formula id="FD38-sensors-25-01015"><label>(30)</label><mml:math id="mm279" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>Z</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>U</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:msup><mml:mi>v</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>U</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="FD39-sensors-25-01015"><label>(31)</label><mml:math id="mm280" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>H</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mn>0</mml:mn></mml:mstyle><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm281" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm282" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mfenced><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></inline-formula> are the three velocity components in the <italic toggle="yes">n</italic>-frame output from HMM and INS, respectively. The vector <inline-formula><mml:math id="mm283" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> has three components <inline-formula><mml:math id="mm284" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, which are obtained by multiplying the vector <inline-formula><mml:math id="mm285" overflow="scroll"><mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mrow><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>&#x02032;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula> by the matrix <inline-formula><mml:math id="mm286" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mi>b</mml:mi><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="mm287" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm288" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm289" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mi>G</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are the longitude and latitude from GNSS, and the depth from DG, respectively. <inline-formula><mml:math id="mm290" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mi>INS</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm291" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm292" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> are longitude, latitude, and depth calculated by INS. <inline-formula><mml:math id="mm293" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm294" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> corresponding to Equations (30) and (31) are:<disp-formula id="FD40-sensors-25-01015"><label>(32a)</label><mml:math id="mm295" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi><mml:mi>g</mml:mi><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.01</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.01</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.01</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>9</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>9</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>9</mml:mn><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula><disp-formula id="FD41-sensors-25-01015"><label>(32b)</label><mml:math id="mm296" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>R</mml:mi></mml:mstyle><mml:mrow><mml:mi>C</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>4.0</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mn>4.0</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:mn>4.0</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000a0;</mml:mo><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mn>0</mml:mn><mml:mrow><mml:mn>3</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd><mml:mtd><mml:mo>&#x000a0;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>The rest of the initial values of MALKF are consistent with those in Equation (20b).</p><p><xref rid="sensors-25-01015-f004" ref-type="fig">Figure 4</xref> shows a simplified flow chart of MALKF. This process is the core part of the complete process shown in <xref rid="sensors-25-01015-f001" ref-type="fig">Figure 1</xref>. In <xref rid="sensors-25-01015-f004" ref-type="fig">Figure 4</xref>, <inline-formula><mml:math id="mm297" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mi>K</mml:mi><mml:mi>F</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>&#x02248;</mml:mo><mml:msup><mml:mi mathvariant="bold-italic">v</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mrow></mml:math></inline-formula>. This means that the output of MALKF is regarded as the real velocity vector in the <italic toggle="yes">n</italic>-frame.</p></sec><sec id="sec2dot6-sensors-25-01015"><title>2.6. Feedback Correction Algorithm</title><p>The accuracy of velocity and position from pure inertial reckoning can be improved by substituting the ground velocity from the SOF into the Specific Force Equation (10) and related elements of the LKF model. This modified LKF model can be applied in CNLKF or MALKF. The accuracy of the attitude angle from the pure inertial solution can be improved by substituting <inline-formula><mml:math id="mm298" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm299" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> into the attitude angle updating process and related elements of LKF. <inline-formula><mml:math id="mm300" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm301" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003c9;</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mrow></mml:mrow></mml:math></inline-formula> can be calculated by Equation (33).<disp-formula id="FD42-sensors-25-01015"><label>(33)</label><mml:math id="mm302" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mfenced close="" open="{"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mo>&#x003c9;</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mi>cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mi>sin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mi>T</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>&#x003b4;</mml:mi><mml:msubsup><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mo>&#x003c9;</mml:mo></mml:mstyle><mml:mrow><mml:mi>e</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>&#x02212;</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi></mml:mrow><mml:mo>&#x02032;</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mi>tan</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>I</mml:mi><mml:mi>N</mml:mi><mml:mi>S</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mi>tan</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b4;</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mi>T</mml:mi></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula></p><p>Here, latitude <italic toggle="yes">L</italic> is from second-order LKF. Highly accurate pure inertial solution implies stable and fast converge of the CNLKF/MALKF recursion.</p><p>The above <xref rid="sec2dot2-sensors-25-01015" ref-type="sec">Section 2.2</xref>, <xref rid="sec2dot3-sensors-25-01015" ref-type="sec">Section 2.3</xref>, <xref rid="sec2dot4-sensors-25-01015" ref-type="sec">Section 2.4</xref>, <xref rid="sec2dot5-sensors-25-01015" ref-type="sec">Section 2.5</xref> and <xref rid="sec2dot6-sensors-25-01015" ref-type="sec">Section 2.6</xref> constitute the complete calculation process of this algorithm. The detailed process is as follows: After receiving forward velocity from the INS and velocity through water from the EML, we fuse the velocities by HMM. The denoised velocity through water can be obtained. By inputting the denoised velocity through water into the first-order KF, the navigation parameters can be obtained. After receiving the position from the GNSS, we input the position and results from the FOF into the SOF, and the navigation parameters of the SOF can be obtained. The current velocity can be estimated by subtracting ground velocity by the SOF from velocity through water. By feeding the current velocity back to the HMM to compensate the velocity through water, the compensated velocity (ground velocity) can be obtained. The compensated velocity, which is defined as velocity compensated by the estimated current speed, is approximately equal to the ground speed. The navigation parameters from SOF and compensated velocity are employed for feedback correction to obtain highly accurate navigation parameters. The five core modules of the detailed process (shown in <xref rid="sensors-25-01015-f001" ref-type="fig">Figure 1</xref> above) are given in <xref rid="sensors-25-01015-f005" ref-type="fig">Figure 5</xref>.</p></sec></sec><sec id="sec3-sensors-25-01015"><title>3. Experimental and Simulation Test</title><p>The algorithm is verified by conducting a sea trial of the AUV in the sea. In this experiment, a small-sized tail rotor propelled AUV is employed and its layout is shown in <xref rid="sensors-25-01015-f006" ref-type="fig">Figure 6</xref>, where ICS and FLS are the integrated control system and forward-looking sonar, respectively. The head of the AUV is equipped with EML and FLS for velocity measurement and obstacle avoidance, respectively, and ICS is located in the anterior half segment of the AUV. In order to avoid the virtual linear velocity caused by the lever arm effect and the AUV&#x02019;s rotation, the INS is installed at the rotation center of the AUV. Virtual linear velocity induces navigation effect. The battery is located in the posterior half part of the AUV, and the propulsion motor is located in the rear section. A propeller is installed at the last end of the AUV. A guidance rudder plate is installed on the abdomen of the rear part of the AUV, and two guidance rudder plates are installed on the two sides of the AUV&#x02019;s rear section (only one is shown in <xref rid="sensors-25-01015-f006" ref-type="fig">Figure 6</xref>). A fin stabilizer is mounted on the top of the rear section, and a GNSS receiver (antenna and circuit board) is mounted on top of the fin stabilizer. A position-indicating light is mounted on top of the AUV&#x02019;s front section. The navigation system mainly consists of the EML, the fiber optic gyro (FOG)-based INS, and the GNSS. The GNSS consists of an antenna and circuit board. The circuit board is installed below the GNSS antenna in the receiver. The zero biases and gyro random walks of accelerometers in the INS are described in the previous <xref rid="sec2dot4-sensors-25-01015" ref-type="sec">Section 2.4</xref>. The velocity measurement error of this EML is less than &#x000b1;0.1 kn (1 kn = 1.852 km/h) or &#x000b1;1% <italic toggle="yes">V</italic> (<italic toggle="yes">V</italic> is the actual speed of the AUV, and the larger of two errors is taken). The positioning error of GNSS is &#x02264;3 m, and the velocity measurement error of the GNSS is &#x02264;0.2 m/s. Photos of the testing field are shown in <xref rid="sensors-25-01015-f007" ref-type="fig">Figure 7</xref>a,b. <xref rid="sensors-25-01015-f007" ref-type="fig">Figure 7</xref>a shows the deployment of the AUV. <xref rid="sensors-25-01015-f007" ref-type="fig">Figure 7</xref>b is a photograph of the AUV sailing on the water surface. In order to preserve the accurate positions of the sampling points on the AUV&#x02019;s trajectory as a reference, the AUV voyages on the water surface throughout the test so that GNSS signals can be received in real time, as shown in <xref rid="sensors-25-01015-f008" ref-type="fig">Figure 8</xref>, and the GNSS antenna of the AUV is always above the water surface while the AUV is moving. In order to study the accuracy of the INS/EML-integrated mode, GNSS measurements are not applied in this mode, and they are only used as benchmarks to calculate the positioning errors. Only when GNSS-based calibration is conducted, GNSS information is input into MALKF as a measurement, and then the integrated navigation system is in the INS/GNSS/EML mode. The frequency of GNSS-based calibration is once every 25 min. When GNSS-based calibration is performed, GNSS measurement is input into MALKF for calibration. Due to the powerful calculation capability of the navigation circuit board, the moment that a valid GNSS measurement is received is the moment that calibration begins, and the time spent by one calibration is in the order of ms. The first GNSS-based calibration is performed at the start-point of the trajectory. In this experiment, the data update periods of the gyro and accelerometer of INS, EML, and GNSS are 5 ms, 1 s, and 1 s. Therefore, the period of pure inertial solution is 5 ms. The time update period of CNLKF/MALKF is 5 ms. The measurement update periods of the EML and GNSS are 1 s and 25 min.</p><p><xref rid="sensors-25-01015-f007" ref-type="fig">Figure 7</xref>a shows a photograph of the test site of the deployment of the AUV. The crane on the working mother ship is employed to lift and put the AUV on the water&#x02019;s surface, and the crane ring is located near the center of the AUV. <xref rid="sensors-25-01015-f007" ref-type="fig">Figure 7</xref>b shows a photo of the AUV voyaging on the water surface. As analyzed above, the GNSS antenna is kept above the water surface during the sailing.</p><p><xref rid="sensors-25-01015-f008" ref-type="fig">Figure 8</xref> shows a schematic diagram of the AUV moving on the surface of the water. In the experiment, the depth of the AUV is precisely controlled, keeping the AUV&#x02019;s position-indicating light and GNSS antenna above the water surface. Compared with the AUV&#x02019;s main body, the position indicating light, fins, and GNSS antenna are small, and they are far away from the EML. Hence, their disturbances to the water current near the EML can be negligible during the experiment. The current velocity estimated by the EML&#x02019;s measurement and proposed algorithm is the velocity of the current near the water surface. Therefore, the measurements obtained from buoys can be used as benchmarks to calculate the error of estimating current speed. When the AUV is moving with high maneuverability or high speed or impacted by strong wind/wave, the GNSS antenna will be below water surface, and some outliers of the GNSS measurement may appear. Therefore, we utilize MALKF, which is more advanced than conventional LKF, for the fusion of the GNSS measurement.</p><p>Physical photos of the shell of the INS, the internal structure of the INS, and the EML are shown in <xref rid="sensors-25-01015-f009" ref-type="fig">Figure 9</xref>a&#x02013;c. The FOG-based INS is selected. The arrow in <xref rid="sensors-25-01015-f009" ref-type="fig">Figure 9</xref>a points to the heading of the AUV. The INS contains three FOGs, three quartz flexible accelerometers, and the navigation circuit board. <xref rid="sensors-25-01015-f009" ref-type="fig">Figure 9</xref>b shows the three orthogonally mounted gyros in the IMU. The EML (shown in <xref rid="sensors-25-01015-f009" ref-type="fig">Figure 9</xref>c) is mounted at the center hole of the AUV&#x02019;s front cover. The velocity measurement of the EML is input into the INS for integrated navigation.</p><p>The experimental process is introduced as follows. After the AUV is placed on the water surface, the INS begins to align. After the alignment is completed, a calibration by GNSS is performed, and the AUV begins its sea trial. The point of GNSS-based calibration is the starting point of this trajectory. The AUV voyages for about 3825 s. Then, the AUV selects a new starting point and performs GNSS-based calibration to start a new voyage. The above processes are repeated, and a total of six voyages are conducted. This article selects the first of six voyagesfor analysis and discussion.</p><p>As analyzed above, in order to obtain accurate current speed as a benchmark, we utilize buoys for the accurate measurements of speed of current of water layer near the surface. <xref rid="sensors-25-01015-f010" ref-type="fig">Figure 10</xref>a shows a schematic diagram of a buoy structure. The buoy contains a drifting float above the water surface, an underwater fabric sail, and a steel cable connecting the float and fabric sail. The underwater fabric sail is designed to improve the attitude stability of the float. All the mass, shape, volume, and fluid properties are optimized to ensure the attitude stability of the float without dragging the float (ensuring that the speed of float is equal to that of the surface current). The underwater sail consists of a halyard, four traction ropes, and a main body, whose material is nylon. The photo shown in <xref rid="sensors-25-01015-f010" ref-type="fig">Figure 10</xref>b shows instruments and sensors inside a floating ball, including: the Iridium communication module, battery pack, the GNSS module (Beidou/GPS 2-in-1), the temperature sensor, and the controller. The measurements of temperature and position/velocity by GNSS are transmitted back to the server by the Iridium communication system, with a data integrity rate &#x02265; 98% and GNSS update period of 1 s. From these data, the speed and direction of the current and temperature of the water surface can be deduced. The velocity error of GNSS inside the buoy is &#x02264;0.1 m/s, and the positioning error is &#x02264;2 m. Therefore, the current speed measured by the buoy can be considered accurate. In this test, 13 buoys are placed near the trajectory of AUV at approximately 1 km intervals for measurement. Accurate current speed is obtained from real-time measurement of the closest buoy to the AUV. The buoys are put into the water by the mother ship. Since the depth of the AUV&#x02019;s central axis is approximately 400 m, the variation in current velocity with depth is generally very slow. Our extensive current velocity testing in this water body indicates that the velocity difference between the surface currents and the currents at the depth of the AUV&#x02019;s central axis typically does not exceed 0.03 m/s. Hence, the current speed measured by the buoy is almost equal to that of water layer where the AUV is located.</p><p><xref rid="sensors-25-01015-f011" ref-type="fig">Figure 11</xref>a&#x02013;c shows the velocity measured by EML, the velocity after HMM processing, the position (longitude and latitude) measured by GNSS, and the local zoom of the measured position during the whole cruise, respectively. During the sailing of the AUV, the input power and rotational speed of propulsion motor remain stable. Hence, average velocity through the water of the AUV is stable. This is evident in <xref rid="sensors-25-01015-f011" ref-type="fig">Figure 11</xref>a. From <xref rid="sensors-25-01015-f011" ref-type="fig">Figure 11</xref>a, it can also be seen that the velocity measured by EML is noisy and has one outlier (At 3318 s, the corresponding velocity is 0.02 m/s, which is far from true value). Without HMM pre-processing, the outlier will cause a large positioning error of the INS/EML-integrated navigation. From this figure, it can be seen that the average speed is about 4.05 m/s, and the minimum speed at the turning is as low as 0.55 m/s. The velocity after HMM filtering shown in <xref rid="sensors-25-01015-f011" ref-type="fig">Figure 11</xref>b shows that the noise has been greatly suppressed and outliers have been effectively removed. The weak fluctuation of the mean velocity in this figure is caused by the error of velocity by pure inertial calculation. From <xref rid="sensors-25-01015-f011" ref-type="fig">Figure 11</xref>c, it can be seen that there is one outlier in the measured latitude and longitude. There is an outlier at 2258 s, with an error of several hundred meters in both longitude and latitude measurements.</p><p><xref rid="sensors-25-01015-f012" ref-type="fig">Figure 12</xref>a shows the speed of the eastward current estimated by the proposed algorithm and that measured by a buoy. Here, the <italic toggle="yes">n</italic>-frame is used to describe water current. While moving, two GNSS calibrations at 1500 s and 3000 s are identified by arrows. As seen in this figure, the maximum estimation error appears at the moment of 1211 s, which is 0.14 m/s, and the estimation error of the endpoint is 0.041 m/s. <xref rid="sensors-25-01015-f012" ref-type="fig">Figure 12</xref>b shows the speed of the northward current estimated by the proposed algorithm and that measured by a buoy. This figure shows that the maximum estimation error at the moment of 2573 s, which is 0.095 m/s, and the estimation error of the endpoint is 0.032 m/s. From these two figures, it can be seen that water current flows in the northeast direction. Due to a GNSS calibration conducted at the starting point, the estimation errors of eastward and northward currents at the start are relatively small. These results indicate that the proposed algorithm can effectively estimate the velocities of ocean currents.</p><p>In order to present the estimated and measured current speeds more clearly, some data in <xref rid="sensors-25-01015-f012" ref-type="fig">Figure 12</xref>a,b is tabulated and shown in <xref rid="sensors-25-01015-t001" ref-type="table">Table 1</xref> below. The time interval for the tabulation is 12 min. It should be noted that the frequency of GNSS-based calibration is once every 25 min, so the estimation error of the current speed is small after a GNSS calibration.</p><p><xref rid="sensors-25-01015-f013" ref-type="fig">Figure 13</xref>a shows the positioning errors of the proposed algorithm and conventional LKF. The positioning error is obtained by taking the square root of sum of squares of latitude and longitude positioning errors. Here, the GNSS measurement update period of conventional LKF is also set to be 25 min. The benchmark datum used for calculation is the position measured by GNSS. In this figure, the small peak at 3318 s is caused by the measurement outlier of the EML. From this figure, the maximum positioning error of the proposed (conventional) algorithm occurs at the moment of 1005 s (2999 s) with an error of 41.1 m (1008.2 m). <xref rid="sensors-25-01015-f013" ref-type="fig">Figure 13</xref>b shows the error rates of the proposed algorithm and conventional LKF. The error rate is defined as the current positioning error divided by the current voyaging distance. The maximum error rate of the proposed (conventional) algorithm occurs at the moment of 508 s (413 s) with an error of 1.2% (15.1%). When analyzing the maximum error rate, few initial inaccurate points are discarded (due to the very small voyaging distance, the error rate is unreasonable and should be abandoned). The positioning error and error rate at the endpoint of the proposed (conventional) algorithm are 20.5 m (712.1 m) and 0.134% (4.64%), respectively. Every error or error rate of the proposed algorithm is significantly reduced compared to the conventional algorithm. It illustrates the superiority of this algorithm. In particular, the positioning error of the INS/EML mode of the conventional method increases sharply when an outlier in the EML output appears, while this error of proposed method does not increase sharply due to the HMM pre-processing technique. <xref rid="sensors-25-01015-f013" ref-type="fig">Figure 13</xref>c shows the trajectory based on GNSS measuring positions (actual trajectory). This trajectory includes two approximately straight line segments and one turning segment. <xref rid="sensors-25-01015-f013" ref-type="fig">Figure 13</xref>a&#x02013;f shows the outputs of three gyroscopes (<italic toggle="yes">x</italic>-axis, <italic toggle="yes">y</italic>-axis, and <italic toggle="yes">z</italic>-axis). From these figures, it can be seen that the output of the <italic toggle="yes">z</italic>-axis gyro is only relatively large when the AUV is turning. <xref rid="sensors-25-01015-f013" ref-type="fig">Figure 13</xref>g shows the outputs of three accelerometers. Due to the stable motion of the AUV, outputs of all three accelerometers are small. The maximum absolute values of the <italic toggle="yes">x</italic>-axis and <italic toggle="yes">y</italic>-axis accelerometers are less than 3.1 m/s<sup>2</sup> and 3.5 m/s<sup>2</sup>, respectively. <xref rid="sensors-25-01015-f013" ref-type="fig">Figure 13</xref>h shows pitch and roll angles of the AUV. <xref rid="sensors-25-01015-f013" ref-type="fig">Figure 13</xref>i shows the heading angle of the AUV. From these two figures, it can be seen that there is a significant variation in heading angle only when the AUV is turning.</p><p>The probability of outliers appearing in GNSS measurements is very low. While the measurement update period of MALKF is 25 min, positions from GNSS are all normal values. The measurement is shown in the above Equation (30). Hence, advantages of MALKF cannot be manifested. In order to specifically verify the excellent robustness of MALKF, we perform another simulation with a measurement update period of 1 s. This period encounters a case in which the outlier of the GNSS measurement appears. By setting the measurement update period of MALKF to be 1 s, results are obtained and shown in <xref rid="sensors-25-01015-f014" ref-type="fig">Figure 14</xref>a,b. <xref rid="sensors-25-01015-f014" ref-type="fig">Figure 14</xref>a shows that the positioning error of the conventional algorithm increases sharply whenever the outlier of the EML or GNSS appears, while the error of the proposed algorithm does not increase sharply at any outlier point. The maximum error is 651 m. Because GNSS is frequently utilized to calibrate, the positioning error of the proposed algorithm is of meter level. <xref rid="sensors-25-01015-f014" ref-type="fig">Figure 14</xref>b shows a local zone (parts of curves except for GNSS and EML outliers) in <xref rid="sensors-25-01015-f014" ref-type="fig">Figure 14</xref>a. As shown by <xref rid="sensors-25-01015-f014" ref-type="fig">Figure 14</xref>c, the characteristics of error rates are similar to those of error. The maximum error rate is 7.1%.</p><p>The results in <xref rid="sensors-25-01015-f014" ref-type="fig">Figure 14</xref>a&#x02013;c shows that the proposed algorithm can indeed effectively solve a sharp increase of error of MALKF caused by a measurement outlier.</p><p>To thoroughly evaluate the performance of the proposed algorithm, we compared it with traditional algorithms, as well as the UKF (Unscented Kalman Filter) and CKF (Cubature Kalman Filter) algorithms. The computational results are presented in <xref rid="sensors-25-01015-t002" ref-type="table">Table 2</xref> below. Using offline simulation techniques, we applied the four algorithms listed in <xref rid="sensors-25-01015-t002" ref-type="table">Table 2</xref> to process the experimental data shown in <xref rid="sensors-25-01015-f013" ref-type="fig">Figure 13</xref>c&#x02013;i. The UKF algorithm utilizes the UKF to replace the CNLKF and MALKF in <xref rid="sensors-25-01015-f001" ref-type="fig">Figure 1</xref>, while the CKF algorithm uses the CKF to replace the CNLKF and MALKF. To ensure a fair comparison, both the UKF and CKF algorithms include HMM preprocessing and outlier removal and replacement for the GNSS data.</p><p>The results from the table indicate that the maximum positioning error and the maximum ocean current estimation error of the UKF and CKF algorithms outperform the proposed algorithm. This is because the proposed algorithm is based on the LKF framework, and its performance still lags behind that of more advanced nonlinear filters. However, the proposed algorithm demonstrates a computational time advantage. Using the ATmega256 AVR microcontroller as the computing chip, the computation times for the proposed algorithm, UKF, and CKF are approximately 1.8, 3.5, and 3.8 times that of the traditional algorithm, respectively. Therefore, the proposed algorithm has a relatively low computational time and holds certain engineering application value.</p></sec><sec sec-type="conclusions" id="sec4-sensors-25-01015"><title>4. Conclusions</title><p>In summary, the INS/EML and INS/EML/GNSS-integrated navigation algorithm for small-sized AUVs is proposed in this paper. The algorithm employs techniques including HMM pre-processing, CNLKF, MALKF, GNSS measurement-based estimation of current speed, and feedback correction of LKF.</p><p>The results of the AUV&#x02019;s sea trial show that the positioning error and error rate at the endpoint of the proposed algorithm are 20.5 m and 0.134%, respectively, when the measurement update period of MALKF is set to be 25 min. The error and error rate of conventional algorithm at the endpoint are 712.1 m and 4.64%. The maximum estimation error of the eastward (northward) current speed appears at the moment of 1211 s (2573 s), which is 0.14 m/s (0.095 m/s), and the estimation error at the endpoint is 0.041 m/s (0.032 m/s).</p><p>These results show that the algorithm in this paper has advantages of high accuracy, strong anti-interference ability, and wide application range. Its engineering practicality is high, and it is expected to be applied to small AUVs, ROVs, underwater gliders, and other marine equipment.</p></sec></body><back><ack><title>Acknowledgments</title><p>The project leader of all the supporting grants in the article &#x0201c;An electro-magnetic log (EML)-integrated navigation algorithm based on a hidden Markov model (HMM) and cross-noise Kalman filter&#x0201d; is Jianming Miao.</p></ack><fn-group><fn><p><bold>Disclaimer/Publisher&#x02019;s Note:</bold> The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.</p></fn></fn-group><notes><title>Author Contributions</title><p>Conceptualization, H.Z.; methodology, H.Z.; software, H.Z.; validation, W.M. and L.X.; formal analysis, L.Y.; investigation, Y.D. and C.C.; resources, C.C.; data curation, L.Z. and Y.D.; writing&#x02014;original draft preparation, L.Y.; writing&#x02014;review and editing, L.X.; visualization, L.Z.; supervision, W.M.; project administration, L.X.; funding acquisition, L.X. All authors have read and agreed to the published version of the manuscript.</p></notes><notes><title>Institutional Review Board Statement</title><p>Not applicable.</p></notes><notes><title>Informed Consent Statement</title><p>Not applicable.</p></notes><notes notes-type="data-availability"><title>Data Availability Statement</title><p>The data presented in this study are available on request from the corresponding author.</p></notes><notes notes-type="COI-statement"><title>Conflicts of Interest</title><p>Author Lei Zhang was employed by the company State Power Investment Group (Zhuhai Hengqin) Thermoelectric Co., Ltd. The remaining authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p></notes><ref-list><title>References</title><ref id="B1-sensors-25-01015"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Paull</surname><given-names>L.</given-names></name>
<name><surname>Saeedi</surname><given-names>S.</given-names></name>
<name><surname>Seto</surname><given-names>M.</given-names></name>
<name><surname>Li</surname><given-names>H.</given-names></name>
</person-group><article-title>AUV navigation and localization: A review</article-title><source>IEEE J. Ocean. Eng.</source><year>2014</year><volume>39</volume><fpage>131</fpage><lpage>149</lpage><pub-id pub-id-type="doi">10.1109/JOE.2013.2278891</pub-id></element-citation></ref><ref id="B2-sensors-25-01015"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Bao</surname><given-names>J.</given-names></name>
<name><surname>Li</surname><given-names>D.</given-names></name>
<name><surname>Qiao</surname><given-names>X.</given-names></name>
<name><surname>Rauschenbach</surname><given-names>T.</given-names></name>
</person-group><article-title>Integrated navigation for autonomous underwater vehicles in aquaculture: A review</article-title><source>Inf. Process. Agric.</source><year>2020</year><volume>7</volume><fpage>139</fpage><lpage>151</lpage><pub-id pub-id-type="doi">10.1016/j.inpa.2019.04.003</pub-id></element-citation></ref><ref id="B3-sensors-25-01015"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Neira</surname><given-names>J.</given-names></name>
<name><surname>Sequeiros</surname><given-names>C.</given-names></name>
<name><surname>Huamani</surname><given-names>R.</given-names></name>
<name><surname>Machaca</surname><given-names>E.</given-names></name>
<name><surname>Fonseca</surname><given-names>P.</given-names></name>
<name><surname>Nina</surname><given-names>W.</given-names></name>
</person-group><article-title>Review on Unmanned Underwater Robotics, Structure Designs, Materials, Sensors. Actuators, and Navigation Control</article-title><source>J. Robot.</source><year>2021</year><volume>2021</volume><fpage>5542920</fpage><pub-id pub-id-type="doi">10.1155/2021/5542920</pub-id></element-citation></ref><ref id="B4-sensors-25-01015"><label>4.</label><element-citation publication-type="confproc"><person-group person-group-type="author">
<name><surname>Hegren&#x000e6;s</surname><given-names>&#x000d8;.</given-names></name>
<name><surname>Berglund</surname><given-names>E.</given-names></name>
</person-group><article-title>Doppler water track aided inertial navigation for autonomous underwater vehicles</article-title><source>Proceedings of the Oceans 2009-Europe</source><conf-loc>Bremen, Germany</conf-loc><conf-date>11&#x02013;14 May 2009</conf-date><fpage>1</fpage><lpage>10</lpage></element-citation></ref><ref id="B5-sensors-25-01015"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Li</surname><given-names>W.</given-names></name>
<name><surname>Chen</surname><given-names>M.</given-names></name>
<name><surname>Li</surname><given-names>Y.</given-names></name>
</person-group><article-title>Key Techniques of SINS/DVL Integrated Navigation System</article-title><source>J. Phys. Conf. Ser.</source><year>2021</year><volume>2095</volume><fpage>012034</fpage><pub-id pub-id-type="doi">10.1088/1742-6596/2095/1/012034</pub-id></element-citation></ref><ref id="B6-sensors-25-01015"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Liu</surname><given-names>S.</given-names></name>
<name><surname>Zhang</surname><given-names>T.</given-names></name>
<name><surname>Zhang</surname><given-names>J.</given-names></name>
<name><surname>Zhu</surname><given-names>Y.</given-names></name>
</person-group><article-title>A New Coupled Method of SINS/DVL Integrated Navigation Based on Improved Dual Adaptive Factors</article-title><source>IEEE Trans. Instrum. Meas.</source><year>2021</year><volume>70</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1109/TIM.2021.3106118</pub-id><pub-id pub-id-type="pmid">33776080</pub-id>
</element-citation></ref><ref id="B7-sensors-25-01015"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Yoo</surname><given-names>T.-S.</given-names></name>
<name><surname>Chung</surname><given-names>G.-P.</given-names></name>
<name><surname>Yoon</surname><given-names>S.-I.</given-names></name>
</person-group><article-title>Development of Integrated Navigation Algorithm for Underwater Vehicle using Velocity Filter</article-title><source>J. Ocean Eng. Technol.</source><year>2013</year><volume>27</volume><fpage>93</fpage><lpage>99</lpage><comment>(In Korean)</comment><pub-id pub-id-type="doi">10.5574/KSOE.2013.27.2.093</pub-id></element-citation></ref><ref id="B8-sensors-25-01015"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Yoo</surname><given-names>T.-S.</given-names></name>
<name><surname>Kim</surname><given-names>M.H.</given-names></name>
</person-group><article-title>Analysis of Integrated Navigation Performance for Sensor Selection of Unmanned Underwater Vehicle (UUV)</article-title><source>J. Ocean Eng. Technol.</source><year>2014</year><volume>28</volume><fpage>566</fpage><lpage>573</lpage><comment>(In Korean)</comment><pub-id pub-id-type="doi">10.5574/KSOE.2014.28.6.566</pub-id></element-citation></ref><ref id="B9-sensors-25-01015"><label>9.</label><element-citation publication-type="confproc"><person-group person-group-type="author">
<name><surname>Guo</surname><given-names>L.</given-names></name>
<name><surname>Shi</surname><given-names>Y.</given-names></name>
<name><surname>Wang</surname><given-names>S.</given-names></name>
</person-group><article-title>Design of Inertial/Acoustic Integrated Navigation System of Underwater Vehicle</article-title><source>Proceedings of the 2019 IEEE International Conference on Signal, Information and Data Processing (ICSIDP)</source><conf-loc>Chongqing, China</conf-loc><conf-date>11&#x02013;13 December 2019</conf-date><fpage>1</fpage><lpage>4</lpage></element-citation></ref><ref id="B10-sensors-25-01015"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Yan</surname><given-names>X.</given-names></name>
<name><surname>Yang</surname><given-names>Y.</given-names></name>
<name><surname>Luo</surname><given-names>Q.</given-names></name>
<name><surname>Chen</surname><given-names>Y.</given-names></name>
<name><surname>Hu</surname><given-names>C.</given-names></name>
</person-group><article-title>A SINS/DVL Integrated Positioning System through Filtering Gain Compensation Adaptive Filtering</article-title><source>Sensors</source><year>2019</year><volume>19</volume><elocation-id>4576</elocation-id><pub-id pub-id-type="doi">10.3390/s19204576</pub-id><pub-id pub-id-type="pmid">31640216</pub-id>
</element-citation></ref><ref id="B11-sensors-25-01015"><label>11.</label><element-citation publication-type="confproc"><person-group person-group-type="author">
<name><surname>Yang</surname><given-names>Y.</given-names></name>
<name><surname>Yan</surname><given-names>X.</given-names></name>
<name><surname>Luo</surname><given-names>Q.</given-names></name>
</person-group><article-title>A SINS/DVL Integrated Navigation Positioning Method Based on Improved Adaptive Filtering Technology</article-title><source>Proceedings of the 2019 IEEE International Conference on Smart Internet of Things (SmartIoT)</source><conf-loc>Tianjin, China</conf-loc><conf-date>9&#x02013;11 August 2019</conf-date><fpage>262</fpage><lpage>268</lpage></element-citation></ref><ref id="B12-sensors-25-01015"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Wang</surname><given-names>D.</given-names></name>
<name><surname>Xu</surname><given-names>X.</given-names></name>
<name><surname>Yao</surname><given-names>Y.</given-names></name>
<name><surname>Zhu</surname><given-names>Y.</given-names></name>
<name><surname>Tong</surname><given-names>J.</given-names></name>
</person-group><article-title>A Hybrid Approach Based on Improved AR Model and MAA for INS/DVL Integrated Navigation Systems</article-title><source>IEEE Access</source><year>2019</year><volume>7</volume><fpage>82794</fpage><lpage>82808</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2019.2924593</pub-id></element-citation></ref><ref id="B13-sensors-25-01015"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Lee</surname><given-names>J.M.</given-names></name>
<name><surname>Lee</surname><given-names>P.M.</given-names></name>
<name><surname>Seong</surname><given-names>W.J.</given-names></name>
</person-group><article-title>Underwater Hybrid Navigation Algorithm Based on an Inertial Sensor and a Doppler Velocity Log Using an Indirect</article-title><source>J. Ocean Eng. Technol.</source><year>2003</year><volume>17</volume><fpage>83</fpage><lpage>90</lpage><comment>(In Korean)</comment></element-citation></ref><ref id="B14-sensors-25-01015"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Yoo</surname><given-names>T.</given-names></name>
<name><surname>Kim</surname><given-names>M.</given-names></name>
<name><surname>Yoon</surname><given-names>S.</given-names></name>
<name><surname>Kim</surname><given-names>D.</given-names></name>
</person-group><article-title>Performance Enhancement for Conventional Tightly Coupled INS/DVL Navigation System Using Regeneration of Partial DVL Measurements</article-title><source>J. Sens.</source><year>2020</year><volume>2020</volume><fpage>5324349</fpage><pub-id pub-id-type="doi">10.1155/2020/5324349</pub-id></element-citation></ref><ref id="B15-sensors-25-01015"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Yang</surname><given-names>H.</given-names></name>
<name><surname>Gao</surname><given-names>X.</given-names></name>
<name><surname>Huang</surname><given-names>H.</given-names></name>
<name><surname>Li</surname><given-names>B.</given-names></name>
<name><surname>Jiang</surname><given-names>J.</given-names></name>
</person-group><article-title>A Tightly Integrated Navigation Method of SINS, DVL, and PS Based on RIMM in the Complex Underwater Environment</article-title><source>Sensors</source><year>2022</year><volume>22</volume><elocation-id>9479</elocation-id><pub-id pub-id-type="doi">10.3390/s22239479</pub-id><pub-id pub-id-type="pmid">36502180</pub-id>
</element-citation></ref><ref id="B16-sensors-25-01015"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Liu</surname><given-names>P.</given-names></name>
<name><surname>Wang</surname><given-names>B.</given-names></name>
<name><surname>Deng</surname><given-names>Z.</given-names></name>
<name><surname>Fu</surname><given-names>M.</given-names></name>
</person-group><article-title>INS/DVL/PS Tightly Coupled Underwater Navigation Method with Limited DVL Measurements</article-title><source>IEEE Sens. J.</source><year>2018</year><volume>18</volume><fpage>2994</fpage><lpage>3002</lpage><pub-id pub-id-type="doi">10.1109/JSEN.2018.2800165</pub-id></element-citation></ref><ref id="B17-sensors-25-01015"><label>17.</label><element-citation publication-type="confproc"><person-group person-group-type="author">
<name><surname>Eliav</surname><given-names>R.</given-names></name>
<name><surname>Klein</surname><given-names>I.</given-names></name>
</person-group><article-title>INS/Partial DVL Measurements Fusion with Correlated Process and Measurement Noise</article-title><source>Proceedings of the 5th International Electronic Conference on Sensors and Applications</source><conf-loc>Online</conf-loc><conf-date>15&#x02013;30 November 2018</conf-date><fpage>1</fpage></element-citation></ref><ref id="B18-sensors-25-01015"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Song</surname><given-names>E.</given-names></name>
<name><surname>Zhu</surname><given-names>Y.</given-names></name>
<name><surname>Zhou</surname><given-names>J.</given-names></name>
<name><surname>You</surname><given-names>Z.</given-names></name>
</person-group><article-title>Optimal Kalman filtering fusion with cross-correlated sensor noises</article-title><source>Automatica</source><year>2007</year><volume>43</volume><fpage>1450</fpage><lpage>1456</lpage><pub-id pub-id-type="doi">10.1016/j.automatica.2007.01.010</pub-id></element-citation></ref><ref id="B19-sensors-25-01015"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Li</surname><given-names>D.</given-names></name>
<name><surname>Xu</surname><given-names>J.</given-names></name>
<name><surname>Zhu</surname><given-names>B.</given-names></name>
<name><surname>He</surname><given-names>H.</given-names></name>
</person-group><article-title>A calibration method of DVL in integrated navigation system based on particle swarm optimization</article-title><source>Measurement</source><year>2022</year><volume>187</volume><fpage>110325</fpage><pub-id pub-id-type="doi">10.1016/j.measurement.2021.110325</pub-id></element-citation></ref><ref id="B20-sensors-25-01015"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Wang</surname><given-names>J.</given-names></name>
<name><surname>Chen</surname><given-names>X.</given-names></name>
<name><surname>Yang</surname><given-names>P.</given-names></name>
</person-group><article-title>Adaptive H-infinite kalman filter based on multiple fading factors and its application in unmanned underwater vehicle</article-title><source>ISA Trans.</source><year>2021</year><volume>108</volume><fpage>295</fpage><pub-id pub-id-type="doi">10.1016/j.isatra.2020.08.030</pub-id><pub-id pub-id-type="pmid">32873373</pub-id>
</element-citation></ref><ref id="B21-sensors-25-01015"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Xu</surname><given-names>B.</given-names></name>
<name><surname>Wang</surname><given-names>X.</given-names></name>
<name><surname>Zhang</surname><given-names>J.</given-names></name>
<name><surname>Razzaqi</surname><given-names>A.A.</given-names></name>
</person-group><article-title>Maximum correntropy delay Kalman filter for SINS/USBL integrated navigation</article-title><source>ISA Trans.</source><year>2021</year><volume>117</volume><fpage>274</fpage><pub-id pub-id-type="doi">10.1016/j.isatra.2021.01.055</pub-id><pub-id pub-id-type="pmid">33849713</pub-id>
</element-citation></ref><ref id="B22-sensors-25-01015"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Morgado</surname><given-names>M.</given-names></name>
<name><surname>Batista</surname><given-names>P.</given-names></name>
<name><surname>Oliveira</surname><given-names>P.</given-names></name>
<name><surname>Silvestre</surname><given-names>C.</given-names></name>
</person-group><article-title>Position USBL/DVL sensor-based navigation filter in the presence of unknown ocean currents</article-title><source>Automatica</source><year>2011</year><volume>47</volume><fpage>2604</fpage><lpage>2614</lpage><pub-id pub-id-type="doi">10.1016/j.automatica.2011.09.024</pub-id></element-citation></ref><ref id="B23-sensors-25-01015"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Gao</surname><given-names>B.</given-names></name>
<name><surname>Hu</surname><given-names>G.</given-names></name>
<name><surname>Zhong</surname><given-names>Y.</given-names></name>
<name><surname>Zhu</surname><given-names>X.</given-names></name>
</person-group><article-title>Cubature Kalman Filter With Both Adaptability and Robustness for Tightly-Coupled GNSS/INS Integration</article-title><source>IEEE Sens. J.</source><year>2021</year><volume>21</volume><fpage>14997</fpage><lpage>15011</lpage><pub-id pub-id-type="doi">10.1109/JSEN.2021.3073963</pub-id></element-citation></ref><ref id="B24-sensors-25-01015"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Meurer</surname><given-names>C.</given-names></name>
<name><surname>Fuentes-P&#x000e9;rez</surname><given-names>J.F.</given-names></name>
<name><surname>Palomeras</surname><given-names>N.</given-names></name>
<name><surname>Carreras</surname><given-names>M.</given-names></name>
<name><surname>Kruusmaa</surname><given-names>M.</given-names></name>
</person-group><article-title>Differential Pressure Sensor Speedometer for Autonomous Underwater Vehicle Velocity Estimation</article-title><source>IEEE J. Ocean. Eng.</source><year>2020</year><volume>45</volume><fpage>946</fpage><lpage>978</lpage><pub-id pub-id-type="doi">10.1109/JOE.2019.2907822</pub-id></element-citation></ref><ref id="B25-sensors-25-01015"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Meurer</surname><given-names>C.</given-names></name>
<name><surname>Fuentes-P&#x000e9;rez</surname><given-names>J.F.</given-names></name>
<name><surname>Schwarzw&#x000e4;lder</surname><given-names>K.</given-names></name>
<name><surname>Ludvigsen</surname><given-names>M.</given-names></name>
<name><surname>S&#x000f8;rensen</surname><given-names>A.J.</given-names></name>
<name><surname>Kruusmaa</surname><given-names>M.</given-names></name>
</person-group><article-title>2D Estimation of Velocity Relative to Water and Tidal Currents Based on Differential Pressure for Autonomous Underwater Vehicles</article-title><source>IEEE Robot. Autom. Lett.</source><year>2020</year><volume>5</volume><fpage>3444</fpage><lpage>3451</lpage><pub-id pub-id-type="doi">10.1109/LRA.2020.2976318</pub-id></element-citation></ref><ref id="B26-sensors-25-01015"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Yoo</surname><given-names>T.S.</given-names></name>
<name><surname>Kim</surname><given-names>M.H.</given-names></name>
<name><surname>Yoon</surname><given-names>S.I.</given-names></name>
<name><surname>Kim</surname><given-names>D.J.</given-names></name>
</person-group><article-title>Design of Tightly Coupled INS/DVL/RPM Integrated Navigation System</article-title><source>J. Ocean Eng. Technol.</source><year>2019</year><volume>33</volume><fpage>470</fpage><pub-id pub-id-type="doi">10.26748/KSOE.2019.085</pub-id></element-citation></ref><ref id="B27-sensors-25-01015"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Praczyk</surname><given-names>T.</given-names></name>
</person-group><article-title>Using Neuro-Evolutionary Techniques to Tune Odometric Navigational System of Small Biomimetic Autonomous Underwater Vehicle&#x02014;Preliminary Report</article-title><source>J. Intell. Robot. Syst.</source><year>2020</year><volume>100</volume><fpage>363</fpage><lpage>376</lpage><pub-id pub-id-type="doi">10.1007/s10846-020-01191-3</pub-id></element-citation></ref><ref id="B28-sensors-25-01015"><label>28.</label><element-citation publication-type="confproc"><person-group person-group-type="author">
<name><surname>Cha</surname><given-names>J.</given-names></name>
<name><surname>Ju</surname><given-names>H.</given-names></name>
<name><surname>Park</surname><given-names>C.G.</given-names></name>
<name><surname>Yoo</surname><given-names>K.</given-names></name>
<name><surname>Park</surname><given-names>C.</given-names></name>
</person-group><article-title>Integration of Inertial Navigation System with EM-log Using H-infinity Filter</article-title><source>Proceedings of the E3S Web of Conferences</source><conf-loc>T&#x000e2;rgovi&#x0015f;te, Romania</conf-loc><conf-date>6&#x02013;8 June 2019</conf-date><volume>Volume 94</volume><fpage>01013</fpage></element-citation></ref><ref id="B29-sensors-25-01015"><label>29.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Vaisgant</surname><given-names>I.B.</given-names></name>
<name><surname>Litvinenko</surname><given-names>Y.A.</given-names></name>
<name><surname>Tupysev</surname><given-names>V.A.</given-names></name>
</person-group><article-title>Verification of EM Log Data in Marine Inertial Navigation System Correction</article-title><source>Gyroscopy Navig.</source><year>2011</year><volume>2</volume><fpage>34</fpage><lpage>38</lpage><pub-id pub-id-type="doi">10.1134/S207510871101010X</pub-id></element-citation></ref><ref id="B30-sensors-25-01015"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Dmitriev</surname><given-names>S.P.</given-names></name>
<name><surname>Zinenko</surname><given-names>V.M.</given-names></name>
<name><surname>Litvinenko</surname><given-names>Y.A.</given-names></name>
</person-group><article-title>Correction and Damping of Medium Accuracy INS Using Electromagnetic Log</article-title><source>Gyroscopy Navig.</source><year>2012</year><volume>3</volume><fpage>270</fpage><lpage>274</lpage><pub-id pub-id-type="doi">10.1134/S2075108712040025</pub-id></element-citation></ref><ref id="B31-sensors-25-01015"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Kim</surname><given-names>E.</given-names></name>
<name><surname>Fan</surname><given-names>S.</given-names></name>
<name><surname>Bose</surname><given-names>N.</given-names></name>
</person-group><article-title>Estimating Water Current Velocities by Using a Model-Based High-Gain Observer for an Autonomous Underwater Vehicle</article-title><source>IEEE Access</source><year>2018</year><volume>6</volume><fpage>70259</fpage><lpage>70271</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2018.2879469</pub-id></element-citation></ref><ref id="B32-sensors-25-01015"><label>32.</label><element-citation publication-type="confproc"><person-group person-group-type="author">
<name><surname>Kim</surname><given-names>E.</given-names></name>
<name><surname>Fan</surname><given-names>S.</given-names></name>
<name><surname>Bose</surname><given-names>N.</given-names></name>
</person-group><article-title>Autonomous Underwater Vehicle Model-Based High-Gain Observer for Ocean Current Estimation</article-title><source>Proceedings of the 2018 IEEE/OES Autonomous Underwater Vehicle Workshop (AUV)</source><conf-loc>Porto, Portugal</conf-loc><conf-date>6&#x02013;9 November 2018</conf-date><fpage>1</fpage><lpage>6</lpage></element-citation></ref><ref id="B33-sensors-25-01015"><label>33.</label><element-citation publication-type="confproc"><person-group person-group-type="author">
<name><surname>Medagoda</surname><given-names>L.</given-names></name>
<name><surname>Kinsey</surname><given-names>J.C.</given-names></name>
<name><surname>Eilders</surname><given-names>M.</given-names></name>
</person-group><article-title>Autonomous Underwater Vehicle localization in a spatiotemporally varying water current field</article-title><source>Proceedings of the 2015 IEEE International Conference on Robotics and Automation (ICRA)</source><conf-loc>Seattle, WA, USA</conf-loc><conf-date>26&#x02013;30 May 2015</conf-date><fpage>565</fpage><lpage>572</lpage></element-citation></ref><ref id="B34-sensors-25-01015"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Liu</surname><given-names>P.</given-names></name>
<name><surname>Wang</surname><given-names>B.</given-names></name>
<name><surname>Li</surname><given-names>G.</given-names></name>
<name><surname>Hou</surname><given-names>D.</given-names></name>
<name><surname>Zhu</surname><given-names>Z.</given-names></name>
<name><surname>Wang</surname><given-names>Z.</given-names></name>
</person-group><article-title>SINS/DVL Integrated Navigation Method With Current Compensation Using RBF Neural Network</article-title><source>IEEE Sens. J.</source><year>2022</year><volume>22</volume><fpage>14366</fpage><pub-id pub-id-type="doi">10.1109/JSEN.2022.3182374</pub-id></element-citation></ref><ref id="B35-sensors-25-01015"><label>35.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Shaukat</surname><given-names>N.</given-names></name>
<name><surname>Ali</surname><given-names>A.</given-names></name>
<name><surname>Javed Iqbal</surname><given-names>M.</given-names></name>
<name><surname>Moinuddin</surname><given-names>M.</given-names></name>
<name><surname>Otero</surname><given-names>P.</given-names></name>
</person-group><article-title>Multi-Sensor Fusion for Underwater Vehicle Localization by Augmentation of RBF Neural Network and Error-State Kalman Filter</article-title><source>Sensors</source><year>2021</year><volume>21</volume><elocation-id>1149</elocation-id><pub-id pub-id-type="doi">10.3390/s21041149</pub-id><pub-id pub-id-type="pmid">33562145</pub-id>
</element-citation></ref><ref id="B36-sensors-25-01015"><label>36.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Ma</surname><given-names>H.</given-names></name>
<name><surname>Mu</surname><given-names>X.</given-names></name>
<name><surname>He</surname><given-names>B.</given-names></name>
</person-group><article-title>Adaptive Navigation Algorithm with Deep Learning for Autonomous Underwater Vehicle</article-title><source>Sensors</source><year>2021</year><volume>21</volume><elocation-id>6406</elocation-id><pub-id pub-id-type="doi">10.3390/s21196406</pub-id><pub-id pub-id-type="pmid">34640726</pub-id>
</element-citation></ref><ref id="B37-sensors-25-01015"><label>37.</label><element-citation publication-type="confproc"><person-group person-group-type="author">
<name><surname>Al Azhima</surname><given-names>S.A.</given-names></name>
<name><surname>Hadi</surname><given-names>M.I.</given-names></name>
<name><surname>Priandiri</surname><given-names>V.P.</given-names></name>
<name><surname>Trilaksono</surname><given-names>B.R.</given-names></name>
<name><surname>Hidayat</surname><given-names>E.M.</given-names></name>
</person-group><article-title>Design and Simulation of Navigation System for Hybrid Autonomous Underwater Glider</article-title><source>Proceedings of the 2019 IEEE 9th International Conference on System Engineering and Technology (ICSET)</source><conf-loc>Shah Alam, Malaysia</conf-loc><conf-date>7 October 2019</conf-date><fpage>189</fpage><lpage>194</lpage></element-citation></ref><ref id="B38-sensors-25-01015"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author">
<name><surname>Juliers</surname><given-names>S.</given-names></name>
<name><surname>Uhlmannj</surname><given-names>J.</given-names></name>
<name><surname>Durrant-Whyte</surname><given-names>H.F.</given-names></name>
</person-group><article-title>A new method for the nonlinear transformation of means and convariances in filters and estimators</article-title><source>IEEE Trans. Autom. Control</source><year>2000</year><volume>45</volume><fpage>477</fpage><lpage>482</lpage><pub-id pub-id-type="doi">10.1109/9.847726</pub-id></element-citation></ref><ref id="B39-sensors-25-01015"><label>39.</label><element-citation publication-type="confproc"><person-group person-group-type="author">
<name><surname>Wan</surname><given-names>E.A.</given-names></name>
<name><surname>Van Der Merwe</surname><given-names>R.</given-names></name>
</person-group><article-title>The unscented Kalman filter for nonlinear estimation</article-title><source>Proceedings of the IEEE Symposium 2000 on Adaptive Systems for Signal Processing Communication and Control</source><conf-loc>Lake Louise, AB, Canada</conf-loc><conf-date>4 October 2000</conf-date><fpage>153</fpage><lpage>158</lpage></element-citation></ref></ref-list></back><floats-group><fig position="float" id="sensors-25-01015-f001"><label>Figure 1</label><caption><p>A schematic diagram of the current estimation and integrated navigation algorithm based on HMM.</p></caption><graphic xlink:href="sensors-25-01015-g001" position="float"/></fig><fig position="float" id="sensors-25-01015-f002"><label>Figure 2</label><caption><p>Schematic diagram of the working principle of the EML.</p></caption><graphic xlink:href="sensors-25-01015-g002" position="float"/></fig><fig position="float" id="sensors-25-01015-f003"><label>Figure 3</label><caption><p>Flow chart of MALKF.</p></caption><graphic xlink:href="sensors-25-01015-g003" position="float"/></fig><fig position="float" id="sensors-25-01015-f004"><label>Figure 4</label><caption><p>Simplified flow chart of the proposed algorithm.</p></caption><graphic xlink:href="sensors-25-01015-g004" position="float"/></fig><fig position="float" id="sensors-25-01015-f005"><label>Figure 5</label><caption><p>The five core modules of the proposed algorithm.</p></caption><graphic xlink:href="sensors-25-01015-g005" position="float"/></fig><fig position="float" id="sensors-25-01015-f006"><label>Figure 6</label><caption><p>Diagram of the AUV layout.</p></caption><graphic xlink:href="sensors-25-01015-g006" position="float"/></fig><fig position="float" id="sensors-25-01015-f007"><label>Figure 7</label><caption><p>(<bold>a</bold>) Photograph of deployment (from ship to water surface) of the AUV. (<bold>b</bold>) Photograph of the AUV sailing on the water surface.</p></caption><graphic xlink:href="sensors-25-01015-g007" position="float"/></fig><fig position="float" id="sensors-25-01015-f008"><label>Figure 8</label><caption><p>Schematic diagram of the AUV voyaging on the water surface.</p></caption><graphic xlink:href="sensors-25-01015-g008" position="float"/></fig><fig position="float" id="sensors-25-01015-f009"><label>Figure 9</label><caption><p>(<bold>a</bold>) Physical photos of the INS. (<bold>b</bold>) Physical photos of the internal structure of the INS. (<bold>c</bold>) Physical photos of the EML.</p></caption><graphic xlink:href="sensors-25-01015-g009" position="float"/></fig><fig position="float" id="sensors-25-01015-f010"><label>Figure 10</label><caption><p>(<bold>a</bold>) Schematic diagram of the drifting buoy. (<bold>b</bold>) Physical picture of devices inside the buoy ball.</p></caption><graphic xlink:href="sensors-25-01015-g010" position="float"/></fig><fig position="float" id="sensors-25-01015-f011"><label>Figure 11</label><caption><p>(<bold>a</bold>) Speed measured by the EML (including one outlier). (<bold>b</bold>) Speed after HMM filtering. (<bold>c</bold>) Position measured by the GNSS (with one outlier).</p></caption><graphic xlink:href="sensors-25-01015-g011" position="float"/></fig><fig position="float" id="sensors-25-01015-f012"><label>Figure 12</label><caption><p>(<bold>a</bold>) Estimated and actual speeds of the eastward current. (<bold>b</bold>) Estimated and actual speeds of the northward current.</p></caption><graphic xlink:href="sensors-25-01015-g012" position="float"/></fig><fig position="float" id="sensors-25-01015-f013"><label>Figure 13</label><caption><p>(<bold>a</bold>) Positioning error of the proposed algorithm and conventional LKF. (<bold>b</bold>) Positioning error rate of the proposed algorithm and conventional LKF. (<bold>c</bold>) Trajectory based on GNSS measuring positions. (<bold>d</bold>) Output of <italic toggle="yes">x</italic>-axis gyros in IMU. (<bold>e</bold>) Output of <italic toggle="yes">y</italic>-axis gyros in IMU. (<bold>f</bold>) Output of <italic toggle="yes">z</italic>-axis gyros in IMU. (<bold>g</bold>) Output of three accelerometers. (<bold>h</bold>) Pitch and roll angles of the AUV. (<bold>i</bold>) Heading angle of the AUV.</p></caption><graphic xlink:href="sensors-25-01015-g013a" position="float"/><graphic xlink:href="sensors-25-01015-g013b" position="float"/><graphic xlink:href="sensors-25-01015-g013c" position="float"/></fig><fig position="float" id="sensors-25-01015-f014"><label>Figure 14</label><caption><p>Simulation results of the GNSS with a measurement update period of 1 s. (<bold>a</bold>) Figure of positioning errors of the proposed and conventional algorithms. (<bold>b</bold>) Local figure (except two peaks caused by two outliers) of positioning errors of the proposed and conventional algorithms. (<bold>c</bold>) Local figure (except peak caused by GNSS outlier) of the positioning error rates of the proposed algorithm and conventional algorithm.</p></caption><graphic xlink:href="sensors-25-01015-g014a" position="float"/><graphic xlink:href="sensors-25-01015-g014b" position="float"/></fig><table-wrap position="float" id="sensors-25-01015-t001"><object-id pub-id-type="pii">sensors-25-01015-t001_Table 1</object-id><label>Table 1</label><caption><p>Estimated and measured speeds of eastward and northward currents.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Time (s)</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Measured Eastward Current (m/s)</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Estimated Eastward Current<break/>(m/s)</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Measured Northward Current<break/>(m/s)</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Estimated Northward Current<break/>(m/s)</th></tr></thead><tbody><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.370</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.369</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.062</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.093</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">720</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.335</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.312</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.117</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.132</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1440</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.293</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.225</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.151</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.192</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">2160</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.132</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.105</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.251</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.206</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">2880</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.21</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.162</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.201</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.193</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">3600</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.331</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.265</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.155</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.143</td></tr></tbody></table></table-wrap><table-wrap position="float" id="sensors-25-01015-t002"><object-id pub-id-type="pii">sensors-25-01015-t002_Table 2</object-id><label>Table 2</label><caption><p>Comparison of results of different filtering algorithms.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Method</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Maximum Positioning Error (m)</th><th align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1" colspan="1">Error in Estimation of Maximum Current Speed (m/s)</th></tr></thead><tbody><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Proposed</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">40.8</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.095</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Traditional</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">1015.4</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">&#x02014;&#x02014;</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">UKF</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">32.4</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.083</td></tr><tr><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">CKF</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">29.7</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">0.071</td></tr></tbody></table></table-wrap></floats-group></article>