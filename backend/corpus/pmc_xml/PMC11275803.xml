<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="en" article-type="research-article"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">bioRxiv</journal-id><journal-id journal-id-type="publisher-id">BIORXIV</journal-id><journal-title-group><journal-title>bioRxiv</journal-title></journal-title-group><issn pub-type="epub">2692-8205</issn><publisher><publisher-name>Cold Spring Harbor Laboratory</publisher-name></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmid">39071335</article-id><article-id pub-id-type="pmc">PMC11275803</article-id>
<article-id pub-id-type="doi">10.1101/2024.07.19.604364</article-id><article-version-alternatives><article-version article-version-type="status">preprint</article-version><article-version article-version-type="number">3</article-version></article-version-alternatives><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Long-read sequencing transcriptome quantification with lr-kallisto</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8725-0376</contrib-id><name><surname>Loving</surname><given-names>Rebekah K.</given-names></name><xref rid="A1" ref-type="aff">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8359-6705</contrib-id><name><surname>Sullivan</surname><given-names>Delaney K.</given-names></name><xref rid="A1" ref-type="aff">1</xref><xref rid="A2" ref-type="aff">2</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9240-0102</contrib-id><name><surname>Reese</surname><given-names>Fairlie</given-names></name><xref rid="A3" ref-type="aff">3</xref><xref rid="A4" ref-type="aff">4</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-2273-0189</contrib-id><name><surname>Rebboah</surname><given-names>Elisabeth</given-names></name><xref rid="A3" ref-type="aff">3</xref><xref rid="A4" ref-type="aff">4</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4470-3192</contrib-id><name><surname>Sakr</surname><given-names>Jasmine</given-names></name><xref rid="A3" ref-type="aff">3</xref><xref rid="A4" ref-type="aff">4</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-9326-9954</contrib-id><name><surname>Rezaie</surname><given-names>Narges</given-names></name><xref rid="A3" ref-type="aff">3</xref><xref rid="A4" ref-type="aff">4</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-6190-9723</contrib-id><name><surname>Liang</surname><given-names>Heidi Y.</given-names></name><xref rid="A3" ref-type="aff">3</xref><xref rid="A4" ref-type="aff">4</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-2612-2554</contrib-id><name><surname>Filimban</surname><given-names>Ghassan</given-names></name><xref rid="A3" ref-type="aff">3</xref><xref rid="A4" ref-type="aff">4</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8577-4763</contrib-id><name><surname>Kawauchi</surname><given-names>Shimako</given-names></name><xref rid="A3" ref-type="aff">3</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8936-055X</contrib-id><name><surname>Oakes</surname><given-names>Conrad</given-names></name><xref rid="A1" ref-type="aff">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4928-5532</contrib-id><name><surname>Trout</surname><given-names>Diane</given-names></name><xref rid="A1" ref-type="aff">1</xref></contrib><contrib contrib-type="author"><name><surname>Williams</surname><given-names>Brian A.</given-names></name><xref rid="A1" ref-type="aff">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-7598-9501</contrib-id><name><surname>MacGregor</surname><given-names>Grant</given-names></name><xref rid="A3" ref-type="aff">3</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-3235-8130</contrib-id><name><surname>Wold</surname><given-names>Barbara J.</given-names></name><xref rid="A1" ref-type="aff">1</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4259-6362</contrib-id><name><surname>Mortazavi</surname><given-names>Ali</given-names></name><xref rid="A3" ref-type="aff">3</xref><xref rid="A4" ref-type="aff">4</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9164-6231</contrib-id><name><surname>Pachter</surname><given-names>Lior</given-names></name><xref rid="A1" ref-type="aff">1</xref><xref rid="A5" ref-type="aff">5</xref></contrib></contrib-group><aff id="A1"><label>1</label>Division of Biology and Biological Engineering, California Institute of Technology, USA</aff><aff id="A2"><label>2</label>UCLA-Caltech Medical Scientist Training Program, David Geffen School of Medicine, University of California, Los Angeles, Los Angeles, CA, 90095, USA</aff><aff id="A3"><label>3</label>Developmental and Cell Biology, University of California Irvine, Irvine, USA</aff><aff id="A4"><label>4</label>Center for Complex Biological Systems, University of California Irvine, Irvine, USA</aff><aff id="A5"><label>5</label>Department of Computing and Mathematical Sciences, California Institute of Technology, Pasadena, USA</aff><author-notes><fn fn-type="con" id="FN1"><p id="P1">Author contributions</p><p id="P2">The lr-kallisto project was conceived by RKL and LP and the lr-kallisto method was developed and implemented by RKL. Benchmarking was conducted by RKL. The exome capture / non-capture experiment was conceived by AM, BWo and BWi. The experiment, data generation and curation was supervised by AM. Experiments were conducted by ER, HL, GF, SK and GM. Data curation was performed by FR, JS, DT and NR. Analysis of the data was conducted by RKL, FR and LP. Supplementary data analysis was performed by RKL, LP and CO. Software testing and release was performed by RKL and DKS. The manuscript was drafted by RKL and LP. LP, RKL, AM, BW, FR, DKS and CO commented on and edited the manuscript. All authors approved the manuscript. LP supervised the lr-kallisto project with BW.</p></fn><corresp id="CR1"><bold>Correspondence:</bold> Barbara Wold (<email>woldb@caltech.edu</email>), Ali Mortazavi (<email>ali.mortazavi@uci.edu</email>) and Lior Pachter (<email>lpachter@caltech.edu</email>)</corresp></author-notes><pub-date pub-type="epub"><day>16</day><month>12</month><year>2024</year></pub-date><elocation-id>2024.07.19.604364</elocation-id><permissions><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This work is licensed under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</ext-link>, which allows reusers to distribute, remix, adapt, and build upon the material in any medium or format, so long as attribution is given to the creator. The license allows for commercial use.</license-p></license></permissions><self-uri content-type="pdf">nihpp-2024.07.19.604364.pdf</self-uri><abstract id="ABS1"><p id="P3">RNA abundance quantification has become routine and affordable thanks to high-throughput &#x0201c;short-read&#x0201d; technologies that provide accurate molecule counts at the gene level. Similarly accurate and affordable quantification of definitive full-length, transcript isoforms has remained a stubborn challenge, despite its obvious biological significance across a wide range of problems. &#x0201c;Long-read&#x0201d; sequencing platforms now produce data-types that can, in principle, drive routine definitive isoform quantification. However some particulars of contemporary long-read datatypes, together with isoform complexity and genetic variation, present bioinformatic challenges. We show here, using ONT data, that fast and accurate quantification of long-read data is possible and that it is improved by exome capture. To perform quantifications we developed lr-kallisto, which adapts the kallisto bulk and single-cell RNA-seq quantification methods for long-read technologies.</p></abstract></article-meta></front><body><sec id="S1"><title>Introduction</title><p id="P4">Advances in long-read RNA sequencing are facilitating transcript discovery, annotation improvements, and detection of isoform switching, thanks to reductions in cost and decreasing error rates as the technologies mature (<xref rid="R1" ref-type="bibr">1</xref>&#x02013;<xref rid="R3" ref-type="bibr">3</xref>). Specifically, long-read RNA-seq can readily detect gene fusion transcripts and other expressed rearrangements in cancer (<xref rid="R4" ref-type="bibr">4</xref>), and isoform switching of biological consequence across development (<xref rid="R5" ref-type="bibr">5</xref>, <xref rid="R6" ref-type="bibr">6</xref>). In translational genomics, precision medicine workflows are increasingly including gene and transcript ontology. These capabilities depend, in part, on accurate annotation of the genomes and transcriptomes of human and model organisms, though they remain incomplete (<xref rid="R7" ref-type="bibr">7</xref>, <xref rid="R8" ref-type="bibr">8</xref>). Improvements in long-read sequencing now allow for much needed refinement of annotations for human and model organisms, coupled with rapid generation of genomes and annotations for non-model organisms (<xref rid="R9" ref-type="bibr">9</xref>). Importantly, while annotation is mainly facilitated by transcript discovery, quantification of isoforms is critical for filtering and thresholding steps that are prerequisites for resolving locus structure and quantifying their expression products (<xref rid="R10" ref-type="bibr">10</xref>).</p><p id="P5">While recent increases in affordability and sequence quality are bringing full-isoform quantification within reach, the long-read platforms are still rapidly changing and less mature than short-read technologies (<xref rid="R2" ref-type="bibr">2</xref>). For example, Oxford Nanopore Technology (ONT) sequencing has evolved over many versions of chemistry in the library preparation kits, pores, and signal processing algorithms. This has resulted in a range of ONT data with various error profiles and error distributions within the sequences. Of the quantification tools that have been developed so far (<xref rid="R11" ref-type="bibr">11</xref>&#x02013;<xref rid="R19" ref-type="bibr">19</xref>), many are optimized for performance with a given generation of long-read data and are now antiquated, in both accuracy and efficiency, for processing the low error rate ONT data currently being produced. Moreover, many methods are based on the assumption of near uniform distribution of sequencing error along reads; we found, as have others (<xref rid="R20" ref-type="bibr">20</xref>), that this does not hold in practice. Furthermore, some ONT sequencing biases have now been described, including non-uniformly distributed sequencing error and sequence influenced error, such as higher GC content and repeat regions increasing sequencing/base calling error (<xref rid="R21" ref-type="bibr">21</xref>).</p><p id="P6">By contrast, several accurate and efficient tools have been developed for short read RNA-seq preprocessing (<xref rid="R22" ref-type="bibr">22</xref>&#x02013;<xref rid="R27" ref-type="bibr">27</xref>). However, even with the recent significant reduction in the long-read RNA-seq error rates to ~0.5%, sequencing errors remain informatically problematic and are comparatively much higher than the ~0.01% in short-read RNA-seq. This makes the application of the fastest pseudoalignment methods (<xref rid="R25" ref-type="bibr">25</xref>, <xref rid="R27" ref-type="bibr">27</xref>) to long-reads nontrivial. Our approach, which builds on kallisto (<xref rid="R23" ref-type="bibr">23</xref>&#x02013;<xref rid="R25" ref-type="bibr">25</xref>, <xref rid="R28" ref-type="bibr">28</xref>) and which we term lr-kallisto, demonstrates the feasibility of pseudoalignment for long-reads; we show via a series of results on both biological and simulated data that lr-kallisto retains the efficiency of kallisto thanks to pseudoalignment, and is accurate on long-read data. Furthermore, we show that lr-kallisto is robust to error rates, making it suitable also for the analysis of previously published older long-read sequencing data.</p></sec><sec id="S2"><title>Results</title><p id="P7">To assess the accuracy of lr-kallisto with respect to data from the current Oxford Nanopore Technologies platform (see <xref rid="S4" ref-type="sec">Materials and Methods</xref>) we generated a deep coverage, high fidelity dataset using long-read sequence and an Illumina short-read sequence SPLiT-Seq nuclei of the left cortices of two mouse strains as part of the IGVF consortium (<xref rid="R29" ref-type="bibr">29</xref>). Specifically, 4 biological replicates (2 males and 2 females) were assayed from both C57BL6/J and CAST/EiJ mice, all at 10 weeks of age, with libraries generated with and without targeted exome capture of all mouse protein coding exons using the Twist Biosciences Mouse exome panel of 215,000 probes (<xref rid="F1" ref-type="fig">Fig. 1a</xref>; see <xref rid="S4" ref-type="sec">Methods</xref>). Thus our exome capture transcriptome will be enriched for reads overlapping one or more coding exons in the same cell. This platform and experimental design was chosen to produce starting data with a highly relevant sequencing error profile for two very well characterized genomes whose natural genetic variation between strains is similar to that found within individual human genomes. This also sets the stage for using lr-kallisto to study natural genetic variation.</p><p id="P8">We found no effective difference in read lengths with reads generated from exome capture as opposed to non-exome capture libraries (<xref rid="F1" ref-type="fig">Fig. 1b</xref>), though the exome capture library showed a smaller fraction of mono-exonic reads (<xref rid="F1" ref-type="fig">Fig. 1c</xref>). This indicated that exome capture is an effective approach to increasing the transcriptome complexity of libraries. The Illumina and ONT sequenced libraries displayed high transcript abundance concordance after quantification with lr-kallisto (<xref rid="F1" ref-type="fig">Fig. 1d</xref>&#x02013;<xref rid="F1" ref-type="fig">g</xref>), showing that lr-kallisto accurately quantifies transcripts from long-reads, as well as demonstrating that deeply sequenced ONT libraries are suitable for high accuracy quantification. The concordance correlation coefficients (CCC), which measure how close the ONT and Illumina quantifications are to being identical, were high for both the exome capture and non-exome capture libraries (0.95 and 0.96, respectively). Importantly, when comparing all long-reads that were subject to exome capture versus those that were not, we observed a 3-fold increase in the percentage of spliced reads aligning (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1a</xref>). Thus, we find that exome capture reads help overcome the limitations of RNA sampling in the nucleus, including expected reads from unspliced precursor transcripts. The effect, as others have noted (<xref rid="R30" ref-type="bibr">30</xref>) is to provide more informative reads to study full-length, spliced transcript isoform usage at lower cost. Furthermore, lr-kallisto outperforms Bambu (<xref rid="R15" ref-type="bibr">15</xref>), IsoQuant (<xref rid="R17" ref-type="bibr">17</xref>), and Oarfish (<xref rid="R16" ref-type="bibr">16</xref>) with respect to CCC, Pearson correlation, and Spearman correlation (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1b</xref>). In particular, the lr-kallisto CCC is 0.95 versus 0.82 for the recently published Oarfish long-read quantification tool. We found that lr-kallisto also outperforms Bambu (CCC = 0.86) and IsoQuant (CCC = 0.78) (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1b</xref>), which have previously been shown to outperform other long-read quantification methods (<xref rid="R2" ref-type="bibr">2</xref>, <xref rid="R31" ref-type="bibr">31</xref>). In addition to being more accurate than other methods, lr-kallisto is also more computationally efficient (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1c</xref>). Note that the dramatic difference in time scales between PacBio and ONT is due to the number of reads in the ONT datasets being much higher, in general.</p><p id="P9">Importantly, lr-kallisto can be used for both high-throughput bulk RNA-seq as well as single-cell or single-nuclei RNA-seq datasets (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1d</xref>), and is not only faster than other tools, but also benefits from the low-memory requirements of kallisto (<xref rid="R23" ref-type="bibr">23</xref>, <xref rid="R28" ref-type="bibr">28</xref>). For single-nuclei RNA-seq processing, we used splitcode (<xref rid="R32" ref-type="bibr">32</xref>) to extract nuclei barcodes, umis, and reads from the raw ONT reads and then pseudoaligned and quantified the reads with lr-kallisto (see <xref rid="S4" ref-type="sec">Methods</xref>). 100% of barcodes from the ONT reads that passed filtering were also found in Illumina sequenced reads (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1d</xref>). Increased UMI depth per nucleus yields higher Spearman correlations, indicating that with deeper sequencing depth, short and long read correlations will only improve (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1dI</xref>). To assess the observed correlations between Nanopore and Illumina, we evaluated random oligo vs 3&#x02019; priming in Illumina sequenced reads and ONT sequenced reads separately, in the same fashion, finding lower correlations (majority of nuclei having a Spearman <italic toggle="yes">&#x003c1;</italic> between 0.10 and 0.30) than between ONT sequenced reads and Illumina sequenced reads (<xref rid="SD1" ref-type="supplementary-material">Supplemental Fig. 1dII</xref>&#x02013;<xref rid="SD1" ref-type="supplementary-material">III</xref>).</p><p id="P10">We also examined the concordance between the exome capture and non-exome capture in both long and short reads, and found it to be only CCC = 0.88, highlighting the distortion resulting from the coupling of exome capture with a mix of 3&#x02019;-end and randomly primed read sequencing that is characteristic of Parse (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 1e</xref>).</p><p id="P11">The lr-kallisto quantification results are corroborated when comparing its performance to other tools on previously published data that is less deeply sequenced. In a comparison of Illumina and ONT on the HCT116 cancer cell line dataset generated by SG-NEx (<xref rid="R33" ref-type="bibr">33</xref>), we found that lr-kallisto could accurately quantify isoform level expression, in performance comparisons constituting two replicates of direct cDNA and direct RNA (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2a</xref>). The CCC performance of lr-kallisto exceeded that of Oarfish, evaluated on this data in (<xref rid="R16" ref-type="bibr">16</xref>). Spearman correlations were lower overall in this dataset, indicating poor data quality, perhaps due to the lower coverage and higher sequencing error rate. We also compared lr-kallisto&#x02019;s performance on direct RNA to direct cDNA (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2b</xref>). We also found better performance with direct cDNA versus direct dRNA, and hypothesize that this is likely due to ~4 times the depth of coverage for replicate 4 in direct cDNA (7,656,893 reads) vs the direct RNA replicate 4 (1,896,643 reads), whereas replicate 3 direct cDNA (873,077 reads) vs direct RNA (1,185,183 reads) does not have the increased depth of coverage. We also compared lr-kallisto to Bambu, IsoQuant, and Oarfish on a previously sequenced mouse cortex PacBio dataset (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 2c</xref>). On this dataset (<xref rid="R34" ref-type="bibr">34</xref>, <xref rid="R35" ref-type="bibr">35</xref>), which has an error rate of 12.4% (see <xref rid="S4" ref-type="sec">Methods</xref>) and a different error profile with errors more uniformly distributed along transcripts, we found similar performance between programs with lr-kallisto slightly outperforming other tools in CCC.</p><p id="P12">We benchmarked lr-kallisto&#x02019;s stability and robustness compared to other long-read quantification tools across species, platforms, and protocols, by evaluating lr-kallisto&#x02019;s performance, along with Bambu, IsoQuant, and Oarfish using the LRGASP&#x02019;s challenge 2 benchmark (<xref rid="R2" ref-type="bibr">2</xref>) of long-read quantification tools (<xref rid="F2" ref-type="fig">Fig. 2</xref>). For our benchmarking, we chose to focus on the Mouse ES data, as it had lower sequencing error rates across 3 out of the 4 protocol/platform combinations, thereby serving as the closer proxy for current long-read data. We found that Bambu, IsoQuant, lr-kallisto, and Oarfish all achieved reasonably high CCCs between replicates, both with respect to abundance estimates (<xref rid="F2" ref-type="fig">Fig. 2a</xref>), and variability between isoforms (<xref rid="F2" ref-type="fig">Fig. 2b</xref>). For completeness, we also compared the performance of lr-kallisto to Bambu, IsoQuant, Oarfish using the metrics of the LRGASP paper (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 3</xref>). Resolution Entropy (RE) is a measure of how well a tool uniformly quantifies at different expression levels. Irreproducibility Measure (IM) is a measure of how reproducibly the tool quantifies expression across replicates, i.e., whether the coefficient of variation between replicates is low. Consistency Measure (CM) is a measure of how consistent the tool is at detecting expressed transcripts, assuming that transcripts should be expressed simultaneously across replicates, and ACVC is the Area under the Coefficient of Variation Curve, which again assumes that for a given mean expression level across replicates the coefficient of variation should be low. We found that lr-kallisto performs as well as other programs on these stability and robustness measures. The variability that we found in quantifications of replicates can be explained by variable depth of sequencing between the replicates and between the protocols and platforms (<xref rid="R2" ref-type="bibr">2</xref>). The notable difference in ONT cDNA is due in part to a sequencing error rate of ~12%, which is characteristic of data obtained in earlier ONT platform versions (<xref rid="R36" ref-type="bibr">36</xref>).</p><p id="P13">We assessed the performance of lr-kallisto using simulated data across a range of sequencing error profiles, and compared with results on the same simulated data for five other widely used or recently published programs. We used simulations generated by (<xref rid="R17" ref-type="bibr">17</xref>) who used the IsoSeqSim simulator (see <xref rid="S14" ref-type="sec">Data and Code Availability</xref>) to generate PacBio reads (6 million <italic toggle="yes">Mus musculus</italic> reads with ~1.4% sequencing error rate), and NanoSim (<xref rid="R18" ref-type="bibr">18</xref>) to generate ONT.R10.4 reads (30 million <italic toggle="yes">Mus musculus</italic> reads with ~2.8% sequencing error rate). The PacBio IsoSeqSim Simulation (<xref rid="F3" ref-type="fig">Fig. 3a</xref>) demonstrates lr-kallisto&#x02019;s high accuracy compared to the currently leading benchmarked long-read quantification tools Bambu, IsoQuant, and Oarfish, with lr-kallisto achieving a CCC of 0.98, vs 0.90, 0.91, and 0.99, respectively (<xref rid="R2" ref-type="bibr">2</xref>, <xref rid="R31" ref-type="bibr">31</xref>). Furthermore, in the ONT NanoSim R10.4 Simulation (<xref rid="F3" ref-type="fig">Fig. 3b</xref>), lr-kallisto ties for the highest CCC of 0.97, vs 0.88 and 0.91, respectively.</p><p id="P14">We performed additional comparative evaluations of Bambu, IsoQuant, lr-kallisto, and Oarfish on a more extensive set of simulations to understand the strengths and weaknesses these tools when confronted with different sequencing error challenges (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 4</xref>). We found that lr-kallisto and IsoQuant were both robust to indel and substitution profiles simulated to match PacBio sequencing data and uniformly distributed. IsoQuant was also robust to uniformly distributed sequencing errors with indel and substitution profiles matched to ONT, whereas lr-kallisto performance degraded at higher ONT error rates in this simulation (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 4a</xref>). In particular, this highlights lr-kallisto&#x02019;s sensitivity to the unrealistic combination of uniform sequencing error distribution and higher rate of insertion errors in ONT versus PacBio.</p><p id="P15">In another ONT simulation generated with NanoSim to produce reads with an 11.2% error rate (see <xref rid="S14" ref-type="sec">Data and Code Availability</xref>), lr-kallisto achieved a CCC of 0.31 on all transcripts, outperforming IsoQuant (CCC = 0.28), and underperforming Bambu (CCC = 0.51), and Oarfish (CCC = 0.55) (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 4b</xref>). This was also the case at a higher error rate (15.2%), with lr-kallisto continuing to outperform IsoQuant and underperform Bambu and Oarfish (Bambu CCC = 0.53, IsoQuant CCC = 0.32, lr-kallisto CCC = 0.34, Oarfish CCC = 0.58) (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 4c</xref>).</p><p id="P16">The performance of lr-kallisto benefits from quantification with respect to a de Bruijn graph (<xref rid="R28" ref-type="bibr">28</xref>). We tested whether and to what extent changing the <italic toggle="yes">k</italic>-mer length default in lr-kallisto to 63 bp long vs 31 bp long in the reference transcriptome de Bruijn graph creates a less connected and less complex structure (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 5</xref>). In this example, of the Pax2 gene, we find that a change of <italic toggle="yes">k</italic>-mer length simplifies the T-DBG with the reduction of a single node and 2 edges. However, when we scale this out to just the first 1000 transcripts listed in the LRGASP basic gencode human annotation, we found a reduction from 3,698 nodes using the 31 <italic toggle="yes">k</italic>-mer T-DBG to 2,708 nodes using the 63 <italic toggle="yes">k</italic>-mer T-DBG and 4,687 edges to 3,238 edges, respectively. Furthermore, the largest connected T-DBG graph component in the 63 <italic toggle="yes">k</italic>-mer T-DBG is composed of 12.59% of the bp vs 65.90% in the 31 <italic toggle="yes">k</italic>-mer T-DBG. We believe that the selection of higher quality, low sequencing error regions from the reads by the 63 <italic toggle="yes">k</italic>-mer T-DBG, combined increasing the probability of uniquely mapping, or at the very least mapping to a transcript compatibility class with less transcripts, is producing more accurate and more efficient pseudoalignment.</p></sec><sec id="S3"><title>Discussion</title><p id="P17">With Oxford Nanopore sequencing becoming more accessible due to low entry costs and reduced sequencing error rate (<xref rid="R37" ref-type="bibr">37</xref>), long-read sequencing is advancing our ability to decipher the complexity of transcriptomes. Increasing throughput now makes it possible to not only perform discovery with long-read sequencing, but also to accurately quantify transcript abundances, and we have shown that results comparable to short-read sequencing can be achieved at reasonable cost with exome capture, and with high accuracy quantification using lr-kallisto. Exome capture will be especially helpful for filtering out intronic reads that would be otherwise sequenced in (single-)nucleus data, as nuclei are replete with intron lariats and partially processed transcripts. lr-kallisto is highly accurate in producing quantification results on data with less than 10% sequencing error rate comparable to those with short-read sequencing. This makes lr-kallisto immediately useful for current long-read sequencing transcriptome projects, although performance will not be as good on legacy higher error long-read sequencing datasets.</p><p id="P18">Furthermore, as described in <xref rid="S4" ref-type="sec">Methods</xref>, lr-kallisto is useful for long-read sequencing of single-cell and single-nucleus RNA-seq libraries when coupled with tools designed for barcode discovery (<xref rid="R32" ref-type="bibr">32</xref>, <xref rid="R38" ref-type="bibr">38</xref>). Furthermore, lr-kallisto is comptible with translated pseudoalignment, which can be useful for detection of viruses (<xref rid="R39" ref-type="bibr">39</xref>).</p><p id="P19">Finally, in this work we have focused on quantification. However, lr-kallisto can also be used, in principle, for transcript discovery. In particular, reads that do not pseudoalign with lr-kallisto can be assembled to construct contigs from unannotated, or incompletely annotated, transcripts.</p></sec><sec id="S4"><title>Methods</title><sec id="S5"><title>lr-kallisto.</title><p id="P20">Many approaches have been applied to RNA-seq quantification from classical alignment approaches to pseudoalignment paired with likelihoods and expectation-maximization (EM). Due to its speed, efficiency, and accuracy, pseudoalignment with likelihoods and EM has been widely adopted for the mapping of short read RNA-seq. However, for long-read RNA-seq, minimap2 has become the standard for aligning long-reads. Minimap2 follows the standard genome alignment methodology of seed-chain-align (<xref rid="R20" ref-type="bibr">20</xref>). It creates a reference index in the form of hashing minimizers into keys for a reference hash table storing the list of genomic/transcriptomic locations of the minimizer. For each read, minimap2 uses read minimizers as seeds matching these to the reference hash table and identifies the optimal collinear chain(s) of matches. While this method is accurate and has been developed to be highly efficient for the alignment strategy used, it is still time and resource expensive with high memory storage demands.</p><p id="P21">lr-kallisto, building on the existing framework of kallisto and adapting the pseudoalignment and expectation-maximization algorithm for long-reads, gives an accurate, fast, and low resource solution for mapping long-reads. The main technical challenge of long-reads lies in the higher sequencing error rates, though others include the differing rates of substitutions, deletions, and insertions between long-read sequencing technologies, sequencing length, repetitive regions, and concatemers. To address the challenge of higher sequencing error, different methods, including minimap2 (<xref rid="R20" ref-type="bibr">20</xref>), uLTRA (<xref rid="R40" ref-type="bibr">40</xref>), and STAR (<xref rid="R41" ref-type="bibr">41</xref>) have utilized various approaches to long-read alignment. Minimap2 uses a small <italic toggle="yes">k</italic>-mer size of 14 and 15 for long-reads, while uLTRA employs a two-pass chaining algorithm to improve alignment accuracy. Strobemers have been suggested using fuzzy <italic toggle="yes">k</italic>-mers that allow error tolerance (<xref rid="R42" ref-type="bibr">42</xref>). In lr-kallisto, we, instead, propose a long <italic toggle="yes">k</italic>-mer length and &#x0201c;chaining&#x0201d; pseudoalignment for addressing the challenges of long-read alignment.</p><p id="P22">We must address two points: first, that sequencing length and long-read sequencing error rates require a different algorithmic approach to pseudoalignment and, second, the length bias in sampling longer transcripts less times. To address the first, we propose the following algorithm for pseudoalignment and the change of index <italic toggle="yes">k</italic>-mer length to 63, which we discuss after describing the algorithm. Both of these changes take into consideration the sequencing error rate and repetitive regions across genes. While this idea is not a direct implementation of the chaining described in (<xref rid="R20" ref-type="bibr">20</xref>), it can be understood in a similar way. Within kallisto&#x02019;s pseudoalignment, a read&#x02019;s transcript compatibility class is determined. For short reads, this is accomplished with a strategy that increases efficiency by checking the transcript compatibility class for the first, middle, and end of <italic toggle="yes">k</italic>-mers in the read if the distance to the end of the contig is longer than the read or the first, middle, and end <italic toggle="yes">k</italic>-mers of the read within the region that is consistent with the contig in the transcriptome de Bruijn graph (T-DBG) (to ensure that the read is consistent with the T-DBG junctions) and then proceeds to the next contig in the read. If they are all the same, these are the only <italic toggle="yes">k</italic>-mers checked, while if they differ a more iterative approach is taken. We then take the intersection of these transcript compatibility classes. Whereas, in lr-kallisto, if the intersection of transcript compatibility classes (TCCs) a read maps to is empty, we instead take the most often occurring TCC. Moreover, if at least one <italic toggle="yes">k</italic>-mer maps uniquely to a transcript, then we take the most often occurring TCC among mapping <italic toggle="yes">k</italic>-mers that are uniquely mapping to a single transcript. In the case of the intersection, the intersection can directly be interpreted as the transcript or set of transcripts that the read has the longest combined stretches of compatibility with, since the intersection takes the subset of transcripts that coexist between all <italic toggle="yes">k</italic>-mers with compatible transcripts. However, the intersection may be empty in the case of a variant or error creating an isolated stretch of compatibility with a disjoint transcript compatibility class. Furthermore, in the case that the intersection is empty and the algorithm switches to using the mode of transcript compatibility classes with threshold one, the calculated mode across all transcript compatibility classes that <italic toggle="yes">k</italic>-mers in the read mapped to is the transcript or set of transcripts that again is the &#x0201c;longest chain&#x0201d; of compatibility.</p><p id="P23">The change of <italic toggle="yes">k</italic>-mer length to 63 was based on empirical evidence showing improved performance over the standard <italic toggle="yes">k</italic>-mer length of 31 for short reads. We found that across long-read technologies and simulations there was an improvement in metrics of Normalized Root Mean Squared Error and Spearman&#x02019;s correlation between lr-kallisto quantifications and the ground truth. In real data (both PacBio and ONT), we observed an increased rate of alignment of reads with a longer <italic toggle="yes">k</italic>-mer length for PacBio sequencing error rate less than 2% and for ONT sequencing error rate less than 10%. Moreover, the longer <italic toggle="yes">k</italic>-mer length improves the quality of mapping <italic toggle="yes">k</italic>-mers making it more probable that the read originates from the transcript compatibility class it maps to. As k increases, the number of distinct <italic toggle="yes">k</italic>-mers also increases, but the number of contigs decreases. This implies that the number of transcripts in a transcript compatibility class decreases on average with increasing length of k. Overall, the complexity of the T-DBG decreases (<xref rid="SD1" ref-type="supplementary-material">Supplementary Fig. 5</xref>), increasing the probability of the read originating from the transcript compatibility class it is mapping to. Furthermore, this also increases the probability of the intersection of equivalence classes being nonempty, which increases the overall mapping rate.</p><p id="P24">To address the second point, we adapted the effective length within kallisto to be transcript specific, i.e., defining the effective transcript length for a transcript <italic toggle="yes">t</italic> to be:
<disp-formula id="FD1">
<mml:math id="M1" display="block"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>eff</mml:mtext><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mrow><mml:mtext>reads</mml:mtext><mml:mspace width="0.5em"/><mml:mtext>aligning</mml:mtext><mml:mspace width="0.5em"/><mml:mtext>to</mml:mtext><mml:mspace width="0.5em"/><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mo>#</mml:mo><mml:mtext>reads</mml:mtext><mml:mspace width="0.5em"/><mml:mtext>aligning</mml:mtext><mml:mspace width="0.5em"/><mml:mtext>to</mml:mtext><mml:mspace width="0.5em"/><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:mi>k</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math>
</disp-formula></p><p id="P25">We use the first 1 million aligning reads to compute these effective, transcript-specific lengths. We found that length normalization was effective at low sequencing error rates (&#x0003c; 2%), providing a slight improvement in results, and was detrimental to performance at high sequencing error rates.</p><p id="P26">Finally, we implemented a change to the expectation-maximization (EM) algorithm for long-reads. In the default option, we initialize transcript abundances to a uniform distribution on the multi mapping counts with the unique counts for each transcript added to the initialization of a transcript abundance. In the long-read option, we first apportion multi-mapping reads using the EM algorithm starting with a uniform distribution of multi-mapping reads among those mapped to transcripts, and then post EM we add the uniquely mapping counts to each transcript. We found that the latter option works better for the PacBio InDel profile with uniform error in reads and has reduced performance in the wild with real PacBio and ONT reads and simulations based on real data.</p></sec><sec id="S6"><title>Mice and Tissue Collection.</title><p id="P27">Mice were housed at the UC Irvine Transgenic Mouse Facility (TMF) in a temperature-controlled pathogen-free room under 12-hour light/dark cycles (lights on at 07:00 hr, off at 19:00 hr). The animal experiments were reviewed and approved by the Institutional Animal Care and Use Committee (IACUC), protocol AUP-21&#x02013;106, &#x0201c;Mouse genomic variation at single cell resolution&#x0201d;. Left cerebral cortex tissues of 10-week-old mice were harvested from 4 C57BL/6J and 4 CAST/EiJ (2 males and 2 females per genotype) between the hours of 09:00 to 13:00. Tissues were stored in 1 mL Bambanker media in cryotubes kept at &#x02212;80&#x000b0;C until nuclei isolation.</p></sec><sec id="S7"><title>Purification of Nuclei from Mouse Tissues.</title><p id="P28">Tissues were thawed in Bambanker media on ice until the tissue could be extracted and lysed using Nuclei Extraction Buffer (Miltenyi Biotec cat. #130&#x02013;128-024). Using forceps, tissues were transferred to a chilled gentle MACS C Tube (Miltenyi Biotec cat. #130&#x02013;093-237) with 2 mL Nuclei Extraction Buffer supplemented with 0.2 U/&#x003bc;L RNase Inhibitor (New England Biolabs cat. M0314L). Nuclei were dissociated from whole tissue using a gentleMACS Octo Dissociator (Miltenyi Biotec cat. #130&#x02013;095-937). The resulting suspension was filtered through a 70 &#x003bc;m MACS SmartStrainer then a 30 &#x003bc;m strainer (Miltenyi Biotec cat. #130&#x02013;110-916 and #130&#x02013;098-458, respectively). Nuclei were resuspended in 3 mL PBS + 7.5% BSA (Life Technologies cat. #15260037) and 0.2 U/&#x003bc;L RNase inhibitor for manual counting using a hemocytometer and DAPI stain (Thermo Fisher cat. #R37606).</p></sec><sec id="S8"><title>Nuclei Fixation.</title><p id="P29">After counting, 4 million nuclei per sample were fixed using Parse Biosciences&#x02019; Nuclei Fixation Kit v2 (cat. #ECF2003), following the manufacturer&#x02019;s protocol. Briefly, nuclei were incubated in fixation solution for 10 minutes on ice, followed by permeabilization for 3 minutes on ice. The reaction was quenched, then nuclei were centrifuged and resuspended in 300 &#x003bc;L Nuclei Buffer (Parse Biosciences cat. #ECF2003) for a final count. DMSO (Parse Biosciences cat. #ECF2003) was added before freezing fixed nuclei at &#x02212;80&#x000b0;C in a Mr. Frosty (Sigma-Aldrich cat. #635639).</p></sec><sec id="S9"><title>Split-Seq Experimental Protocol.</title><p id="P30">Nuclei were barcoded using Parse Biosciences&#x02019; WT Kit v2 (cat. #ECW02030), following the manufacturer&#x02019;s protocol. Fixed, frozen nuclei were thawed in a 37&#x000b0;C water bath and added to the Round 1 reverse transcription barcoding plate at 19,500 nuclei per well, with alternating columns in rows A and C containing C57BL/6J males and females and rows B and D containing CAST/EiJ males and females. In situ reverse transcription (RT) and annealing of barcode 1 + linker was performed using a thermocycler (Bio-Rad T100, cat. #1861096). After RT, nuclei were pooled and distributed in 96 wells of the Round 2 ligation barcoding plate for the in situ barcode 2 + linker ligation. After Round 2 ligation, nuclei were pooled and redistributed into 96 wells of the Round 3 ligation barcoding plate for the in situ barcode 3 + UMI + Illumina adapter ligation. Finally, nuclei were counted using a hemocytometer and distributed into 8 subpools of 13,000 nuclei. The nuclei in each subpool were lysed and cDNA was purified using AMPure XP beads (Beckman Coulter cat. #A63881), then the barcoded cDNA underwent template switching and amplification. Importantly, for two subpools (&#x0201c;13G&#x0201d; and &#x0201c;13H&#x0201d;) we increased the number of PCR cycles to 13 cycles from 12, and increased the extension time from 3 minutes to 13 minutes in order to increase the yield of full-length barcoded cDNA. cDNA from one of the subpools (&#x0201c;13G&#x0201d;) also received exome capture treatment using Parse Biosciences&#x02019; Custom Gene Capture Kit (cat. #GCE1001) and a Mouse Exome Panel (Twist Bioscience, cat. #102036). 1 &#x003bc;g of cDNA was hybridized with a blocker solution to block repetitive sequences, then hybridized with the exome panel overnight. Captured molecules were purified using Streptavidin beads, then amplified again using the cDNA amplification reagents from the WT Kit v2 (Parse Biosciences cat. #ECW02030). The cDNA for all 8 subpools were cleaned using AMPure XP beads and quality checked using an Agilent Bioanalyzer before proceeding to Illumina and Nanopore library preparation. All 8 subpools were fragmented, size-selected using AMPure XP beads, and Illumina adapters were ligated. The cDNA fragments were cleaned again using beads and amplified, adding the fourth barcode and P5/P7 adapters, followed by size selection and quality checking with a Bioanalyzer. Libraries were sequenced with two runs of the Illumina NextSeq 2000 sequencer with P3 200 cycles kits (1.1 billion reads) and paired-end run configuration 140/86/6/0. Libraries with 5% PhiX spike-in were loaded at 1000 pM for one run and 1100 pM for the second run and sequenced to an average depth of # million reads per library.</p></sec><sec id="S10"><title>Long-Read-Split-Seq Experimental Protocol and Base Calling.</title><p id="P31">Nuclei were barcoded and cDNA was purified as specified in the previous section. LR-Split-seq libraries were generated using an input of 200 fmol from the amplified, barcoded Split-seq cDNA before fragmentation (section 2 of the Split-seq protocol). Libraries were built using Oxford Nanopore Technologies Ligation Sequencing Kit (SQK-LSK114) and NEBNext Companion Module for Oxford Nanopore Technologies Ligation Sequencing (E7180L). The Short Fragment Buffer (SFB) from the Ligation Sequencing Kit (SQK-LSK114) during the second wash step. Libraries were loaded on R10.4.1 flowcells (FLO-PRO114M, FLO-MIN114) with an input of 20 fmol and 12 fmol, respectively. Sequencing was performed on the GridION and PromethION 2 Solo instruments using the MinKNOW software.</p><p id="P32">Bases were called from reads with Oxford Nanopore base-calling software Dorado v0.5.0 (<ext-link xlink:href="https://github.com/nanoporetech/dorado" ext-link-type="uri">https://github.com/nanoporetech/dorado</ext-link>) in super-accurate mode using config file dna_r10.4.1_e8.2_400bps_sup@v4.1.0 for both the exome capture and non-exome capture data, as well as the MinION and PromethION data.</p></sec><sec id="S11"><title>Long-Read-Split-Seq Preprocessing and Quantification with splitcode and lr-kallisto.</title><p id="P33">We first used splitcode to find barcodes and umis using linkers and reverse complements of linkers, allowing a total of 3 errors in linkers. We then used a custom python script to reverse the order of barcodes extracted from reverse strand to be in the same order as forward strand barcodes. Subsequently, we apply splitcode to combine and split randO and polyT barcodes from round 1 of Split-Seq barcoding, allowing 1 substitution or indel per barcode, 39,027,314 out of 105,591,654 raw reads passed this pipeline. We then use lr-kallisto to pseudoalign and quantify the resulting reads; 22,197,716 of the reads pseudoalign. We performed QC with a 500 UMI threshold per nuclei and filtered to genes present in at least 100 cells.</p></sec><sec id="S12"><title>Error rate estimation.</title><p id="P34">Error rates for the PacBio dataset (<xref rid="R34" ref-type="bibr">34</xref>) were calculated by analyzing a subsample of 1/8th of the reads using the NanoSim read characterization module with the command &#x02018;read_analysis.py transcriptome -i *fastq* -rg references/genome.fa -rt references/transcriptome.fa -annot references/annotations.gtf -t 8 -o output_folder&#x02019;. Error rates for the LRGASP datasets were also calculated this way, without need for subsampling.</p></sec><sec id="S13"><title>Benchmarking and comparisons.</title><p id="P35">In benchmarks and comparisons of programs, we used Bambu v3.4.1, IsoQuant v3.3.0, and Oarfish v0.5.1. For the HCT116 data we also ran Oarfish 0.3.1 so as to be able to make a direct comparison with the results of (<xref rid="R16" ref-type="bibr">16</xref>). We ran Oarfish according to the scripts at <ext-link xlink:href="https://github.com/COMBINE-lab/lr_quant_benchmarks/blob/0b89465420250d3511044fdc3d988a320aba73c6/snakemake_rules/isoquant_sim_data/alignment/alignment_transcriptome/align.snk" ext-link-type="uri">https://github.com/COMBINE-lab/lr_quant_benchmarks/blob/0b89465420250d3511044fdc3d988a320aba73c6/snakemake_rules/isoquant_sim_data/alignment/alignment_transcriptome/align.snk</ext-link> and <ext-link xlink:href="https://github.com/COMBINE-lab/lr_quant_benchmarks/blob/0b89465420250d3511044fdc3d988a320aba73c6/snakemake_rules/isoquant_sim_data/quantification/oarfish_quant/quant.snk" ext-link-type="uri">https://github.com/COMBINE-lab/lr_quant_benchmarks/blob/0b89465420250d3511044fdc3d988a320aba73c6/snakemake_rules/isoquant_sim_data/quantification/oarfish_quant/quant.snk</ext-link>. In a previous version of this preprint (<xref rid="R43" ref-type="bibr">43</xref>), Oarfish v0.3.1 and v0.4.0 were used and the simulation data was run with SAMtools sort as in (<xref rid="R44" ref-type="bibr">44</xref>). This appears to have resulted in overcounting that degraded Oarfish&#x02019;s performance.</p></sec></sec><sec sec-type="supplementary-material" id="SM1"><title>Supplementary Material</title><supplementary-material id="SD1" position="float" content-type="local-data"><label>Supplement 1</label><media xlink:href="media-1.pdf" id="d67e764" position="anchor"/></supplementary-material></sec></body><back><ack id="S15"><title>Acknowledgements</title><p id="P39">This work was partially supported by UM1 HG012077 to A.M., B.J.W., and L.P. as well as a United States Department of Energy, Office of Science, Office of Advanced Scientific Computing Research, Department of Energy Computational Science Graduate Fellowship under Award Number DE-SC0020347 to R.K.L. D.K.S. was supported by the UCLA-Caltech Medical Scientist Training Program (NIH NIGMS training grant T32 GM008042). We thank Zahra Zare Jousheghani, Noor Pratap Singh, and Rob Patro for comments on consistency and version control following the first version of this manuscript on bioRxiv.</p></ack><sec sec-type="data-availability" id="S14"><title>Data and code availability</title><p id="P36">The LRGASP data can be accessed from the accessions and ftp links listed in the data folder of <ext-link xlink:href="https://github.com/pachterlab/LSRRSRLFKOTWMWMP_2024" ext-link-type="uri">https://github.com/pachterlab/LSRRSRLFKOTWMWMP_2024</ext-link>. IGVF Bridge exome capture and non-exome capture can be accessed from the IGVF portal with the accession IDs in the provided table.</p><p id="P37">The HCT116 cell line SG-NEx data was accessed on March 13, 2024 at <ext-link xlink:href="https://registry.opendata.aws/sg-nex-data" ext-link-type="uri">https://registry.opendata.aws/sg-nex-data</ext-link>. The lr-kallisto method is available via release 0.51 of kallisto at <ext-link xlink:href="https://github.com/pachterlab/kallisto" ext-link-type="uri">https://github.com/pachterlab/kallisto</ext-link>.</p><p id="P38">We used bambu v3.4.1, IsoQuant v3.3.0, and oarfish v0.5.1 (with the exception of analysis of HCT116 data). In the initial version of the preprint, oarfish (v0.3.1 and v0.4.0) were used and the simulation data was run with samtools sort (genome coordinate sorting), causing overcounting in oarfish&#x02019;s performance due to oarfish&#x02019;s use of consecutive alignments of the same read filtering; this has been updated in this version of the manuscript. Simulation data is available at <ext-link xlink:href="https://zenodo.org/records/11201284" ext-link-type="uri">https://zenodo.org/records/11201284</ext-link>. Processed abundance matrices for <xref rid="F1" ref-type="fig">Figures 1</xref>&#x02013;<xref rid="F3" ref-type="fig">3</xref> are available at <ext-link xlink:href="https://zenodo.org/records/13755772" ext-link-type="uri">https://zenodo.org/records/13755772</ext-link>. Code for reproducing the results and figures in the manuscript is available at <ext-link xlink:href="https://github.com/pachterlab/LSRRSRLFKOTWMWMP_2024" ext-link-type="uri">https://github.com/pachterlab/LSRRSRLFKOTWMWMP_2024</ext-link>.</p></sec><ref-list><title>Bibliography</title><ref id="R1"><label>1.</label><mixed-citation publication-type="journal"><name><surname>Amarasinghe</surname><given-names>Shanika L</given-names></name>, <name><surname>Su</surname><given-names>Shian</given-names></name>, <name><surname>Dong</surname><given-names>Xueyi</given-names></name>, <name><surname>Zappia</surname><given-names>Luke</given-names></name>, <name><surname>Ritchie</surname><given-names>Matthew E</given-names></name>, and <name><surname>Gouil</surname><given-names>Quentin</given-names></name>. <article-title>Opportunities and challenges in long-read sequencing data analysis</article-title>. <source>Genome Biology</source>, <volume>21</volume>(<issue>1</issue>):<fpage>30</fpage>, <year>2020</year>.<pub-id pub-id-type="pmid">32033565</pub-id>
</mixed-citation></ref><ref id="R2"><label>2.</label><mixed-citation publication-type="journal"><name><surname>Pardo-Palacios</surname><given-names>Francisco J</given-names></name>, <name><surname>Wang</surname><given-names>Dingjie</given-names></name>, <name><surname>Reese</surname><given-names>Fairlie</given-names></name>, <name><surname>Diekhans</surname><given-names>Mark</given-names></name>, <name><surname>Carbonell-Sala</surname><given-names>S&#x000ed;lvia</given-names></name>, <name><surname>Williams</surname><given-names>Brian</given-names></name>, <name><surname>Loveland</surname><given-names>Jane E</given-names></name>, <etal/>
<article-title>Systematic assessment of long-read RNA-seq methods for transcript identification and quantification</article-title>. <source>bioRxiv</source>, <month>July</month>
<year>2023</year>. doi: <pub-id pub-id-type="doi">10.1101/2023.07.25.550582</pub-id>.</mixed-citation></ref><ref id="R3"><label>3.</label><mixed-citation publication-type="journal"><name><surname>Reese</surname><given-names>Fairlie</given-names></name>, <name><surname>Williams</surname><given-names>Brian</given-names></name>, <name><surname>Balderrama-Gutierrez</surname><given-names>Gabriela</given-names></name>, <name><surname>Wyman</surname><given-names>Dana</given-names></name>, <name><surname>&#x000c7;elik</surname><given-names>Muhammed Hasan</given-names></name>, <name><surname>Rebboah</surname><given-names>Elisabeth</given-names></name>, <name><surname>Rezaie</surname><given-names>Narges</given-names></name>, <etal/>
<article-title>The ENCODE4 long-read RNA-seq collection reveals distinct classes of transcript structure diversity</article-title>. <source>bioRxiv</source>, <month>May</month>
<year>2023</year>. doi: <pub-id pub-id-type="doi">10.1101/2023.05.15.540865</pub-id>.</mixed-citation></ref><ref id="R4"><label>4.</label><mixed-citation publication-type="journal"><name><surname>Sakamoto</surname><given-names>Yoshitaka</given-names></name>, <name><surname>Sereewattanawoot</surname><given-names>Sarun</given-names></name>, and <name><surname>Suzuki</surname><given-names>Ayako</given-names></name>. <article-title>A new era of long-read sequencing for cancer genomics</article-title>. <source>Journal of Human Genetics</source>, <volume>65</volume>(<issue>1</issue>):<fpage>3</fpage>&#x02013;<lpage>10</lpage>, <year>2020</year>.<pub-id pub-id-type="pmid">31474751</pub-id>
</mixed-citation></ref><ref id="R5"><label>5.</label><mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Chaoyang</given-names></name>, <name><surname>Shi</surname><given-names>Zhuoxing</given-names></name>, <name><surname>Huang</surname><given-names>Qingpei</given-names></name>, <name><surname>Liu</surname><given-names>Rong</given-names></name>, <name><surname>Su</surname><given-names>Dan</given-names></name>, <name><surname>Chang</surname><given-names>Lei</given-names></name>, <name><surname>Xiao</surname><given-names>Chuanle</given-names></name>, and <name><surname>Fan</surname><given-names>Xiaoying</given-names></name>. <article-title>Single-cell analysis of isoform switching and transposable element expression during preimplantation embryonic development</article-title>. <source>PLoS Biology</source>, <volume>22</volume>(<issue>2</issue>):<fpage>e3002505</fpage>, <year>2024</year>.<pub-id pub-id-type="pmid">38363809</pub-id>
</mixed-citation></ref><ref id="R6"><label>6.</label><mixed-citation publication-type="journal"><name><surname>Penter</surname><given-names>Livius</given-names></name>, <name><surname>Borji</surname><given-names>Mehdi</given-names></name>, <name><surname>Nagler</surname><given-names>Adi</given-names></name>, <name><surname>Lyu</surname><given-names>Haoxiang</given-names></name>, <name><surname>Lu</surname><given-names>Wesley S</given-names></name>, <name><surname>Cieri</surname><given-names>Nicoletta</given-names></name>, <name><surname>Maurer</surname><given-names>Katie</given-names></name>, <etal/>
<article-title>Integrative genotyping of cancer and immune phenotypes by long-read sequencing</article-title>. <source>Nature Communications</source>, <volume>15</volume>(<issue>1</issue>):<fpage>32</fpage>, <year>2024</year>.</mixed-citation></ref><ref id="R7"><label>7.</label><mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>David</given-names></name>, <name><surname>Guelfi</surname><given-names>Sebastian</given-names></name>, <name><surname>Garcia-Ruiz</surname><given-names>Sonia</given-names></name>, <name><surname>Costa</surname><given-names>Beatrice</given-names></name>, <name><surname>Reynolds</surname><given-names>Regina H</given-names></name>, <name><surname>D&#x02019;Sa</surname><given-names>Karishma</given-names></name>, <name><surname>Liu</surname><given-names>Wenfei</given-names></name>, <etal/>
<article-title>Incomplete annotation has a disproportionate impact on our understanding of mendelian and complex neurogenetic disorders</article-title>. <source>Science Advances</source>, <volume>6</volume>(<issue>24</issue>), <fpage>2020</fpage>. doi: <pub-id pub-id-type="doi">10.1126/sciadv.aay8299</pub-id>.</mixed-citation></ref><ref id="R8"><label>8.</label><mixed-citation publication-type="journal"><name><surname>Frankish</surname><given-names>Adam</given-names></name>, <name><surname>Diekhans</surname><given-names>Mark</given-names></name>, <name><surname>Jungreis</surname><given-names>Irwin</given-names></name>, <name><surname>Lagarde</surname><given-names>Julien</given-names></name>, <name><surname>Loveland</surname><given-names>Jane E</given-names></name>, <name><surname>Mudge</surname><given-names>Jonathan M</given-names></name>, <name><surname>Sisu</surname><given-names>Cristina</given-names></name>, <etal/>
<article-title>GENCODE 2021</article-title>. <source>Nucleic Acids Research</source>, <volume>49</volume> (<issue>D1</issue>):<fpage>D916</fpage>&#x02013;<lpage>D923</lpage>, <year>2021</year>.<pub-id pub-id-type="pmid">33270111</pub-id>
</mixed-citation></ref><ref id="R9"><label>9.</label><mixed-citation publication-type="journal"><name><surname>Warburton</surname><given-names>Peter E</given-names></name> and <name><surname>Sebra</surname><given-names>Robert P</given-names></name>. <article-title>Long-read DNA sequencing: recent advances and remaining challenges</article-title>. <source>Annual Review of Genomics and Human Genetics</source>, <volume>24</volume>:<fpage>109</fpage>&#x02013;<lpage>132</lpage>, <year>2023</year>.</mixed-citation></ref><ref id="R10"><label>10.</label><mixed-citation publication-type="journal"><name><surname>Cook</surname><given-names>David E</given-names></name>, <name><surname>Valle-Inclan</surname><given-names>Jose Espejo</given-names></name>, <name><surname>Pajoro</surname><given-names>Alice</given-names></name>, <name><surname>Rovenich</surname><given-names>Hanna</given-names></name>, <name><surname>Thomma</surname><given-names>Bart PHJ</given-names></name>, and <name><surname>Faino</surname><given-names>Luigi</given-names></name>. <article-title>Long-read annotation: Automated eukaryotic genome annotation based on long-read cdna sequencing</article-title>. <source>Plant Physiology</source>, <volume>179</volume>(<issue>1</issue>):<fpage>38</fpage>&#x02013;<lpage>54</lpage>, <year>2019</year>.<pub-id pub-id-type="pmid">30401722</pub-id>
</mixed-citation></ref><ref id="R11"><label>11.</label><mixed-citation publication-type="journal"><name><surname>Tang</surname><given-names>Alison D</given-names></name>, <name><surname>Soulette</surname><given-names>Cameron M</given-names></name>, <name><surname>van Baren</surname><given-names>Marijke J</given-names></name>, <name><surname>Hart</surname><given-names>Kevyn</given-names></name>, <name><surname>Hrabeta-Robinson</surname><given-names>Eva</given-names></name>, <name><surname>Wu</surname><given-names>Catherine J</given-names></name>, and <name><surname>Brooks</surname><given-names>Angela N</given-names></name>. <article-title>Full-length transcript characterization of sf3b1 mutation in chronic lymphocytic leukemia reveals downregulation of retained introns</article-title>. <source>Nature communications</source>, <volume>11</volume>(<issue>1</issue>):<fpage>1438</fpage>, <year>2020</year>.</mixed-citation></ref><ref id="R12"><label>12.</label><mixed-citation publication-type="journal"><name><surname>Tian</surname><given-names>Luyi</given-names></name>, <name><surname>Jabbari</surname><given-names>Jafar S</given-names></name>, <name><surname>Thijssen</surname><given-names>Rachel</given-names></name>, <name><surname>Gouil</surname><given-names>Quentin</given-names></name>, <name><surname>Amarasinghe</surname><given-names>Shanika L</given-names></name>, <name><surname>Voogd</surname><given-names>Oliver</given-names></name>, <name><surname>Kariyawasam</surname><given-names>Hasaru</given-names></name>, <name><surname>Du</surname><given-names>Mei RM</given-names></name>, <name><surname>Schuster</surname><given-names>Jakob</given-names></name>, <name><surname>Wang</surname><given-names>Changqing</given-names></name>, <etal/>
<article-title>Comprehensive characterization of single-cell full-length isoforms in human and mouse with long-read sequencing</article-title>. <source>Genome biology</source>, <volume>22</volume>:<fpage>1</fpage>&#x02013;<lpage>24</lpage>, <year>2021</year>.<pub-id pub-id-type="pmid">33397451</pub-id>
</mixed-citation></ref><ref id="R13"><label>13.</label><mixed-citation publication-type="journal"><name><surname>Wyman</surname><given-names>Dana</given-names></name>, <name><surname>Balderrama-Gutierrez</surname><given-names>Gabriela</given-names></name>, <name><surname>Reese</surname><given-names>Fairlie</given-names></name>, <name><surname>Jiang</surname><given-names>Shan</given-names></name>, <name><surname>Rahmanian</surname><given-names>Sorena</given-names></name>, <name><surname>Forner</surname><given-names>Stefania</given-names></name>, <name><surname>Matheos</surname><given-names>Dina</given-names></name>, <name><surname>Zeng</surname><given-names>Weihua</given-names></name>, <name><surname>Williams</surname><given-names>Brian</given-names></name>, <name><surname>Trout</surname><given-names>Diane</given-names></name>, <etal/>
<article-title>A technology-agnostic long-read analysis pipeline for transcriptome discovery and quantification</article-title>. <source>Biorxiv</source>, page <fpage>672931</fpage>, <year>2019</year>.</mixed-citation></ref><ref id="R14"><label>14.</label><mixed-citation publication-type="journal"><name><surname>Lienhard</surname><given-names>Matthias</given-names></name>, <name><surname>van den Beucken</surname><given-names>Twan</given-names></name>, <name><surname>Timmermann</surname><given-names>Bernd</given-names></name>, <name><surname>Hochradel</surname><given-names>Myriam</given-names></name>, <name><surname>Boerno</surname><given-names>Stefan</given-names></name>, <name><surname>Caiment</surname><given-names>Florian</given-names></name>, <name><surname>Vingron</surname><given-names>Martin</given-names></name>, and <name><surname>Herwig</surname><given-names>Ralf</given-names></name>. <article-title>Isotools: a flexible workflow for long-read transcriptome sequencing analysis</article-title>. <source>Bioinformatics</source>, <volume>39</volume>(<issue>6</issue>):<fpage>btad364</fpage>, <year>2023</year>.<pub-id pub-id-type="pmid">37267159</pub-id>
</mixed-citation></ref><ref id="R15"><label>15.</label><mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>Ying</given-names></name>, <name><surname>Sim</surname><given-names>Andre</given-names></name>, <name><surname>Yuk Kei Wan</surname><given-names>Keith Yeo</given-names></name>, <name><surname>Lee</surname><given-names>Joseph Jing Xian</given-names></name>, <name><surname>Ling</surname><given-names>Min Hao</given-names></name>, <name><surname>Love</surname><given-names>Michael I</given-names></name>, and <name><surname>G&#x000f6;ke</surname><given-names>Jonathan</given-names></name>. <article-title>Context-aware transcript quantification from long-read RNA-seq data with bambu</article-title>. <source>Nature Methods</source>, <volume>20</volume>(<issue>8</issue>):<fpage>1187</fpage>&#x02013;<lpage>1195</lpage>, <year>2023</year>.<pub-id pub-id-type="pmid">37308696</pub-id>
</mixed-citation></ref><ref id="R16"><label>16.</label><mixed-citation publication-type="journal"><name><surname>Jousheghani</surname><given-names>Zahra Zare</given-names></name> and <name><surname>Patro</surname><given-names>Rob</given-names></name>. <article-title>Oarfish: Enhanced probabilistic modeling leads to improved accuracy in long read transcriptome quantification</article-title>. <source>bioRxiv</source>, <month>March</month>
<year>2024</year>. doi:<pub-id pub-id-type="doi">10.1101/2024.02.28.582591</pub-id>.</mixed-citation></ref><ref id="R17"><label>17.</label><mixed-citation publication-type="journal"><name><surname>Prjibelski</surname><given-names>Andrey D</given-names></name>, <name><surname>Mikheenko</surname><given-names>Alla</given-names></name>, <name><surname>Joglekar</surname><given-names>Anoushka</given-names></name>, <name><surname>Smetanin</surname><given-names>Alexander</given-names></name>, <name><surname>Jarroux</surname><given-names>Julien</given-names></name>, <name><surname>Lapidus</surname><given-names>Alla L</given-names></name>, and <name><surname>Tilgner</surname><given-names>Hagen U</given-names></name>. <article-title>Accurate isoform discovery with IsoQuant using long reads</article-title>. <source>Nature Biotechnology</source>, <volume>41</volume>(<issue>7</issue>):<fpage>915</fpage>&#x02013;<lpage>918</lpage>, <year>2023</year>.</mixed-citation></ref><ref id="R18"><label>18.</label><mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>Chen</given-names></name>, <name><surname>Chu</surname><given-names>Justin</given-names></name>, <name><surname>Warren</surname><given-names>Ren&#x000e9; L</given-names></name>, and <name><surname>Birol</surname><given-names>Inan&#x000e7;</given-names></name>. <article-title>Nanosim: nanopore sequence read simulator based on statistical characterization</article-title>. <source>GigaScience</source>, <volume>6</volume>(<issue>4</issue>):<fpage>gix010</fpage>, <year>2017</year>.</mixed-citation></ref><ref id="R19"><label>19.</label><mixed-citation publication-type="journal"><name><surname>Kabza</surname><given-names>Michal</given-names></name>, <name><surname>Ritter</surname><given-names>Alexander</given-names></name>, <name><surname>Byrne</surname><given-names>Ashley</given-names></name>, <name><surname>Sereti</surname><given-names>Kostianna</given-names></name>, <name><surname>Le</surname><given-names>Daniel</given-names></name>, <name><surname>Stephenson</surname><given-names>William</given-names></name>, and <name><surname>Sterne-Weiler</surname><given-names>Timothy</given-names></name>. <article-title>Accurate long-read transcript discovery and quantification at single-cell resolution with isosceles</article-title>. <source>bioRxiv</source>, pages <fpage>2023</fpage>&#x02013;<lpage>11</lpage>, <year>2023</year>.</mixed-citation></ref><ref id="R20"><label>20.</label><mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>Heng</given-names></name>. <article-title>Minimap2: Pairwise alignment for nucleotide sequences</article-title>. <source>Bioinformatics</source>, <volume>34</volume>(<issue>18</issue>):<fpage>3094</fpage>&#x02013;<lpage>3100</lpage>, <year>2018</year>.<pub-id pub-id-type="pmid">29750242</pub-id>
</mixed-citation></ref><ref id="R21"><label>21.</label><mixed-citation publication-type="journal"><name><surname>Delahaye</surname><given-names>Clara</given-names></name> and <name><surname>Nicolas</surname><given-names>Jacques</given-names></name>. <article-title>Sequencing DNA with nanopores: Troubles and biases</article-title>. <source>PloS One</source>, <volume>16</volume>(<issue>10</issue>):<fpage>e0257521</fpage>, <year>2021</year>.<pub-id pub-id-type="pmid">34597327</pub-id>
</mixed-citation></ref><ref id="R22"><label>22.</label><mixed-citation publication-type="journal"><name><surname>Kaminow</surname><given-names>Benjamin</given-names></name>, <name><surname>Yunusov</surname><given-names>Dinar</given-names></name>, and <name><surname>Dobin</surname><given-names>Alexander</given-names></name>. <article-title>STARsolo: Accurate, fast and versatile mapping/quantification of single-cell and single-nucleus RNA-seq data</article-title>. <source>bioRxiv</source>, <year>2021</year>. doi: <pub-id pub-id-type="doi">10.1101/2021.05.05.442755</pub-id>.</mixed-citation></ref><ref id="R23"><label>23.</label><mixed-citation publication-type="journal"><name><surname>Sullivan</surname><given-names>Delaney K</given-names></name>, <name><surname>Min</surname><given-names>Kyung Hoi Joseph</given-names></name>, <name><surname>Hj&#x000f6;rleifsson</surname><given-names>Kristj&#x000e1;n Eldj&#x000e1;rn</given-names></name>, <name><surname>Luebbert</surname><given-names>Laura</given-names></name>, <name><surname>Holley</surname><given-names>Guillaume</given-names></name>, <name><surname>Moses</surname><given-names>Lambda</given-names></name>, <name><surname>Gustafsson</surname><given-names>Johan</given-names></name>, <etal/>
<article-title>Kallisto, bustools, and kb-python for quantifying bulk, single-cell, and single-nucleus RNA-seq</article-title>. <source>bioRxiv</source>, <month>November</month>
<year>2023</year>. doi: <pub-id pub-id-type="doi">10.1101/2023.11.21.568164</pub-id>.</mixed-citation></ref><ref id="R24"><label>24.</label><mixed-citation publication-type="journal"><name><surname>Melsted</surname><given-names>P&#x000e1;ll</given-names></name>, <name><surname>Booeshaghi</surname><given-names>A Sina</given-names></name>, <name><surname>Liu</surname><given-names>Lauren</given-names></name>, <name><surname>Gao</surname><given-names>Fan</given-names></name>, <name><surname>Lu</surname><given-names>Lambda</given-names></name>, <name><surname>Min</surname><given-names>Kyung Hoi Joseph</given-names></name>, <name><surname>da Veiga Beltrame</surname><given-names>Eduardo</given-names></name>, <etal/>
<article-title>Modular, efficient and constant-memory single-cell RNA-seq preprocessing</article-title>. <source>Nature Biotechnology</source>, <volume>39</volume>(<issue>7</issue>):<fpage>813</fpage>&#x02013;<lpage>818</lpage>, <year>2021</year>.</mixed-citation></ref><ref id="R25"><label>25.</label><mixed-citation publication-type="journal"><name><surname>Bray</surname><given-names>Nicolas L</given-names></name>, <name><surname>Pimentel</surname><given-names>Harold</given-names></name>, <name><surname>Melsted</surname><given-names>P&#x000e1;ll</given-names></name>, and <name><surname>Pachter</surname><given-names>Lior</given-names></name>. <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>. <source>Nature Biotechnology</source>, <volume>34</volume>(<issue>5</issue>):<fpage>525</fpage>&#x02013;<lpage>527</lpage>, <year>2016</year>.</mixed-citation></ref><ref id="R26"><label>26.</label><mixed-citation publication-type="journal"><name><surname>Sarkar</surname><given-names>Hirak</given-names></name>, <name><surname>Srivastava</surname><given-names>Avi</given-names></name>, <name><surname>Zakeri</surname><given-names>Mohsen</given-names></name>, <name><surname>Van Buren</surname><given-names>Scott K</given-names></name>, <name><surname>Rashid</surname><given-names>Naim U</given-names></name>, <name><surname>Love</surname><given-names>Michael I</given-names></name>, and <name><surname>Patro</surname><given-names>Rob</given-names></name>. <article-title>Accurate, efficient, and uncertainty-aware expression quantification of single-cell RNA-seq data</article-title>. <source>bioRxiv</source>, <year>2020</year>. doi: <pub-id pub-id-type="doi">10.6084/m9.figshare.13198100</pub-id>.</mixed-citation></ref><ref id="R27"><label>27.</label><mixed-citation publication-type="journal"><name><surname>Patro</surname><given-names>Rob</given-names></name>, <name><surname>Duggal</surname><given-names>Geet</given-names></name>, <name><surname>Love</surname><given-names>Michael I</given-names></name>, <name><surname>Irizarry</surname><given-names>Rafael A</given-names></name>, and <name><surname>Kingsford</surname><given-names>Carl</given-names></name>. <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>. <source>Nature Methods</source>, <volume>14</volume>(<issue>4</issue>): <fpage>417</fpage>&#x02013;<lpage>419</lpage>, <year>2017</year>.<pub-id pub-id-type="pmid">28263959</pub-id>
</mixed-citation></ref><ref id="R28"><label>28.</label><mixed-citation publication-type="journal"><name><surname>Hj&#x000f6;rleifsson</surname><given-names>Kristj&#x000e1;n Eldj&#x000e1;rn</given-names></name>, <name><surname>Sullivan</surname><given-names>Delaney K</given-names></name>, <name><surname>Holley</surname><given-names>Guillaume</given-names></name>, <name><surname>Melsted</surname><given-names>P&#x000e1;ll</given-names></name>, and <name><surname>Pachter</surname><given-names>Lior</given-names></name>. <article-title>Accurate quantification of single-nucleus and single-cell RNA-seq transcripts</article-title>. <source>bioRxiv</source>, <year>2022</year>. doi: <pub-id pub-id-type="doi">10.1101/2022.12.02.518832</pub-id>.</mixed-citation></ref><ref id="R29"><label>29.</label><mixed-citation publication-type="journal"><collab>IGVF Consortium</collab>. <article-title>The impact of genomic variation on function (IGVF) consortium</article-title>. <source>ArXiv</source>, <year>2023</year>. doi: <pub-id pub-id-type="doi">10.1101/2023.03.28.533945</pub-id>.</mixed-citation></ref><ref id="R30"><label>30.</label><mixed-citation publication-type="journal"><name><surname>Landrith</surname><given-names>Tyler</given-names></name>, <name><surname>Li</surname><given-names>Bing</given-names></name>, <name><surname>Cass</surname><given-names>Ashley A</given-names></name>, <name><surname>Conner</surname><given-names>Blair R</given-names></name>, <name><surname>LaDuca</surname><given-names>Holly</given-names></name>, <name><surname>McKenna</surname><given-names>Danielle B</given-names></name>, <name><surname>Maxwell</surname><given-names>Kara N</given-names></name>, <name><surname>Domchek</surname><given-names>Susan</given-names></name>, <name><surname>Morman</surname><given-names>Nichole A</given-names></name>, <name><surname>Heinlen</surname><given-names>Christopher</given-names></name>, <etal/>
<article-title>Splicing profile by capture rna-seq identifies pathogenic germline variants in tumor suppressor genes</article-title>. <source>NPJ precision oncology</source>, <volume>4</volume>(<issue>1</issue>):<fpage>4</fpage>, <year>2020</year>.<pub-id pub-id-type="pmid">32133419</pub-id>
</mixed-citation></ref><ref id="R31"><label>31.</label><mixed-citation publication-type="journal"><name><surname>Dong</surname><given-names>Xueyi</given-names></name>, <name><surname>Du</surname><given-names>Mei RM</given-names></name>, <name><surname>Gouil</surname><given-names>Quentin</given-names></name>, <name><surname>Tian</surname><given-names>Luyi</given-names></name>, <name><surname>Jabbari</surname><given-names>Jafar S</given-names></name>, <name><surname>Bowden</surname><given-names>Rory</given-names></name>, <name><surname>Baldoni</surname><given-names>Pedro L</given-names></name>, <etal/>
<article-title>Benchmarking long-read RNA-sequencing analysis tools using in silico mixtures</article-title>. <source>Nature Methods</source>, <volume>20</volume>(<issue>11</issue>):<fpage>1810</fpage>&#x02013;<lpage>1821</lpage>, <year>2023</year>.<pub-id pub-id-type="pmid">37783886</pub-id>
</mixed-citation></ref><ref id="R32"><label>32.</label><mixed-citation publication-type="journal"><name><surname>Sullivan</surname><given-names>Delaney K</given-names></name> and <name><surname>Pachter</surname><given-names>Lior</given-names></name>. <article-title>Flexible parsing, interpretation, and editing of technical sequences with splitcode</article-title>. <source>Bioinformatics</source>, <volume>40</volume>(<issue>6</issue>), <fpage>2024</fpage>.</mixed-citation></ref><ref id="R33"><label>33.</label><mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>Ying</given-names></name>, <name><surname>Davidson</surname><given-names>Nadia M</given-names></name>, <name><surname>Wan</surname><given-names>Yuk Kei</given-names></name>, <name><surname>Patel</surname><given-names>Harshil</given-names></name>, <name><surname>Yao</surname><given-names>Fei</given-names></name>, <name><surname>Low</surname><given-names>Hwee Meng</given-names></name>, <name><surname>Hendra</surname><given-names>Christopher</given-names></name>, <etal/>
<article-title>A systematic benchmark of nanopore long read RNA sequencing for transcript level analysis in human cell lines</article-title>. <source>bioRxiv</source>, <year>2021</year>. doi: <pub-id pub-id-type="doi">10.1101/2021.04.21.440736</pub-id>.</mixed-citation></ref><ref id="R34"><label>34.</label><mixed-citation publication-type="journal"><name><surname>Leung</surname><given-names>Szi Kay</given-names></name>, <name><surname>Jeffries</surname><given-names>Aaron R</given-names></name>, <name><surname>Castanho</surname><given-names>Isabel</given-names></name>, <name><surname>Jordan</surname><given-names>Ben T</given-names></name>, <name><surname>Moore</surname><given-names>Karen</given-names></name>, <name><surname>Davies</surname><given-names>Jonathan P</given-names></name>, <name><surname>Dempster</surname><given-names>Emma L</given-names></name>, <etal/>
<article-title>Full-length transcript sequencing of human and mouse cerebral cortex identifies widespread isoform diversity and alternative splicing</article-title>. <source>Cell Reports</source>, <volume>37</volume>(<issue>7</issue>):<fpage>110022</fpage>, <year>2021</year>.<pub-id pub-id-type="pmid">34788620</pub-id>
</mixed-citation></ref><ref id="R35"><label>35.</label><mixed-citation publication-type="journal"><name><surname>Castanho</surname><given-names>Isabel</given-names></name>, <name><surname>Murray</surname><given-names>Tracey K</given-names></name>, <name><surname>Hannon</surname><given-names>Eilis</given-names></name>, <name><surname>Jeffries</surname><given-names>Aaron</given-names></name>, <name><surname>Walker</surname><given-names>Emma</given-names></name>, <name><surname>Laing</surname><given-names>Emma</given-names></name>, <name><surname>Baulf</surname><given-names>Hedley</given-names></name>, <etal/>
<article-title>Transcriptional signatures of tau and amyloid neuropathology</article-title>. <source>Cell Reports</source>, <volume>30</volume>(<issue>6</issue>):<fpage>2040</fpage>&#x02013;<lpage>2054.e5</lpage>, <year>2020</year>.<pub-id pub-id-type="pmid">32049030</pub-id>
</mixed-citation></ref><ref id="R36"><label>36.</label><mixed-citation publication-type="journal"><name><surname>Goodwin</surname><given-names>Sara</given-names></name>, <name><surname>Gurtowski</surname><given-names>James</given-names></name>, <name><surname>Ethe-Sayers</surname><given-names>Scott</given-names></name>, <name><surname>Deshpande</surname><given-names>Panchajanya</given-names></name>, <name><surname>Schatz</surname><given-names>Michael C</given-names></name>, and <name><surname>McCombie</surname><given-names>W Richard</given-names></name>. <article-title>Oxford nanopore sequencing, hybrid error correction, and de novo assembly of a eukaryotic genome</article-title>. <source>Genome research</source>, <volume>25</volume>(<issue>11</issue>):<fpage>1750</fpage>&#x02013;<lpage>1756</lpage>, <year>2015</year>.<pub-id pub-id-type="pmid">26447147</pub-id>
</mixed-citation></ref><ref id="R37"><label>37.</label><mixed-citation publication-type="journal"><name><surname>Bloomfield</surname><given-names>Max</given-names></name>, <name><surname>Hutton</surname><given-names>Samantha</given-names></name>, <name><surname>Velasco</surname><given-names>Charles</given-names></name>, <name><surname>Burton</surname><given-names>Megan</given-names></name>, <name><surname>Benton</surname><given-names>Miles</given-names></name>, <name><surname>Storey</surname><given-names>Matt</given-names></name>, and <collab>ESR Genomics Consortium</collab>. <article-title>Oxford nanopore next generation sequencing in a front-line clinical microbiology laboratory without on-site bioinformaticians</article-title>. <source>Pathology</source>, <volume>56</volume>(<issue>3</issue>):<fpage>444</fpage>&#x02013;<lpage>447</lpage>, <year>2024</year>.<pub-id pub-id-type="pmid">37867010</pub-id>
</mixed-citation></ref><ref id="R38"><label>38.</label><mixed-citation publication-type="journal"><name><surname>Cheng</surname><given-names>Oliver</given-names></name>, <name><surname>Ling</surname><given-names>Min Hao</given-names></name>, <name><surname>Wang</surname><given-names>Changqing</given-names></name>, <name><surname>Wu</surname><given-names>Shuyi</given-names></name>, <name><surname>Ritchie</surname><given-names>Matthew E</given-names></name>, <name><surname>G&#x000f6;ke</surname><given-names>Jonathan</given-names></name>, <name><surname>Amin</surname><given-names>Noorul</given-names></name>, and <name><surname>Davidson</surname><given-names>Nadia M</given-names></name>. <article-title>Flexiplex: a versatile demultiplexer and search tool for omics data</article-title>. <source>Bioinformatics</source>, <volume>40</volume>(<issue>3</issue>), <fpage>2024</fpage>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btae102</pub-id>.</mixed-citation></ref><ref id="R39"><label>39.</label><mixed-citation publication-type="journal"><name><surname>Luebbert</surname><given-names>Laura</given-names></name>, <name><surname>Sullivan</surname><given-names>Delaney K</given-names></name>, <name><surname>Carilli</surname><given-names>Maria</given-names></name>, <name><surname>Hj&#x000f6;rleifsson</surname><given-names>Kristj&#x000e1;n Eldj&#x000e1;rn</given-names></name>, <name><surname>Winnett</surname><given-names>Alexander Viloria</given-names></name>, <name><surname>Chari</surname><given-names>Tara</given-names></name>, and <name><surname>Pachter</surname><given-names>Lior</given-names></name>. <article-title>Efficient and accurate detection of viral sequences at single-cell resolution reveals novel viruses perturbing host gene expression</article-title>. <source>bioRxiv</source>, <year>2023</year>.</mixed-citation></ref><ref id="R40"><label>40.</label><mixed-citation publication-type="journal"><name><surname>Sahlin</surname><given-names>Kristoffer</given-names></name> and <name><surname>M&#x000e4;kinen</surname><given-names>Veli</given-names></name>. <article-title>Accurate spliced alignment of long rna sequencing reads</article-title>. <source>Bioinformatics</source>, <volume>37</volume>(<issue>24</issue>):<fpage>4643</fpage>&#x02013;<lpage>4651</lpage>, <year>2021</year>.<pub-id pub-id-type="pmid">34302453</pub-id>
</mixed-citation></ref><ref id="R41"><label>41.</label><mixed-citation publication-type="journal"><name><surname>Dobin</surname><given-names>Alexander</given-names></name>, <name><surname>Davis</surname><given-names>Carrie A</given-names></name>, <name><surname>Schlesinger</surname><given-names>Felix</given-names></name>, <name><surname>Drenkow</surname><given-names>Jorg</given-names></name>, <name><surname>Zaleski</surname><given-names>Chris</given-names></name>, <name><surname>Jha</surname><given-names>Sonali</given-names></name>, <name><surname>Batut</surname><given-names>Philippe</given-names></name>, <name><surname>Chaisson</surname><given-names>Mark</given-names></name>, and <name><surname>Gingeras</surname><given-names>Thomas R</given-names></name>. <article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>, <volume>29</volume>(<issue>1</issue>):<fpage>15</fpage>&#x02013;<lpage>21</lpage>, <year>2013</year>.<pub-id pub-id-type="pmid">23104886</pub-id>
</mixed-citation></ref><ref id="R42"><label>42.</label><mixed-citation publication-type="journal"><name><surname>Sahlin</surname><given-names>Kristoffer</given-names></name>. <article-title>Effective sequence similarity detection with strobemers</article-title>. <source>Genome Research</source>, <volume>31</volume>(<issue>11</issue>):<fpage>2080</fpage>&#x02013;<lpage>2094</lpage>, <year>2021</year>.<pub-id pub-id-type="pmid">34667119</pub-id>
</mixed-citation></ref><ref id="R43"><label>43.</label><mixed-citation publication-type="journal"><name><surname>Loving</surname><given-names>Rebekah K</given-names></name>, <name><surname>Sullivan</surname><given-names>Delaney K</given-names></name>, <name><surname>Reese</surname><given-names>Fairlie</given-names></name>, <name><surname>Rebboah</surname><given-names>Elisabeth</given-names></name>, <name><surname>Sakr</surname><given-names>Jasmine</given-names></name>, <name><surname>Rezaie</surname><given-names>Narges</given-names></name>, <name><surname>Liang</surname><given-names>Heidi Y</given-names></name>, <name><surname>Filimban</surname><given-names>Ghassan</given-names></name>, <name><surname>Kawauchi</surname><given-names>Shimako</given-names></name>, <name><surname>Oakes</surname><given-names>Conrad</given-names></name>, <etal/>
<article-title>Long-read sequencing transcriptome quantification with lr-kallisto</article-title>. <source>bioRxiv v1</source>, pages <fpage>2024</fpage>&#x02013;<lpage>07</lpage>, <year>2024</year>.</mixed-citation></ref><ref id="R44"><label>44.</label><mixed-citation publication-type="journal"><name><surname>Ji</surname><given-names>Hyun Joo</given-names></name> and <name><surname>Pertea</surname><given-names>Mihaela</given-names></name>. <article-title>Enhancing transcriptome expression quantification through accurate assignment of long rna sequencing reads with transigner</article-title>. <source>bioRxiv v2</source>, pages <fpage>2024</fpage>&#x02013;<lpage>08</lpage>, <year>2024</year>.</mixed-citation></ref></ref-list></back><floats-group><fig position="float" id="F1"><label>Fig. 1.</label><caption><p id="P40">lr-kallisto demonstrates high concordance between Illumina and ONT. (a) Experimental overview for comparison of exome capture vs. non-exome capture LR-Split-seq libraries. (b) Kernel density estimations for read length distributions by capture strategy. (c) Percentage of demultiplexed reads by number of exons in each read between exome and non-exome capture. (d) lr-kallisto pseudobulk quantifications of exome capture for the C57BL/6J sample. (e) lr-kallisto pseudobulk quantifications of exome capture for the CAST/Eij sample. (f) lr-kallisto pseudobulk quantifications of non-exome capture for the C57BL/6J sample. (g) lr-kallisto pseudobulk quantifications of non-exome capture for the CAST/Eij sample. Concordance Correlation Coefficient (CCC), Pearson, and Spearman correlations are shown for each comparison.</p></caption><graphic xlink:href="nihpp-2024.07.19.604364v3-f0001" position="float"/></fig><fig position="float" id="F2"><label>Fig. 2.</label><caption><p id="P41">Comparison of Bambu, IsoQuant, lr-kallisto, and Oarfish in (a) abundance estimates as measured by CCC of expression and (b) variability between isoforms as measured by CCC of isoform CV<sup>2</sup>, with 90% CI to measure consistency and reproducibility among replicates between the tools.</p></caption><graphic xlink:href="nihpp-2024.07.19.604364v3-f0002" position="float"/></fig><fig position="float" id="F3"><label>Fig. 3.</label><caption><p id="P42">lr-kallisto is highly accurate in simulations with error up to ~3%. A comparison of performance of Bambu, IsoQuant, lr-kallisto, and Oarfish on PacBio (left-hand side) and ONT (right-hand side) simulations with Concordance Correlation Coefficient (CCC), Normalized Root Mean Squared Error, and Pearson&#x02019;s and Spearman&#x02019;s correlation coefficients reported.</p></caption><graphic xlink:href="nihpp-2024.07.19.604364v3-f0003" position="float"/></fig><table-wrap position="float" id="T1"><label>Table 1.</label><caption><p id="P43">IGVF Bridge exome capture and non-exome capture accession IDs.</p></caption><table frame="box" rules="cols"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr style="border-bottom: solid 1px"><th align="center" valign="middle" rowspan="1" colspan="1">Accession ID</th><th align="center" valign="middle" rowspan="1" colspan="1">Subpool Name</th><th align="center" valign="middle" rowspan="1" colspan="1">Read Type</th></tr></thead><tbody><tr><td align="center" valign="middle" rowspan="1" colspan="1">IGVFDS4803WKTQ</td><td align="center" valign="middle" rowspan="1" colspan="1">B01_13G</td><td align="center" valign="middle" rowspan="1" colspan="1">Nanopore</td></tr><tr><td align="center" valign="middle" rowspan="1" colspan="1">IGVFDS9445YYVB</td><td align="center" valign="middle" rowspan="1" colspan="1">B01_13H</td><td align="center" valign="middle" rowspan="1" colspan="1">Nanopore</td></tr><tr><td align="center" valign="middle" rowspan="1" colspan="1">IGVFDS9522BMQK</td><td align="center" valign="middle" rowspan="1" colspan="1">B01_13G</td><td align="center" valign="middle" rowspan="1" colspan="1">Illumina</td></tr><tr><td align="center" valign="middle" rowspan="1" colspan="1">IGVFDS0356VCIO</td><td align="center" valign="middle" rowspan="1" colspan="1">B01_13H</td><td align="center" valign="middle" rowspan="1" colspan="1">Illumina</td></tr></tbody></table></table-wrap></floats-group></article>