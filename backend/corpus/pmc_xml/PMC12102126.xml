<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Bull Math Biol</journal-id><journal-id journal-id-type="iso-abbrev">Bull Math Biol</journal-id><journal-title-group><journal-title>Bulletin of Mathematical Biology</journal-title></journal-title-group><issn pub-type="ppub">0092-8240</issn><issn pub-type="epub">1522-9602</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmid">40410602</article-id><article-id pub-id-type="pmc">PMC12102126</article-id>
<article-id pub-id-type="publisher-id">1464</article-id><article-id pub-id-type="doi">10.1007/s11538-025-01464-8</article-id><article-categories><subj-group subj-group-type="heading"><subject>Methods</subject></subj-group></article-categories><title-group><article-title>Fast simulation of identity-by-descent segments</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7651-6527</contrib-id><name><surname>Temple</surname><given-names>Seth D.</given-names></name><address><email>sethtem@umich.edu</email></address><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Browning</surname><given-names>Sharon R.</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><contrib contrib-type="author"><name><surname>Thompson</surname><given-names>Elizabeth A.</given-names></name><xref ref-type="aff" rid="Aff1">1</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00cvxb145</institution-id><institution-id institution-id-type="GRID">grid.34477.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2298 6657</institution-id><institution>Department of Statistics, </institution><institution>University of Washington, </institution></institution-wrap>Seattle, WA USA </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00jmfr291</institution-id><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7347</institution-id><institution>Department of Statistics, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, MI USA </aff><aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00jmfr291</institution-id><institution-id institution-id-type="GRID">grid.214458.e</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 7347</institution-id><institution>Michigan Institute of Data Science, </institution><institution>University of Michigan, </institution></institution-wrap>Ann Arbor, MI USA </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/00cvxb145</institution-id><institution-id institution-id-type="GRID">grid.34477.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2298 6657</institution-id><institution>Department of Biostatistics, </institution><institution>University of Washington, </institution></institution-wrap>Seattle, WA USA </aff></contrib-group><pub-date pub-type="epub"><day>23</day><month>5</month><year>2025</year></pub-date><pub-date pub-type="pmc-release"><day>23</day><month>5</month><year>2025</year></pub-date><pub-date pub-type="ppub"><year>2025</year></pub-date><volume>87</volume><issue>7</issue><elocation-id>84</elocation-id><history><date date-type="received"><day>16</day><month>1</month><year>2025</year></date><date date-type="accepted"><day>8</day><month>5</month><year>2025</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2025</copyright-statement><copyright-year>2025</copyright-year><license><ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">The worst-case runtime complexity to simulate haplotype segments identical by descent (IBD) is quadratic in sample size. We propose two main techniques to reduce the compute time, both of which are motivated by coalescent and recombination processes. We provide mathematical results that explain why our algorithm should outperform a naive implementation with high probability. In our experiments, we observe average compute times to simulate detectable IBD segments around a locus that scale approximately linearly in sample size and take a couple of seconds for sample sizes that are less than 10,000 diploid individuals. In contrast, we find that existing methods to simulate IBD segments take minutes to hours for sample sizes exceeding a few thousand diploid individuals. When using IBD segments to study recent positive selection around a locus, our efficient simulation algorithm makes feasible statistical inferences, e.g., parametric bootstrapping in analyses of large biobanks, that would be otherwise intractable.</p><sec><title>Supplementary Information</title><p>The online version contains supplementary material available at 10.1007/s11538-025-01464-8.</p></sec></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Identity-by-descent</kwd><kwd>Coalescent</kwd><kwd>Computational runtime</kwd></kwd-group><kwd-group xml:lang="--"><title>Mathematics Subject Classification</title><kwd>60-08</kwd><kwd>92-04</kwd><kwd>92-08</kwd><kwd>92-10</kwd><kwd>92D15</kwd></kwd-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000005</institution-id><institution>U.S. Department of Defense</institution></institution-wrap></funding-source><award-id>National Defense Science Engineering Graduate Fellowship</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100027426</institution-id><institution>Schmidt Futures</institution></institution-wrap></funding-source><award-id>AI in Science Postdoctoral Fellowship</award-id></award-group></funding-group><funding-group><award-group><funding-source><institution-wrap><institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id><institution>National Human Genome Research Institute</institution></institution-wrap></funding-source><award-id>HG005701</award-id></award-group></funding-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; The Author(s) under exclusive licence to Society for Mathematical Biology 2025</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par2">Simulation is a powerful tool in population genetics to forecast the genetic impact of evolutionary scenarios, perform statistical inference on models and their parameters, and develop and evaluate new methods (Hoban et&#x000a0;al. <xref ref-type="bibr" rid="CR28">2012</xref>; Yuan et&#x000a0;al. <xref ref-type="bibr" rid="CR63">2012</xref>). There are two main frameworks for population genetics simulations, each having its own use cases, advantages, and disadvantages. Forward simulation models the dynamics of entire populations over time regarding individuals and their interactions (Haller and Messer <xref ref-type="bibr" rid="CR32">2019</xref>). This flexible approach can incorporate complex dynamics of selection, migration, and spatial context, among other features, at the cost of additional computation. Backward simulation models the genealogy of present-day samples strictly through their common ancestors and is less computationally intensive (Hoban et&#x000a0;al. <xref ref-type="bibr" rid="CR28">2012</xref>).</p><p id="Par3">The speed of backward simulation is in large part due to coalescent theory (Kingman <xref ref-type="bibr" rid="CR39">1982a</xref>, <xref ref-type="bibr" rid="CR40">b</xref>), which approximates the Wright-Fisher (WF) process (Wright <xref ref-type="bibr" rid="CR61">1931</xref>) when the sample size is much smaller than the population size. The Kingman coalescent has been extended to address examples of migration (Nath and Griffiths <xref ref-type="bibr" rid="CR44">1993</xref>), recombination (Hudson <xref ref-type="bibr" rid="CR35">1983</xref>; Hudson and Kaplan <xref ref-type="bibr" rid="CR31">1988</xref>), selection (Hudson and Kaplan <xref ref-type="bibr" rid="CR31">1988</xref>; Kaplan et&#x000a0;al. <xref ref-type="bibr" rid="CR37">1988</xref>), and demography (Hein et&#x000a0;al. <xref ref-type="bibr" rid="CR34">2005</xref>). With recombination, the model becomes a sequence of correlated coalescent trees called the ancestral recombination graph (ARG). In recent years, numerous coalescent methods have been developed to simulate polymorphism data over large genomic regions efficiently (Ewing and Hermisson <xref ref-type="bibr" rid="CR20">2010</xref>; Hudson <xref ref-type="bibr" rid="CR36">2002</xref>; Kern and Schrider <xref ref-type="bibr" rid="CR41">2016</xref>), having randomly placed mutations on tree branches at a fixed genome-wide rate. The msprime software is a popular and robust option for backward simulation that scales to entire chromosomes and thousands of individuals (Baumdicker et al. <xref ref-type="bibr" rid="CR7">2021</xref>). Hybrid frameworks with forward simulations (Haller et&#x000a0;al. <xref ref-type="bibr" rid="CR30">2019</xref>) and standards set for species-specific simulations (Adrion et al. <xref ref-type="bibr" rid="CR1">2020</xref>; Lauterbur et al. <xref ref-type="bibr" rid="CR42">2023</xref>) have contributed to its widespread adoption.</p><p id="Par4">Placing mutations on tree branches has linear complexity in sample size, which means analyses focusing on summary statistics of polymorphism data can be runtime inexpensive even in large samples. On the other hand, deriving the pairwise relationships between haplotypes is difficult for large sample sizes because the total number of computations scales quadratically in sample size. To be precise, two individuals share a haplotype segment identical-by-descent (IBD) if they inherit it from the same common ancestor. msprime has a feature to access IBD segments from the tree sequence, but its documentation warns that deriving and storing the IBD segments requires a lot of time and memory (Baumdicker et al. <xref ref-type="bibr" rid="CR7">2021</xref>). Another coalescent method ARGON simulates IBD segments as a feature within a much broader ARG-inference program (Palamara <xref ref-type="bibr" rid="CR47">2016</xref>). These methods are the two current options to simulate IBD segments genome-wide in modestly sized samples. The runtime to simulate IBD segments with these programs has not been extensively benchmarked.</p><p id="Par5">Long IBD segments can be informative about recent demographic changes (Browning and Browning <xref ref-type="bibr" rid="CR2">2015</xref>; Browning et al. <xref ref-type="bibr" rid="CR6">2018</xref>; Cai et al. <xref ref-type="bibr" rid="CR15">2023</xref>; Palamara et&#x000a0;al. <xref ref-type="bibr" rid="CR48">2012</xref>), recent positive selection (Browning and Browning <xref ref-type="bibr" rid="CR3">2020</xref>; Temple et&#x000a0;al. <xref ref-type="bibr" rid="CR59">2024</xref>), population-specific recombination rates (Zhou et&#x000a0;al. <xref ref-type="bibr" rid="CR64">2020a</xref>), mutation rates (Tian et&#x000a0;al. <xref ref-type="bibr" rid="CR55">2019</xref>), allelic conversions (Browning and Browning <xref ref-type="bibr" rid="CR4">2024</xref>), rare variant association studies (Browning and Thompson <xref ref-type="bibr" rid="CR11">2012</xref>; Chen et al. <xref ref-type="bibr" rid="CR17">2023</xref>), and close familial relatedness (Zhou et&#x000a0;al. <xref ref-type="bibr" rid="CR66">2020c</xref>), whereas summary statistics like the fixation index <inline-formula id="IEq1"><alternatives><tex-math id="d33e344">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F_{ST}$$\end{document}</tex-math><mml:math id="d33e349"><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi mathvariant="italic">ST</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq1.gif"/></alternatives></inline-formula> (Weir and Cockerham <xref ref-type="bibr" rid="CR60">1984</xref>) and Tajima&#x02019;s <italic>D</italic> (Tajima <xref ref-type="bibr" rid="CR53">1989</xref>) or models like the sequentially Markovian coalescent (SMC) (Li and Durbin <xref ref-type="bibr" rid="CR43">2011</xref>), and its extensions (Schiffels and Durbin <xref ref-type="bibr" rid="CR51">2014</xref>), concern population divergences and old selection events (Tajima <xref ref-type="bibr" rid="CR53">1989</xref>; Weir and Cockerham <xref ref-type="bibr" rid="CR60">1984</xref>), among other things. Methods using IBD segments thus serve as an important complementary approach to summary statistics and coalescent-based methods.</p><p id="Par6">Distinguishing between alleles that are identical-by-state versus those that are identical-by-descent from a common ancestor can be challenging. Only those haplotypes extending over multiple centiMorgans, a unit of genetic distance to be defined in Section <xref rid="Sec2" ref-type="sec">2</xref>, can be detected as IBD with high accuracy (Freyman et al. <xref ref-type="bibr" rid="CR22">2021</xref>; Nait Saada et&#x000a0;al. <xref ref-type="bibr" rid="CR46">2020</xref>; Naseri et&#x000a0;al. <xref ref-type="bibr" rid="CR45">2019</xref>; Shemirani et&#x000a0;al. <xref ref-type="bibr" rid="CR49">2021</xref>; Zhou et&#x000a0;al. <xref ref-type="bibr" rid="CR65">2020b</xref>). We refer to IBD segments longer than a fixed Morgans threshold as &#x0201c;detectable&#x0201d;, where a user-defined threshold can depend on the dataset, the IBD segment detection method, and the tolerance to detection inaccuracies. Exceptionally long IBD segments are rare to observe outside of family studies, meaning that large sample sizes are required to observe enough segments for IBD-based analyses in outbred population studies.</p><p id="Par7">Some methods require IBD data for the entire chromosomes (Browning and Browning <xref ref-type="bibr" rid="CR2">2015</xref>; Palamara et&#x000a0;al. <xref ref-type="bibr" rid="CR48">2012</xref>; Temple <xref ref-type="bibr" rid="CR57">2024</xref>; Zhou et&#x000a0;al. <xref ref-type="bibr" rid="CR64">2020a</xref>, <xref ref-type="bibr" rid="CR66">c</xref>), which simulators like msprime (Baumdicker et al. <xref ref-type="bibr" rid="CR7">2021</xref>) and ARGON (Palamara <xref ref-type="bibr" rid="CR47">2016</xref>) are suited for. Other statistical inferences concern estimator consistency (Temple et&#x000a0;al. <xref ref-type="bibr" rid="CR59">2024</xref>), uncertainty quantification (Temple et&#x000a0;al. <xref ref-type="bibr" rid="CR59">2024</xref>), the power of a hypothesis test (Temple and Browning <xref ref-type="bibr" rid="CR54">2025</xref>), and convergence to an asymptotic distribution (Temple and Thompson <xref ref-type="bibr" rid="CR58">2024</xref>) around a single locus. Validating such theoretical results involves enormous simulations, for which msprime and ARGON are less suited.</p><p id="Par8">In this work, we propose an algorithm to simulate IBD segments overlapping a focal location that is fast enough to validate asymptotic properties like consistency, confidence interval coverage, and weak convergence (Casella and Berger <xref ref-type="bibr" rid="CR13">2002</xref>). We modify a naive approach (Temple et&#x000a0;al. <xref ref-type="bibr" rid="CR59">2024</xref>), and then we argue that our modified approach should drastically decrease runtime with high probability. We demonstrate in some simulation examples that the modified algorithm&#x02019;s average runtime scales approximately linearly with sample size, not quadratically.</p></sec><sec id="Sec2"><title>Preliminary material</title><p id="Par9">Backward simulation of IBD segment lengths overlapping a focal location involves two waiting time distributions: the time until a common ancestor and the genetic length until a crossover. Figure <xref rid="Fig1" ref-type="fig">1</xref> illustrates the coalescent and recombination processes. Here, we formally define a parametric model for IBD segments overlapping a specific locus in terms of these processes. Table <xref rid="Tab1" ref-type="table">1</xref> defines the notation used in this article.</p><sec id="Sec3"><title>The time until a common ancestor</title><p id="Par10">Let <italic>n</italic> be the haploid sample size, <inline-formula id="IEq2"><alternatives><tex-math id="d33e474">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \le n$$\end{document}</tex-math><mml:math id="d33e479"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq2.gif"/></alternatives></inline-formula> the size of a subsample, and <italic>N</italic>(<italic>t</italic>) the haploid effective population size <italic>t</italic> generations ago. Effective population size is the number of individuals who contribute offspring to the next generation. In the discrete-time WF process, each haploid has a haploid ancestor in the previous generation. If haploids have the same haploid ancestor, their lineages join. Unless otherwise specified, time <inline-formula id="IEq3"><alternatives><tex-math id="d33e496">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t \ge 0$$\end{document}</tex-math><mml:math id="d33e501"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq3.gif"/></alternatives></inline-formula> always refers to time backward from the present day. For constant population size, note that <inline-formula id="IEq4"><alternatives><tex-math id="d33e508">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N = N(t)$$\end{document}</tex-math><mml:math id="d33e513"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq4.gif"/></alternatives></inline-formula> for all <italic>t</italic>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Conceptual framework for IBD segment lengths. (Left) Sample haplotypes <italic>a</italic>,&#x000a0;<italic>b</italic>,&#x000a0;<italic>c</italic>,&#x000a0;<italic>d</italic> trace their lineages back to common ancestors at times <inline-formula id="IEq5"><alternatives><tex-math id="d33e546">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_4, t_4+t_3, t_4+t_3+t_2$$\end{document}</tex-math><mml:math id="d33e551"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq5.gif"/></alternatives></inline-formula>. (Right) Relative to a focal point, the haplotype segments lengths <inline-formula id="IEq6"><alternatives><tex-math id="d33e579">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_a,R_b,L_a,L_b$$\end{document}</tex-math><mml:math id="d33e584"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq6.gif"/></alternatives></inline-formula> are independent, identically distributed <inline-formula id="IEq7"><alternatives><tex-math id="d33e603">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {Exponential}(t_4)$$\end{document}</tex-math><mml:math id="d33e608"><mml:mrow><mml:mtext>Exponential</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq7.gif"/></alternatives></inline-formula>. The lengths shared IBD are <inline-formula id="IEq8"><alternatives><tex-math id="d33e620">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{a,b}:=\min (R_a,R_b)$$\end{document}</tex-math><mml:math id="d33e625"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq8.gif"/></alternatives></inline-formula> and <inline-formula id="IEq9"><alternatives><tex-math id="d33e651">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{a,b}:=\min (L_a,L_b)$$\end{document}</tex-math><mml:math id="d33e656"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq9.gif"/></alternatives></inline-formula>. The IBD segment length <inline-formula id="IEq10"><alternatives><tex-math id="d33e682">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{a,b} := L_{a,b} + R_{a,b} \sim \text {Gamma}(2,2 \cdot t_4)$$\end{document}</tex-math><mml:math id="d33e687"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq10.gif"/></alternatives></inline-formula> exceeds the detection threshold <italic>w</italic> Morgans (Color figure online)</p></caption><graphic xlink:href="11538_2025_1464_Fig1_HTML" id="MO1"/></fig><table-wrap id="Tab1"><label>Table 1</label><caption><p>Glossary of mathematical terms</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"><bold>Term</bold></th><th align="left"><bold>Definition</bold></th></tr></thead><tbody><tr><td align="left"><italic>n</italic></td><td align="left">Sample size</td></tr><tr><td align="left"><italic>k</italic></td><td align="left">Subsample size</td></tr><tr><td align="left"><italic>N</italic>(<italic>t</italic>)</td><td align="left">Population size at time <italic>t</italic></td></tr><tr><td align="left"><inline-formula id="IEq11"><alternatives><tex-math id="d33e781">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_k$$\end{document}</tex-math><mml:math id="d33e786"><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq11.gif"/></alternatives></inline-formula></td><td align="left">Time of first coalescent event for <italic>k</italic> samples</td></tr><tr><td align="left"><inline-formula id="IEq12"><alternatives><tex-math id="d33e800">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{n:k}^+:=\sum _{j=k}^n T_j$$\end{document}</tex-math><mml:math id="d33e805"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq12.gif"/></alternatives></inline-formula></td><td align="left">Total time until <inline-formula id="IEq13"><alternatives><tex-math id="d33e830">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-k+1$$\end{document}</tex-math><mml:math id="d33e835"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq13.gif"/></alternatives></inline-formula> coalescent events</td></tr><tr><td align="left"><italic>a</italic>,&#x000a0;<italic>b</italic>,&#x000a0;<italic>c</italic>,&#x000a0;<italic>d</italic></td><td align="left">Indices for sample haplotypes</td></tr><tr><td align="left"><inline-formula id="IEq14"><alternatives><tex-math id="d33e863">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_a,R_a$$\end{document}</tex-math><mml:math id="d33e868"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq14.gif"/></alternatives></inline-formula></td><td align="left">Sample <italic>a</italic>&#x02019;s left and right recombination endpoints around a focal point</td></tr><tr><td align="left"><inline-formula id="IEq15"><alternatives><tex-math id="d33e887">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{a,b},R_{a,b}$$\end{document}</tex-math><mml:math id="d33e892"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq15.gif"/></alternatives></inline-formula></td><td align="left">Left and right recombination endpoints around a focal point that are shared by <italic>a</italic> and <italic>b</italic></td></tr><tr><td align="left"><inline-formula id="IEq16"><alternatives><tex-math id="d33e919">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{a,b}$$\end{document}</tex-math><mml:math id="d33e924"><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq16.gif"/></alternatives></inline-formula></td><td align="left">IBD segment around a focal point that is shared by <italic>a</italic> and <italic>b</italic></td></tr><tr><td align="left"><italic>w</italic></td><td align="left">Segment length threshold</td></tr><tr><td align="left"><inline-formula id="IEq17"><alternatives><tex-math id="d33e950">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{j}$$\end{document}</tex-math><mml:math id="d33e955"><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq17.gif"/></alternatives></inline-formula></td><td align="left">Size of one subtree of a randomly bifurcating subtree of size <inline-formula id="IEq18"><alternatives><tex-math id="d33e963">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{j-1}$$\end{document}</tex-math><mml:math id="d33e968"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq18.gif"/></alternatives></inline-formula></td></tr><tr><td align="left"><italic>s</italic></td><td align="left">Selection coefficient</td></tr><tr><td align="left"><italic>p</italic>(<italic>t</italic>)</td><td align="left">Allele frequency at time <italic>t</italic></td></tr><tr><td align="left"><inline-formula id="IEq19"><alternatives><tex-math id="d33e1001">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta $$\end{document}</tex-math><mml:math id="d33e1006"><mml:mi>&#x003b2;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq19.gif"/></alternatives></inline-formula></td><td align="left">Regression coefficient</td></tr></tbody></table><table-wrap-foot><p><inline-formula id="IEq20"><alternatives><tex-math id="d33e1013">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$^{1}$$\end{document}</tex-math><mml:math id="d33e1018"><mml:mmultiscripts><mml:mrow/><mml:mrow/><mml:mn>1</mml:mn></mml:mmultiscripts></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq20.gif"/></alternatives></inline-formula> Realizations of random variables are lowercase, e.g., <inline-formula id="IEq21"><alternatives><tex-math id="d33e1025">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t_2$$\end{document}</tex-math><mml:math id="d33e1030"><mml:msub><mml:mi>t</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq21.gif"/></alternatives></inline-formula> is the observed value of <inline-formula id="IEq22"><alternatives><tex-math id="d33e1036">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_2$$\end{document}</tex-math><mml:math id="d33e1041"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq22.gif"/></alternatives></inline-formula> and <inline-formula id="IEq23"><alternatives><tex-math id="d33e1047">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l_a$$\end{document}</tex-math><mml:math id="d33e1052"><mml:msub><mml:mi>l</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq23.gif"/></alternatives></inline-formula> is the observed value of <inline-formula id="IEq24"><alternatives><tex-math id="d33e1058">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_a$$\end{document}</tex-math><mml:math id="d33e1063"><mml:msub><mml:mi>L</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq24.gif"/></alternatives></inline-formula></p></table-wrap-foot></table-wrap></p><p id="Par11">Let the random variable <inline-formula id="IEq25"><alternatives><tex-math id="d33e1070">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_k$$\end{document}</tex-math><mml:math id="d33e1075"><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq11.gif"/></alternatives></inline-formula> denote the time until a common ancestor is reached for any two of <italic>k</italic> haploids. The random variable <inline-formula id="IEq26"><alternatives><tex-math id="d33e1084">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{n:k}^+ := \sum _{j=k}^n T_j$$\end{document}</tex-math><mml:math id="d33e1089"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>T</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq26.gif"/></alternatives></inline-formula> is the time until <inline-formula id="IEq27"><alternatives><tex-math id="d33e1112">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n-k+1$$\end{document}</tex-math><mml:math id="d33e1117"><mml:mrow><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq13.gif"/></alternatives></inline-formula> coalescent events. The time to the most recent common ancestor (TMRCA) of the sample is <inline-formula id="IEq28"><alternatives><tex-math id="d33e1126">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{n:2}^+$$\end{document}</tex-math><mml:math id="d33e1131"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo>+</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq28.gif"/></alternatives></inline-formula>. The probability that the time until the most recent common ancestor of two specific haploids is<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="d33e1142">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P(T_2 = t) = \prod _{\tau =1}^{t-1} \bigg ( 1 - \frac{1}{N(\tau )} \bigg ) \frac{1}{N(t)}, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e1148" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">(</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">)</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq29"><alternatives><tex-math id="d33e1205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 / N(\tau )$$\end{document}</tex-math><mml:math id="d33e1210"><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq29.gif"/></alternatives></inline-formula> is the probability that a haploid has the same haploid parent as the other haploid at generation <inline-formula id="IEq30"><alternatives><tex-math id="d33e1223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau $$\end{document}</tex-math><mml:math id="d33e1228"><mml:mi>&#x003c4;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq30.gif"/></alternatives></inline-formula>. The approximate probability that the time until a common ancestor is reached for any two of <italic>k</italic> haploids is<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="d33e1235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P(T_k = t \hspace{2.0pt}|\hspace{2.0pt}T_{n:k+1}^+ = t_0) = \prod _{\tau = t_0+1}^{t-1} \bigg ( 1 - \frac{\left( {\begin{array}{c}k\\ 2\end{array}}\right) }{N(\tau )} \bigg ) \frac{\left( {\begin{array}{c}k\\ 2\end{array}}\right) }{N(t)} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e1241" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mspace width="2.0pt"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="2.0pt"/><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">(</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">)</mml:mo></mml:mrow><mml:mfrac><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>when <italic>k</italic> is much smaller than <inline-formula id="IEq31"><alternatives><tex-math id="d33e1342">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min _t N(t)$$\end{document}</tex-math><mml:math id="d33e1347"><mml:mrow><mml:msub><mml:mo movablelimits="true">min</mml:mo><mml:mi>t</mml:mi></mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq31.gif"/></alternatives></inline-formula> (Hein et&#x000a0;al. <xref ref-type="bibr" rid="CR34">2005</xref>). The geometric model assumes that multiple coalescent events in a single generation are improbable. Its rate <inline-formula id="IEq32"><alternatives><tex-math id="d33e1365">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\begin{array}{c}k\\ 2\end{array}}\right) / N(\tau )$$\end{document}</tex-math><mml:math id="d33e1370"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq32.gif"/></alternatives></inline-formula> is the probability that any two of <italic>k</italic> haploids have the same haploid parent at generation <inline-formula id="IEq33"><alternatives><tex-math id="d33e1397">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\tau $$\end{document}</tex-math><mml:math id="d33e1402"><mml:mi>&#x003c4;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq30.gif"/></alternatives></inline-formula>.</p><p id="Par12">The Kingman coalescent (Kingman <xref ref-type="bibr" rid="CR40">1982b</xref>, <xref ref-type="bibr" rid="CR39">a</xref>) comes from the continuous time limit of Equations <xref rid="Equ1" ref-type="disp-formula">1</xref> and <xref rid="Equ2" ref-type="disp-formula">2</xref> for large constant population size <italic>N</italic>. Specifically, <inline-formula id="IEq34"><alternatives><tex-math id="d33e1424">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_k$$\end{document}</tex-math><mml:math id="d33e1429"><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq11.gif"/></alternatives></inline-formula> converges weakly to <inline-formula id="IEq35"><alternatives><tex-math id="d33e1435">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {Exponential}(\left( {\begin{array}{c}k\\ 2\end{array}}\right) )$$\end{document}</tex-math><mml:math id="d33e1440"><mml:mrow><mml:mtext>Exponential</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq35.gif"/></alternatives></inline-formula> for <inline-formula id="IEq36"><alternatives><tex-math id="d33e1460">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \ll N$$\end{document}</tex-math><mml:math id="d33e1465"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x0226a;</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq36.gif"/></alternatives></inline-formula>, <inline-formula id="IEq37"><alternatives><tex-math id="d33e1472">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \rightarrow \infty $$\end{document}</tex-math><mml:math id="d33e1477"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>&#x0221e;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq37.gif"/></alternatives></inline-formula>, and time is scaled in units of <italic>N</italic> generations. Henceforth, we consider the positive real-valued <inline-formula id="IEq38"><alternatives><tex-math id="d33e1488">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_k $$\end{document}</tex-math><mml:math id="d33e1493"><mml:msub><mml:mi>T</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq38.gif"/></alternatives></inline-formula> in units of <italic>N</italic> generations. Varying population sizes <italic>N</italic>(<italic>t</italic>) are implemented by rescaling time <italic>post-hoc</italic> in a coalescent with constant population size <italic>N</italic> (Hein et&#x000a0;al. <xref ref-type="bibr" rid="CR34">2005</xref>).</p></sec><sec id="Sec4"><title>The distance until crossover recombination</title><p id="Par13">The genetic distance between two points is the expected number of crossovers between them in an offspring gamete. This unit of haplotype segment length is the Morgan. Assuming no interference in double-stranded breaks and that crossovers occur randomly and independently, Haldane (<xref ref-type="bibr" rid="CR24">1919</xref>) derives that the genetic distance until crossover recombination is exponentially distributed, with the Poisson process modeling the crossover points along the genome. The number of crossovers between two points is then Poisson distributed with mean equal to the genetic distance between the two points, which leads to the Haldane map function connecting Morgans to the recombination frequency. (The Haldane map function is <inline-formula id="IEq39"><alternatives><tex-math id="d33e1525">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho = 0.5 (1 - \exp (-2d))$$\end{document}</tex-math><mml:math id="d33e1530"><mml:mrow><mml:mi>&#x003c1;</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mo>exp</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>d</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq39.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq40"><alternatives><tex-math id="d33e1552">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho $$\end{document}</tex-math><mml:math id="d33e1557"><mml:mi>&#x003c1;</mml:mi></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq40.gif"/></alternatives></inline-formula> is the recombination frequency and <italic>d</italic> is the genetic distance.)</p><p id="Par14">From a fixed location, the Morgan distance until a crossover in one gamete offspring is distributed as <inline-formula id="IEq41"><alternatives><tex-math id="d33e1566">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {Exponential}(1)$$\end{document}</tex-math><mml:math id="d33e1571"><mml:mrow><mml:mtext>Exponential</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq41.gif"/></alternatives></inline-formula>. An important property of the exponential random variable is that the minimum of independent exponential random variables is an exponential random variable with a rate that is the sum of the rates of the independent random variables. Since meioses are independent after <italic>t</italic> meioses the haplotype segment length to the right of a focal location is distributed as <inline-formula id="IEq42"><alternatives><tex-math id="d33e1584">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {Exponential}(t)$$\end{document}</tex-math><mml:math id="d33e1589"><mml:mrow><mml:mtext>Exponential</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq42.gif"/></alternatives></inline-formula>, where <italic>t</italic> is the rate parameter. We stress that our model concerns recombination events proximal to a focal point, whereas approximate models like the SMC concern recombination events across the entire genome (Hein et&#x000a0;al. <xref ref-type="bibr" rid="CR34">2005</xref>; Li and Durbin <xref ref-type="bibr" rid="CR43">2011</xref>; Schiffels and Durbin <xref ref-type="bibr" rid="CR51">2014</xref>).</p><p id="Par15">Let <italic>a</italic> and <italic>b</italic> be sample haplotypes in the current generation. Define <inline-formula id="IEq43"><alternatives><tex-math id="d33e1620">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_a, R_a \hspace{2.0pt}| \hspace{2.0pt}t \sim \text {Exponential}(t)$$\end{document}</tex-math><mml:math id="d33e1625"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mspace width="2.0pt"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="2.0pt"/><mml:mi>t</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mtext>Exponential</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq43.gif"/></alternatives></inline-formula> to be sample haplotypes <italic>a</italic>&#x02019;s recombination endpoints to the left and right of a focal location. Since crossovers to the left and right are independent, the extant width derived from the ancestor at time <italic>t</italic> is <inline-formula id="IEq44"><alternatives><tex-math id="d33e1657">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_a := L_a + R_a \hspace{2.0pt}| \hspace{2.0pt}t \sim \text {Gamma}(2,t)$$\end{document}</tex-math><mml:math id="d33e1662"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mspace width="2.0pt"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="2.0pt"/><mml:mi>t</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq44.gif"/></alternatives></inline-formula>. Because recombination events are independent in the <italic>t</italic> meioses descending to <italic>a</italic> and <italic>b</italic> from their common ancestor, the IBD segments that are shared by <italic>a</italic> and <italic>b</italic> are <inline-formula id="IEq45"><alternatives><tex-math id="d33e1710">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{a,b}, R_{a,b} \hspace{1.0pt}|\hspace{1.0pt}t \sim \text {Exponential}(2 t)$$\end{document}</tex-math><mml:math id="d33e1715"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mspace width="1.0pt"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="1.0pt"/><mml:mi>t</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mtext>Exponential</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq45.gif"/></alternatives></inline-formula> and <inline-formula id="IEq46"><alternatives><tex-math id="d33e1747">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_{a,b} \hspace{2.0pt}| \hspace{2.0pt}t \sim \text {Gamma}(2,2 t)$$\end{document}</tex-math><mml:math id="d33e1752"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mspace width="2.0pt"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="2.0pt"/><mml:mi>t</mml:mi><mml:mo>&#x0223c;</mml:mo><mml:mtext>Gamma</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq46.gif"/></alternatives></inline-formula>. Under this model, the lengths of IBD segments are thus shorter, with a higher probability the more removed its common ancestor is from the present day. This fact is a key motivation for the fast algorithm we develop.</p></sec></sec><sec id="Sec5"><title>An efficient algorithm to simulate identity-by-descent segments</title><p id="Par16">Based on Sections <xref rid="Sec3" ref-type="sec">2.1</xref> and <xref rid="Sec4" ref-type="sec">2.2</xref>, the blueprint to simulate IBD segment lengths around a locus is as follows: 1) simulate a coalescent tree for a sample from a population, 2) draw recombination endpoints to the left and right of a focal point at each coalescent event, and 3) derive from the recombination endpoints the haplotype segment lengths that are shared IBD. The third step involves calculating the minimum lengths to the right and left of a focal point for every pair of haplotypes, which is the computational bottleneck in simulating IBD segment lengths. Making fewer haplotype comparisons, without sacrificing the exactness of simulation, is the way to decrease compute times.</p><p id="Par17">In Algorithm&#x000a0;1, we state the method to simulate long IBD segments around a single locus. We make four modifications to the naive simulation algorithm, which are designed to reduce compute times when the primary goal is to generate IBD segments longer than some detection threshold. These implementations reduce compute times due to the mathematical properties of the coalescent time and recombination endpoint distributions.</p><p id="Par18">First, whenever there is likely to be more than one coalescent event in a WF generation, we approximate the sampling of haploid parents as a binomial random variable (Section <xref rid="Sec6" ref-type="sec">4</xref>). Second, we exchange the Kingman coalescent for the discrete-time WF model once the number of non-coalesced haploids is much smaller than the population sizes. This implementation is similar to the hybrid simulation approach in Bhaskar et&#x000a0;al. (<xref ref-type="bibr" rid="CR8">2014</xref>). Third, we do not consider a sample haplotype for IBD segment calculation at future coalescent events once its haplotype segment length is less than the specified detection threshold, which we refer to as &#x0201c;pruning&#x0201d;. In Section <xref rid="Sec7" ref-type="sec">5</xref>, we elaborate on the rare probability of long haplotype segments in large populations. Fourth, we combine two sample haplotypes for IBD segment calculation at future coalescent events if they share the same left and right recombination endpoints, which we refer to as &#x0201c;merging&#x0201d;. In Section <xref rid="Sec8" ref-type="sec">6</xref>, we derive results concerning the probability of merging. We implement pruning and merging using object-oriented programming.</p><p id="Par19">
<fig position="anchor" id="Figa"><label>Algorithm 1</label><caption><p>Efficient simulation of IBD segment lengths</p></caption><graphic position="anchor" xlink:href="11538_2025_1464_Figa_HTML" id="MO2"/></fig>
</p></sec><sec id="Sec6"><title>An approximation of the Wright-Fisher process in large samples</title><p id="Par20">Simulating the Kingman coalescent is much faster than simulating the discrete-time WF process. The accuracy of the Kingman coalescent requires that the sample size is much smaller than the population size. This requirement is so that the probability of there being more than one coalescent event in a generation is small. The assumption that the sample size is small relative to the population size can be violated in analyses of human biobanks. Under this violation, the coalescent approximation can deviate significantly from the exact discrete-time WF model (Bhaskar et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2014</xref>; Palamara <xref ref-type="bibr" rid="CR47">2016</xref>; Wakeley and Takahashi <xref ref-type="bibr" rid="CR62">2003</xref>).</p><p id="Par21">In the following approximations for the sampling of haploid parents at each generation, we suppress the dependence on the generation time <italic>t</italic>. Let <inline-formula id="IEq78"><alternatives><tex-math id="d33e1833">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k:=k(t-1)$$\end{document}</tex-math><mml:math id="d33e1838"><mml:mrow><mml:mi>k</mml:mi><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq78.gif"/></alternatives></inline-formula> be the number of lineages at generation <inline-formula id="IEq79"><alternatives><tex-math id="d33e1853">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="d33e1858"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq79.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq80"><alternatives><tex-math id="d33e1865">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k^\prime := k(t)$$\end{document}</tex-math><mml:math id="d33e1870"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq80.gif"/></alternatives></inline-formula> and <inline-formula id="IEq81"><alternatives><tex-math id="d33e1886">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^\prime := N(t)$$\end{document}</tex-math><mml:math id="d33e1891"><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq81.gif"/></alternatives></inline-formula> be the number of lineages and the population size in the previous generation <italic>t</italic>. The probability that a parent among <inline-formula id="IEq82"><alternatives><tex-math id="d33e1911">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{1,\dots ,N^\prime \}$$\end{document}</tex-math><mml:math id="d33e1916"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq82.gif"/></alternatives></inline-formula> has no children is <inline-formula id="IEq83"><alternatives><tex-math id="d33e1931">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(1-1/N^\prime )^k$$\end{document}</tex-math><mml:math id="d33e1936"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq83.gif"/></alternatives></inline-formula>. The probability that a parent has at least one child is <inline-formula id="IEq84"><alternatives><tex-math id="d33e1954">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1-(1-1/N^\prime )^k$$\end{document}</tex-math><mml:math id="d33e1959"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq84.gif"/></alternatives></inline-formula>. The Taylor series expansion in <inline-formula id="IEq85"><alternatives><tex-math id="d33e1980">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1/N^\prime $$\end{document}</tex-math><mml:math id="d33e1985"><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq85.gif"/></alternatives></inline-formula> about zero is<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="d33e1995">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} 1 - \bigg (1 - k/N^\prime + \frac{k(k-1)}{2{N^\prime }^2} - \frac{k(k-1)(k-2)}{6{N^\prime }^3} \pm \dots \bigg ). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e2001" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">(</mml:mo></mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:msup><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>&#x000b1;</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>The second order approximation <inline-formula id="IEq86"><alternatives><tex-math id="d33e2075">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k/N^\prime - \left( {\begin{array}{c}k\\ 2\end{array}}\right) \times {N^\prime }^{-2}$$\end{document}</tex-math><mml:math id="d33e2080"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq86.gif"/></alternatives></inline-formula> is accurate if <inline-formula id="IEq87"><alternatives><tex-math id="d33e2111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k^3 = o({N^\prime }^3)$$\end{document}</tex-math><mml:math id="d33e2116"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mi>o</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq87.gif"/></alternatives></inline-formula>. The expected number of parents in the previous generation <italic>t</italic> with a child in generation <inline-formula id="IEq88"><alternatives><tex-math id="d33e2139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="d33e2144"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq79.gif"/></alternatives></inline-formula> is then<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="d33e2151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbb {E}}[k^\prime ] \approx N^\prime \bigg (k / {N^\prime } - \left( {\begin{array}{c}k\\ 2\end{array}}\right) \times {N^\prime }^{-2} \bigg ) = k - \left( {\begin{array}{c}k\\ 2\end{array}}\right) \times {N^\prime }^{-1}. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e2157" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x02248;</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">(</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo maxsize="2.047em" minsize="2.047em" stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>As an example, consider a sample of 20,000 haploids whose ancestral population sizes in the recent ten generations are more than 200,000 haploids. The second order approximation is accurate for the first ten generations because <inline-formula id="IEq89"><alternatives><tex-math id="d33e2237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k^3 \cdot N^{-3} = 10^{-3}$$\end{document}</tex-math><mml:math id="d33e2242"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq89.gif"/></alternatives></inline-formula> when the sample size <inline-formula id="IEq90"><alternatives><tex-math id="d33e2262">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k = 2 \cdot 10^{4}$$\end{document}</tex-math><mml:math id="d33e2267"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq90.gif"/></alternatives></inline-formula> is an order of magnitude smaller than the population size <inline-formula id="IEq91"><alternatives><tex-math id="d33e2278">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N = 2 \cdot 10^5$$\end{document}</tex-math><mml:math id="d33e2283"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq91.gif"/></alternatives></inline-formula>. For this choice of <italic>k</italic> and <inline-formula id="IEq92"><alternatives><tex-math id="d33e2297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^\prime $$\end{document}</tex-math><mml:math id="d33e2302"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq92.gif"/></alternatives></inline-formula>, the expected number of coalescent events per generation is approximately five hundred.</p><p id="Par22">Compared to drawing a parent for each child and then scanning a vector of size <italic>k</italic> for siblings, simulating the number of coalescent events in one generation from Binomial(<inline-formula id="IEq93"><alternatives><tex-math id="d33e2313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\begin{array}{c}k\\ 2\end{array}}\right) , {N^\prime }^{-1}$$\end{document}</tex-math><mml:math id="d33e2318"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq93.gif"/></alternatives></inline-formula>) can be an efficient approximation. The last term being subtracted in Equation <xref rid="Equ4" ref-type="disp-formula">4</xref> is equal to the expected value of a Binomial random variable of <inline-formula id="IEq94"><alternatives><tex-math id="d33e2345">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\begin{array}{c}k\\ 2\end{array}}\right) $$\end{document}</tex-math><mml:math id="d33e2350"><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq94.gif"/></alternatives></inline-formula> trials with success probability <inline-formula id="IEq95"><alternatives><tex-math id="d33e2364">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${N^\prime }^{-1}$$\end{document}</tex-math><mml:math id="d33e2369"><mml:msup><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq95.gif"/></alternatives></inline-formula>. Next, let <inline-formula id="IEq96"><alternatives><tex-math id="d33e2381">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1$$\end{document}</tex-math><mml:math id="d33e2386"><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq96.gif"/></alternatives></inline-formula> and <inline-formula id="IEq97"><alternatives><tex-math id="d33e2392">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="d33e2397"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq97.gif"/></alternatives></inline-formula> be the number of children from two specific haploid parents among the <inline-formula id="IEq98"><alternatives><tex-math id="d33e2403">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^\prime $$\end{document}</tex-math><mml:math id="d33e2408"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq92.gif"/></alternatives></inline-formula> parents in the previous generation. If <inline-formula id="IEq99"><alternatives><tex-math id="d33e2414">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1$$\end{document}</tex-math><mml:math id="d33e2419"><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq96.gif"/></alternatives></inline-formula> and <inline-formula id="IEq100"><alternatives><tex-math id="d33e2425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="d33e2430"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq97.gif"/></alternatives></inline-formula> are independent, then <inline-formula id="IEq101"><alternatives><tex-math id="d33e2436">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(A_1 = a_1, A_2 = a_2) = P(A_1 = a_1) \times P(A_2 = a_2)$$\end{document}</tex-math><mml:math id="d33e2441"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq101.gif"/></alternatives></inline-formula>. <inline-formula id="IEq102"><alternatives><tex-math id="d33e2495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1$$\end{document}</tex-math><mml:math id="d33e2500"><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq96.gif"/></alternatives></inline-formula> and <inline-formula id="IEq103"><alternatives><tex-math id="d33e2506">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="d33e2511"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq97.gif"/></alternatives></inline-formula> are not independent, but the difference between the left term <inline-formula id="IEq104"><alternatives><tex-math id="d33e2517">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(A_1=a_1, A_2=a_2)$$\end{document}</tex-math><mml:math id="d33e2522"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq104.gif"/></alternatives></inline-formula> and the right term <inline-formula id="IEq105"><alternatives><tex-math id="d33e2546">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(A_1 = a_1) \times P(A_2 = a_2)$$\end{document}</tex-math><mml:math id="d33e2551"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq105.gif"/></alternatives></inline-formula> can be vanishingly small when <inline-formula id="IEq106"><alternatives><tex-math id="d33e2582">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N^\prime $$\end{document}</tex-math><mml:math id="d33e2587"><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq92.gif"/></alternatives></inline-formula> is large. The probability <inline-formula id="IEq107"><alternatives><tex-math id="d33e2593">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(A_1=a_1,A_2=a_2)$$\end{document}</tex-math><mml:math id="d33e2598"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq107.gif"/></alternatives></inline-formula> is derived by choosing <inline-formula id="IEq108"><alternatives><tex-math id="d33e2623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_1$$\end{document}</tex-math><mml:math id="d33e2628"><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq108.gif"/></alternatives></inline-formula> among <italic>k</italic> samples to have the same parent and then choosing <inline-formula id="IEq109"><alternatives><tex-math id="d33e2637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_2$$\end{document}</tex-math><mml:math id="d33e2642"><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq109.gif"/></alternatives></inline-formula> among <inline-formula id="IEq110"><alternatives><tex-math id="d33e2648">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k-a_1$$\end{document}</tex-math><mml:math id="d33e2653"><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq110.gif"/></alternatives></inline-formula> samples to have a same parent distinct from the parent of the first <inline-formula id="IEq111"><alternatives><tex-math id="d33e2662">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_1$$\end{document}</tex-math><mml:math id="d33e2667"><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq108.gif"/></alternatives></inline-formula> samples.<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="d33e2673">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}&#x00026;P(A_1=a_1, A_2=a_2) - P(A_1=a_1) \times P(A_2=a_2)\nonumber \\&#x00026;\quad = \left( {\begin{array}{c}k\\ a_1\end{array}}\right) {(N^\prime )^{-a_1}} \times \left( {\begin{array}{c}k-a_1\\ a_2\end{array}}\right) {(N^\prime -1)^{-a_2}} \nonumber \\&#x00026;\qquad - \left( {\begin{array}{c}k\\ a_1\end{array}}\right) {(N^\prime )^{-a_1}} \times \left( {\begin{array}{c}k\\ a_2\end{array}}\right) {(N^\prime )^{-a_2}} \nonumber \\&#x00026;\quad \le \left( {\begin{array}{c}k\\ a_1\end{array}}\right) {(N^\prime )^{-a_1}} \times \left( {\begin{array}{c}k\\ a_2\end{array}}\right) {(N^\prime )^{-a_2}} \nonumber \\&#x00026;\quad =O(k^{a_1+a_2} \cdot {N^\prime }^{-(a_1+a_2)}). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e2679" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>&#x000d7;</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="2em"/><mml:mo>-</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>&#x000d7;</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>&#x02264;</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>&#x000d7;</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>k</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>If both <inline-formula id="IEq112"><alternatives><tex-math id="d33e2973">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_1$$\end{document}</tex-math><mml:math id="d33e2978"><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq96.gif"/></alternatives></inline-formula> and <inline-formula id="IEq113"><alternatives><tex-math id="d33e2984">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$A_2$$\end{document}</tex-math><mml:math id="d33e2989"><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq97.gif"/></alternatives></inline-formula> have two or more children (<inline-formula id="IEq114"><alternatives><tex-math id="d33e2995">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min (a_1,a_2) \ge 2$$\end{document}</tex-math><mml:math id="d33e3000"><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x02265;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq114.gif"/></alternatives></inline-formula>), then Equation <xref rid="Equ5" ref-type="disp-formula">5</xref> is <italic>o</italic>(1) when the second order approximation <inline-formula id="IEq115"><alternatives><tex-math id="d33e3025">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k^3 = o({N^\prime }^3)$$\end{document}</tex-math><mml:math id="d33e3030"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mi>o</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mo>&#x02032;</mml:mo></mml:msup></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq87.gif"/></alternatives></inline-formula> is accurate.</p><p id="Par23">In Algorithm&#x000a0;1, we assume that all simultaneous coalescent events are the result of only two children having the same parent. Bhaskar et&#x000a0;al. (<xref ref-type="bibr" rid="CR8">2014</xref>) have shown that the majority of simultaneous coalescent events in a generation are of this type. Due to the coalescent and WF approximations, our method is not exact with respect to the time until a common ancestor.</p></sec><sec id="Sec7"><title>The probability of detectable haplotype segment lengths</title><p id="Par24">Within tens of generations, most haplotype segment lengths are shrunk by crossovers to a genetic length less than detection thresholds that are used in IBD-based analyses. A Morgans length threshold at least greater than 0.01 is typical in applied research (Browning and Browning <xref ref-type="bibr" rid="CR2">2015</xref>, <xref ref-type="bibr" rid="CR3">2020</xref>; Temple et&#x000a0;al. <xref ref-type="bibr" rid="CR59">2024</xref>; Tian et&#x000a0;al. <xref ref-type="bibr" rid="CR55">2019</xref>; Zhou et&#x000a0;al. <xref ref-type="bibr" rid="CR64">2020a</xref>). The probabilities of a detectable haplotype segment to the right of and overlapping a focal location, <inline-formula id="IEq116"><alternatives><tex-math id="d33e3075">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_a$$\end{document}</tex-math><mml:math id="d33e3080"><mml:msub><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq116.gif"/></alternatives></inline-formula> and <inline-formula id="IEq117"><alternatives><tex-math id="d33e3086">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_a$$\end{document}</tex-math><mml:math id="d33e3091"><mml:msub><mml:mi>W</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq117.gif"/></alternatives></inline-formula>, respectively, conditional on coalescent time <italic>Nt</italic> (in generations), are<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="d33e3100">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &#x00026;  1- F_{R_a | t} (w) = \exp (- N t w), \end{aligned}$$\end{document}</tex-math><mml:math id="d33e3106" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>N</mml:mi><mml:mi>t</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="d33e3144">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &#x00026;  1 - F_{W_a|t} (w) = \exp (-Ntw) + Ntw \cdot \exp (-Ntw). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e3150" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>N</mml:mi><mml:mi>t</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>N</mml:mi><mml:mi>t</mml:mi><mml:mi>w</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mi>N</mml:mi><mml:mi>t</mml:mi><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>Figure <xref rid="MOESM1" ref-type="media">S1</xref> shows that the upper tail probabilities of <inline-formula id="IEq118"><alternatives><tex-math id="d33e3209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_a$$\end{document}</tex-math><mml:math id="d33e3214"><mml:msub><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq116.gif"/></alternatives></inline-formula> and <inline-formula id="IEq119"><alternatives><tex-math id="d33e3220">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$W_a$$\end{document}</tex-math><mml:math id="d33e3225"><mml:msub><mml:mi>W</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq117.gif"/></alternatives></inline-formula> are decreasing exponentially over <italic>Nt</italic> generations. The probabilities of haplotype segment lengths greater than 0.01 can be far from zero when the haplotype is descendant from an ancestor within the last 100 generations. The probabilities of haplotype segments lengths greater than 0.02 are nearly zero when they are descendant from an ancestor more than 300 generations ago. (But exponential random variables have heavy upper tail probabilities, so, in large samples, we may detect some long IBD segments descendant from ancestors older than 300 generations.)</p><p id="Par25">For large effective population sizes, the coalescent times of ancestral lineages can be much greater than 500 generations. The expected time of the <inline-formula id="IEq120"><alternatives><tex-math id="d33e3236">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(n-k+1)^{\text {th}}$$\end{document}</tex-math><mml:math id="d33e3241"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>th</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq120.gif"/></alternatives></inline-formula> coalescent event can be derived as:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="d33e3256">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbb {E}}[ T_{n:k}^+]&#x00026;= \sum _{l=k}^n {\mathbb {E}}[ T_{l}] = \sum _{l=k}^n \left( {\begin{array}{c}l\\ 2\end{array}}\right) ^{-1}\nonumber \\&#x00026;= 2 \times \sum _{l=k}^n \Big (\frac{1}{l-1} - \frac{1}{l} \Big ) \nonumber \\&#x00026;= 2 \times ((k-1)^{-1} - n^{-1}), \end{aligned}$$\end{document}</tex-math><mml:math id="d33e3262" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>l</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">(</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>l</mml:mi></mml:mfrac><mml:mrow><mml:mo maxsize="1.623em" minsize="1.623em" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000d7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq121"><alternatives><tex-math id="d33e3388">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\begin{array}{c}l\\ 2\end{array}}\right) $$\end{document}</tex-math><mml:math id="d33e3393"><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>l</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq121.gif"/></alternatives></inline-formula> is the rate parameter for the time until a common ancestor is reached for any two of <italic>l</italic> haploids. For <inline-formula id="IEq122"><alternatives><tex-math id="d33e3410">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N = 10,000$$\end{document}</tex-math><mml:math id="d33e3415"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq122.gif"/></alternatives></inline-formula> and <inline-formula id="IEq123"><alternatives><tex-math id="d33e3425">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \rightarrow \infty $$\end{document}</tex-math><mml:math id="d33e3430"><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>&#x0221e;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq123.gif"/></alternatives></inline-formula>, the expected coalescent time <inline-formula id="IEq124"><alternatives><tex-math id="d33e3438">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {E}}[T_{n:40}^+]$$\end{document}</tex-math><mml:math id="d33e3443"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mn>40</mml:mn></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq124.gif"/></alternatives></inline-formula> is 512.82 generations. For <inline-formula id="IEq125"><alternatives><tex-math id="d33e3460">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N = 100,000$$\end{document}</tex-math><mml:math id="d33e3465"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq125.gif"/></alternatives></inline-formula> and <inline-formula id="IEq126"><alternatives><tex-math id="d33e3474">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \rightarrow \infty $$\end{document}</tex-math><mml:math id="d33e3479"><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>&#x0221e;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq123.gif"/></alternatives></inline-formula>, the expected coalescent time <inline-formula id="IEq127"><alternatives><tex-math id="d33e3487">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {E}}[T_{n:400}]$$\end{document}</tex-math><mml:math id="d33e3492"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mn>400</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq127.gif"/></alternatives></inline-formula> is 501.25. If many recombination endpoint comparisons happen at the coalescence of common ancestors older than five hundred generations ago, many haplotypes can be pruned ahead of time. The pruning technique does not compromise the exactness of simulating IBD segment detectable beyond a length threshold.</p></sec><sec id="Sec8"><title>The probability that recombination endpoints are shared between haplotypes</title><p id="Par26">At some point in the past, two sample haplotypes may share the same recombination endpoints to the left and right of a fixed location. Without loss of generality, let haplotypes <italic>a</italic> and <italic>b</italic> coalesce to their common ancestor <italic>c</italic> at time <italic>u</italic>, and let haplotypes <italic>c</italic> and <italic>d</italic> coalesce to their common ancestor <italic>e</italic> at time <inline-formula id="IEq128"><alternatives><tex-math id="d33e3534">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u + v$$\end{document}</tex-math><mml:math id="d33e3539"><mml:mrow><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq128.gif"/></alternatives></inline-formula>. Figures <xref rid="MOESM1" ref-type="media">S2</xref> and <xref rid="MOESM1" ref-type="media">S3</xref> illustrate the coalescent tree in this scenario. Observe that the recombination endpoints to the right <inline-formula id="IEq129"><alternatives><tex-math id="d33e3552">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{a,c}, R_{b,c} \sim \text {Exponential}(u)$$\end{document}</tex-math><mml:math id="d33e3557"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Exponential</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq129.gif"/></alternatives></inline-formula> and <inline-formula id="IEq130"><alternatives><tex-math id="d33e3583">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{c,e} \sim \text {Exponential}(v)$$\end{document}</tex-math><mml:math id="d33e3588"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Exponential</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq130.gif"/></alternatives></inline-formula>.</p><p id="Par27">The merging step in Algorithm&#x000a0;1 serves to avoid comparing both the endpoints of <italic>a</italic> and <italic>b</italic> with <italic>d</italic> when <italic>a</italic> and <italic>b</italic> have the same endpoints at time <inline-formula id="IEq131"><alternatives><tex-math id="d33e3624">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u + v$$\end{document}</tex-math><mml:math id="d33e3629"><mml:mrow><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq128.gif"/></alternatives></inline-formula>. Specifically, if <italic>a</italic> and <italic>b</italic>&#x02019;s shared recombination endpoint <inline-formula id="IEq132"><alternatives><tex-math id="d33e3642">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{c,e}$$\end{document}</tex-math><mml:math id="d33e3647"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq132.gif"/></alternatives></inline-formula> is smaller than their separate endpoints <inline-formula id="IEq133"><alternatives><tex-math id="d33e3656">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{a,c}$$\end{document}</tex-math><mml:math id="d33e3661"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq133.gif"/></alternatives></inline-formula> and <inline-formula id="IEq134"><alternatives><tex-math id="d33e3670">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{b,c}$$\end{document}</tex-math><mml:math id="d33e3675"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq134.gif"/></alternatives></inline-formula>, we can henceforth treat them as the same haplotype without loss of information (Figure <xref rid="MOESM1" ref-type="media">S2</xref>). If either of the individual lengths <inline-formula id="IEq135"><alternatives><tex-math id="d33e3688">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{a,c}$$\end{document}</tex-math><mml:math id="d33e3693"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq133.gif"/></alternatives></inline-formula> or <inline-formula id="IEq136"><alternatives><tex-math id="d33e3702">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{b,c}$$\end{document}</tex-math><mml:math id="d33e3707"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq134.gif"/></alternatives></inline-formula> are smaller than the common length <inline-formula id="IEq137"><alternatives><tex-math id="d33e3716">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{c,e}$$\end{document}</tex-math><mml:math id="d33e3721"><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq132.gif"/></alternatives></inline-formula>, we cannot merge the haplotypes without losing information (Figure <xref rid="MOESM1" ref-type="media">S3</xref>).</p><p id="Par28">The probability that haplotypes <italic>a</italic> and <italic>b</italic> have the same recombination endpoint at time <inline-formula id="IEq138"><alternatives><tex-math id="d33e3741">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u + v$$\end{document}</tex-math><mml:math id="d33e3746"><mml:mrow><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq128.gif"/></alternatives></inline-formula> is <inline-formula id="IEq139"><alternatives><tex-math id="d33e3753">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v(2u+v)^{-1}$$\end{document}</tex-math><mml:math id="d33e3758"><mml:mrow><mml:mi>v</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq139.gif"/></alternatives></inline-formula>. Replacing arbitrary coalescent times <italic>u</italic> and <inline-formula id="IEq140"><alternatives><tex-math id="d33e3780">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u + v$$\end{document}</tex-math><mml:math id="d33e3785"><mml:mrow><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq128.gif"/></alternatives></inline-formula> with (double) the expected times after the <inline-formula id="IEq141"><alternatives><tex-math id="d33e3792">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(n-k)^{\text {th}}$$\end{document}</tex-math><mml:math id="d33e3797"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>th</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq141.gif"/></alternatives></inline-formula> and <inline-formula id="IEq142"><alternatives><tex-math id="d33e3810">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(n-j)^{\text {th}}$$\end{document}</tex-math><mml:math id="d33e3815"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>th</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq142.gif"/></alternatives></inline-formula> coalescent events, respectively, we derive an asymptotic result concerning the probability that haplotypes merge before the <inline-formula id="IEq143"><alternatives><tex-math id="d33e3828">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(n-k)^{\text {th}}$$\end{document}</tex-math><mml:math id="d33e3833"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>th</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq141.gif"/></alternatives></inline-formula> coalescent event.</p><sec id="FPar1"><title>Proposition 1</title><p id="Par29">Let <inline-formula id="IEq144"><alternatives><tex-math id="d33e3850">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$u/2 = {\mathbb {E}}[T_{n:(k+1)}^+]= 1/k - 1/n$$\end{document}</tex-math><mml:math id="d33e3855"><mml:mrow><mml:mi>u</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq144.gif"/></alternatives></inline-formula> and <inline-formula id="IEq145"><alternatives><tex-math id="d33e3894">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v/2 = {\mathbb {E}}[T_{n:(j+1)}^+] - {\mathbb {E}}[T_{n:(k+1)}^+] = 1 /j - 1/k$$\end{document}</tex-math><mml:math id="d33e3899"><mml:mrow><mml:mi>v</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq145.gif"/></alternatives></inline-formula> (Equation <xref rid="Equ8" ref-type="disp-formula">8</xref>). For <inline-formula id="IEq146"><alternatives><tex-math id="d33e3963">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j=o(k)$$\end{document}</tex-math><mml:math id="d33e3968"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq146.gif"/></alternatives></inline-formula>,<disp-formula id="Equ26"><alternatives><tex-math id="d33e3980">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P(\min (R_{a,c}, R_{b,c}, R_{c,e}) = R_{c,e} \hspace{1.0pt}| \hspace{1.0pt}u,v ) \rightarrow 1. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e3985" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mspace width="1.0pt"/><mml:mo stretchy="false">|</mml:mo><mml:mspace width="1.0pt"/><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ26.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="FPar2"><title>Proof</title><p id="Par30">Note that <inline-formula id="IEq147"><alternatives><tex-math id="d33e4047">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j = o(n)$$\end{document}</tex-math><mml:math id="d33e4052"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq147.gif"/></alternatives></inline-formula> as well because <inline-formula id="IEq148"><alternatives><tex-math id="d33e4064">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k \le n$$\end{document}</tex-math><mml:math id="d33e4069"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq2.gif"/></alternatives></inline-formula>.<disp-formula id="Equ27"><alternatives><tex-math id="d33e4076">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} P(\min (R_{a,c},R_{b,c},R_{c,e})&#x00026;=R_{c,e} \hspace{1.0pt}| \hspace{1.0pt}u,v) = \frac{1/j-1/k}{1/j+1/k-2/n} \\&#x00026;= \frac{(k-j)n}{(nk+nj-2kj)} \\&#x00026;= \frac{1-j/k}{(1+j/k-2j/n)} \\&#x00026;\rightarrow 1. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e4081" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mspace width="1.0pt"/><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mspace width="1.0pt"/><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>k</mml:mi><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>j</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ27.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq149"><alternatives><tex-math id="d33e4235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="d33e4240"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq149.gif"/></alternatives></inline-formula></p><p>The implication of Proposition <xref ref-type="sec" rid="FPar1">1</xref> is that haplotypes that share a recent common ancestor should have the same endpoints at the most distant common ancestors.</p><p>Since recombinations to the right and left of a focal location are independent, the result of Proposition <xref ref-type="sec" rid="FPar1">1</xref> extends to simulating IBD segments overlapping a focal location. Figures <xref rid="MOESM1" ref-type="media">S2</xref> and <xref rid="MOESM1" ref-type="media">S3</xref> illustrate that merging occurs when the minimum recombination endpoints to the left and right of the focal location are drawn for the common ancestor <italic>c</italic> (<inline-formula id="IEq150"><alternatives><tex-math id="d33e4262">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min (R_{a,c}, R_{b,c},R_{c,e}) = R_{c,e}$$\end{document}</tex-math><mml:math id="d33e4267"><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq150.gif"/></alternatives></inline-formula> and <inline-formula id="IEq151"><alternatives><tex-math id="d33e4306">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\min (L_{a,c}, L_{b,c},L_{c,e}) = L_{c,e}$$\end{document}</tex-math><mml:math id="d33e4311"><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq151.gif"/></alternatives></inline-formula>).</p></sec></sec><sec id="Sec9"><title>The number of identity-by-descent comparisons</title><p id="Par33">Pruning and merging should be most effective at reducing runtime if the majority of recombination endpoint comparisons happen at the oldest coalescent events. For these oldest coalescent events, we show that without pruning nor merging the expected number of IBD comparisons is of the same order as the worst-case number of IBD comparisons, which is asymptotically equivalent to the sample size squared.</p><p id="Par34">Consider a random bifurcating tree. Here, and nowhere else, we work downward from the root of the tree. Throughout, we assume that <italic>n</italic> equals a power of 2 to simplify the floor and ceiling functions <inline-formula id="IEq152"><alternatives><tex-math id="d33e4358">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lfloor n/ 2^j \rfloor = \lceil n/2^j \rceil $$\end{document}</tex-math><mml:math id="d33e4363"><mml:mrow><mml:mrow><mml:mo>&#x0230a;</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup><mml:mo>&#x0230b;</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>&#x02308;</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:msup><mml:mo>&#x02309;</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq152.gif"/></alternatives></inline-formula> for <inline-formula id="IEq153"><alternatives><tex-math id="d33e4386">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j \in {\mathbb {N}}$$\end{document}</tex-math><mml:math id="d33e4391"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq153.gif"/></alternatives></inline-formula>. At the coalescent event <inline-formula id="IEq154"><alternatives><tex-math id="d33e4399">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_2$$\end{document}</tex-math><mml:math id="d33e4404"><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq22.gif"/></alternatives></inline-formula>, the tree bifurcates into two subtrees. At the coalescent event <inline-formula id="IEq155"><alternatives><tex-math id="d33e4410">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_3$$\end{document}</tex-math><mml:math id="d33e4415"><mml:msub><mml:mi>T</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq155.gif"/></alternatives></inline-formula>, the scenario with the worst case number of comparisons is subtrees of size <italic>n</italic>/2,&#x000a0;<italic>n</italic>/4, and <italic>n</italic>/4. In general, at each coalescent event, the worst case is to split in half the largest subtree, depicted in Figure <xref rid="MOESM1" ref-type="media">S4</xref>A.</p><p id="Par35">Let <inline-formula id="IEq156"><alternatives><tex-math id="d33e4436">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_j$$\end{document}</tex-math><mml:math id="d33e4441"><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq156.gif"/></alternatives></inline-formula> be the size of one subtree randomly bifurcated from a subtree of size <inline-formula id="IEq157"><alternatives><tex-math id="d33e4447">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{j-1}$$\end{document}</tex-math><mml:math id="d33e4452"><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq18.gif"/></alternatives></inline-formula>. Figure <xref rid="MOESM1" ref-type="media">S4</xref> illustrates these subtree sizes in the context of a random bifurcating tree. The number of recombination endpoint comparisons is <inline-formula id="IEq158"><alternatives><tex-math id="d33e4464">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{j} (B_{j-1} - B_j) $$\end{document}</tex-math><mml:math id="d33e4469"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq158.gif"/></alternatives></inline-formula>. In Theorem <xref ref-type="sec" rid="FPar3">1</xref>, we relate the expected value and covariance of <inline-formula id="IEq159"><alternatives><tex-math id="d33e4495">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_{j} (B_{j-1} - B_j) $$\end{document}</tex-math><mml:math id="d33e4500"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq158.gif"/></alternatives></inline-formula> to the worst-case <inline-formula id="IEq160"><alternatives><tex-math id="d33e4522">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n/2^{2j}$$\end{document}</tex-math><mml:math id="d33e4527"><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq160.gif"/></alternatives></inline-formula> computations. The result concerns a bounded number of standard deviations from the expected value, which is a stronger notion than the expected number of computations <inline-formula id="IEq161"><alternatives><tex-math id="d33e4539">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Theta (\cdot )$$\end{document}</tex-math><mml:math id="d33e4544"><mml:mrow><mml:mi mathvariant="normal">&#x00398;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq161.gif"/></alternatives></inline-formula>. The intuition is that a Binomial(<italic>m</italic>, 1/2) random variable&#x02019;s coefficient of variation <inline-formula id="IEq162"><alternatives><tex-math id="d33e4558">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m^{-1/2}$$\end{document}</tex-math><mml:math id="d33e4563"><mml:msup><mml:mi>m</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq162.gif"/></alternatives></inline-formula> converges to 0 as <italic>m</italic> gets large. The general proof strategy is to recursively apply the law of total covariance and identify the exponents in the dominating terms.</p><sec id="FPar3"><title>Theorem 1</title><p id="Par36">Let <inline-formula id="IEq163"><alternatives><tex-math id="d33e4581">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_j \sim \text {Binomial}(B_{j-1},1/2)$$\end{document}</tex-math><mml:math id="d33e4586"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq163.gif"/></alternatives></inline-formula> for bounded index <inline-formula id="IEq164"><alternatives><tex-math id="d33e4611">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j \ge 1$$\end{document}</tex-math><mml:math id="d33e4616"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq164.gif"/></alternatives></inline-formula> and <inline-formula id="IEq165"><alternatives><tex-math id="d33e4623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_0=n$$\end{document}</tex-math><mml:math id="d33e4628"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq165.gif"/></alternatives></inline-formula>.<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="d33e4637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lim _{n \rightarrow \infty } \frac{{\mathbb {E}}[B_j (B_{j-1} - B_j)] + O(1) \cdot \text {Cov}^{1/2} (B_j (B_{j-1}-B_j)) }{n^2 / 2^{2j}} = 1. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e4643" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo movablelimits="true">lim</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>&#x0221e;</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="FPar4"><title>Proof</title><p id="Par37">We must calculate the expected value and the covariance in the numerator. Let <inline-formula id="IEq166"><alternatives><tex-math id="d33e4742">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B \sim $$\end{document}</tex-math><mml:math id="d33e4747"><mml:mrow><mml:mi>B</mml:mi><mml:mo>&#x0223c;</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq166.gif"/></alternatives></inline-formula> Binomial(<italic>m</italic>, 1/2).<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="d33e4756">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} {\mathbb {E}}[B(B-1)]&#x00026;= {\mathbb {E}}[B^2] - {\mathbb {E}}[B] \\&#x00026;= m/4 + m^2 / 4 - m/2 \\&#x00026;= m(m-1)/4 \\&#x00026;= m(m-1)\cdot 2^{-2\cdot 1}. \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e4762" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn><mml:mo>-</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>Using the law of total expectation, we solve the expected value for <inline-formula id="IEq167"><alternatives><tex-math id="d33e4874">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j = 2$$\end{document}</tex-math><mml:math id="d33e4879"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq167.gif"/></alternatives></inline-formula>.<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="d33e4886">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} {\mathbb {E}}[ B_{2} (B_1 - B_2)]&#x00026;= {\mathbb {E}}[ {\mathbb {E}}[B_2 (B_1 - B_2) | B_1]] \\&#x00026;= {\mathbb {E}}[ B_1 (B_1 - 1) \cdot 2^{-2 \cdot 1}] \\&#x00026;= n(n-1) \cdot 2^{-2\cdot 1} \cdot 2^{-2 \cdot 1} = n(n-1) \times 2^{-2 \cdot 2}. \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e4892" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000d7;</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula>Applying Equation <xref rid="Equ10" ref-type="disp-formula">10</xref> recursively, we derive the general formula<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="d33e5049">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\mathbb {E}}[B_{j} (B_{j-1} - B_j)] = n(n-1) \cdot 2^{-2j}. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5055" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>The limit of Equation <xref rid="Equ12" ref-type="disp-formula">12</xref> divided by <inline-formula id="IEq168"><alternatives><tex-math id="d33e5109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^2 \cdot 2^{-2j}$$\end{document}</tex-math><mml:math id="d33e5114"><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mi>j</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq168.gif"/></alternatives></inline-formula> is one. Next, we require that the standard deviation is of order less than <inline-formula id="IEq169"><alternatives><tex-math id="d33e5128">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^2$$\end{document}</tex-math><mml:math id="d33e5133"><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq169.gif"/></alternatives></inline-formula>. Using the law of total covariance, we derive in Lemma <xref ref-type="sec" rid="FPar5">2</xref> that <inline-formula id="IEq170"><alternatives><tex-math id="d33e5143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text {Cov}(B_j(B_{j-1}-B_j)) \sim n^3$$\end{document}</tex-math><mml:math id="d33e5148"><mml:mrow><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x0223c;</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq170.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq171"><alternatives><tex-math id="d33e5180">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim $$\end{document}</tex-math><mml:math id="d33e5185"><mml:mo>&#x0223c;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq171.gif"/></alternatives></inline-formula> means asymptotically equivalent. Consequently,<disp-formula id="Equ28"><alternatives><tex-math id="d33e5189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \lim _{n\rightarrow \infty } n^{-2} \cdot \text {Cov}^{1/2} (B_j(B_{j-1}-B_j)) = 0. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5194" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo movablelimits="true">lim</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">&#x02192;</mml:mo><mml:mi>&#x0221e;</mml:mi></mml:mrow></mml:munder><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ28.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq172"><alternatives><tex-math id="d33e5248">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="d33e5253"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq149.gif"/></alternatives></inline-formula></p><p>We remark that our marginal calculations along one branching path are not the same as deriving the expected number of comparisons at the final <italic>j</italic> coalescent events, the latter of which depends on the tree topology. Harding (<xref ref-type="bibr" rid="CR27">1971</xref>) discusses the intractability of calculating probability masses for a tree topology with many leaves, which is a limiting factor in deriving the expected number of comparisons at the final <italic>j</italic> coalescent events. In Appendix <xref rid="Sec20" ref-type="sec">A</xref>, we give moment calculations from Dahmer and Kersting (<xref ref-type="bibr" rid="CR18">2015</xref>) that offer a complementary perspective on the number of IBD comparisons, reiterating that a number of computations <inline-formula id="IEq173"><alternatives><tex-math id="d33e5274">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sim n^2$$\end{document}</tex-math><mml:math id="d33e5279"><mml:mrow><mml:mo>&#x0223c;</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq173.gif"/></alternatives></inline-formula> should occur at and near the root of the coalescent tree.</p></sec></sec><sec id="Sec10"><title>Empirical results</title><p id="Par39">Temple et&#x000a0;al. (<xref ref-type="bibr" rid="CR59">2024</xref>) and Temple and Thompson (<xref ref-type="bibr" rid="CR58">2024</xref>) use our algorithm to conduct enormous simulation studies involving sample sizes as large as 10,000 individuals and tens of millions of runs. (Individuals are &#x0201c;diploids&#x0201d;, which we implement as a haploid model with the number of haploids equal to the number of individuals times 2.) Their empirical studies are feasible because of the pruning and merging techniques, whose effects on runtime we benchmark in this section. We also benchmark runtimes for msprime and ARGON, showing that these existing methods to simulate IBD can take more than an hour to complete one run when sample size exceeds 5000 diploid individuals. For all runs, we use 1 core processing unit of an Intel Xeon E5-2630 2.60 gigahertz (GHz) node.</p><sec id="Sec11"><title>Experimental setup</title><sec id="Sec12"><title>Demographic scenarios</title><p id="Par40">We consider two complex demographic scenarios and constant population sizes. Figure <xref rid="MOESM1" ref-type="media">S5</xref> shows the demographic scenarios graphically. These demographic scenarios are the same as those used in Temple et&#x000a0;al. (<xref ref-type="bibr" rid="CR59">2024</xref>), Temple and Thompson (<xref ref-type="bibr" rid="CR58">2024</xref>), Temple (<xref ref-type="bibr" rid="CR57">2024</xref>), and Temple and Browning (<xref ref-type="bibr" rid="CR54">2025</xref>). We refer to the complex demographic scenarios as examples of three phases of exponential growth and a population bottleneck. The three phases of exponential growth scenario involves an ancestral population of 5000 individuals that grew exponentially at different rates in three different time periods. This demographic model is similar to the &#x0201c;UK-like&#x0201d; model in Cai et al. (<xref ref-type="bibr" rid="CR15">2023</xref>). The population bottleneck scenario involves an ancestral population of 10,000 individuals that grew exponentially at a fixed rate but experienced an instantaneous reduction in size twenty generations before the present day.</p></sec><sec id="Sec13"><title>Hard selective sweeps</title><p id="Par41">We also consider a genetic model for positive selection (Fisher <xref ref-type="bibr" rid="CR21">1923</xref>; Haldane <xref ref-type="bibr" rid="CR25">1924</xref>, <xref ref-type="bibr" rid="CR26">1932</xref>) that is described in Crow and Kimura (<xref ref-type="bibr" rid="CR16">1970</xref>), Temple et&#x000a0;al. (<xref ref-type="bibr" rid="CR59">2024</xref>), and Temple (<xref ref-type="bibr" rid="CR57">2024</xref>) as well as in many other articles. Briefly, the allele frequency <inline-formula id="IEq174"><alternatives><tex-math id="d33e5351">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$p_s(t)$$\end{document}</tex-math><mml:math id="d33e5356"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq174.gif"/></alternatives></inline-formula> decreases backward in time as a function of a nonnegative selection coefficient <italic>s</italic>. The selection coefficient reflects the advantage the allele has relative to alternative alleles. The larger the selection coefficient is, the faster the allele frequency increased. Also, the larger the selection coefficient is, the more detectable IBD segments there are on average.</p><p id="Par42">Positive selection around a locus is implemented via a coalescent with two subpopulations: one subpopulation has the sweeping allele, and one subpopulation does not have the sweeping allele. The allele-specific effective population sizes are <inline-formula id="IEq175"><alternatives><tex-math id="d33e5374">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N(t) \cdot p(t)$$\end{document}</tex-math><mml:math id="d33e5379"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq175.gif"/></alternatives></inline-formula> and <inline-formula id="IEq176"><alternatives><tex-math id="d33e5396">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N(t) \cdot (1 - p(t))$$\end{document}</tex-math><mml:math id="d33e5401"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&#x000b7;</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq176.gif"/></alternatives></inline-formula>. Until the coalescent reaches the sweeping allele&#x02019;s time of <italic>de novo</italic> mutation, IBD segments are not possible between individuals in separate subpopulations.</p></sec></sec><sec id="Sec14"><title>Compute times</title><sec id="Sec15"><title>Simulating identity-by-descent segment lengths around a locus</title><p id="Par43">To assess the effect of the pruning and merging rules, we evaluate four implementation strategies: merging and pruning (Algorithm&#x000a0;1), pruning only, merging only, and neither pruning nor merging (the naive approach). For each implementation, we run five simulations for sample sizes increasing by a factor of 2, recording the average wall clock compute time. The upper bound on sample size that we consider is 128,000 individiuals, which is of the same order as the UK Biobank data (Bycroft et&#x000a0;al. <xref ref-type="bibr" rid="CR9">2018</xref>).</p><p id="Par44">Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the average runtime per sample size between the implementations. Simulating IBD segment lengths without pruning nor merging takes more than one minute on average for 8000 samples. Simulating IBD segment lengths with either pruning or merging can take less than one minute for 64,000 samples. Pruning appears to give a larger reduction in compute time than merging. Merging can further reduce runtime for sample sizes greater than 100,000. The difference in five to ten seconds can be important when the number of simulations is enormous, as is the case in the Temple et&#x000a0;al. (<xref ref-type="bibr" rid="CR59">2024</xref>) and Temple and Thompson (<xref ref-type="bibr" rid="CR58">2024</xref>) studies.<fig id="Fig2"><label>Fig. 2</label><caption><p>Compute time to simulate IBD segment lengths around a locus depending on algorithm implementation. Compute time (<italic>y</italic>-axis) in seconds by sample size (<italic>x</italic>-axis) in thousands is averaged over five simulations. The legend denotes colored line styles for implementations using Algorithm&#x000a0;1 as is (blue), merging only (orange), pruning only (green), and neither pruning nor merging (red). The main text describes &#x0201c;merging&#x0201d; and &#x0201c;pruning&#x0201d; techniques. The demography is the population bottleneck. The Morgans length threshold is 0.01 (Color figure online)</p></caption><graphic xlink:href="11538_2025_1464_Fig2_HTML" id="MO3"/></fig></p><p id="Par45">One important influence on runtime is the detection threshold. Figure <xref rid="Fig3" ref-type="fig">3</xref>A shows the algorithm&#x02019;s average runtime per sample size for different detection thresholds on segment length. With the 0.0025 Morgans cutoff, the quadratic behavior of runtime is visually apparent when more than 20,000 samples are simulated, whereas the trend is less obvious for detection thresholds greater than 0.0050 Morgans. The algorithm is at least twice as fast on average for detection thresholds <inline-formula id="IEq177"><alternatives><tex-math id="d33e5467">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 0.02$$\end{document}</tex-math><mml:math id="d33e5472"><mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq177.gif"/></alternatives></inline-formula> Morgans versus those <inline-formula id="IEq178"><alternatives><tex-math id="d33e5478">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 0.0050$$\end{document}</tex-math><mml:math id="d33e5483"><mml:mrow><mml:mo>&#x02264;</mml:mo><mml:mn>0.0050</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq178.gif"/></alternatives></inline-formula> Morgans.</p><p id="Par46">Another important influence on runtime is the population size. Figure <xref rid="Fig3" ref-type="fig">3</xref>B shows the algorithm&#x02019;s average runtime per sample size for different constant population sizes. The algorithm is at least twice as fast on average for population sizes <inline-formula id="IEq179"><alternatives><tex-math id="d33e5494">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \ge 10,000$$\end{document}</tex-math><mml:math id="d33e5499"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq179.gif"/></alternatives></inline-formula> versus <inline-formula id="IEq180"><alternatives><tex-math id="d33e5508">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \le 1,000$$\end{document}</tex-math><mml:math id="d33e5513"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq180.gif"/></alternatives></inline-formula>. Population sizes are estimated to be at least 10,000 for many model organisms (Adrion et al. <xref ref-type="bibr" rid="CR1">2020</xref>; Lauterbur et al. <xref ref-type="bibr" rid="CR42">2023</xref>).</p><p id="Par47">Figure <xref rid="MOESM1" ref-type="media">S6</xref> shows the algorithm&#x02019;s average runtime per sample size for different demographic scenarios and varying selection coefficients. Simulating IBD segment lengths takes more time for the population bottleneck and three phases of exponential growth scenarios compared to constant-size population scenarios. Runtime increases with the selection coefficient. The highest average measurement is more than four minutes for 64,000 samples, the population bottleneck scenario, and <inline-formula id="IEq181"><alternatives><tex-math id="d33e5533">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s=0.04$$\end{document}</tex-math><mml:math id="d33e5538"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>0.04</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq181.gif"/></alternatives></inline-formula>.<fig id="Fig3"><label>Fig. 3</label><caption><p>Compute time to simulate IBD segment lengths around a locus depending on the detection threshold and population size. Compute time (<italic>y</italic>-axis) in seconds by sample size (<italic>x</italic>-axis) in thousands is averaged over five simulations. The legends denote colored line styles for A) different detection thresholds (in Morgans) with <inline-formula id="IEq182"><alternatives><tex-math id="d33e5557">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N = 10^5$$\end{document}</tex-math><mml:math id="d33e5562"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq182.gif"/></alternatives></inline-formula> fixed or B) different population sizes with 0.02 Morgans fixed (Color figure online)</p></caption><graphic xlink:href="11538_2025_1464_Fig3_HTML" id="MO4"/></fig></p><p id="Par48">Now, we perform twenty simulations each for sample sizes <inline-formula id="IEq183"><alternatives><tex-math id="d33e5575">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\cdot 10^4, 4\cdot 10^4, 8\cdot 10^4, 16\cdot 10^4,$$\end{document}</tex-math><mml:math id="d33e5580"><mml:mrow><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mn>8</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mn>16</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq183.gif"/></alternatives></inline-formula> and <inline-formula id="IEq184"><alternatives><tex-math id="d33e5609">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$32\cdot 10^4$$\end{document}</tex-math><mml:math id="d33e5614"><mml:mrow><mml:mn>32</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq184.gif"/></alternatives></inline-formula> and regress on runtime. The linear models in runtimes <inline-formula id="IEq185"><alternatives><tex-math id="d33e5623">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{Y}} \in {\mathbb {R}}$$\end{document}</tex-math><mml:math id="d33e5628"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq185.gif"/></alternatives></inline-formula>, sample sizes <inline-formula id="IEq186"><alternatives><tex-math id="d33e5637">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\textbf{X}} \in {\mathbb {R}}$$\end{document}</tex-math><mml:math id="d33e5642"><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq186.gif"/></alternatives></inline-formula>, and regression coefficients <inline-formula id="IEq187"><alternatives><tex-math id="d33e5651">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="d33e5656"><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b2;</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq187.gif"/></alternatives></inline-formula> be:<disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="d33e5663">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{Y}}= &#x00026;  \beta _0 {\textbf{X}} ; \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5669" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mo>&#x0037e;</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="d33e5687">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} {\textbf{Y}}= &#x00026;  \beta _1 {\textbf{X}} + \beta _2{\textbf{X}}^2. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5693" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003b2;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula>We measure the proportion of a fitted value explained by the linear effect as<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="d33e5721">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {Percentage of prediction from linear component} = \frac{{\hat{\beta }}_1 x}{{\hat{\beta }}_1 x + {\hat{\beta }}_2 \cdot x^2}, \end{aligned}$$\end{document}</tex-math><mml:math id="d33e5727" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Percentage of prediction from linear component</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula>where <italic>x</italic> is a sample size. Figure <xref rid="Fig4" ref-type="fig">4</xref> shows that the linear component in Equation <xref rid="Equ14" ref-type="disp-formula">14</xref> explains more than fifty percent of predictions for sample size <inline-formula id="IEq188"><alternatives><tex-math id="d33e5776">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le 16\cdot 10^4$$\end{document}</tex-math><mml:math id="d33e5781"><mml:mrow><mml:mo>&#x02264;</mml:mo><mml:mn>16</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq188.gif"/></alternatives></inline-formula>, which we say demonstrates approximately linear computational complexity in this domain. Next, we estimate <inline-formula id="IEq189"><alternatives><tex-math id="d33e5791">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\beta }}_0$$\end{document}</tex-math><mml:math id="d33e5796"><mml:msub><mml:mover accent="true"><mml:mi>&#x003b2;</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq189.gif"/></alternatives></inline-formula> equal to 0.0913 and 0.0707 in Equation <xref rid="Equ13" ref-type="disp-formula">13</xref> for population sizes <inline-formula id="IEq190"><alternatives><tex-math id="d33e5808">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=10,000$$\end{document}</tex-math><mml:math id="d33e5813"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq190.gif"/></alternatives></inline-formula> and <inline-formula id="IEq191"><alternatives><tex-math id="d33e5822">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N=100,000$$\end{document}</tex-math><mml:math id="d33e5827"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq191.gif"/></alternatives></inline-formula>. We interpret this to mean that the expected runtime increases by 0.0913 and 0.0707 seconds for each one unit increase to sample size (in thousands), at least up to <inline-formula id="IEq192"><alternatives><tex-math id="d33e5836">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \le 16\cdot 10^4$$\end{document}</tex-math><mml:math id="d33e5841"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mn>16</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq192.gif"/></alternatives></inline-formula>.<fig id="Fig4"><label>Fig. 4</label><caption><p>Percentage of regression model predictions explained by linear and quadratic effects. The percentage of predicted compute time (<italic>y</italic>-axis) in seconds by sample size (<italic>x</italic>-axis) in thousands with respect to linear and quadratic effects. Plots show results for A) the constant population size <inline-formula id="IEq193"><alternatives><tex-math id="d33e5865">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \equiv N_e =10,000$$\end{document}</tex-math><mml:math id="d33e5870"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&#x02261;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq193.gif"/></alternatives></inline-formula> versus B) <inline-formula id="IEq194"><alternatives><tex-math id="d33e5883">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \equiv N_e =100,000$$\end{document}</tex-math><mml:math id="d33e5888"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&#x02261;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq194.gif"/></alternatives></inline-formula>. The detectable IBD segments are simulated with a 0.02 Morgans threshold (Color figure online)</p></caption><graphic xlink:href="11538_2025_1464_Fig4_HTML" id="MO5"/></fig></p><p id="Par49">Overall, we benchmark that our simulation algorithm can be run tens of thousands of times within a day on 1 core processing unit of an Intel 2.20 GHz compute node. Despite performance savings, we observe that our simulation algorithm maintains quadratic behavior in sample size (Figure <xref rid="Fig2" ref-type="fig">2</xref> and Figure <xref rid="MOESM1" ref-type="media">S6</xref>). One explanation for this finding is that a sizeable fraction of all lineages coalesce at least once in the first few generations when the sample size exceeds 10,000 (Bhaskar et&#x000a0;al. <xref ref-type="bibr" rid="CR8">2014</xref>).</p></sec><sec id="Sec16"><title>Simulating identity-by-descent segment lengths from the ancestral recombination graph</title><p id="Par50">We measure the times it takes ARGON (Palamara <xref ref-type="bibr" rid="CR47">2016</xref>) and msprime (Baumdicker et al. <xref ref-type="bibr" rid="CR7">2021</xref>) with tskibd (Guo et&#x000a0;al. <xref ref-type="bibr" rid="CR23">2024</xref>) to simulate detectable IBD segments around a locus. The tskibd program concatenates short IBD segments from msprime tree sequences into detectable IBD segment lengths. To measure the computing time of these approaches, we do not include the time to simulate an ARG. The computing time includes writing memory to disk, which is small when there are few detectable IBD segments.</p><p id="Par51">We simulate IBD segments <inline-formula id="IEq195"><alternatives><tex-math id="d33e5945">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 0.02$$\end{document}</tex-math><mml:math id="d33e5950"><mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq177.gif"/></alternatives></inline-formula> Morgans in a 0.07 Morgans region, which is a large enough region to contain all IBD segments <inline-formula id="IEq196"><alternatives><tex-math id="d33e5956">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 0.02$$\end{document}</tex-math><mml:math id="d33e5961"><mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq177.gif"/></alternatives></inline-formula> Morgans around its central location. (We also benchmarked runtimes for the <inline-formula id="IEq197"><alternatives><tex-math id="d33e5967">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 0.03$$\end{document}</tex-math><mml:math id="d33e5972"><mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mn>0.03</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq197.gif"/></alternatives></inline-formula> Morgans detection threshold and observed no substantive differences to the <inline-formula id="IEq198"><alternatives><tex-math id="d33e5978">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 0.02$$\end{document}</tex-math><mml:math id="d33e5983"><mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mn>0.02</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq177.gif"/></alternatives></inline-formula> Morgans results.) Both programs visit nodes in the ARG in small, non-overlapping sliding windows. We consider 0.0001 Morgans windows in benchmarking runtimes; using smaller window sizes results in more exact segment endpoints at the cost of additional runtime.</p><p id="Par52">Table <xref rid="Tab2" ref-type="table">2</xref> reports the average runtimes of each method for increasing sample size in the population bottleneck demographic scenario. ARGON takes more than an hour to simulate the detectable IBD segment lengths of 2000 diploids. We do not run it for more than 4000 diploids due to concerns surrounding quadratic runtimes. tskibd takes less than twenty minutes to simulate the detectable IBD segment lengths of 4000 diploids and a little over an hour to simulate the IBD length distribution of 8000 diploids. Our improved approach simulates IBD segments <inline-formula id="IEq199"><alternatives><tex-math id="d33e6000">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 0.01$$\end{document}</tex-math><mml:math id="d33e6005"><mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mn>0.01</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq199.gif"/></alternatives></inline-formula> Morgans around a locus of 8000 diploids in less than two seconds (Figure <xref rid="Fig2" ref-type="fig">2</xref>). Even our naive approach completes the same scope of simulations in less than two minutes.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Average runtime to simulate detectable IBD segments with ARGON and tskibd</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left">Samples</th><th align="left">Compute Time (s)</th></tr></thead><tbody><tr><td align="left">ARGON</td><td align="left">500</td><td align="left">129.7</td></tr><tr><td align="left"/><td align="left">1000</td><td align="left">722.9 (<inline-formula id="IEq200"><alternatives><tex-math id="d33e6055">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx 12$$\end{document}</tex-math><mml:math id="d33e6060"><mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mn>12</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq200.gif"/></alternatives></inline-formula> min)</td></tr><tr><td align="left"/><td align="left">2000</td><td align="left">3878.5 (<inline-formula id="IEq201"><alternatives><tex-math id="d33e6073">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx 65$$\end{document}</tex-math><mml:math id="d33e6078"><mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mn>65</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq201.gif"/></alternatives></inline-formula> min)</td></tr><tr><td align="left"/><td align="left">4000</td><td align="left">18,995.9 (<inline-formula id="IEq202"><alternatives><tex-math id="d33e6091">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx 317$$\end{document}</tex-math><mml:math id="d33e6096"><mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mn>317</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq202.gif"/></alternatives></inline-formula> min)</td></tr><tr><td align="left">tskibd</td><td align="left">500</td><td align="left">6.4</td></tr><tr><td align="left"/><td align="left">1000</td><td align="left">39.4</td></tr><tr><td align="left"/><td align="left">2000</td><td align="left">209.2 (<inline-formula id="IEq203"><alternatives><tex-math id="d33e6124">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx 3$$\end{document}</tex-math><mml:math id="d33e6129"><mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq203.gif"/></alternatives></inline-formula> min)</td></tr><tr><td align="left"/><td align="left">4000</td><td align="left">947.3 (<inline-formula id="IEq204"><alternatives><tex-math id="d33e6142">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx 16$$\end{document}</tex-math><mml:math id="d33e6147"><mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mn>16</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq204.gif"/></alternatives></inline-formula> min)</td></tr><tr><td align="left"/><td align="left">8000</td><td align="left">4022.0 (<inline-formula id="IEq205"><alternatives><tex-math id="d33e6160">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\approx 67$$\end{document}</tex-math><mml:math id="d33e6165"><mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mn>67</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq205.gif"/></alternatives></inline-formula> min)</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec17"><title>Benchmarking simulation accuracy of segment lengths</title><p id="Par53">To evaluate the accuracy of our simulation algorithm, we calculate the percentiles of IBD segment length and common ancestor time distributions (conditional on the IBD segment being detectable). We estimate percentiles from replicates of 1 and 0.40 Morgans chromosomes in tskibd and ARGON simulations, respectively. (The scope of ARGON simulations is smaller in light of computational cost.) We condition on the IBD segment lengths overlapping the midpoint of the chromosome. Here, we consider the population bottleneck and staged exponential growth scenarios (Figure <xref rid="MOESM1" ref-type="media">S5</xref>).</p><p id="Par54">Figure <xref rid="MOESM1" ref-type="media">S7</xref> shows that the estimated percentiles of the segment length distributions. Except for 95th and 99th percentiles, the estimated percentiles are indistinguishable between our method, tskibd, and ARGON. The (detectable) IBD rates are similar between our method and tskibd, and the means of their simulated IBD rates are close to the approximate probability of detecting an IBD segment (Palamara et&#x000a0;al. <xref ref-type="bibr" rid="CR48">2012</xref>). Figure <xref rid="MOESM1" ref-type="media">S8</xref> shows that the estimated percentiles for the time of a detectable IBD segment&#x02019;s common ancestor are indistinguishable across methods.</p><p id="Par55">Although the ARGON segment length distributions are similar to our method and tskibd, the IBD rates from ARGON are slightly higher and more variable. This metric is not evaluated in Palamara (<xref ref-type="bibr" rid="CR47">2016</xref>), and the method description of IBD segments is limited. All these methods make some approximations to reduce computing time, so there is no &#x0201c;ground truth&#x0201d; number of detectable IBD segments or segment lengths in our experiments. By and large, we find that the different methods offer qualitatively similar length distributions for IBD segments around a locus.</p></sec><sec id="Sec18"><title>The effect of chromosome ends on length distributions</title><p id="Par56">Next, we compare the IBD segment length distributions across the entire genome versus around focal points some distance from a chromosome end. For different focal points, Figure <xref rid="MOESM1" ref-type="media">S9</xref> gives the estimated percentiles of the tskibd segment length and time of common ancestor distributions. The segment length percentiles greater than the 80th are affected by truncating at the chromosome ends. So long as the focal point is more than <italic>w</italic> Morgans away from the chromosome ends, the percentiles of segment lengths less than the 80th and all conditional times of common ancestors are unaffected by finitely-sized chromosomes. We can modify Algorithm&#x000a0;1 to accommodate chromosome ends by setting the initial recombination endpoints to finite values. Figure <xref rid="MOESM1" ref-type="media">S10</xref> shows that our algorithm with this finite chromosome change simulates length distributions similar to tskibd. Compared to IBD segment lengths around a focal point, IBD segment lengths along the entire genome are typically smaller, and thus, the segments&#x02019; times of common ancestors larger (Figure <xref rid="MOESM1" ref-type="media">S9</xref>).</p></sec></sec></sec><sec id="Sec19"><title>Discussion</title><p id="Par57">To efficiently simulate IBD segment lengths overlapping a focal location, we exploit the fact that small values occur with high probability in Gamma random variables. Fast simulation in population genetics is important for statistical methods like approximate Bayesian computation (Beaumont et&#x000a0;al. <xref ref-type="bibr" rid="CR12">2002</xref>), importance sampling (Browning <xref ref-type="bibr" rid="CR10">2000</xref>; Stern et al. <xref ref-type="bibr" rid="CR52">2019</xref>), and neural network learning (Korfmann et al. <xref ref-type="bibr" rid="CR38">2023</xref>). Our method was developed with the evaluation of statistical consistency (Casella and Berger <xref ref-type="bibr" rid="CR13">2002</xref>), parametric bootstrapping (Efron <xref ref-type="bibr" rid="CR19">1987</xref>), and asymptotic distributions (Temple and Thompson <xref ref-type="bibr" rid="CR58">2024</xref>) in mind.</p><p id="Par58">Existing methods ARGON (Palamara <xref ref-type="bibr" rid="CR47">2016</xref>) and tskibd (Guo et&#x000a0;al. <xref ref-type="bibr" rid="CR23">2024</xref>) simulate IBD segment lengths for genomic region sizes less than 0.10 Morgans and thousands of samples within hours to days. These runtime performances are insufficient for the aforementioned methods and analyses, in particular parametric bootstrapping (Temple et&#x000a0;al. <xref ref-type="bibr" rid="CR59">2024</xref>; Efron <xref ref-type="bibr" rid="CR19">1987</xref>). We benchmark that our average runtime scales approximately linear as the number of haplotype pairs scales quadratically in sample size, taking as little as a couple of seconds or tens of seconds for sample sizes of order <inline-formula id="IEq206"><alternatives><tex-math id="d33e6292">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^4$$\end{document}</tex-math><mml:math id="d33e6297"><mml:msup><mml:mn>10</mml:mn><mml:mn>4</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq206.gif"/></alternatives></inline-formula> or <inline-formula id="IEq207"><alternatives><tex-math id="d33e6303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10^5$$\end{document}</tex-math><mml:math id="d33e6308"><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq207.gif"/></alternatives></inline-formula>, respectively. The pruning and merging techniques presented here for a single locus could motivate changes to ARGON and tskibd that improve the runtime of genome-wide IBD simulations.</p><p id="Par59">Related studies have already used our algorithm to these ends. Running our algorithm tens of millions of times with samples sizes <inline-formula id="IEq208"><alternatives><tex-math id="d33e6322">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\ge 5000$$\end{document}</tex-math><mml:math id="d33e6327"><mml:mrow><mml:mo>&#x02265;</mml:mo><mml:mn>5000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq208.gif"/></alternatives></inline-formula>, Temple and Thompson (<xref ref-type="bibr" rid="CR58">2024</xref>) show simulation results that are consistent with the conditions of their central limit theorems. Running our algorithm millions of times with a sample size of 5000 diploids, Temple et&#x000a0;al. (<xref ref-type="bibr" rid="CR59">2024</xref>) show that 95% parametric bootstrap intervals for a selection coefficient estimator contain the true parameter in 90% of simulations. They also show that exploring the effects of sample size and detection threshold on selection coefficient estimation is feasible on a laptop. Temple (<xref ref-type="bibr" rid="CR57">2024</xref>) assesses the tradeoffs between standard normal and percentile-based confidence intervals for the Temple et&#x000a0;al. (<xref ref-type="bibr" rid="CR59">2024</xref>) selection coefficient estimator. Temple and Browning (<xref ref-type="bibr" rid="CR54">2025</xref>) also show how to calculate the statistical power in an excess IBD rate scan as the magnitude of directional selection increases. These studies would otherwise have been computationally intractable using the existing methods ARGON and tskibd. Indeed, the scope of the Temple and Thompson (<xref ref-type="bibr" rid="CR58">2024</xref>) simulations amounts to hundreds of days of computing time even with our efficient algorithm.</p><p id="Par60">Simulating IBD segments around a single locus versus along the whole genome serves different research purposes. IBD segments along the entire genome are required to estimate effective population sizes (Browning and Browning <xref ref-type="bibr" rid="CR2">2015</xref>; Cai et al. <xref ref-type="bibr" rid="CR15">2023</xref>; Guo et&#x000a0;al. <xref ref-type="bibr" rid="CR23">2024</xref>; Huang et&#x000a0;al. <xref ref-type="bibr" rid="CR29">2025</xref>), recombination rates (Zhou et&#x000a0;al. <xref ref-type="bibr" rid="CR64">2020a</xref>), mutation rates (Tian et&#x000a0;al. <xref ref-type="bibr" rid="CR55">2019</xref>, <xref ref-type="bibr" rid="CR56">2022</xref>), and gene conversion rates (Browning and Browning <xref ref-type="bibr" rid="CR5">2025</xref>) or detect recent positive selection (Browning and Browning <xref ref-type="bibr" rid="CR3">2020</xref>; Temple and Browning <xref ref-type="bibr" rid="CR54">2025</xref>). Fast simulation of IBD segments around a focal point is useful in describing distributions (the time of the common ancestor given a detectable IBD segment (Temple <xref ref-type="bibr" rid="CR57">2024</xref>), the structure of IBD networks (Temple and Thompson <xref ref-type="bibr" rid="CR58">2024</xref>), and the IBD rate (Temple and Thompson <xref ref-type="bibr" rid="CR58">2024</xref>)) and inferring selective sweeps (Temple et&#x000a0;al. <xref ref-type="bibr" rid="CR59">2024</xref>). For example, Temple and Browning (<xref ref-type="bibr" rid="CR54">2025</xref>) leverage whole-genome IBD segments to estimate the family-wise error rate of a selection scan and local IBD segments to estimate the power to detect selection given different population genetics parameters. Our method is so far implemented to analyze hard sweeps (evaluating null model assumptions (Temple and Thompson <xref ref-type="bibr" rid="CR58">2024</xref>), calculating power to reject the null hypothesis (Temple and Browning <xref ref-type="bibr" rid="CR54">2025</xref>), and estimating selection coefficient confidence intervals (Temple et&#x000a0;al. <xref ref-type="bibr" rid="CR59">2024</xref>)), including scenarios of the hardening of a sweep from standing variation (Temple et&#x000a0;al. <xref ref-type="bibr" rid="CR59">2024</xref>) and time-varying selection coefficients (Temple <xref ref-type="bibr" rid="CR57">2024</xref>). Implementing soft selective sweeps with a few mutations (Hermisson and Pennings <xref ref-type="bibr" rid="CR33">2017</xref>) or simple models of recent migration (Nath and Griffiths <xref ref-type="bibr" rid="CR44">1993</xref>) is feasible but out of the scope of our research. Implementing complex models of population structure or admixture would be more difficult to program, and such models are also out of the scope of local simulation&#x02019;s use cases.</p><p id="Par61">Given our method&#x02019;s computational feasibility to characterize the distribution of IBD cluster sizes, the algorithm may assist in developing IBD clustering methods as well. For instance, simulating the distribution of IBD cluster sizes could help benchmark multi-way IBD segment detection (Browning and Browning <xref ref-type="bibr" rid="CR4">2024</xref>). Temple et&#x000a0;al. (<xref ref-type="bibr" rid="CR59">2024</xref>) developed their method to find abnormally large IBD clusters by experimenting with our simulations. A previously published method to simulate IBD cluster sizes comparable to those observed in human data is based solely on heuristics (Shemirani et al. <xref ref-type="bibr" rid="CR50">2023</xref>). In contrast, our method is an exact simulation of the IBD process. Studying IBD clusters, which are qualitatively different from Erdos-Renyi networks (Temple and Thompson <xref ref-type="bibr" rid="CR58">2024</xref>), could be fruitful in IBD network analyses (Shemirani et al. <xref ref-type="bibr" rid="CR50">2023</xref>) or IBD-based association mapping (Cai and Browning <xref ref-type="bibr" rid="CR14">2025</xref>).</p></sec><sec id="Sec23" sec-type="supplementary-material"><title>Supplementary Information</title><p>Below is the link to the electronic supplementary material.<supplementary-material content-type="local-data" id="MOESM1"><media xlink:href="11538_2025_1464_MOESM1_ESM.pdf"><caption><p>Supplementary file 1 (pdf 1089 KB)</p></caption></media></supplementary-material></p></sec></body><back><app-group><app id="App1"><sec id="Sec20"><title>The number of identity-by-descent comparisons</title><sec id="Sec21"><title>Computations near the root of the coalescent tree</title><sec id="FPar8"><title>Lemma 2</title><p id="Par71">Recall that <inline-formula id="IEq209"><alternatives><tex-math id="d33e6499">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_j \sim \text {Binomial}(B_{j-1},1/2)$$\end{document}</tex-math><mml:math id="d33e6504"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&#x0223c;</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq163.gif"/></alternatives></inline-formula> for <inline-formula id="IEq210"><alternatives><tex-math id="d33e6529">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j \ge 1$$\end{document}</tex-math><mml:math id="d33e6534"><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x02265;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq164.gif"/></alternatives></inline-formula> and <inline-formula id="IEq211"><alternatives><tex-math id="d33e6541">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$B_0=n$$\end{document}</tex-math><mml:math id="d33e6546"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq165.gif"/></alternatives></inline-formula>. Then,<disp-formula id="Equ16"><label>A1</label><alternatives><tex-math id="d33e6555">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {Cov}(B_j (B_{j-1} - B_j)) \sim n^3. \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6561" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x0223c;</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="FPar9"><title>Proof</title><p id="Par72">We apply the laws of total covariance and expectation in a recursive fashion. Overall, we must control three terms:<disp-formula id="Equ17"><label>A2</label><alternatives><tex-math id="d33e6601">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} \text {Cov}(B_{j} (B_{j-1} - B_j))&#x00026;= \text {Cov}(B_j^2,B_j^2) \\&#x00026;\quad + \text {Cov}(B_{j} B_{j-1}, B_{j} B_{j-1}) \\&#x00026;\quad - 2 \cdot \text {Cov}(B_{j} B_{j-1}, B_j^2). \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6607" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula>The first four moments of the conditional binomial random variable are useful:<disp-formula id="Equ18"><label>A3</label><alternatives><tex-math id="d33e6720">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} {\mathbb {E}}[ B_j | B_{j-1}]&#x00026;= 0.5 \cdot B_{j-1}; \\ {\mathbb {E}}[B_j^2 | B_{j-1}]&#x00026;= 0.5^2 ( B_{j-1} + B_{j-1}^2 ); \\ {\mathbb {E}}[ B_j^3 | B_{j-1}]&#x00026;= 1 \cdot 0.5 \cdot B_{j-1} \\&#x00026;\quad + 3 \cdot 0.5^2 \cdot B_{j-1} (B_{j-1}-1) \\&#x00026;\quad + 1 \cdot 0.5^3 \cdot B_{j-1} (B_{j-1} - 1) (B_{j-1} - 2); \\ {\mathbb {E}}[ B_j^4 | B_{j-1}]&#x00026;= 1 \cdot 0.5 \cdot B_{j-1} \\&#x00026;\quad + 7 \cdot 0.5^2 \cdot B_{j-1} (B_{j-1}-1) \\&#x00026;\quad + 6 \cdot 0.5^3 \cdot B_{j-1} (B_{j-1} - 1) (B_{j-1} - 2) \\&#x00026;\quad + 1 \cdot 0.5^4 \cdot B_{j-1} (B_{j-1} - 1) (B_{j-1} - 2)(B_{j-1}-3). \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e6726" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x0037e;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x0037e;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0.5</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>&#x0037e;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>4</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0.5</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mn>7</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mn>6</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mspace width="1em"/><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>The following conditional covariances are also useful.<disp-formula id="Equ19"><label>A4</label><alternatives><tex-math id="d33e7113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {Cov}(B_j,B_j | B_{j-1})= &#x00026;  0.5^2 \cdot B_{j-1}^1 = O( B_{j-1}^1). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e7119" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ20"><label>A5</label><alternatives><tex-math id="d33e7177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {Cov}(B_j,B_j^2 | B_{j-1})= &#x00026;  {\mathbb {E}}[B_j^3 | B_{j-1}] - {\mathbb {E}}[B_j | B_{j-1}] \cdot {\mathbb {E}}[ B_j^2 | B_{j-1}] \nonumber \\ &#x00026;  = 1 \cdot 0.5 \cdot B_{j-1} \nonumber \\ &#x00026;  + 3 \cdot 0.5^2 \cdot B_{j-1} (B_{j-1}-1) \nonumber \\ &#x00026;  + 1 \cdot 0.5^3 \cdot B_{j-1} (B_{j-1} - 1) (B_{j-1}-2) \nonumber \\ &#x00026;  - 0.5^3 \cdot B_{j-1} (B_{j-1} + B_{j-1}^2) \nonumber \\ &#x00026;  = 0.5^2 \cdot B_{j-1}^2 \nonumber \\ &#x00026;  = O( B_{j-1}^2). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e7183" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0.5</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ21"><label>A6</label><alternatives><tex-math id="d33e7442">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {Cov}(B_j^2,B_j^2 | B_{j-1})= &#x00026;  {\mathbb {E}}[B_j^4 | B_{j-1}] - {\mathbb {E}}[B_j^2 | B_{j-1}] \cdot {\mathbb {E}}[ B_j^2 | B_{j-1}] \nonumber \\ &#x00026;  = 1 \cdot 0.5 \cdot B_{j-1} \nonumber \\ &#x00026;  + 7 \cdot 0.5^2 \cdot B_{j-1} (B_{j-1}-1) \nonumber \\ &#x00026;  + 6 \cdot 0.5^3 \cdot B_{j-1} (B_{j-1} - 1) (B_{j-1} - 2) \nonumber \\ &#x00026;  + 1 \cdot 0.5^4 \cdot B_{j-1} (B_{j-1} - 1) (B_{j-1} - 2)(B_{j-1}-3) \nonumber \\ &#x00026;  - 0.5^4 (B_{j-1}^2 + 2 \cdot B_{j-1}^3 + B_{j-1}^4) \nonumber \\ &#x00026;  = - 0.5^3 \cdot B_{j-1} - 0.5^3 \cdot B_{j-1}^2 + 0.5 \cdot B_{j-1}^3 \nonumber \\ &#x00026;  = O( B_{j-1}^3). \end{aligned}$$\end{document}</tex-math><mml:math id="d33e7448" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>4</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>-</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x000b7;</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0.5</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>7</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>6</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>4</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo>&#x000b7;</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>Notice that all of the conditional covariances are of an order of three or less. By recursively applying the law of total expectation, we derive <inline-formula id="IEq212"><alternatives><tex-math id="d33e7798">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb {E}}[B_j^3] \sim n^3$$\end{document}</tex-math><mml:math id="d33e7803"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>&#x0223c;</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq212.gif"/></alternatives></inline-formula>. Another important unconditional covariance term is<disp-formula id="Equ22"><label>A7</label><alternatives><tex-math id="d33e7823">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \begin{aligned} \text {Cov}(B_j, B_j^2)&#x00026;= {\mathbb {E}}[\text {Cov}(B_j, B_j^2 | B_{j-1})] + \text {Cov}({\mathbb {E}}[B_j | B_{j-1}], {\mathbb {E}}[B_j^2 | B_{j-1}]) \\&#x00026;= {\mathbb {E}}[ O(B_{j-1}^2)] + \text {Cov}( O(B_{j-1}), O(B_{j-1}^2) ), \\ \end{aligned} \end{aligned}$$\end{document}</tex-math><mml:math id="d33e7829" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula>which is asymptotically equivalent to <inline-formula id="IEq213"><alternatives><tex-math id="d33e7994">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^2$$\end{document}</tex-math><mml:math id="d33e7999"><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq169.gif"/></alternatives></inline-formula> when the total laws of expectation and covariance are applied recursively. Finally, we evaluate the asymptotic behavior of the three unconditional covariances in Equation <xref rid="Equ17" ref-type="disp-formula">A2</xref>.<disp-formula id="Equ23"><label>A8</label><alternatives><tex-math id="d33e8008">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {Cov}(B_j^2,B_j^2)= &#x00026;  {\mathbb {E}}[ \text {Cov}( B_j^2, B_j^2 | B_{j-1}) ] + \text {Cov}( {\mathbb {E}}[ B_j^2 | B_{j-1}], {\mathbb {E}}[B_j^2 | B_{j-1}]) \nonumber \\= &#x00026;  {\mathbb {E}}[ O(B_{j-1}^3)] + 0.5^4 \cdot \text {Cov}( B_{j-1} + B_{j-1}^2, B_{j-1} + B_{j-1}^2) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e8014" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>4</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ24"><label>A9</label><alternatives><tex-math id="d33e8183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {Cov}(B_{j-1} B_j,B_{j-1} B_j)= &#x00026;  {\mathbb {E}}[ B_{j-1}^2 \text {Cov}( B_j, B_j | B_{j-1})] \nonumber \\ &#x00026;  + \text {Cov}( B_{j-1} \cdot {\mathbb {E}}[ B_j | B_{j-1}], B_{j-1} \cdot {\mathbb {E}}[ B_j | B_{j-1}]) \nonumber \\ &#x00026;  = 0.5^2 \cdot ( {\mathbb {E}}[ B_{j-1}^3 ] + \text {Cov}( B_{j-1}^2, B_{j-1}^2) ) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e8189" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ25"><label>A10</label><alternatives><tex-math id="d33e8373">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \text {Cov}(B_{j-1} B_j, B_j^2)= &#x00026;  {\mathbb {E}}[ B_{j-1} \cdot \text {Cov}( B_j, B_j^2 | B_{j-1}) ] \nonumber \\ &#x00026;  + \text {Cov}( B_{j-1} \cdot {\mathbb {E}}[B_j | B_{j-1}], {\mathbb {E}}[B_j^2 | B_{j-1}]) \nonumber \\ &#x00026;  = {\mathbb {E}}[O(B_{j-1}^3)] + 0.5^3 \cdot \text {Cov}(B_{j-1}^2, B_{j-1} + B_{j-1}^2) \end{aligned}$$\end{document}</tex-math><mml:math id="d33e8379" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mtext>Cov</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x000b7;</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:msup><mml:mn>5</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>&#x000b7;</mml:mo><mml:mtext>Cov</mml:mtext><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="11538_2025_1464_Article_Equ25.gif" position="anchor"/></alternatives></disp-formula>By recursively applying the total laws of expectation and covariance, we conclude that Equations <xref rid="Equ23" ref-type="disp-formula">A8</xref>, <xref rid="Equ24" ref-type="disp-formula">A9</xref>, and <xref rid="Equ25" ref-type="disp-formula">A10</xref> are asymptotically equivalent to <inline-formula id="IEq214"><alternatives><tex-math id="d33e8571">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n^3$$\end{document}</tex-math><mml:math id="d33e8576"><mml:msup><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq214.gif"/></alternatives></inline-formula>. <inline-formula id="IEq215"><alternatives><tex-math id="d33e8582">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\square $$\end{document}</tex-math><mml:math id="d33e8587"><mml:mo>&#x025a1;</mml:mo></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq149.gif"/></alternatives></inline-formula></p></sec></sec><sec id="Sec22"><title>Computations near the leaves of the coalescent tree</title><p id="Par73">A complementary perspective on joint subtree sizes we take from Dahmer and Kersting (<xref ref-type="bibr" rid="CR18">2015</xref>). Now, we work upward from the leaves to the root. Dahmer and Kersting (<xref ref-type="bibr" rid="CR18">2015</xref>) provide a lemma for the expected number of subtrees containing <italic>r</italic> sample haplotypes at the <inline-formula id="IEq216"><alternatives><tex-math id="d33e8603">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$(n-k)^{\text {th}}$$\end{document}</tex-math><mml:math id="d33e8608"><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mtext>th</mml:mtext></mml:msup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq141.gif"/></alternatives></inline-formula> coalescent event. We can use their moment calculations together with the expected value of the hypoexponential random variable <inline-formula id="IEq217"><alternatives><tex-math id="d33e8621">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T_{n:k}^+$$\end{document}</tex-math><mml:math id="d33e8626"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq217.gif"/></alternatives></inline-formula> to build intuition for the average subtree sizes at a specified generation. In a toy example, Figure <xref rid="MOESM1" ref-type="media">S11</xref> shows the average number of sample haplotypes under subtrees of a given size at generations <inline-formula id="IEq218"><alternatives><tex-math id="d33e8640">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \cdot {\mathbb {E}}[T_{n:k}^+]$$\end{document}</tex-math><mml:math id="d33e8645"><mml:mrow><mml:mi>N</mml:mi><mml:mo>&#x000b7;</mml:mo><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>+</mml:mo></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="11538_2025_1464_Article_IEq218.gif"/></alternatives></inline-formula>. Our main observation is that before the final coalescent events, which occur at expected times proportional to population size <italic>N</italic>, most sample haplotypes are expected to be under a subtree of size an order of magnitude smaller than the sample size.</p></sec></sec></app></app-group><fn-group><fn><p><bold>Publisher's Note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><notes notes-type="author-contribution"><title>Author Contributions</title><p>S.D.T. proposed the study, planned the study, wrote the software, conducted the analysis, and wrote the manuscript. S.D.T. and S.R.B. developed the algorithm. S.D.T. and E.A.T. derived the theoretical results. All authors contributed to editing the manuscript.</p></notes><notes notes-type="funding-information"><title>Funding</title><p>S.D.T. acknowledges funding support from the US Department of Defense National Defense Science and Engineering Graduate Fellowship, the US National Institutes of Health T32 GM081062 Predoctoral Training Grant in Statistical Genetics, and The Eric and Wendy Schmidt AI in Science Postdoctoral Fellowship by Schmidt Sciences, LLC.</p><p>This research was supported in part by the US National Human Genome Research Institute of the National Institutes of Health under award number HG005701.</p></notes><notes notes-type="data-availability"><title>Data Availability</title><p>Not applicable</p></notes><notes notes-type="data-availability"><title>Code Availability</title><p>The algorithm is in a Python package (<ext-link ext-link-type="uri" xlink:href="https://github.com/sdtemple/isweep">https://github.com/sdtemple/isweep</ext-link>), which is available under the CC0 1.0 Universal License.</p></notes><notes notes-type="data-availability"><title>Materials Availability</title><p>Not applicable.</p></notes><notes><title>Declarations</title><notes id="FPar5" notes-type="COI-statement"><title>Competing interests</title><p id="Par68">The authors declare no competing interests.</p></notes><notes id="FPar6"><title>Ethics approval and consent to participate</title><p id="Par69">Not applicable</p></notes><notes id="FPar7"><title>Consent for publication</title><p id="Par70">Not applicable</p></notes></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><mixed-citation publication-type="other">Adrion JR, Cole CB, Dukler N, Galloway JG, Gladstein AL, Gower G, Kyriazis CC, Ragsdale AP, Tsambos G, Baumdicker F, Carlson J, Cartwright RA, Durvasula A, Gronau I, Kim BY, McKenzie P, Messer PW, Noskova E, Ortega-Del&#x000a0;Vecchyo D, Racimo F, Struck TJ, Gravel S, Gutenkunst RN, Lohmueller KE, Ralph PL, Schrider DR, Siepel A, Kelleher J, Kern AD (2020) A community-maintained standard library of population genetic models. Elife <bold>9</bold></mixed-citation></ref><ref id="CR2"><citation-alternatives><element-citation id="ec-CR2" publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname><given-names>SR</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name></person-group><article-title>Accurate non-parametric estimation of recent effective population size from segments of identity by descent</article-title><source>Am. J. Hum. Genet.</source><year>2015</year><volume>97</volume><issue>3</issue><fpage>404</fpage><lpage>418</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2015.07.012</pub-id><pub-id pub-id-type="pmid">26299365</pub-id>
</element-citation><mixed-citation id="mc-CR2" publication-type="journal">Browning SR, Browning BL (2015) Accurate non-parametric estimation of recent effective population size from segments of identity by descent. Am. J. Hum. Genet. 97(3):404&#x02013;418<pub-id pub-id-type="pmid">26299365</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR3"><citation-alternatives><element-citation id="ec-CR3" publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname><given-names>SR</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name></person-group><article-title>Probabilistic estimation of identity by descent segment endpoints and detection of recent selection</article-title><source>Am. J. Hum. Genet.</source><year>2020</year><volume>107</volume><issue>5</issue><fpage>895</fpage><lpage>910</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2020.09.010</pub-id><pub-id pub-id-type="pmid">33053335</pub-id>
</element-citation><mixed-citation id="mc-CR3" publication-type="journal">Browning SR, Browning BL (2020) Probabilistic estimation of identity by descent segment endpoints and detection of recent selection. Am. J. Hum. Genet. 107(5):895&#x02013;910<pub-id pub-id-type="pmid">33053335</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR4"><citation-alternatives><element-citation id="ec-CR4" publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname><given-names>SR</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name></person-group><article-title>Biobank-scale inference of multi-individual identity by descent and gene conversion</article-title><source>Am. J. Hum. Genet.</source><year>2024</year><volume>111</volume><issue>4</issue><fpage>691</fpage><lpage>700</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2024.02.015</pub-id><pub-id pub-id-type="pmid">38513668</pub-id>
</element-citation><mixed-citation id="mc-CR4" publication-type="journal">Browning SR, Browning BL (2024) Biobank-scale inference of multi-individual identity by descent and gene conversion. Am. J. Hum. Genet. 111(4):691&#x02013;700<pub-id pub-id-type="pmid">38513668</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR5"><mixed-citation publication-type="other">Browning SR, Browning BL (2025) Estimating gene conversion rates from population data using multi-individual identity by descent. bioRxiv 10.1101/2025.02.22.639693</mixed-citation></ref><ref id="CR6"><mixed-citation publication-type="other">Browning SR, Browning BL, Daviglus ML, Durazo-Arvizu RA, Schneiderman N, Kaplan RC, Laurie CC (2018) Ancestry-specific recent effective population size in the Americas. PLoS Genet. <bold>14</bold>(5)</mixed-citation></ref><ref id="CR7"><mixed-citation publication-type="other">Baumdicker F, Bisschop G, Goldstein D, Gower G, Ragsdale AP, Tsambos G, Zhu S, Eldon B, Castedo&#x000a0;Ellerman E, Galloway JG, Gladstein AL, Gorjanc G, Guo B, Jeffery B, Kretzschmar WW, Lohse K, Matschiner M, Nelson D, Pope NS, Quinto-Cort&#x000e9;s CD, Rodrigues MF, Saunack K, Sellinger T, Thornton KR, Kemenade H, Wohns A, Wong HY, Gravel S, Kern A, Koskela J, Ralph PL, Kelleher J (2021) Efficient ancestry and mutation simulation with msprime 1.0. Genetics <bold>220</bold>(3)</mixed-citation></ref><ref id="CR8"><citation-alternatives><element-citation id="ec-CR8" publication-type="journal"><person-group person-group-type="author"><name><surname>Bhaskar</surname><given-names>A</given-names></name><name><surname>Clark</surname><given-names>AG</given-names></name><name><surname>Song</surname><given-names>YS</given-names></name></person-group><article-title>Distortion of genealogical properties when the sample is very large</article-title><source>Proc. Natl. Acad. Sci. U. S. A.</source><year>2014</year><volume>111</volume><issue>6</issue><fpage>2385</fpage><lpage>2390</lpage><pub-id pub-id-type="doi">10.1073/pnas.1322709111</pub-id><pub-id pub-id-type="pmid">24469801</pub-id>
</element-citation><mixed-citation id="mc-CR8" publication-type="journal">Bhaskar A, Clark AG, Song YS (2014) Distortion of genealogical properties when the sample is very large. Proc. Natl. Acad. Sci. U. S. A. 111(6):2385&#x02013;2390<pub-id pub-id-type="pmid">24469801</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR9"><citation-alternatives><element-citation id="ec-CR9" publication-type="journal"><person-group person-group-type="author"><name><surname>Bycroft</surname><given-names>C</given-names></name><name><surname>Freeman</surname><given-names>C</given-names></name><name><surname>Petkova</surname><given-names>D</given-names></name><name><surname>Band</surname><given-names>G</given-names></name><name><surname>Elliott</surname><given-names>LT</given-names></name><name><surname>Sharp</surname><given-names>K</given-names></name><name><surname>Motyer</surname><given-names>A</given-names></name><name><surname>Vukcevic</surname><given-names>D</given-names></name><name><surname>Delaneau</surname><given-names>O</given-names></name><name><surname>O&#x02019;Connell</surname><given-names>J</given-names></name><etal/></person-group><article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title><source>Nature</source><year>2018</year><volume>562</volume><issue>7726</issue><fpage>203</fpage><lpage>209</lpage><pub-id pub-id-type="doi">10.1038/s41586-018-0579-z</pub-id><pub-id pub-id-type="pmid">30305743</pub-id>
</element-citation><mixed-citation id="mc-CR9" publication-type="journal">Bycroft C, Freeman C, Petkova D, Band G, Elliott LT, Sharp K, Motyer A, Vukcevic D, Delaneau O, O&#x02019;Connell J et al (2018) The UK Biobank resource with deep phenotyping and genomic data. Nature 562(7726):203&#x02013;209<pub-id pub-id-type="pmid">30305743</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR10"><citation-alternatives><element-citation id="ec-CR10" publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname><given-names>S</given-names></name></person-group><article-title>A Monte Carlo approach to calculating probabilities for continuous identity by descent data</article-title><source>J. Appl. Probab.</source><year>2000</year><volume>37</volume><issue>3</issue><fpage>850</fpage><lpage>864</lpage><pub-id pub-id-type="doi">10.1239/jap/1014842841</pub-id></element-citation><mixed-citation id="mc-CR10" publication-type="journal">Browning S (2000) A Monte Carlo approach to calculating probabilities for continuous identity by descent data. J. Appl. Probab. 37(3):850&#x02013;864</mixed-citation></citation-alternatives></ref><ref id="CR11"><citation-alternatives><element-citation id="ec-CR11" publication-type="journal"><person-group person-group-type="author"><name><surname>Browning</surname><given-names>SR</given-names></name><name><surname>Thompson</surname><given-names>EA</given-names></name></person-group><article-title>Detecting rare variant associations by identity-by-descent mapping in case-control studies</article-title><source>Genetics</source><year>2012</year><volume>190</volume><issue>4</issue><fpage>1521</fpage><lpage>1531</lpage><pub-id pub-id-type="doi">10.1534/genetics.111.136937</pub-id><pub-id pub-id-type="pmid">22267498</pub-id>
</element-citation><mixed-citation id="mc-CR11" publication-type="journal">Browning SR, Thompson EA (2012) Detecting rare variant associations by identity-by-descent mapping in case-control studies. Genetics 190(4):1521&#x02013;1531<pub-id pub-id-type="pmid">22267498</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR12"><citation-alternatives><element-citation id="ec-CR12" publication-type="journal"><person-group person-group-type="author"><name><surname>Beaumont</surname><given-names>MA</given-names></name><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Balding</surname><given-names>DJ</given-names></name></person-group><article-title>Approximate Bayesian computation in population genetics</article-title><source>Genetics</source><year>2002</year><volume>162</volume><issue>4</issue><fpage>2025</fpage><lpage>2035</lpage><pub-id pub-id-type="doi">10.1093/genetics/162.4.2025</pub-id><pub-id pub-id-type="pmid">12524368</pub-id>
</element-citation><mixed-citation id="mc-CR12" publication-type="journal">Beaumont MA, Zhang W, Balding DJ (2002) Approximate Bayesian computation in population genetics. Genetics 162(4):2025&#x02013;2035<pub-id pub-id-type="pmid">12524368</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR13"><citation-alternatives><element-citation id="ec-CR13" publication-type="book"><person-group person-group-type="author"><name><surname>Casella</surname><given-names>G</given-names></name><name><surname>Berger</surname><given-names>RL</given-names></name></person-group><source>Statistical Inference</source><year>2002</year><edition>2</edition><publisher-loc>Thomson Learning</publisher-loc><publisher-name>Australia; Pacific Grove, CA</publisher-name></element-citation><mixed-citation id="mc-CR13" publication-type="book">Casella G, Berger RL (2002) Statistical Inference, 2nd edn. Australia; Pacific Grove, CA, Thomson Learning</mixed-citation></citation-alternatives></ref><ref id="CR14"><mixed-citation publication-type="other">Cai R, Browning S (2025) Identity-by-descent mapping using multi-individual IBD with genome-wide multiple testing adjustment. bioRxiv 10.1101/2025.01.28.635369</mixed-citation></ref><ref id="CR15"><mixed-citation publication-type="other">Cai R, Browning BL, Browning SR (2023) Identity-by-descent-based estimation of the X chromosome effective population size with application to sex-specific demographic history. G3 (Bethesda) <bold>13</bold>(10)</mixed-citation></ref><ref id="CR16"><citation-alternatives><element-citation id="ec-CR16" publication-type="book"><person-group person-group-type="author"><name><surname>Crow</surname><given-names>JF</given-names></name><name><surname>Kimura</surname><given-names>M</given-names></name></person-group><source>An Introduction to Population Genetics Theory</source><year>1970</year><publisher-loc>New York, NY</publisher-loc><publisher-name>Harper &#x00026; Row</publisher-name></element-citation><mixed-citation id="mc-CR16" publication-type="book">Crow JF, Kimura M (1970) An Introduction to Population Genetics Theory. Harper &#x00026; Row, New York, NY</mixed-citation></citation-alternatives></ref><ref id="CR17"><mixed-citation publication-type="other">Chen H, Naseri A, Zhi D (2023) FiMAP: A fast identity-by-descent mapping test for biobank-scale cohorts. PLoS Genet. <bold>19</bold>(12)</mixed-citation></ref><ref id="CR18"><citation-alternatives><element-citation id="ec-CR18" publication-type="journal"><person-group person-group-type="author"><name><surname>Dahmer</surname><given-names>I</given-names></name><name><surname>Kersting</surname><given-names>G</given-names></name></person-group><article-title>The internal branch lengths of the Kingman coalescent</article-title><source>Ann. Appl. Probab.</source><year>2015</year><volume>25</volume><issue>3</issue><fpage>1325</fpage><lpage>1348</lpage><pub-id pub-id-type="doi">10.1214/14-AAP1024</pub-id></element-citation><mixed-citation id="mc-CR18" publication-type="journal">Dahmer I, Kersting G (2015) The internal branch lengths of the Kingman coalescent. Ann. Appl. Probab. 25(3):1325&#x02013;1348</mixed-citation></citation-alternatives></ref><ref id="CR19"><citation-alternatives><element-citation id="ec-CR19" publication-type="journal"><person-group person-group-type="author"><name><surname>Efron</surname><given-names>B</given-names></name></person-group><article-title>Better bootstrap confidence intervals</article-title><source>J. Am. Stat. Assoc.</source><year>1987</year><volume>82</volume><issue>397</issue><fpage>171</fpage><lpage>185</lpage><pub-id pub-id-type="doi">10.1080/01621459.1987.10478410</pub-id></element-citation><mixed-citation id="mc-CR19" publication-type="journal">Efron B (1987) Better bootstrap confidence intervals. J. Am. Stat. Assoc. 82(397):171&#x02013;185</mixed-citation></citation-alternatives></ref><ref id="CR20"><citation-alternatives><element-citation id="ec-CR20" publication-type="journal"><person-group person-group-type="author"><name><surname>Ewing</surname><given-names>G</given-names></name><name><surname>Hermisson</surname><given-names>J</given-names></name></person-group><article-title>MSMS: a coalescent simulation program including recombination, demographic structure and selection at a single locus</article-title><source>Bioinformatics</source><year>2010</year><volume>26</volume><issue>16</issue><fpage>2064</fpage><lpage>2065</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btq322</pub-id><pub-id pub-id-type="pmid">20591904</pub-id>
</element-citation><mixed-citation id="mc-CR20" publication-type="journal">Ewing G, Hermisson J (2010) MSMS: a coalescent simulation program including recombination, demographic structure and selection at a single locus. Bioinformatics 26(16):2064&#x02013;2065<pub-id pub-id-type="pmid">20591904</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR21"><citation-alternatives><element-citation id="ec-CR21" publication-type="journal"><person-group person-group-type="author"><name><surname>Fisher</surname><given-names>RA</given-names></name></person-group><article-title>XXI.-on the dominance ratio</article-title><source>Proc. R. Soc. Edinb.</source><year>1923</year><volume>42</volume><fpage>321</fpage><lpage>341</lpage><pub-id pub-id-type="doi">10.1017/S0370164600023993</pub-id></element-citation><mixed-citation id="mc-CR21" publication-type="journal">Fisher RA (1923) XXI.-on the dominance ratio. Proc. R. Soc. Edinb. 42:321&#x02013;341</mixed-citation></citation-alternatives></ref><ref id="CR22"><mixed-citation publication-type="other">Freyman WA, McManus KF, Shringarpure SS, Jewett EM, Bryc K, 23 and Me Research Team Auton A (2021) Fast and robust identity-by-descent inference with the templated positional Burrows-Wheeler transform. Mol. Biol. Evol. <bold>38</bold>(5), 2131&#x02013;2151</mixed-citation></ref><ref id="CR23"><citation-alternatives><element-citation id="ec-CR23" publication-type="journal"><person-group person-group-type="author"><name><surname>Guo</surname><given-names>B</given-names></name><name><surname>Borda</surname><given-names>V</given-names></name><name><surname>Laboulaye</surname><given-names>R</given-names></name><name><surname>Spring</surname><given-names>MD</given-names></name><name><surname>Wojnarski</surname><given-names>M</given-names></name><name><surname>Vesely</surname><given-names>BA</given-names></name><name><surname>Silva</surname><given-names>JC</given-names></name><name><surname>Waters</surname><given-names>NC</given-names></name><name><surname>O&#x02019;Connor</surname><given-names>TD</given-names></name><name><surname>Takala-Harrison</surname><given-names>S</given-names></name></person-group><article-title>Strong positive selection biases identity-by-descent-based inferences of recent demography and population structure in plasmodium falciparum</article-title><source>Nat Commun</source><year>2024</year><volume>15</volume><issue>1</issue><fpage>2499</fpage><pub-id pub-id-type="doi">10.1038/s41467-024-46659-0</pub-id><pub-id pub-id-type="pmid">38509066</pub-id>
</element-citation><mixed-citation id="mc-CR23" publication-type="journal">Guo B, Borda V, Laboulaye R, Spring MD, Wojnarski M, Vesely BA, Silva JC, Waters NC, O&#x02019;Connor TD, Takala-Harrison S (2024) Strong positive selection biases identity-by-descent-based inferences of recent demography and population structure in plasmodium falciparum. Nat Commun 15(1):2499<pub-id pub-id-type="pmid">38509066</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR24"><citation-alternatives><element-citation id="ec-CR24" publication-type="journal"><person-group person-group-type="author"><name><surname>Haldane</surname><given-names>JBS</given-names></name></person-group><article-title>The combination of linkage values and the calculation of distances between the loci of linked factors</article-title><source>J. Genet.</source><year>1919</year><volume>8</volume><issue>29</issue><fpage>299</fpage><lpage>309</lpage></element-citation><mixed-citation id="mc-CR24" publication-type="journal">Haldane JBS (1919) The combination of linkage values and the calculation of distances between the loci of linked factors. J. Genet. 8(29):299&#x02013;309</mixed-citation></citation-alternatives></ref><ref id="CR25"><citation-alternatives><element-citation id="ec-CR25" publication-type="journal"><person-group person-group-type="author"><name><surname>Haldane</surname><given-names>JBS</given-names></name></person-group><article-title>A mathematical theory of natural and artificial selection. Part I</article-title><source>Math. Proc. Cambridge Philos. Soc.</source><year>1924</year><volume>23</volume><fpage>19</fpage><lpage>41</lpage></element-citation><mixed-citation id="mc-CR25" publication-type="journal">Haldane JBS (1924) A mathematical theory of natural and artificial selection. Part I. Math. Proc. Cambridge Philos. Soc. 23:19&#x02013;41</mixed-citation></citation-alternatives></ref><ref id="CR26"><citation-alternatives><element-citation id="ec-CR26" publication-type="book"><person-group person-group-type="author"><name><surname>Haldane</surname><given-names>JBS</given-names></name></person-group><source>The Causes of Evolution</source><year>1932</year><publisher-loc>New York, NY</publisher-loc><publisher-name>Harper &#x00026; Row</publisher-name></element-citation><mixed-citation id="mc-CR26" publication-type="book">Haldane JBS (1932) The Causes of Evolution. Harper &#x00026; Row, New York, NY</mixed-citation></citation-alternatives></ref><ref id="CR27"><citation-alternatives><element-citation id="ec-CR27" publication-type="journal"><person-group person-group-type="author"><name><surname>Harding</surname><given-names>EF</given-names></name></person-group><article-title>The probabilities of rooted tree-shapes generated by random bifurcation</article-title><source>Adv. Appl. Probab.</source><year>1971</year><volume>3</volume><issue>1</issue><fpage>44</fpage><lpage>77</lpage><pub-id pub-id-type="doi">10.2307/1426329</pub-id></element-citation><mixed-citation id="mc-CR27" publication-type="journal">Harding EF (1971) The probabilities of rooted tree-shapes generated by random bifurcation. Adv. Appl. Probab. 3(1):44&#x02013;77</mixed-citation></citation-alternatives></ref><ref id="CR28"><citation-alternatives><element-citation id="ec-CR28" publication-type="journal"><person-group person-group-type="author"><name><surname>Hoban</surname><given-names>S</given-names></name><name><surname>Bertorelle</surname><given-names>G</given-names></name><name><surname>Gaggiotti</surname><given-names>OE</given-names></name></person-group><article-title>Computer simulations: tools for population and evolutionary genetics</article-title><source>Nat. Rev. Genet.</source><year>2012</year><volume>13</volume><issue>2</issue><fpage>110</fpage><lpage>122</lpage><pub-id pub-id-type="doi">10.1038/nrg3130</pub-id><pub-id pub-id-type="pmid">22230817</pub-id>
</element-citation><mixed-citation id="mc-CR28" publication-type="journal">Hoban S, Bertorelle G, Gaggiotti OE (2012) Computer simulations: tools for population and evolutionary genetics. Nat. Rev. Genet. 13(2):110&#x02013;122<pub-id pub-id-type="pmid">22230817</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR29"><citation-alternatives><element-citation id="ec-CR29" publication-type="journal"><person-group person-group-type="author"><name><surname>Huang</surname><given-names>Y</given-names></name><name><surname>Carmi</surname><given-names>S</given-names></name><name><surname>Ringbauer</surname><given-names>H</given-names></name></person-group><article-title>Estimating effective population size trajectories from time-series identity-by-descent segments</article-title><source>Genetics</source><year>2025</year><volume>229</volume><issue>3</issue><fpage>212</fpage><pub-id pub-id-type="doi">10.1093/genetics/iyae212</pub-id></element-citation><mixed-citation id="mc-CR29" publication-type="journal">Huang Y, Carmi S, Ringbauer H (2025) Estimating effective population size trajectories from time-series identity-by-descent segments. Genetics 229(3):212</mixed-citation></citation-alternatives></ref><ref id="CR30"><citation-alternatives><element-citation id="ec-CR30" publication-type="journal"><person-group person-group-type="author"><name><surname>Haller</surname><given-names>BC</given-names></name><name><surname>Galloway</surname><given-names>J</given-names></name><name><surname>Kelleher</surname><given-names>J</given-names></name><name><surname>Messer</surname><given-names>PW</given-names></name><name><surname>Ralph</surname><given-names>PL</given-names></name></person-group><article-title>Tree-sequence recording in SLiM opens new horizons for forward-time simulation of whole genomes</article-title><source>Mol. Ecol. Resour.</source><year>2019</year><volume>19</volume><issue>2</issue><fpage>552</fpage><lpage>566</lpage><pub-id pub-id-type="doi">10.1111/1755-0998.12968</pub-id><pub-id pub-id-type="pmid">30565882</pub-id>
</element-citation><mixed-citation id="mc-CR30" publication-type="journal">Haller BC, Galloway J, Kelleher J, Messer PW, Ralph PL (2019) Tree-sequence recording in SLiM opens new horizons for forward-time simulation of whole genomes. Mol. Ecol. Resour. 19(2):552&#x02013;566<pub-id pub-id-type="pmid">30565882</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR31"><citation-alternatives><element-citation id="ec-CR31" publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>RR</given-names></name><name><surname>Kaplan</surname><given-names>NL</given-names></name></person-group><article-title>The coalescent process in models with selection and recombination</article-title><source>Genetics</source><year>1988</year><volume>120</volume><issue>3</issue><fpage>831</fpage><lpage>840</lpage><pub-id pub-id-type="doi">10.1093/genetics/120.3.831</pub-id><pub-id pub-id-type="pmid">3147214</pub-id>
</element-citation><mixed-citation id="mc-CR31" publication-type="journal">Hudson RR, Kaplan NL (1988) The coalescent process in models with selection and recombination. Genetics 120(3):831&#x02013;840<pub-id pub-id-type="pmid">3147214</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR32"><citation-alternatives><element-citation id="ec-CR32" publication-type="journal"><person-group person-group-type="author"><name><surname>Haller</surname><given-names>BC</given-names></name><name><surname>Messer</surname><given-names>PW</given-names></name></person-group><article-title>SLiM 3: forward genetic simulations beyond the Wright-Fisher model</article-title><source>Mol. Biol. Evol.</source><year>2019</year><volume>46</volume><issue>3</issue><fpage>632</fpage><lpage>637</lpage><pub-id pub-id-type="doi">10.1093/molbev/msy228</pub-id></element-citation><mixed-citation id="mc-CR32" publication-type="journal">Haller BC, Messer PW (2019) SLiM 3: forward genetic simulations beyond the Wright-Fisher model. Mol. Biol. Evol. 46(3):632&#x02013;637</mixed-citation></citation-alternatives></ref><ref id="CR33"><mixed-citation publication-type="other">Hermisson J, Pennings PS (2017) Soft sweeps and beyond: understanding the patterns and probabilities of selection footprints under rapid adaptation. Methods in Ecology and Evolution</mixed-citation></ref><ref id="CR34"><citation-alternatives><element-citation id="ec-CR34" publication-type="book"><person-group person-group-type="author"><name><surname>Hein</surname><given-names>J</given-names></name><name><surname>Schierup</surname><given-names>M</given-names></name><name><surname>Wiuf</surname><given-names>C</given-names></name></person-group><source>Gene Genealogies, Variation and Evolution: A Primer in Coalescent Theory</source><year>2005</year><publisher-loc>New York, NY, USA</publisher-loc><publisher-name>Oxford University Press</publisher-name></element-citation><mixed-citation id="mc-CR34" publication-type="book">Hein J, Schierup M, Wiuf C (2005) Gene Genealogies, Variation and Evolution: A Primer in Coalescent Theory. Oxford University Press, New York, NY, USA</mixed-citation></citation-alternatives></ref><ref id="CR35"><citation-alternatives><element-citation id="ec-CR35" publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>RR</given-names></name></person-group><article-title>Properties of a neutral allele model with intragenic recombination</article-title><source>Theor. Popul. Biol.</source><year>1983</year><volume>23</volume><issue>2</issue><fpage>183</fpage><lpage>201</lpage><pub-id pub-id-type="doi">10.1016/0040-5809(83)90013-8</pub-id><pub-id pub-id-type="pmid">6612631</pub-id>
</element-citation><mixed-citation id="mc-CR35" publication-type="journal">Hudson RR (1983) Properties of a neutral allele model with intragenic recombination. Theor. Popul. Biol. 23(2):183&#x02013;201<pub-id pub-id-type="pmid">6612631</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR36"><citation-alternatives><element-citation id="ec-CR36" publication-type="journal"><person-group person-group-type="author"><name><surname>Hudson</surname><given-names>RR</given-names></name></person-group><article-title>ms a program for generating samples under neutral models</article-title><source>Bioinformatics</source><year>2002</year><volume>18</volume><issue>2</issue><fpage>337</fpage><lpage>338</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/18.2.337</pub-id><pub-id pub-id-type="pmid">11847089</pub-id>
</element-citation><mixed-citation id="mc-CR36" publication-type="journal">Hudson RR (2002) ms a program for generating samples under neutral models. Bioinformatics 18(2):337&#x02013;338<pub-id pub-id-type="pmid">11847089</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR37"><citation-alternatives><element-citation id="ec-CR37" publication-type="journal"><person-group person-group-type="author"><name><surname>Kaplan</surname><given-names>NL</given-names></name><name><surname>Darden</surname><given-names>T</given-names></name><name><surname>Hudson</surname><given-names>RR</given-names></name></person-group><article-title>The coalescent process in models with selection</article-title><source>Genetics</source><year>1988</year><volume>120</volume><issue>3</issue><fpage>819</fpage><lpage>829</lpage><pub-id pub-id-type="doi">10.1093/genetics/120.3.819</pub-id><pub-id pub-id-type="pmid">3066685</pub-id>
</element-citation><mixed-citation id="mc-CR37" publication-type="journal">Kaplan NL, Darden T, Hudson RR (1988) The coalescent process in models with selection. Genetics 120(3):819&#x02013;829<pub-id pub-id-type="pmid">3066685</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR38"><mixed-citation publication-type="other">Korfmann K, Gaggiotti OE, Fumagalli M (2023) Deep learning in population genetics. Genome Biol. Evol. <bold>15</bold>(2)</mixed-citation></ref><ref id="CR39"><citation-alternatives><element-citation id="ec-CR39" publication-type="journal"><person-group person-group-type="author"><name><surname>Kingman</surname><given-names>JFC</given-names></name></person-group><source>The coalescent. Stoch. Process. Their Appl.</source><year>1982</year><volume>13</volume><issue>3</issue><fpage>235</fpage><lpage>248</lpage><pub-id pub-id-type="doi">10.1016/0304-4149(82)90011-4</pub-id></element-citation><mixed-citation id="mc-CR39" publication-type="journal">Kingman JFC (1982) The coalescent. Stoch. Process. Their Appl. 13(3):235&#x02013;248</mixed-citation></citation-alternatives></ref><ref id="CR40"><citation-alternatives><element-citation id="ec-CR40" publication-type="journal"><person-group person-group-type="author"><name><surname>Kingman</surname><given-names>JFC</given-names></name></person-group><article-title>On the genealogy of large populations</article-title><source>J. Appl. Probab.</source><year>1982</year><volume>19</volume><fpage>27</fpage><lpage>43</lpage><pub-id pub-id-type="doi">10.2307/3213548</pub-id></element-citation><mixed-citation id="mc-CR40" publication-type="journal">Kingman JFC (1982) On the genealogy of large populations. J. Appl. Probab. 19:27&#x02013;43</mixed-citation></citation-alternatives></ref><ref id="CR41"><citation-alternatives><element-citation id="ec-CR41" publication-type="journal"><person-group person-group-type="author"><name><surname>Kern</surname><given-names>AD</given-names></name><name><surname>Schrider</surname><given-names>DR</given-names></name></person-group><article-title>Discoal: flexible coalescent simulations with selection</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><issue>24</issue><fpage>3839</fpage><lpage>3841</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw556</pub-id><pub-id pub-id-type="pmid">27559153</pub-id>
</element-citation><mixed-citation id="mc-CR41" publication-type="journal">Kern AD, Schrider DR (2016) Discoal: flexible coalescent simulations with selection. Bioinformatics 32(24):3839&#x02013;3841<pub-id pub-id-type="pmid">27559153</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR42"><mixed-citation publication-type="other">Lauterbur EM, Cavassim MIA, Gladstein AL, Gower G, Pope NS, Tsambos G, Adrion J, Belsare S, Biddanda A, Caudill V, Cury J, Echevarria I, Haller BC, Hasan AR, Huang X, Iasi LNM, Noskova E, Ob&#x00161;teter J, Pavinato VAC, Pearson A, Peede D, Perez MF, Rodrigues MF, Smith CCR, Spence JP, Teterina A, Tittes S, Unneberg P, Vazquez JM, Waples RK, Wohns AW, Wong Y, Baumdicker F, Cartwright RA, Gorjanc G, Gutenkunst RN, Kelleher J, Kern AD, Ragsdale AP, Ralph PL, Schrider DR, Gronau I (2023) Expanding the stdpopsim species catalog, and lessons learned for realistic genome simulations. Elife <bold>12</bold></mixed-citation></ref><ref id="CR43"><citation-alternatives><element-citation id="ec-CR43" publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Inference of human population history from individual whole-genome sequences</article-title><source>Nature</source><year>2011</year><volume>475</volume><issue>7357</issue><fpage>493</fpage><lpage>496</lpage><pub-id pub-id-type="doi">10.1038/nature10231</pub-id><pub-id pub-id-type="pmid">21753753</pub-id>
</element-citation><mixed-citation id="mc-CR43" publication-type="journal">Li H, Durbin R (2011) Inference of human population history from individual whole-genome sequences. Nature 475(7357):493&#x02013;496<pub-id pub-id-type="pmid">21753753</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR44"><citation-alternatives><element-citation id="ec-CR44" publication-type="journal"><person-group person-group-type="author"><name><surname>Nath</surname><given-names>HB</given-names></name><name><surname>Griffiths</surname><given-names>RC</given-names></name></person-group><article-title>The coalescent in two colonies with symmetric migration</article-title><source>J. Math. Biol.</source><year>1993</year><volume>31</volume><issue>8</issue><fpage>841</fpage><lpage>851</lpage><pub-id pub-id-type="doi">10.1007/BF00168049</pub-id><pub-id pub-id-type="pmid">8263428</pub-id>
</element-citation><mixed-citation id="mc-CR44" publication-type="journal">Nath HB, Griffiths RC (1993) The coalescent in two colonies with symmetric migration. J. Math. Biol. 31(8):841&#x02013;851<pub-id pub-id-type="pmid">8263428</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR45"><citation-alternatives><element-citation id="ec-CR45" publication-type="journal"><person-group person-group-type="author"><name><surname>Naseri</surname><given-names>A</given-names></name><name><surname>Liu</surname><given-names>X</given-names></name><name><surname>Tang</surname><given-names>K</given-names></name><name><surname>Zhang</surname><given-names>S</given-names></name><name><surname>Zhi</surname><given-names>D</given-names></name></person-group><article-title>RaPID: ultra-fast, powerful, and accurate detection of segments identical by descent (IBD) in biobank-scale cohorts</article-title><source>Genome Biol.</source><year>2019</year><volume>20</volume><fpage>1</fpage><lpage>15</lpage><pub-id pub-id-type="doi">10.1186/s13059-019-1754-8</pub-id><pub-id pub-id-type="pmid">30606230</pub-id>
</element-citation><mixed-citation id="mc-CR45" publication-type="journal">Naseri A, Liu X, Tang K, Zhang S, Zhi D (2019) RaPID: ultra-fast, powerful, and accurate detection of segments identical by descent (IBD) in biobank-scale cohorts. Genome Biol. 20:1&#x02013;15<pub-id pub-id-type="pmid">30606230</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR46"><citation-alternatives><element-citation id="ec-CR46" publication-type="journal"><person-group person-group-type="author"><name><surname>Nait Saada</surname><given-names>J</given-names></name><name><surname>Kalantzis</surname><given-names>G</given-names></name><name><surname>Shyr</surname><given-names>D</given-names></name><name><surname>Cooper</surname><given-names>F</given-names></name><name><surname>Robinson</surname><given-names>M</given-names></name><name><surname>Gusev</surname><given-names>A</given-names></name><name><surname>Palamara</surname><given-names>PF</given-names></name></person-group><article-title>Identity-by-descent detection across 487,409 British samples reveals fine scale population structure and ultra-rare variant associations</article-title><source>Nat. Commun.</source><year>2020</year><volume>11</volume><issue>1</issue><fpage>6130</fpage><pub-id pub-id-type="doi">10.1038/s41467-020-19588-x</pub-id><pub-id pub-id-type="pmid">33257650</pub-id>
</element-citation><mixed-citation id="mc-CR46" publication-type="journal">Nait Saada J, Kalantzis G, Shyr D, Cooper F, Robinson M, Gusev A, Palamara PF (2020) Identity-by-descent detection across 487,409 British samples reveals fine scale population structure and ultra-rare variant associations. Nat. Commun. 11(1):6130<pub-id pub-id-type="pmid">33257650</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR47"><citation-alternatives><element-citation id="ec-CR47" publication-type="journal"><person-group person-group-type="author"><name><surname>Palamara</surname><given-names>PF</given-names></name></person-group><article-title>ARGON: Fast, whole-genome simulation of the discrete time Wright-Fisher process</article-title><source>Bioinformatics</source><year>2016</year><volume>32</volume><issue>19</issue><fpage>3032</fpage><lpage>3034</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btw355</pub-id><pub-id pub-id-type="pmid">27312410</pub-id>
</element-citation><mixed-citation id="mc-CR47" publication-type="journal">Palamara PF (2016) ARGON: Fast, whole-genome simulation of the discrete time Wright-Fisher process. Bioinformatics 32(19):3032&#x02013;3034<pub-id pub-id-type="pmid">27312410</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR48"><citation-alternatives><element-citation id="ec-CR48" publication-type="journal"><person-group person-group-type="author"><name><surname>Palamara</surname><given-names>PF</given-names></name><name><surname>Lencz</surname><given-names>T</given-names></name><name><surname>Darvasi</surname><given-names>A</given-names></name><name><surname>Pe&#x02019;er</surname><given-names>I</given-names></name></person-group><article-title>Length distributions of identity by descent reveal fine-scale demographic history</article-title><source>Am. J. Hum. Genet.</source><year>2012</year><volume>91</volume><issue>5</issue><fpage>809</fpage><lpage>822</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2012.08.030</pub-id><pub-id pub-id-type="pmid">23103233</pub-id>
</element-citation><mixed-citation id="mc-CR48" publication-type="journal">Palamara PF, Lencz T, Darvasi A, Pe&#x02019;er I (2012) Length distributions of identity by descent reveal fine-scale demographic history. Am. J. Hum. Genet. 91(5):809&#x02013;822<pub-id pub-id-type="pmid">23103233</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR49"><citation-alternatives><element-citation id="ec-CR49" publication-type="journal"><person-group person-group-type="author"><name><surname>Shemirani</surname><given-names>R</given-names></name><name><surname>Belbin</surname><given-names>GM</given-names></name><name><surname>Avery</surname><given-names>CL</given-names></name><name><surname>Kenny</surname><given-names>EE</given-names></name><name><surname>Gignoux</surname><given-names>CR</given-names></name><name><surname>Ambite</surname><given-names>JL</given-names></name></person-group><article-title>Rapid detection of identity-by-descent tracts for mega-scale datasets</article-title><source>Nat. Commun.</source><year>2021</year><volume>12</volume><issue>1</issue><fpage>3546</fpage><pub-id pub-id-type="doi">10.1038/s41467-021-22910-w</pub-id><pub-id pub-id-type="pmid">34112768</pub-id>
</element-citation><mixed-citation id="mc-CR49" publication-type="journal">Shemirani R, Belbin GM, Avery CL, Kenny EE, Gignoux CR, Ambite JL (2021) Rapid detection of identity-by-descent tracts for mega-scale datasets. Nat. Commun. 12(1):3546<pub-id pub-id-type="pmid">34112768</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR50"><mixed-citation publication-type="other">Shemirani R, Belbin GM, Burghardt K, Lerman K, Avery CL, Kenny EE, Gignoux CR, Ambite JL (2023) Selecting clustering algorithms for identity-by-descent mapping. In: Pacific Symposium on Biocomputing 2023, pp. 121&#x02013;132</mixed-citation></ref><ref id="CR51"><citation-alternatives><element-citation id="ec-CR51" publication-type="journal"><person-group person-group-type="author"><name><surname>Schiffels</surname><given-names>S</given-names></name><name><surname>Durbin</surname><given-names>R</given-names></name></person-group><article-title>Inferring human population size and separation history from multiple genome sequences</article-title><source>Nature genetics</source><year>2014</year><volume>46</volume><issue>8</issue><fpage>919</fpage><lpage>925</lpage><pub-id pub-id-type="doi">10.1038/ng.3015</pub-id><pub-id pub-id-type="pmid">24952747</pub-id>
</element-citation><mixed-citation id="mc-CR51" publication-type="journal">Schiffels S, Durbin R (2014) Inferring human population size and separation history from multiple genome sequences. Nature genetics 46(8):919&#x02013;925<pub-id pub-id-type="pmid">24952747</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR52"><mixed-citation publication-type="other">Stern AJ, Wilton PR, Nielsen R (2019) An approximate full-likelihood method for inferring selection and allele frequency trajectories from DNA sequence data. PLoS Genet. <bold>15</bold>(9)</mixed-citation></ref><ref id="CR53"><citation-alternatives><element-citation id="ec-CR53" publication-type="journal"><person-group person-group-type="author"><name><surname>Tajima</surname><given-names>F</given-names></name></person-group><article-title>Statistical method for testing the neutral mutation hypothesis by DNA polymorphism</article-title><source>Genetics</source><year>1989</year><volume>123</volume><issue>3</issue><fpage>585</fpage><lpage>595</lpage><pub-id pub-id-type="doi">10.1093/genetics/123.3.585</pub-id><pub-id pub-id-type="pmid">2513255</pub-id>
</element-citation><mixed-citation id="mc-CR53" publication-type="journal">Tajima F (1989) Statistical method for testing the neutral mutation hypothesis by DNA polymorphism. Genetics 123(3):585&#x02013;595<pub-id pub-id-type="pmid">2513255</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR54"><mixed-citation publication-type="other">Temple SD, Browning SR (2025) Multiple-testing corrections in selection scans using identity-by-descent segments. bioRxiv 10.1101/2025.01.29.635528</mixed-citation></ref><ref id="CR55"><citation-alternatives><element-citation id="ec-CR55" publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>X</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name><name><surname>Browning</surname><given-names>SR</given-names></name></person-group><article-title>Estimating the genome-wide mutation rate with three-way identity by descent</article-title><source>Am. J. Hum. Genet.</source><year>2019</year><volume>105</volume><issue>5</issue><fpage>883</fpage><lpage>893</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2019.09.012</pub-id><pub-id pub-id-type="pmid">31587867</pub-id>
</element-citation><mixed-citation id="mc-CR55" publication-type="journal">Tian X, Browning BL, Browning SR (2019) Estimating the genome-wide mutation rate with three-way identity by descent. Am. J. Hum. Genet. 105(5):883&#x02013;893<pub-id pub-id-type="pmid">31587867</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR56"><citation-alternatives><element-citation id="ec-CR56" publication-type="journal"><person-group person-group-type="author"><name><surname>Tian</surname><given-names>X</given-names></name><name><surname>Cai</surname><given-names>R</given-names></name><name><surname>Browning</surname><given-names>SR</given-names></name></person-group><article-title>Estimating the genome-wide mutation rate from thousands of unrelated individuals</article-title><source>Am. J. Hum. Genet.</source><year>2022</year><volume>109</volume><issue>12</issue><fpage>2178</fpage><lpage>2184</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2022.10.015</pub-id><pub-id pub-id-type="pmid">36370709</pub-id>
</element-citation><mixed-citation id="mc-CR56" publication-type="journal">Tian X, Cai R, Browning SR (2022) Estimating the genome-wide mutation rate from thousands of unrelated individuals. Am. J. Hum. Genet. 109(12):2178&#x02013;2184<pub-id pub-id-type="pmid">36370709</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR57"><mixed-citation publication-type="other">Temple SD (2024) Statistical Inference Using Identity-by-Descent Segments: Perspectives on Recent Positive Selection. PhD thesis, University of Washington</mixed-citation></ref><ref id="CR58"><citation-alternatives><element-citation id="ec-CR58" publication-type="journal"><person-group person-group-type="author"><name><surname>Temple</surname><given-names>SD</given-names></name><name><surname>Thompson</surname><given-names>EA</given-names></name></person-group><source>Identity-by-descent segments in large samples. bioRxiv</source><year>2024</year><pub-id pub-id-type="doi">10.1101/2024.06.05.597656</pub-id></element-citation><mixed-citation id="mc-CR58" publication-type="journal">Temple SD, Thompson EA (2024). Identity-by-descent segments in large samples bioRxiv. 10.1101/2024.06.05.597656</mixed-citation></citation-alternatives></ref><ref id="CR59"><citation-alternatives><element-citation id="ec-CR59" publication-type="journal"><person-group person-group-type="author"><name><surname>Temple</surname><given-names>SD</given-names></name><name><surname>Waples</surname><given-names>RK</given-names></name><name><surname>Browning</surname><given-names>SR</given-names></name></person-group><article-title>Modeling recent positive selection using identity-by-descent segments</article-title><source>Am. J. Hum. Genet.</source><year>2024</year><volume>111</volume><issue>11</issue><fpage>2510</fpage><lpage>2529</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2024.08.023</pub-id><pub-id pub-id-type="pmid">39362217</pub-id>
</element-citation><mixed-citation id="mc-CR59" publication-type="journal">Temple SD, Waples RK, Browning SR (2024) Modeling recent positive selection using identity-by-descent segments. Am. J. Hum. Genet. 111(11):2510&#x02013;2529<pub-id pub-id-type="pmid">39362217</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR60"><citation-alternatives><element-citation id="ec-CR60" publication-type="journal"><person-group person-group-type="author"><name><surname>Weir</surname><given-names>BS</given-names></name><name><surname>Cockerham</surname><given-names>CC</given-names></name></person-group><article-title>Estimating F-statistics for the analysis of population structure</article-title><source>Evolution</source><year>1984</year><volume>38</volume><issue>6</issue><fpage>1358</fpage><lpage>1370</lpage><pub-id pub-id-type="pmid">28563791</pub-id>
</element-citation><mixed-citation id="mc-CR60" publication-type="journal">Weir BS, Cockerham CC (1984) Estimating F-statistics for the analysis of population structure. Evolution 38(6):1358&#x02013;1370<pub-id pub-id-type="pmid">28563791</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR61"><citation-alternatives><element-citation id="ec-CR61" publication-type="journal"><person-group person-group-type="author"><name><surname>Wright</surname><given-names>S</given-names></name></person-group><article-title>Evolution in Mendelian populations</article-title><source>Genetics</source><year>1931</year><volume>16</volume><issue>2</issue><fpage>97</fpage><lpage>159</lpage><pub-id pub-id-type="doi">10.1093/genetics/16.2.97</pub-id><pub-id pub-id-type="pmid">17246615</pub-id>
</element-citation><mixed-citation id="mc-CR61" publication-type="journal">Wright S (1931) Evolution in Mendelian populations. Genetics 16(2):97&#x02013;159<pub-id pub-id-type="pmid">17246615</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR62"><citation-alternatives><element-citation id="ec-CR62" publication-type="journal"><person-group person-group-type="author"><name><surname>Wakeley</surname><given-names>J</given-names></name><name><surname>Takahashi</surname><given-names>T</given-names></name></person-group><article-title>Gene genealogies when the sample size exceeds the effective size of the population</article-title><source>Mol. Biol. Evol.</source><year>2003</year><volume>22</volume><issue>2</issue><fpage>208</fpage><lpage>213</lpage><pub-id pub-id-type="doi">10.1093/molbev/msg024</pub-id></element-citation><mixed-citation id="mc-CR62" publication-type="journal">Wakeley J, Takahashi T (2003) Gene genealogies when the sample size exceeds the effective size of the population. Mol. Biol. Evol. 22(2):208&#x02013;213</mixed-citation></citation-alternatives></ref><ref id="CR63"><citation-alternatives><element-citation id="ec-CR63" publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>X</given-names></name><name><surname>Miller</surname><given-names>DJ</given-names></name><name><surname>Zhang</surname><given-names>J</given-names></name><name><surname>Herrington</surname><given-names>D</given-names></name><name><surname>Wang</surname><given-names>Y</given-names></name></person-group><article-title>An overview of population genetic data simulation</article-title><source>J. Comput. Biol.</source><year>2012</year><volume>19</volume><issue>1</issue><fpage>42</fpage><lpage>54</lpage><pub-id pub-id-type="doi">10.1089/cmb.2010.0188</pub-id><pub-id pub-id-type="pmid">22149682</pub-id>
</element-citation><mixed-citation id="mc-CR63" publication-type="journal">Yuan X, Miller DJ, Zhang J, Herrington D, Wang Y (2012) An overview of population genetic data simulation. J. Comput. Biol. 19(1):42&#x02013;54<pub-id pub-id-type="pmid">22149682</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR64"><citation-alternatives><element-citation id="ec-CR64" publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name><name><surname>Browning</surname><given-names>SR</given-names></name></person-group><article-title>Population-specific recombination maps from segments of identity by descent</article-title><source>Am. J. Hum. Genet.</source><year>2020</year><volume>107</volume><issue>1</issue><fpage>137</fpage><lpage>148</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2020.05.016</pub-id><pub-id pub-id-type="pmid">32533945</pub-id>
</element-citation><mixed-citation id="mc-CR64" publication-type="journal">Zhou Y, Browning BL, Browning SR (2020) Population-specific recombination maps from segments of identity by descent. Am. J. Hum. Genet. 107(1):137&#x02013;148<pub-id pub-id-type="pmid">32533945</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR65"><citation-alternatives><element-citation id="ec-CR65" publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Browning</surname><given-names>SR</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name></person-group><article-title>A fast and simple method for detecting identity-by-descent segments in large-scale data</article-title><source>Am. J. Hum. Genet.</source><year>2020</year><volume>106</volume><issue>4</issue><fpage>426</fpage><lpage>437</lpage><pub-id pub-id-type="doi">10.1016/j.ajhg.2020.02.010</pub-id><pub-id pub-id-type="pmid">32169169</pub-id>
</element-citation><mixed-citation id="mc-CR65" publication-type="journal">Zhou Y, Browning SR, Browning BL (2020) A fast and simple method for detecting identity-by-descent segments in large-scale data. Am. J. Hum. Genet. 106(4):426&#x02013;437<pub-id pub-id-type="pmid">32169169</pub-id>
</mixed-citation></citation-alternatives></ref><ref id="CR66"><citation-alternatives><element-citation id="ec-CR66" publication-type="journal"><person-group person-group-type="author"><name><surname>Zhou</surname><given-names>Y</given-names></name><name><surname>Browning</surname><given-names>SR</given-names></name><name><surname>Browning</surname><given-names>BL</given-names></name></person-group><article-title>IBDkin: fast estimation of kinship coefficients from identity by descent segments</article-title><source>Bioinformatics</source><year>2020</year><volume>36</volume><issue>16</issue><fpage>4519</fpage><lpage>4520</lpage><pub-id pub-id-type="doi">10.1093/bioinformatics/btaa569</pub-id><pub-id pub-id-type="pmid">32844204</pub-id>
</element-citation><mixed-citation id="mc-CR66" publication-type="journal">Zhou Y, Browning SR, Browning BL (2020) IBDkin: fast estimation of kinship coefficients from identity by descent segments. Bioinformatics 36(16):4519&#x02013;4520<pub-id pub-id-type="pmid">32844204</pub-id>
</mixed-citation></citation-alternatives></ref></ref-list></back></article>