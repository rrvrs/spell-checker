<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">Sci Rep</journal-id><journal-id journal-id-type="iso-abbrev">Sci Rep</journal-id><journal-title-group><journal-title>Scientific Reports</journal-title></journal-title-group><issn pub-type="epub">2045-2322</issn><publisher><publisher-name>Nature Publishing Group UK</publisher-name><publisher-loc>London</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmid">39730644</article-id><article-id pub-id-type="pmc">PMC11681074</article-id><article-id pub-id-type="publisher-id">81769</article-id><article-id pub-id-type="doi">10.1038/s41598-024-81769-1</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Deep reinforcement learning and fuzzy logic controller codesign for energy management of hydrogen fuel cell powered electric vehicles</article-title></title-group><contrib-group><contrib contrib-type="author" corresp="yes"><name><surname>Rostami</surname><given-names>Seyed Mehdi Rakhtala</given-names></name><address><email>Mehdi.Rakhtalarostami@uwe.ac.uk</email></address><xref ref-type="aff" rid="Aff1">1</xref></contrib><contrib contrib-type="author"><name><surname>Al-Shibaany</surname><given-names>Zeyad</given-names></name><xref ref-type="aff" rid="Aff1">1</xref><xref ref-type="aff" rid="Aff2">2</xref></contrib><contrib contrib-type="author"><name><surname>Kay</surname><given-names>Peter</given-names></name><xref ref-type="aff" rid="Aff3">3</xref></contrib><contrib contrib-type="author"><name><surname>Karimi</surname><given-names>Hamid Reza</given-names></name><xref ref-type="aff" rid="Aff4">4</xref></contrib><aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/02nwg5t34</institution-id><institution-id institution-id-type="GRID">grid.6518.a</institution-id><institution-id institution-id-type="ISNI">0000 0001 2034 5266</institution-id><institution>School of Engineering, </institution><institution>University of the West of England Bristol, </institution></institution-wrap>Bristol, UK </aff><aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01w1ehb86</institution-id><institution-id institution-id-type="GRID">grid.444967.c</institution-id><institution-id institution-id-type="ISNI">0000 0004 0618 8761</institution-id><institution>Computer Engineering Department, </institution><institution>University of Technology, </institution></institution-wrap>Baghdad, Iraq </aff><aff id="Aff3"><label>3</label>The Engineering and Design Institute, London, UK </aff><aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01nffqt88</institution-id><institution-id institution-id-type="GRID">grid.4643.5</institution-id><institution-id institution-id-type="ISNI">0000 0004 1937 0327</institution-id><institution>Department of Mechanical Engineering, </institution><institution>Politecnico di Milano, </institution></institution-wrap>Milan, Italy </aff></contrib-group><pub-date pub-type="epub"><day>28</day><month>12</month><year>2024</year></pub-date><pub-date pub-type="pmc-release"><day>28</day><month>12</month><year>2024</year></pub-date><pub-date pub-type="collection"><year>2024</year></pub-date><volume>14</volume><elocation-id>30917</elocation-id><history><date date-type="received"><day>29</day><month>8</month><year>2024</year></date><date date-type="accepted"><day>28</day><month>11</month><year>2024</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2024</copyright-statement><copyright-year>2024</copyright-year><license><ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article&#x02019;s Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article&#x02019;s Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>.</license-p></license></permissions><abstract id="Abs1"><p id="Par1">Hydrogen-based electric vehicles such as Fuel Cell Electric Vehicles (FCHEVs) play an important role in producing zero carbon emissions and in reducing the pressure from the fuel economy crisis, simultaneously. This paper aims to address the energy management design for various performance metrics, such as power tracking and system accuracy, fuel cell lifetime, battery lifetime, and reduction of transient and peak current on Polymer Electrolyte Membrane Fuel Cell (PEMFC) and Li-ion batteries. The proposed algorithm includes a combination of reinforcement learning algorithms in low-level control loops and high-level supervisory control based on fuzzy logic load sharing, which is implemented in the system under consideration. More specifically, this research paper establishes a power system model with three DC-DC converters, which includes a hierarchical energy management framework employed in a two-layer control strategy. Three loop control strategies for hybrid electric vehicles based on reinforcement learning are designed in the low-level layer control strategy. The Deep Deterministic Policy Gradient with Twin Delayed (DDPG TD3) is used with a network. Three DRL controllers are designed using the hierarchical energy optimization control architecture. The comparative results between the two strategies, Deep Reinforcement Learning and Fuzzy logic supervisory control (DRL-F) and Super-Twisting algorithm and Fuzzy logic supervisory control (STW-F) under the EUDC driving cycle indicate that the proposed model DRL-F can ensure the Root Mean Square Error (RMSE) reduction for 21.05% compared to the STW-F and the Mean Error reduction for 8.31% compared to the STW-F method. The results demonstrate a more robust, accurate and precise system alongside uncertainties and disturbances in the Energy Management System (EMS) of FCHEV based on an advanced learning method.</p></abstract><kwd-group xml:lang="en"><title>Keywords</title><kwd>Fuel cell electric vehicle</kwd><kwd>PEM fuel cell</kwd><kwd>Ultracapacitor</kwd><kwd>Deep reinforcement learning</kwd><kwd>Fuzzy control</kwd><kwd>Energy management</kwd></kwd-group><kwd-group kwd-group-type="npg-subject"><title>Subject terms</title><kwd>Electrical and electronic engineering</kwd><kwd>Fuel cells</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; Springer Nature Limited 2024</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1"><title>Introduction</title><p id="Par28">Fc electric hybrid vehicles have become a hot topic today as they have the potential to improve zero-emission, aiming to mitigate environmental degradation, and improve the fuel economy and performance of power sources in real-time<sup><xref ref-type="bibr" rid="CR1">1</xref></sup>. Transportation is one of the key contributors to global warming and air pollution. Then, there has been a growing demand for electrified vehicles that utilize electric motors in their powertrain and, thus, emit fewer pollutants. Fossil fuel cars and vehicles will be swapped for new electric vehicles in the future. Because of its safety, cost-effectiveness, and other advantages, lithium-ion batteries are widely used in electric vehicles<sup><xref ref-type="bibr" rid="CR2">2</xref>,<xref ref-type="bibr" rid="CR3">3</xref></sup>. Despite the high energy density of the Li-ion batteries, their power densities are not high enough for EV applications, making them a low-efficiency element for the rapid exchange of energy. Because it is beneficial to combine batteries with another complementary storage resource, such as UC, that provides high power density and low energy density<sup><xref ref-type="bibr" rid="CR4">4</xref></sup>. To make the current transportation system more environmentally friendly, a variety of vehicle electrification technologies, including FCHEVs, plug-in hybrid electric vehicles (PHEVs), hybrid electric vehicles (HEVs), and battery electric vehicles (BEVs), have been developed. FCHEVs are showing a consistent increase in the market segment for road cars, to the point where numerous prototypes of various brands and sizes, such as the Hyundai Nexo, Honda Clarity, Mercedes-Benz F-Cell, and Toyota Mirai, have been produced<sup><xref ref-type="bibr" rid="CR5">5</xref>&#x02013;<xref ref-type="bibr" rid="CR9">9</xref></sup>.</p><p id="Par29">The PEMFC, with its solid electrolyte, high power density, and low operating temperature, has the most potential of all the FC types to be used in automotive applications. Table <xref rid="Tab1" ref-type="table">1</xref> presents a comparison of various electric cars. Taking advantage of the high energy density and short refuelling time. However, the higher cost and short life of the PEMFC system and battery in an electric vehicle diminish the fuel cell electric vehicle from becoming the main transportation solution<sup><xref ref-type="bibr" rid="CR10">10</xref></sup>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Markets, companies and FCHEV<sup><xref ref-type="bibr" rid="CR6">6</xref>&#x02013;<xref ref-type="bibr" rid="CR9">9</xref></sup>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Type of vehicles</th><th align="left">Markets and companies</th><th align="left">Strength</th><th align="left">Weakness</th></tr></thead><tbody><tr><td align="left" rowspan="3">PHEV (ICE&#x02009;+&#x02009;Bat)</td><td align="left">Mercedes-GLC360e</td><td align="left" rowspan="3"><p>&#x02022; Less emission than HEV</p><p>&#x02022; Convenient charging</p></td><td align="left" rowspan="3"><p>&#x02022; Complex powertrain</p><p>&#x02022; Higher battery cost</p></td></tr><tr><td align="left">Honda-Clarity</td></tr><tr><td align="left">Audi A3 E-Tron 2016</td></tr><tr><td align="left" rowspan="3">BEV (Only Bat)</td><td align="left">Tesla-Model S</td><td align="left" rowspan="3"><p>&#x02022; Zero exhaust emission</p><p>&#x02022; Convenient charging</p><p>&#x02022; Smooth propelling without noise</p></td><td align="left" rowspan="3"><p>&#x02022; Long recharging time</p><p>&#x02022; Shorter battery lifetime rather than hybrid</p></td></tr><tr><td align="left">Nissan-Leaf<sup><xref ref-type="bibr" rid="CR6">6</xref></sup></td></tr><tr><td align="left">Kia-Soul</td></tr><tr><td align="left" rowspan="3">FCHEV (FC&#x02009;+&#x02009;Bat&#x02009;+&#x02009;and/or UC)</td><td align="left">Toyota-Mirai<sup><xref ref-type="bibr" rid="CR7">7</xref></sup></td><td align="left" rowspan="3"><p>&#x02022; Fast refuelling</p><p>&#x02022; Smooth propelling without noise</p><p>&#x02022; High driving autonomy</p></td><td align="left" rowspan="3"><p>&#x02022; Immature technology</p><p>&#x02022; Restriction for infrastructures</p><p>&#x02022; High cost</p></td></tr><tr><td align="left">Hyundai ix35 FUEL CELL<sup><xref ref-type="bibr" rid="CR8">8</xref></sup></td></tr><tr><td align="left">Kia Borrego FCEV<sup><xref ref-type="bibr" rid="CR9">9</xref></sup></td></tr></tbody></table></table-wrap></p><p id="Par30">However, a PEMFC includes some restrictions, such as its slow dynamic and inability to store energy, which prevent it from meeting all the needs of vehicles. Due to this, using a secondary power source such as a battery or UC is required to meet the fast-dynamic load in automobiles, lower the rate of PEMFC degradation by absorbing power peaks, improve fuel efficiency, power the load during cold start, and recover energy. Three common configurations for hydrogen vehicle hybridization are FC-battery, FC-UC, and FC-battery-UC<sup><xref ref-type="bibr" rid="CR11">11</xref></sup>. The battery and the supercapacitor serve as auxiliary sources, whereas the FC serves as the primary source in the Hybrid Energy Storage System (HESS) paradigm, which has one main source and two energy storage sources. There are multiple possible configuration types of an FCHEV listed in Table <xref rid="Tab2" ref-type="table">2</xref><sup><xref ref-type="bibr" rid="CR12">12</xref></sup>.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Multiple possible configurations.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">PEMFC</th><th align="left">Battery and/or SC</th><th align="left"/></tr></thead><tbody><tr><td align="left" rowspan="4">Connection (DC/DC converter)</td><td align="left">YES</td><td align="left">YES</td><td align="left">Full-active</td></tr><tr><td align="left">YES</td><td align="left">NO</td><td align="left">Semi-active</td></tr><tr><td align="left">NO</td><td align="left">NO</td><td align="left">Passive</td></tr><tr><td align="left">NO</td><td align="left">YES</td><td align="left">Not common</td></tr></tbody></table></table-wrap></p><sec id="Sec2"><title>Control issues on energy management strategies</title><sec id="Sec3"><title>Rule-based/fuzzy logic control energy management strategies</title><p id="Par31">In the rule-based energy management strategy, a set of predefined rules or look-up tables determine power sharing.</p><p id="Par32">The main benefits of the fuzzy rule-based strategy in the EMS of HESS are low computational load, robustness, easy implementation, and high reliability<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>. They are cost-effective nonlinear control and intelligent and smart. The fuzzy controller output has good smoothness. And it is dependent on the fuzzy membership functions and rules<sup><xref ref-type="bibr" rid="CR13">13</xref></sup>.</p><p id="Par33">The main disadvantage of the fuzzy rule-based strategy in the EMS of HESS is that fuzzy controller design depends on the engineer&#x02019;s experience and knowledge. A summary of optimization-based Energy management systems in FCHEVs based on Fuel cell, battery, and UC are presented in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> and Table <xref rid="Tab3" ref-type="table">3</xref>. In several classifications in the literature, recent energy management systems have been found in research and classified into three methods: Rule-based, optimization-based, and learning-based, as shown in Fig.&#x000a0;<xref rid="Fig1" ref-type="fig">1</xref> and Table <xref rid="Tab3" ref-type="table">3</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Review of different energy management systems in Fuel cell + battery + UC Electric vehicle system.</p></caption><graphic xlink:href="41598_2024_81769_Fig1_HTML" id="d33e634"/></fig><table-wrap id="Tab3"><label>Table 3</label><caption><p>Classification of different energy management systems in Fuel cell&#x02009;+&#x02009;battery&#x02009;+&#x02009;UC Electric vehicle system.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Proposed method</th><th align="left">Vehicle type</th><th align="left">Objective function</th><th align="left">Management system performance description</th></tr></thead><tbody><tr><td align="left">Equivalent Consumption Minimisation (ECMS)&#x02009;+&#x02009;Fuzzy</td><td align="left">Mining truck (FC&#x02009;+&#x02009;BAT&#x02009;+&#x02009;UC)</td><td align="left">Minimize the hydrogen consumption</td><td align="left">Fuel consumption was reduced by 7.94% using an ECMS with a fuzzy controller<sup><xref ref-type="bibr" rid="CR23">23</xref></sup></td></tr><tr><td align="left">State machine control&#x02009;+&#x02009;ECMS</td><td align="left">Tram (FC&#x02009;+&#x02009;BAT&#x02009;+&#x02009;UC)</td><td align="left">Maximize the overall efficiency including distance, speed, fuel economy and FCS efficiency</td><td align="left">Better fuel economy decreased by 3.2% and stack efficiency increased by 6.74%<sup><xref ref-type="bibr" rid="CR24">24</xref></sup></td></tr><tr><td align="left">Meta-model based global optimization algorithm</td><td align="left">Mining truck (FC&#x02009;+&#x02009;BAT&#x02009;+&#x02009;UC)</td><td align="left">Minimize the life cycle cost</td><td align="left">Minimize the overall operation costs of FCEVs, including the cost of hydrogen fuel, the cost associated with the degradations of the PEMFC system<sup><xref ref-type="bibr" rid="CR25">25</xref></sup></td></tr><tr><td align="left">Dynamic Programming (DP)</td><td align="left">Transit bus (FC&#x02009;+&#x02009;BAT&#x02009;+&#x02009;UC)</td><td align="left">Minimize the percentage deviation of the hydrogen consumption and the average absolute battery power</td><td align="left">DP consumes the same amount of hydrogen with a deviation of less than 0.05%<sup><xref ref-type="bibr" rid="CR26">26</xref></sup></td></tr><tr><td align="left">Efficient convex programming</td><td align="left">Others (FC&#x02009;+&#x02009;BAT&#x02009;+&#x02009;UC)</td><td align="left">Minimize the percentage deviation of the hydrogen consumption</td><td align="left">Reduce the average absolute battery power<sup><xref ref-type="bibr" rid="CR27">27</xref></sup></td></tr><tr><td align="left">Rule-based and dynamic programming (DP)-based</td><td align="left">Others (FC&#x02009;+&#x02009;BAT&#x02009;+&#x02009;UC)</td><td align="left">Improves the fuel economy and system durability of vehicles and hydrogen consumption</td><td align="left">FCs struggles to fulfil the vehicle&#x02019;s constant fluctuating power requirement under real-world driving situations<sup><xref ref-type="bibr" rid="CR28">28</xref></sup></td></tr><tr><td align="left">Deep reinforcement learning-based energy management for cabin comfort control</td><td align="left">Fuel cell vehicles (FCVs) without UC</td><td align="left">To optimize powertrain energy consumption</td><td align="left">Comprehensive control of cabin comfort and fuel cell/battery durability is proposed to increase energy efficiency of FC bus<sup><xref ref-type="bibr" rid="CR29">29</xref></sup></td></tr><tr><td align="left">Deep RL energy management for fuel cell buses based on TD3 algorithm</td><td align="left">Fuel cell Buses, (FC&#x02009;+&#x02009;BAT)</td><td align="left">Fuel cell durability, and Li-ion Battery thermal health awareness</td><td align="left">TD3-based energy management system can improve battery life by 28.02% and overall vehicle economy by 8.92%<sup><xref ref-type="bibr" rid="CR30">30</xref></sup></td></tr><tr><td align="left">Bi-directional long short-term memory for degradation prediction model for PEMFC</td><td align="left">Just Fuel cell system</td><td align="left">Fuel cell durability, lifetime prediction</td><td align="left">Proposed BiLSTM model achieves accurate predictions under different current conditions<sup><xref ref-type="bibr" rid="CR31">31</xref></sup></td></tr></tbody></table></table-wrap></p></sec></sec></sec><sec id="Sec4"><title>Main contribution</title><p id="Par34">The contributions of this research manuscript are summarised as follows:<list list-type="order"><list-item><p id="Par35"> An energy management system including Deep Reinforcement Learning (DRL) and fuzzy logic control-based load sharing is implemented for the dynamic PEMFC/Battery/UC hybrid vehicular power system model. A hierarchical energy management framework is employed in a two-layer control strategy. In the low-level layer control strategy of the hierarchical energy management structure, three loop control strategies for hybrid electric vehicles based on reinforcement learning are designed to improve FC and battery power-sharing tracking and voltage bus.</p></list-item><list-item><p id="Par36"> The Twin Delayed Deep Deterministic Policy Gradient (TD3) approach is used as one of the advanced DRL methods to develop an intelligent energy management strategy in low-level loops (Bus line voltage tracking loop&#x02014;Fuel cell power tracking loop, and battery power tracking loop) for FCHEV. For the complex continuous state-action space of FCHEV, a DDPG-based algorithm is introduced, and a hierarchical energy management framework is employed to reduce the dimensionality of the action-state space.</p></list-item><list-item><p id="Par37">In this work, the Deep Deterministic Policy Gradient with Twin Delayed (DDPG TD3) was used with a network. Three RL-PID controllers are developed using an artificial intelligence algorithm based on reinforcement learning. This algorithm uses an actor-critic agent whose objective is to optimize the actor&#x02019;s policy and train a critic for rewards. This will generate the appropriate gains without the need to know the system.</p></list-item><list-item><p id="Par38">Furthermore, fuzzy logic controller in the high-level supervisory control layer offers the following benefits: Simple understanding and easy implementation&#x02014;Real-time operation- Robustness and adaptability against uncertainty, noise, disturbances and stability handling in various performing situations. Therefore, the proposed method will suggest a more robust, accurate, and precise system alongside uncertainties and disturbances in the EMS of FCHEVs.</p></list-item></list></p><p id="Par39">However, the engineering process of obtaining a mathematical system modelling often demands in-depth, physical concepts. If some initial conditions change (such as FC temperature, flow rate, FC voltage, Battery voltage, UC voltage, battery SoC and UC SoC, and &#x02026;), the engineering process must be repeated to obtain an appropriate controller. Conversely, with the DDPG-TD3 training policy, the system continually adjusts itself, eliminating the need for the user to engage in re-engineering for applied control.</p><p id="Par40">This paper is organized as follows: section &#x0201c;<xref rid="Sec4" ref-type="sec">Main contribution</xref>&#x0201d; introduces a literature review of the paper, and the hybrid topologies used in this study. In section &#x0201c;<xref rid="Sec5" ref-type="sec">Topology and structure of HESS</xref>&#x0201d;, the topology and structure of HESS is presented and discussed. Modelling of the hybrid energy storage system is presented in section &#x0201c;<xref rid="Sec7" ref-type="sec">Modelling of PEMFC, UC, and Li-ion battery</xref>&#x0201d;. In section &#x0201c;<xref rid="Sec14" ref-type="sec">Energy management strategy three RL loops and high level supervisory fuzzy control</xref>&#x0201d;, a proposed energy management strategy with three RL Loops and high-level supervisory fuzzy control is developed. The evaluations, results and analysis are performed in section &#x0201c;<xref rid="Sec22" ref-type="sec">Evaluations and results</xref>&#x0201d;. Finally, conclusions drawn from the study are given in section &#x0201c;<xref rid="Sec24" ref-type="sec">Conclusion</xref>&#x0201d;.</p></sec><sec id="Sec5"><title>Topology and structure of HESS</title><p id="Par41">A typical FCHEV powertrain design is shown in Fig.&#x000a0;<xref rid="Fig2" ref-type="fig">2</xref>. An FCHEV is a car with these kinds of structures, where the primary energy source is a PEMFC stack, and the secondary source is either a Li-ion battery pack or a UC bank. In this framework, a PEM fuel cell, lithium-ion battery bank, and Ultra-capacitor establish a connection to the DC link. The HESS should have high power density, extended working life, and relatively high efficiency. Therefore, HESS consists of a FC connected with a boost converter, the lithium-ion battery bank and the Ultra-capacitor to maintain a link to the DC bus via two bidirectional DC-DC converters. The DC bus, on the other side, is connected to a DC-AC inverter used to drive the vehicle&#x02019;s traction motor. The inverter plays a critical role, delivering DC power to its AC counterpart, thereby empowering the motor to actuate the vehicle&#x02019;s transmission system. The traction system consists of a combination of power inverters and electric motors that are expertly coordinated by control systems.<fig id="Fig2"><label>Fig. 2</label><caption><p>Structure of Hydrogen FC &#x02013; Battery &#x02212; UC on fuel cell hybrid electric vehicle.</p></caption><graphic xlink:href="41598_2024_81769_Fig2_HTML" id="d33e834"/></fig></p><sec id="Sec6"><title>Full-active topology for PEMFC-Li-ion battery-UC</title><p id="Par42">A full-active HESS topology, including the PEMFC and Li-ion battery and Ultra-capacitor, is illustrated in Fig.&#x000a0;<xref rid="Fig3" ref-type="fig">3</xref>. This full-active HESS type has significant controllability and enables customized power allocations. This facilitates efficient energy management and the best possible use of every energy storage resource according to its unique charge/discharge properties.<fig id="Fig3"><label>Fig. 3</label><caption><p>Full-active HESS topology including the hydrogen FC, Li-ion battery, and UC.</p></caption><graphic xlink:href="41598_2024_81769_Fig3_HTML" id="d33e848"/></fig></p><p id="Par43">Figure&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref> details the battery, Ultracapacitor, FC, and load and DC-DC converters. There are two non-isolated bidirectional DC-DC converters and one DC- DC boost converter in full-active HESS topology that are connected by power switches <italic>S</italic><sub>1</sub>, <italic>S</italic><sub>2</sub>, <italic>S</italic><sub>3</sub>, <italic>S</italic><sub>4</sub>, and <italic>S</italic><sub>5</sub>. The detailed circuit topology is shown in Fig.&#x000a0;<xref rid="Fig4" ref-type="fig">4</xref>.<fig id="Fig4"><label>Fig. 4</label><caption><p>Circuit diagram of HESS in FCHEV.</p></caption><graphic xlink:href="41598_2024_81769_Fig4_HTML" id="d33e884"/></fig></p><p id="Par44">For discharge mode of FC, battery, and UC:<list list-type="bullet"><list-item><p id="Par45">Switches <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> are engaged, thus being in the on state, whereas switch <italic>S</italic><sub>3</sub> remains off. Here, diode <italic>D</italic><sub><italic>0</italic></sub> and the antiparallel diode <italic>D</italic><sub>3</sub> assume the roles of freewheel diodes, facilitating a particular directionality of the current flow.</p></list-item></list></p><p id="Par46">However, when the load transitions into the discharge mode:<list list-type="bullet"><list-item><p id="Par47">Switch <italic>S</italic><sub>3</sub> becomes activated, shifting into the on state, whilst the switches <italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> are deactivated, hence assuming the off state. To maintain a consistent current flow, the antiparallel diodes <italic>D</italic><sub>1</sub> and <italic>D</italic><sub>2</sub> come into play. Additional components within this circuit include inductive elements denoted as <italic>L</italic><sub>1</sub> and <italic>L</italic><sub>2</sub>, coupled with series equivalent internal resistances represented by <italic>R</italic><sub>1</sub> and <italic>R</italic><sub>2</sub>, contributing to the functioning of the system.</p></list-item></list></p></sec></sec><sec id="Sec7"><title>Modelling of PEMFC, UC, and Li-ion battery</title><sec id="Sec8"><title>PEM fuel cell model</title><p id="Par48">The open circuit voltage of a cell is1.229&#x000a0;V. The actual cell potential is decreased because of irreversible losses. The irreversible losses can arise from multiple sources. Three different processes can cause the losses, commonly referred to as polarization over voltage: concentration polarization, ohmic polarization, and activation polarization<sup><xref ref-type="bibr" rid="CR32">32</xref>&#x02013;<xref ref-type="bibr" rid="CR35">35</xref></sup>. Symbols used in this paper are tabulated in Table <xref rid="Tab4" ref-type="table">4</xref>.<table-wrap id="Tab4"><label>Table 4</label><caption><p>Fuel cell voltage parameters.</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left"><inline-formula id="IEq28"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq28.gif"/></alternatives></inline-formula></td><td align="left">Number of cells</td></tr><tr><td align="left"><inline-formula id="IEq29"><alternatives><tex-math id="M2">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$T$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq29.gif"/></alternatives></inline-formula></td><td align="left">Temperature of fuel cell</td></tr><tr><td align="left"><inline-formula id="IEq30"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{{H_{2} }} ,\; P_{{O_{2} }}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq30.gif"/></alternatives></inline-formula></td><td align="left">Partial pressure of each gas inside</td></tr><tr><td align="left"><inline-formula id="IEq31"><alternatives><tex-math id="M4">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq31.gif"/></alternatives></inline-formula></td><td align="left">Universal gas constant</td></tr><tr><td align="left"><inline-formula id="IEq32"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$F$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq32.gif"/></alternatives></inline-formula></td><td align="left">Faraday&#x02019;s constant</td></tr><tr><td align="left"><inline-formula id="IEq33"><alternatives><tex-math id="M6">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq33.gif"/></alternatives></inline-formula></td><td align="left">Charge transfer coefficient</td></tr><tr><td align="left"><inline-formula id="IEq34"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq34.gif"/></alternatives></inline-formula></td><td align="left">Output current density</td></tr><tr><td align="left"><inline-formula id="IEq35"><alternatives><tex-math id="M8">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{0}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq35.gif"/></alternatives></inline-formula></td><td align="left">Exchange current density</td></tr><tr><td align="left"><inline-formula id="IEq36"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{fc}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq36.gif"/></alternatives></inline-formula></td><td align="left">Output current</td></tr><tr><td align="left"><inline-formula id="IEq37"><alternatives><tex-math id="M10">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$r$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq37.gif"/></alternatives></inline-formula></td><td align="left">Area-specific resistance</td></tr><tr><td align="left"><italic>m</italic> and <italic>n</italic></td><td align="left">Constants in the mass transfer voltage</td></tr></tbody></table></table-wrap></p><p id="Par49">A cell voltage with losses is mentioned in Eq.&#x000a0;(<xref rid="Equ1" ref-type="disp-formula">1</xref>):<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{FC} = E - losses$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par50">Nernst voltage equation is presented form as<sup><xref ref-type="bibr" rid="CR32">32</xref>&#x02013;<xref ref-type="bibr" rid="CR35">35</xref></sup>:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M12">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$E = 1.229 - 0.85 \times 10^{ - 3} \times \left( {T - 298.15} \right) + 4.3085 \times 10^{ - 5} T \times \left( {\ln \;P_{{H_{2} }} + \frac{1}{2}\ln P_{O2} } \right)$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par51">The voltage losses due to activation, ohmic and concentration losses are defined in the following:</p><sec id="Sec9"><title>Ohmic loss</title><p id="Par52">The ohmic resistance of the PEM fuel cell includes the resistance of the anode and cathode in electrode manufacturing and the resistance of the polymer electrolyte membrane to the movement of ions. Ohmic voltage loss for a single PEM fuel cell stack can be given as:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ohmic} = N\; I_{fc } \;r$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec10"><title>Activation loss</title><p id="Par53">This loss is caused by the slowness of the reactions taking place on the surface of the electrodes<sup><xref ref-type="bibr" rid="CR32">32</xref>&#x02013;<xref ref-type="bibr" rid="CR35">35</xref></sup>. Dominant at low current density (i.e. at the beginning of V&#x02013;I characteristic curve).<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M14">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{act} = N\frac{R T}{{2 \alpha F}} \ln \left( {\frac{i}{{i_{o} }}} \right)$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec11"><title>Concentration loss</title><p id="Par54">This voltage drop results from the change in concentration of the reactants at the surface of the electrodes as the fuel is used. The concentration losses for a single cell stack can be given as<sup><xref ref-type="bibr" rid="CR32">32</xref>&#x02013;<xref ref-type="bibr" rid="CR35">35</xref></sup>:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{conc} = N \;m\;\exp (n I_{fc} )$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par55">Significant at higher currents (at the end of V&#x02013;I characteristics of the PEM fuel cell).</p><p id="Par56">Hence, the actual output voltage of PEM fuel cell at normal operating conditions<sup><xref ref-type="bibr" rid="CR32">32</xref>&#x02013;<xref ref-type="bibr" rid="CR35">35</xref></sup>:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M16">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{Cell} = E - V_{ohmic} - V_{act} - V_{conc}$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par57"><italic>E</italic> is the Nernst instantaneous voltage. A fuel cell stack consists of several cells in series to increase the voltage from fuel cell. In the following equation, <inline-formula id="IEq16"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N_{cell}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq16.gif"/></alternatives></inline-formula> is the number of cells in series. Fuel cell stack voltage was described by:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M18">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{stack} = N_{cell} \cdot V_{Cell}$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par58">The PEMFC is proposed in this research that presented in Table <xref rid="Tab4" ref-type="table">4</xref>.</p><p id="Par59">The design parameters used for the simulation purposes have been presented in<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p><p id="Par60">The polarization curve test is one of the key testing techniques for fuel cells to check simulation modelling and experimental test results. Figure&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref> shows the polarization curve measured directly after the dynamic load cycle. The complete shared dataset is available on the Mendeley data repository<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>. This figure shows that the developed and used simulated model fits exactly with experimental tests and confirms the simulation model used in FCHEV (Table <xref rid="Tab5" ref-type="table">5</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Model verification: Fuel cell polarization curve and experimental evaluation and datasets<sup><xref ref-type="bibr" rid="CR36">36</xref></sup>.</p></caption><graphic xlink:href="41598_2024_81769_Fig5_HTML" id="d33e1232"/></fig><table-wrap id="Tab5"><label>Table 5</label><caption><p>PEMFC specifications<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Parameter</th><th align="left">Value</th></tr></thead><tbody><tr><td align="left">Maximal stack power (W)</td><td align="left">35&#x000a0;kW</td></tr><tr><td align="left">Nominal voltage (V)</td><td align="left">350&#x000a0;V</td></tr><tr><td align="left">Nominal current (A)</td><td align="left">250&#x000a0;A</td></tr><tr><td align="left">Number of cells</td><td align="left">400</td></tr></tbody></table></table-wrap></p></sec></sec><sec id="Sec12"><title>Battery model</title><p id="Par61">Kirchhoff voltage law and Kirchhoff current law can be used to obtain the state-space equation of the Thevenin model, as shown in Eq.&#x000a0;(<xref rid="Equ8" ref-type="disp-formula">8</xref>). Figure&#x000a0;<xref rid="Fig6" ref-type="fig">6</xref><sup><xref ref-type="bibr" rid="CR3">3</xref></sup> displays the corresponding Thevenin-based electrical model of the Li-ion battery cells utilized in this article. The following equations show the Kirchhoff voltage law and Kirchhoff current law. Equation&#x000a0;(<xref rid="Equ8" ref-type="disp-formula">8</xref>) can be used to obtain the state-space equation.<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} &#x00026; \dot{V}_{cp} = \frac{{I_{Bat} }}{{C_{p} }} - \frac{{V_{cp} }}{{R_{p } C_{p} }} \\ &#x00026; V_{Bat} = V_{ocv}^{Bat} - R_{p} \cdot C_{p } \cdot \frac{{dV_{cp} }}{dt} - I_{Bat} \cdot R_{series } \\ \end{aligned}$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula><fig id="Fig6"><label>Fig. 6</label><caption><p>Equivalent Thevenin battery model<sup><xref ref-type="bibr" rid="CR5">5</xref></sup>.</p></caption><graphic xlink:href="41598_2024_81769_Fig6_HTML" id="d33e1306"/></fig></p><p id="Par62">The Li-ion battery pack output voltage is shown in Fig.&#x000a0;<xref rid="Fig5" ref-type="fig">5</xref>, and the Li-ion battery pack characteristics are listed in Table <xref rid="Tab6" ref-type="table">6</xref>.<table-wrap id="Tab6"><label>Table 6</label><caption><p>Li-ion battery pack specifications<sup><xref ref-type="bibr" rid="CR37">37</xref></sup>.</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left">Rated voltage</td><td align="left">115&#x000a0;V</td></tr><tr><td align="left">Rated capacity</td><td align="left">4.4&#x000a0;Ah</td></tr><tr><td align="left">Number of cells</td><td align="left">32</td></tr><tr><td align="left">Power</td><td align="left">15&#x000a0;kW</td></tr></tbody></table></table-wrap></p></sec><sec id="Sec13"><title>Ultracapacitor model</title><p id="Par63">Ultracapacitors are electrical storage devices that present power density and high-power output. Their power density can be approximately 100 times higher than conventional capacitors and up to 10 times higher than batteries. High-power ultracapacitors may be charged and drained in 60 to 120&#x000a0;s on average, whereas high-power batteries take 10 to 15&#x000a0;min to charge and discharge. The classical equivalent circuit of the UC unit, shown in Fig.&#x000a0;<xref rid="Fig7" ref-type="fig">7</xref>, consists of:<list list-type="order"><list-item><p id="Par64"><italic>C:</italic> Capacitor.</p></list-item><list-item><p id="Par65"><italic>ESR:</italic> An equivalent series resistance representing the charging and discharging resistance.</p></list-item><list-item><p id="Par66"><italic>EPR:</italic> An equivalent parallel resistance representing the self-discharging losses.</p></list-item></list><fig id="Fig7"><label>Fig. 7</label><caption><p>UC circuit diagram.</p></caption><graphic xlink:href="41598_2024_81769_Fig7_HTML" id="d33e1384"/></fig></p><p id="Par67">The highest power demand for the cycle is 50&#x000a0;kW. Therefore, a 35&#x000a0;kW FC system and a 15&#x000a0;kW battery bank are appropriate for our design. The baseload power supplied by FC system ensures that the membrane is not subjected to sharp peak loads, thus increasing the lifetime of the FC system. This model is selected based on the ultracapacitor 48&#x000a0;V&#x02013;165F produced by BMOD0165 P048. The following parameters were used to start the UC bank design, and UC specifications are presented in Table <xref rid="Tab7" ref-type="table">7</xref>.<table-wrap id="Tab7"><label>Table 7</label><caption><p>Ultracapacitor module specifications.</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left">Rated voltage</td><td align="left">48&#x000a0;V</td></tr><tr><td align="left">Rated capacitance</td><td align="left">165 F</td></tr><tr><td align="left">Number of cells</td><td align="left">18</td></tr><tr><td align="left">Maximum equivalent series resistance (ESR)</td><td align="left">6.3&#x000a0;m&#x02126;</td></tr><tr><td align="left">Absolute maximum current</td><td align="left">1900&#x000a0;A</td></tr><tr><td align="left">Capacitance of individual cell</td><td align="left">3000&#x000a0;F</td></tr></tbody></table></table-wrap></p><p id="Par68">Table <xref rid="Tab8" ref-type="table">8</xref> also shows the parameters of UC power calculation.<table-wrap id="Tab8"><label>Table 8</label><caption><p>UC power calculation.</p></caption><table frame="hsides" rules="groups"><tbody><tr><td align="left">dt</td><td align="left">Time of discharge</td><td align="left">10&#x000a0;s</td></tr><tr><td align="left">Vmax</td><td align="left">Maximum terminal voltage</td><td align="left">432&#x000a0;V</td></tr><tr><td align="left">Vmin</td><td align="left">Minimum terminal voltage</td><td align="left">48&#x000a0;V</td></tr><tr><td align="left">Vw</td><td align="left">Operating terminal voltage</td><td align="left">240&#x000a0;V</td></tr><tr><td align="left">P</td><td align="left">Power rating</td><td align="left">20&#x000a0;kW</td></tr></tbody></table></table-wrap></p><p id="Par69">The average current (<inline-formula id="IEq17"><alternatives><tex-math id="M20">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{avg}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq17.gif"/></alternatives></inline-formula>) to be supplied by the UC bank is the average of the maximum (<inline-formula id="IEq18"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{\max }$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq18.gif"/></alternatives></inline-formula>) and minimum (<inline-formula id="IEq19"><alternatives><tex-math id="M22">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{min}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq19.gif"/></alternatives></inline-formula>) current demands from the UC bank.<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{max} = \frac{P}{{V_{min} }} = \frac{20{,}000}{{48}} = 416.6\;{\text{A}}$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M24">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{min} = \frac{P}{{V_{max} }} = \frac{20{,}000}{{432}} = 46.29\;{\text{A}}$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{avg} = \frac{416.6 + 46.29}{2} = 231.44\;{\text{A}}$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par70">Total capacitance (<inline-formula id="IEq20"><alternatives><tex-math id="M26">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{{UC{ - }total}}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq20.gif"/></alternatives></inline-formula>) is calculated in the following and where <inline-formula id="IEq21"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{p}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq21.gif"/></alternatives></inline-formula> is the number of parallel capacitors and <inline-formula id="IEq22"><alternatives><tex-math id="M28">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n_{s}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq22.gif"/></alternatives></inline-formula> is the number of series capacitors and <inline-formula id="IEq23"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{{UC{ - }total}}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq23.gif"/></alternatives></inline-formula> is the total resistance of the UC.<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M30">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{UC - total} = C . \frac{{n_{p} }}{{n_{s} }}$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ13"><label>13</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{{UC{ - }total}} = 165 . \frac{2}{9} = 36.67 F$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ14"><label>14</label><alternatives><tex-math id="M32">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{{UC{ - }total}} = ESR . \frac{{n_{s} }}{{n_{p} }}$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{{UC{ - }total}} = 6.3 *(10^{ - 3} )*\frac{2}{9} = 1.4*(10^{ - 3} )$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par71">The allowable voltage drop in the proposed design is expressed in Eq.&#x000a0;(<xref rid="Equ16" ref-type="disp-formula">16</xref>) and total voltage drop <inline-formula id="IEq24"><alternatives><tex-math id="M34">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dV_{total}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq24.gif"/></alternatives></inline-formula> of the UC bank is the sum of the voltage drop due to the capacitive and resistive components<sup><xref ref-type="bibr" rid="CR38">38</xref></sup>:<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$dV_{total} = Vw - Vmin = 240 - 48 = 192 V$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M36">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{gathered} dV_{total} = i_{avg} \cdot \frac{dt}{C} + R \cdot i_{avg} \hfill \\ dV_{total} = 231.44 \cdot \frac{10}{{36.67}} + 1.4*(10^{ - 3} )*231.44 = 63.5\;{\text{V}} \hfill \\ \end{gathered}$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula></p></sec></sec><sec id="Sec14"><title>Energy management strategy three RL loops and high level supervisory fuzzy control</title><p id="Par72">The control strategy structure for HESS based on the Battery and UC/FC comprises two levels.</p><p id="Par73">The Energy Management strategy in EVs or FCEVs has a cascade with a two-layer control strategy and two different control layers. The first layer is a High-level supervisory control for power sharing, and the second is a low-level control strategy for switching power switches. These control layers aim to decrease fuel cell current stress and consider fuel cell ageing. A diagram of the overall solution procedure is drawn in Fig.&#x000a0;<xref rid="Fig8" ref-type="fig">8</xref> to illustrate the solution clearly.<fig id="Fig8"><label>Fig. 8</label><caption><p>Overall solution procedure diagram of the proposed method.</p></caption><graphic xlink:href="41598_2024_81769_Fig8_HTML" id="d33e1610"/></fig></p><sec id="Sec15"><title>High-level supervisory control</title><p id="Par74">These scops aim to decrease fuel cell current stress and consider fuel cell ageing. The proposed method will suggest a more robust, accurate, and precise system alongside uncertainties and disturbances in the EMS of FCHEVs. There is a main category rule-based in high-level supervisory control. An energy management system categorization is shown in Fig.&#x000a0;<xref rid="Fig9" ref-type="fig">9</xref>. In the rule-based energy management system, power-sharing was determined by a set of predefined rules or look-up tables.<fig id="Fig9"><label>Fig. 9</label><caption><p>Schematic diagram of the high-level supervisory control for EMS.</p></caption><graphic xlink:href="41598_2024_81769_Fig9_HTML" id="d33e1624"/></fig></p><p id="Par75">The energy management system uses the Mamdani inference structure with three input parameters and one output parameter that are vital to the energy management strategy.<list list-type="order"><list-item><p id="Par76"> The demand power is an important parameter for driving, which determines the output power of HESS.</p></list-item><list-item><p id="Par77">Battery State of Charge (SoC<sub>bat</sub>) determines the endurance mileage of electric vehicles.</p></list-item><list-item><p id="Par78">Ultracapacitor SoC (SoC<sub>UC</sub>) determines the instantaneous acceleration ability and climbing ability of electric vehicles.</p></list-item></list></p><p id="Par79">The fuzzy linguistic values (Table <xref rid="Tab9" ref-type="table">9</xref>) and the input and output variables and membership functions are shown in Fig.&#x000a0;<xref rid="Fig10" ref-type="fig">10</xref>. Therefore, the final fuzzy rule base, depending on the driver&#x02019;s experience and expert experience, is shown in Table <xref rid="Tab10" ref-type="table">10</xref>. The rules are categorized into 45 different cases based on the defined limits for SoC<sub>bat</sub> and SoC<sub>UC</sub> and P<sub>demand</sub>.<table-wrap id="Tab9"><label>Table 9</label><caption><p>Linguistic variables.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Variable</th><th align="left">Fuzzy linguistic variables</th><th align="left">Fuzzy range</th></tr></thead><tbody><tr><td align="left">P<sub>demand</sub></td><td align="left">NB, N, ZE, P, PB</td><td align="left">[&#x02212;&#x02009;2000, 2000]</td></tr><tr><td align="left">SoC<sub>bat</sub></td><td align="left">L, M, H</td><td align="left">[0, 1]</td></tr><tr><td align="left">SoC<sub>uc</sub></td><td align="left">L, M, H</td><td align="left">[0, 1]</td></tr><tr><td align="left">P*<sub>bat</sub></td><td align="left">VL, ML, ME, MB, PB</td><td align="left">[0, 2000]</td></tr></tbody></table></table-wrap><fig id="Fig10"><label>Fig. 10</label><caption><p>Fuzzy membership functions.</p></caption><graphic xlink:href="41598_2024_81769_Fig10_HTML" id="d33e1725"/></fig><table-wrap id="Tab10"><label>Table 10</label><caption><p>Fuzzy rule bases.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">P<sub>demand</sub></th><th align="left" colspan="3">SoC<sub>uc</sub> (L) and SoC<sub>bat</sub></th><th align="left" colspan="3">SoCuc(M) and SoCbat</th><th align="left" colspan="3">SoC<sub>uc</sub>(H)and SoC<sub>bat</sub></th></tr><tr><th align="left">L</th><th align="left">M</th><th align="left">H</th><th align="left">L</th><th align="left">M</th><th align="left">H</th><th align="left">L</th><th align="left">M</th><th align="left">H</th></tr></thead><tbody><tr><td align="left">NB</td><td align="left">ML</td><td align="left">VL</td><td align="left">VL</td><td align="left">ME</td><td align="left">ML</td><td align="left">VL</td><td align="left">PB</td><td align="left">PB</td><td align="left">ME</td></tr><tr><td align="left">N</td><td align="left">ML</td><td align="left">VL</td><td align="left">VL</td><td align="left">VL</td><td align="left">ML</td><td align="left">VL</td><td align="left">ME</td><td align="left">ML</td><td align="left">PB</td></tr><tr><td align="left">ZE</td><td align="left">VL</td><td align="left">VL</td><td align="left">VL</td><td align="left">VL</td><td align="left">VL</td><td align="left">VL</td><td align="left">VL</td><td align="left">VL</td><td align="left">VL</td></tr><tr><td align="left">P</td><td align="left">ML</td><td align="left">PB</td><td align="left">PB</td><td align="left">VL</td><td align="left">ML</td><td align="left">ME</td><td align="left">VL</td><td align="left">VL</td><td align="left">ML</td></tr><tr><td align="left">PB</td><td align="left">ME</td><td align="left">PB</td><td align="left">PB</td><td align="left">VL</td><td align="left">ME</td><td align="left">MB</td><td align="left">VL</td><td align="left">ML</td><td align="left">ME</td></tr></tbody></table></table-wrap></p><p id="Par80">Input and output fuzzy variables based on linguistics are presented in the following:</p><p id="Par81">
<bold>Load demand power (P</bold>
<sub><bold>demand</bold></sub>
<bold>) as an input:</bold>
</p><p id="Par82">NB (Negative Big), N (Negative), ZE (Zero), P (Positive), and PB (Positive Big).</p><p id="Par83">
<bold>SoC as an input:</bold>
</p><p id="Par84">L (Low), M (Medium), H (High).</p><p id="Par85">
<bold>Fuel cell and battery required power (P*</bold>
<sub><bold>FC</bold></sub>
<bold> and P*</bold>
<sub><bold>bat</bold></sub>
<bold>):</bold>
</p><p id="Par86">VL (Very Low), ML (Medium low), ME (Medium), MB (Medium Big), and PB (Positive Big).</p></sec><sec id="Sec16"><title>Low-level local control</title><p id="Par87">Generally, the energy management problem in the form of RL is represented as a Markov decision process (MDP). The MDP is a mechanism that provides agents to learn and interact with their environment to achieve specific goals, known in the following:<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$MDP = \, (S,\;A,\;R,\;P)$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par88">Where <italic>S</italic> presents the state and the state vector are:<disp-formula id="Equa"><alternatives><tex-math id="M38">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[s_{1} ,\;s_{2} , \ldots ,\;s_{n} ].$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par89"><italic>n</italic> means the dimension of the state space.</p><p id="Par90"><italic>A</italic> shows the action set, which includes the sequence of action vectors [<italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>, &#x02026; , <italic>a</italic><sub><italic>k</italic></sub>].</p><p id="Par91"><italic>k</italic> is the dimension of the action space. <italic>R</italic> is the reward function, and <italic>P</italic> presents the dynamic transition probability of the environment.</p><p id="Par92">The TD3 agent is presented, and the training settings are explained. After training, the trained policy obtained from the TD3 agent is used in low-level control in the EMS. Figure&#x000a0;<xref rid="Fig11" ref-type="fig">11</xref> displays an overview of the TD3-based energy management for the fuel cell hybrid electric vehicle.<fig id="Fig11"><label>Fig. 11</label><caption><p>TD3-based low-level energy management for the fuel cell hybrid electric vehicle.</p></caption><graphic xlink:href="41598_2024_81769_Fig11_HTML" id="d33e1995"/></fig></p><p id="Par93">Regarding the current state <italic>s</italic> of the environment, the agent does an action <italic>a</italic> that follows a policy for the environment. The agent <italic>r</italic> takes a reward <italic>r</italic> for acting and a new state <italic>s</italic>&#x02019; from the environment. Based on this feedback, the agent updates the policy. The target is to find the policy <italic>&#x003c0;</italic> to maximize the action-value function.</p><p id="Par94">The Q function is known as future discount rewards are given as follows:<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q(s,a) = {\mathbb{E}}\left[ {\mathop \sum \limits_{k = 0}^{T} \gamma^{k} r_{k} (s,a)} \right]$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>where <italic>&#x003b3;</italic> is the discount factor.</p><sec id="Sec17"><title>TD3-based energy management strategy</title><p id="Par95">As in the DRL configuration shown in Fig.&#x000a0;<xref rid="Fig12" ref-type="fig">12</xref>, the training environment includes the powertrain system with three TD3-based agents. The settings of agent actions, environment states, and rewards are critical to the interaction and learning of the agent.<fig id="Fig12"><label>Fig. 12</label><caption><p>Layout of the proposed methodology-DRL configuration.</p></caption><graphic xlink:href="41598_2024_81769_Fig12_HTML" id="d33e2042"/></fig></p></sec><sec id="Sec18"><title>TD3-based agent actions</title><p id="Par96">The agent controls the output power of the battery/fuel cell/UC and regulate powers. Thus, the desired fuel cell power is a direct control input to the environment, where the fuel cell system is automatically controlled by a boost DC-DC converter to achieve the desired power output. The battery system in a closed-loop system is controlled by two Bi-directional DC-DC converters to achieve the desired power outputs are defined as:<disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M40">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a_{1} = \left[ {P_{fc} } \right];\;a_{2} = \left[ {P_{bat} } \right];\;a_{3} = \left[ {P_{UC} } \right]$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec19"><title>Environment states</title><p id="Par97">The agents need appropriate state information to manage the power precisely. Error 1 represents the error of the difference between the reference fuel cell power (P<sub>fc</sub>) and the measured fuel cell power. Error 2 mentions the error of the difference between the reference battery power (P<sub>bat</sub>) and the measured battery power. Where Error 3 shows the error of the difference between the reference UC power (P<sub>UC</sub>) and the measured UC power. Thus, the states of the environment are set to be:<disp-formula id="Equz"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s= [Error\; 1,\;\; Error\; 2,\;\; Error\; 3].$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equz.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec20"><title>Rewards</title><p id="Par99">The reward setting is crucial because the reward provides feedback to the agent on the effectiveness of the action and strongly affects the success of the training convergence.</p><p id="Par100">The RL agent&#x02019;s reward function (<xref rid="Equ21" ref-type="disp-formula">21</xref>) is the negative of the LQG criterion cost, as represented in Eq.&#x000a0;(<xref rid="Equ23" ref-type="disp-formula">23</xref>). The RL agent maximizes this reward, thus minimizing the LQG cost.</p><p id="Par101">In this work, the input weighting allows to maintain the desired power while minimizing the control effort <italic>u</italic>. The controllers in one closed-loop system are used the following criterion; also, there are three closed-loop structures in this research:<disp-formula id="Equ21"><label>21</label><alternatives><tex-math id="M42">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{Re}} wards = - \left( {\left( {P_{fc}^{*} \left( t \right) - P_{m} \left( t \right)} \right)^{2} + W*u^{2} \left( t \right)} \right)$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ21.gif" position="anchor"/></alternatives></disp-formula>where: <italic>W</italic>: Input weighting, <italic>u(t)</italic>: Control time-varying action signal.<disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J = \mathop {\lim }\limits_{T \to \infty } E\left( {\frac{1}{T}\mathop \smallint \limits_{T0}^{Tf} \left( {\left( {P_{fc}^{*} \left( t \right) - P_{m} \left( t \right)} \right)^{2} + W*u^{2} \left( t \right)} \right) \cdot dt} \right)$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec21"><title>Training settings</title><p id="Par102">For the proposed TD3-based energy management system, a training procedure should be performed before testing. The settings for training the TD3-agent are summarized in Table <xref rid="Tab11" ref-type="table">11</xref>.<table-wrap id="Tab11"><label>Table 11</label><caption><p>TD3 agent settings for training.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Networks and parameters</th><th align="left">Settings and values</th></tr></thead><tbody><tr><td align="left">Actor networks</td><td align="left">Fully connected layers 400/200/100 units</td></tr><tr><td align="left">Actor learning rate</td><td align="left">1e&#x02212;3</td></tr><tr><td align="left">Critic networks</td><td align="left">Fully connected layers 400/200/100 units</td></tr><tr><td align="left">Critic learning rate</td><td align="left">1e&#x02212;3</td></tr><tr><td align="left">Optimizer type Adam</td><td align="left">Adam</td></tr><tr><td align="left">Batch size</td><td align="left">128</td></tr><tr><td align="left">Delayed policy update iterations</td><td align="left">10</td></tr><tr><td align="left">Discount factor</td><td align="left">0.99</td></tr><tr><td align="left">Exploration policy</td><td align="left"><italic>Variance</italic>&#x02009;=&#x02009;0.1</td></tr></tbody></table></table-wrap></p></sec></sec></sec><sec id="Sec22"><title>Evaluations and results</title><p id="Par103">In this section, the proposed Deep reinforcement learning-based energy management system (DRL-EMS) controller has been verified using varying load conditions under the European Extra Urban Driving Cycle (EUDC) by generating reference current for FC, battery and UC by controlling three converters.</p><p id="Par104">The entire system of FCEV and the proposed algorithms are simulated in MATLAB/Simulink<sup>&#x000ae;</sup>(2023b) software, the sampling size is 1e&#x02212;4, solver type is the variable step of ode23tb (stiff/TR-BDF2).</p><p id="Par105">A proposed controller is designed to share the energy between the battery and ultracapacitor, and it is proposed to reduce peak power and prolong the battery life to meet SoC of the battery and ultracapacitor constraint by optimizing the parameters of the fuzzy membership functions.</p><p id="Par106">
<bold>EUDC test</bold>
</p><p id="Par107">Figures&#x000a0;<xref rid="Fig13" ref-type="fig">13</xref> and <xref rid="Fig14" ref-type="fig">14</xref> demonstrate the vehicle&#x02019;s EUDC speed profile and varying load current profile. The vehicle can achieve a maximum speed of 90&#x000a0;km/h. Figure&#x000a0;<xref rid="Fig14" ref-type="fig">14</xref> displays the current profile under varying load current demand from <italic>t</italic>&#x02009;=&#x02009;0&#x000a0;s to <italic>t</italic>&#x02009;=&#x02009;380&#x000a0;s.<fig id="Fig13"><label>Fig. 13</label><caption><p>Varying EUDC speed profile of the vehicle.</p></caption><graphic xlink:href="41598_2024_81769_Fig13_HTML" id="d33e2214"/></fig><fig id="Fig14"><label>Fig. 14</label><caption><p>Varying load current profile used for EV.</p></caption><graphic xlink:href="41598_2024_81769_Fig14_HTML" id="d33e2221"/></fig></p><sec id="Sec23"><title>Comparison of power sharing/current profile tracking in different strategies</title><p id="Par108">The power-sharing of proposed Deep Reinforcement Learning (DRL), and Fuzzy logic supervisory control (DRL-F) is compared to the Super-Twisting algorithm (STW) and Fuzzy logic supervisory control (STW-F) under EUDC driving cycle conditions are shown in Figs.&#x000a0;<xref rid="Fig15" ref-type="fig">15</xref>, <xref rid="Fig16" ref-type="fig">16</xref>, respectively. Figure&#x000a0;<xref rid="Fig14" ref-type="fig">14</xref> demonstrates the current output profile for FCHEV and its reference.<fig id="Fig15"><label>Fig. 15</label><caption><p>Current tracking error of DRL-F and STW-F.</p></caption><graphic xlink:href="41598_2024_81769_Fig15_HTML" id="d33e2241"/></fig><fig id="Fig16"><label>Fig. 16</label><caption><p>Load current tracking by DRL-F and STW-F used for EV.</p></caption><graphic xlink:href="41598_2024_81769_Fig16_HTML" id="d33e2248"/></fig></p><p id="Par109">Super twisting algorithm is a type of sliding mode control which is known as second-order sliding mode control that is supposed by Levant et al.<sup><xref ref-type="bibr" rid="CR39">39</xref></sup> and used in several applications in<sup><xref ref-type="bibr" rid="CR40">40</xref>,<xref ref-type="bibr" rid="CR41">41</xref></sup> that can be written as follows:<disp-formula id="Equ23"><label>23</label><alternatives><tex-math id="M44">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{gathered} u_{STW} = u_{a} + u_{b} \hfill \\ u_{a} = - \lambda \left| s \right|^{\frac{1}{2}} sign(s) \hfill \\ \dot{u}_{b} = - W sign(s) \hfill \\ \end{gathered}$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula></p><p id="Par110">A sliding surface <inline-formula id="IEq25"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( s \right)$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq25.gif"/></alternatives></inline-formula> is defined as the error between the real load current and the reference current.</p><p id="Par111">Controller coefficients such as <inline-formula id="IEq26"><alternatives><tex-math id="M46">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq26.gif"/></alternatives></inline-formula>&#x02009;=&#x02009;300, and <inline-formula id="IEq27"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{W}}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq27.gif"/></alternatives></inline-formula>&#x02009;=&#x02009;100 are calculated to meet the desired objectives such as reducing the chattering.</p><p id="Par112">In Fig.&#x000a0;<xref rid="Fig15" ref-type="fig">15</xref>, the desired current of FCHEV can be observed from <italic>t</italic>&#x02009;=&#x02009;0&#x000a0;s to <italic>t</italic>&#x02009;=&#x02009;380&#x000a0;s as well as the tracking of the desired current by the proposed controller DRL-F can be seen and compared to STW-F. The current tracking error is shown in Fig.&#x000a0;<xref rid="Fig15" ref-type="fig">15</xref> and is very close to zero. However, DRL is direct to zero faster than the STW method. It is obvious in the Zoom picture.</p><p id="Par113">It can be observed that the DRL-F controller tracks the desired reference more accurately and faster, and the errors approach zero, which is a requirement for the system. Some undershoots and overshoots are shown due to load variations, but the overall performance of the proposed algorithms is satisfactory.</p><p id="Par114">Table <xref rid="Tab12" ref-type="table">12</xref> shows the comparison between two strategies (DRL-F, STW-F) under the EUDC driving cycle for the Root Mean Square Error (RMSE), Mean Square error (MSE), and Mean error. Error is defined in the following and it is clear for better operation of DRL-F strategy rather than STW-F.<disp-formula id="Equb"><alternatives><tex-math id="M48">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Error = Desired \, \;output\; \, current{-}Measured \, \;output\; \, current$$\end{document}</tex-math><graphic xlink:href="41598_2024_81769_Article_Equb.gif" position="anchor"/></alternatives></disp-formula><table-wrap id="Tab12"><label>Table 12</label><caption><p>Comparison results for current tracking error.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Driving test</th><th align="left">Control strategy</th><th align="left">Mean error</th><th align="left">Root mean square error</th><th align="left">Mean square error</th></tr></thead><tbody><tr><td align="left">EUDC</td><td align="left">STW-F</td><td align="left">&#x02212;&#x02009;1.7077</td><td align="left">14.3475</td><td align="left">205.8511</td></tr><tr><td align="left">EUDC</td><td align="left">DRL-F</td><td align="left">&#x02212;&#x02009;1.5658</td><td align="left">11.3289</td><td align="left">128.3440</td></tr></tbody></table></table-wrap></p><p id="Par115">Simulation results show that, compared with STW-F EMS, the proposed strategy achieves less Mean Error of power tracking 0.1419 with 8.31%. Less Mean Square Error for DRL-F of 77.59 with 37.65% compared to the STW-F algorithm.</p><p id="Par116">Results in Table <xref rid="Tab12" ref-type="table">12</xref> indicate that the proposed model of DRL-F can ensure the RMSE reduction of 3.0186 for 21.05% compared to the STW-F.</p><p id="Par117">The power-sharing of the proposed DRL-F, and STW-F under EUDC driving cycle conditions are shown in Fig.&#x000a0;<xref rid="Fig16" ref-type="fig">16</xref>. However, the DRL-F proposed method shows accurate tracking of the desired current. However, STW-F, as a robust controller, has lower tracking accuracy in the first times of simulation until below 50&#x000a0;s of power demand. Load current tracking in Fig.&#x000a0;<xref rid="Fig16" ref-type="fig">16</xref> shows that lower tracking accuracy is between 25 to 50&#x000a0;s of STW-F used for EV with high peak and without any power tracking, which is clear in this picture&#x02019;s zoom.</p><p id="Par118">The DRL-F in Fig.&#x000a0;<xref rid="Fig17" ref-type="fig">17</xref> displays that the desired Li-ion battery power can allocate less power than STW-F. STW-F has a big overshoot and peak power in the first times of simulation until below 50&#x000a0;s. When the Battery Current is less than zero (Battery Current&#x02009;&#x0003c;&#x02009;0), the battery goes into the charging mode also, it is in the discharging mode for Battery Current&#x02009;&#x0003e;&#x02009;0, depending on the SoC of the battery and UC.<fig id="Fig17"><label>Fig. 17</label><caption><p>Varying load current profile used for EV.</p></caption><graphic xlink:href="41598_2024_81769_Fig17_HTML" id="d33e2389"/></fig></p><p id="Par119">Also, Fig.&#x000a0;<xref rid="Fig18" ref-type="fig">18</xref> shows the tracking of the PEM fuel cell current desired by DRL and STW-F, in which DRL-F is more precise and faster current tracking rather than STW-F. Desired PEMFC current can be allocated faster in the first second than STW-F. STW-F takes time to achieve the reference fuel cell power. It is shown in the figure that tracking the desired PEMFC current by STW-F in below 50&#x000a0;s does not happen, and there is no tracking below 50&#x000a0;s, which increases inaccuracy and errors in power tracking.<fig id="Fig18"><label>Fig. 18</label><caption><p>Tracking of the PEMFC current desired by DRL and STW-F.</p></caption><graphic xlink:href="41598_2024_81769_Fig18_HTML" id="d33e2401"/></fig></p><p id="Par120">From <italic>t</italic>&#x02009;=&#x02009;120s to <italic>t</italic>&#x02009;=&#x02009;130s the load current is negative (Fig.&#x000a0;<xref rid="Fig14" ref-type="fig">14</xref>), according to the high-level supervisory control of fuzzy and fuzzy rules presented in Table <xref rid="Tab10" ref-type="table">10</xref>, when the current is negative and FCHEV is on regenerative braking mode, and the SoC of battery is low with the SoC of UC is <italic>low</italic>, the FC is low power or idle mode and battery and UC is charged. It is presented in Figs.&#x000a0;<xref rid="Fig16" ref-type="fig">16</xref>, <xref rid="Fig17" ref-type="fig">17</xref>, and <xref rid="Fig18" ref-type="fig">18</xref> from <italic>t</italic>&#x02009;=&#x02009;120 s to <italic>t</italic>&#x02009;=&#x02009;130 s. This confirmed the results obtained, and the effectiveness of the Proposed algorithms can be observed.</p><p id="Par121">Another aspect of the results noted is that less use of batteries in the power-sharing process causes an increase in fuel cell lifetime and battery lifetime, a decrease in energy cost, and a reduction in electricity cost for battery charging. Therefore, both DRL-F and STW-F under EUDC can share the demand power by taking advantage of Ultracapacitors in the HESS. High-level supervisory control and DRL low-level control are proposed for transient power-sharing provided by UC and flat-level power-sharing and low-stress loads delivered by fuel cell and battery to reduce current stress on fuel cell and prevent fuel cell damage and ageing.</p><p id="Par122">The UC power-sharing of the proposed DRL-F under EUDC driving cycle condition is shown in Fig.&#x000a0;<xref rid="Fig19" ref-type="fig">19</xref> and is compared with STW-F, and it is clear that UC delivers transient power.<fig id="Fig19"><label>Fig. 19</label><caption><p>Transient current delivered by UC on load current profile.</p></caption><graphic xlink:href="41598_2024_81769_Fig19_HTML" id="d33e2448"/></fig></p><p id="Par123">It can be noted that when the load current is getting high peaks and transient load currents (from t&#x02009;=&#x02009;20&#x000a0;s to 60&#x000a0;s, 187&#x000a0;s to 200&#x000a0;s, and 250&#x000a0;s to 275&#x000a0;s) UC start discharging to meet the load requirements. There is a reduction in fuel cell and battery usage, the ultracapacitor operates faster than FC and battery throughout the driving cycle; some benefits described as follows:<list list-type="bullet"><list-item><p id="Par124">Increasing accuracy of power tracking</p></list-item><list-item><p id="Par125">The lithium battery&#x02019;s output and peak current reduction, thus gaining fuel cell and battery lifetime.</p></list-item><list-item><p id="Par126">Flat-power sharing is delivered by PEMFC, and battery Fuel cell ageing, and destruction are prevented.</p></list-item><list-item><p id="Par127">Regenerative braking energy across the driving saved in UC in a short time and prevents energy consumption.</p></list-item><list-item><p id="Par128">Facilitate ultracapacitor&#x02019;s charging through regenerative braking mechanisms.</p></list-item></list></p><p id="Par129">Figure&#x000a0;<xref rid="Fig20" ref-type="fig">20</xref> shows the variation range of the Li-ion battery SoC<sub>bat</sub> and Ultracapacitor SoC<sub>UC</sub> optimized by DRL-F. Meanwhile, the terminal SoC<sub>bat</sub> and U SoC<sub>UC</sub> show that the UC charging numbers are higher than the battery charging. It mentions that overall power sharing and transient load current are expanding battery lifetime.<fig id="Fig20"><label>Fig. 20</label><caption><p>Variation range of the Li-ion battery SoC<sub>bat</sub> and Ultracapacitor SoC<sub>UC</sub> under EUDC profile.</p></caption><graphic xlink:href="41598_2024_81769_Fig20_HTML" id="d33e2492"/></fig></p><p id="Par130">PWM switching of SW<sub>4</sub> and SW<sub>5</sub> of UC bi-directional converter on FCHEV is shown in Fig.&#x000a0;<xref rid="Fig21" ref-type="fig">21</xref>, and PWM signals in buck mode and boost modes are shown and signals are placed under each other, and it is obvious that signals cover each other in each mode (Buck-Boost) as a bi-directional converter.<fig id="Fig21"><label>Fig. 21</label><caption><p>PWM switching&#x02019;s of SW<sub>4</sub> and SW<sub>5</sub> of bi-directional converter on FCHEV.</p></caption><graphic xlink:href="41598_2024_81769_Fig21_HTML" id="d33e2513"/></fig></p></sec></sec><sec id="Sec24"><title>Conclusion</title><p id="Par131">In this research, hydrogen-based electric vehicle-PEMFC electric vehicles have been studied. PEM fuel cell was a main source and a hybrid energy storage system, including a battery and an Ultra-capacitor. The combination of reinforcement learning algorithms in low-level control loops and high-level supervisory control based on fuzzy logic load sharing was designed for FCHEV.</p><p id="Par132">A powertrain system for FCHEV was implemented with three DC-DC converters, two bi-directional and one boost converter. A hierarchical energy management framework was employed in a two-layer control strategy. Three loop control strategies based on reinforcement learning were designed to improve FC and battery power-sharing tracking in the low-level layer control strategy.</p><p id="Par133">The DRL-F energy management system has been designed to address various performance metrics of energy consumption, fuel cell lifetime, and battery lifetime, as well as the reduction of transient and peak current on PEMFC and Li-ion batteries. Deep reinforcement learning control was used, and three DRL-PID controllers were designed using the hierarchical energy optimization control architecture. Finally, the performance of the obtained controller was compared with a sliding mode super-twisting algorithm. The proposed method suggested a more robust, accurate and precise system alongside uncertainties and disturbances in EMS of FCHEVs with an advanced learning method.</p><p id="Par134">This paper proposed a novel energy management method to improve the lifetime of fuel cells and batteries because the UC is faced with transient and peak current demands, and it can save batteries and fuel cells for any peak transient demands. In future research, we will develop a new method, deep learning, to measure the lifetime of fuel cells. The lifetime of fuel cells will be measured online using AI approaches.</p></sec></body><back><glossary><title>Abbreviations</title><def-list><def-item><term>HESS</term><def><p id="Par2">Hybrid energy storage system</p></def></def-item><def-item><term>EMS</term><def><p id="Par3">Energy management strategy</p></def></def-item><def-item><term>UC</term><def><p id="Par4">Ultracapacitor</p></def></def-item><def-item><term>DRL</term><def><p id="Par5">Deep Reinforcement Learning</p></def></def-item><def-item><term>PID-RL</term><def><p id="Par6">PID-Reinforcement Learning</p></def></def-item><def-item><term>DDPG-TD3</term><def><p id="Par7">Deep Deterministic Policy Gradient with Twin Delayed</p></def></def-item><def-item><term>EUDC</term><def><p id="Par8">Extra-urban driving cycle</p></def></def-item><def-item><term>SoC<sub>UC</sub></term><def><p id="Par9">Ultracapacitor state of charge</p></def></def-item><def-item><term>SoC<sub>bat</sub></term><def><p id="Par10">Battery state of charge</p></def></def-item><def-item><term>Voc</term><def><p id="Par11">Open-circuit voltage</p></def></def-item><def-item><term><inline-formula id="IEq1"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{series }$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq1.gif"/></alternatives></inline-formula></term><def><p id="Par12">DC battery series resistance</p></def></def-item><def-item><term><inline-formula id="IEq2"><alternatives><tex-math id="M50">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{Bat}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq2.gif"/></alternatives></inline-formula></term><def><p id="Par13">Battery current</p></def></def-item><def-item><term><inline-formula id="IEq3"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{UC}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq3.gif"/></alternatives></inline-formula></term><def><p id="Par14">Ultracapacitor current</p></def></def-item><def-item><term><inline-formula id="IEq4"><alternatives><tex-math id="M52">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{UC }$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq4.gif"/></alternatives></inline-formula></term><def><p id="Par15">Ultracapacitor internal resistance</p></def></def-item><def-item><term><inline-formula id="IEq5"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{UC}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq5.gif"/></alternatives></inline-formula></term><def><p id="Par16">Ultracapacitor capacitance</p></def></def-item><def-item><term><inline-formula id="IEq6"><alternatives><tex-math id="M54">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{UC}^{oc}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq6.gif"/></alternatives></inline-formula></term><def><p id="Par17">Ultracapacitor open-circuit voltage</p></def></def-item><def-item><term><inline-formula id="IEq7"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{Bat}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq7.gif"/></alternatives></inline-formula></term><def><p id="Par18">Battery current</p></def></def-item><def-item><term>RMSE </term><def><p id="Par19">Root-mean-square error</p></def></def-item><def-item><term><inline-formula id="IEq8"><alternatives><tex-math id="M56">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C_{p}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq8.gif"/></alternatives></inline-formula></term><def><p id="Par20">Polarisation capacitance</p></def></def-item><def-item><term><inline-formula id="IEq9"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{p}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq9.gif"/></alternatives></inline-formula></term><def><p id="Par21">Polarisation internal resistance</p></def></def-item><def-item><term><inline-formula id="IEq10"><alternatives><tex-math id="M58">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{Bat}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq10.gif"/></alternatives></inline-formula></term><def><p id="Par22">Battery terminal voltage</p></def></def-item><def-item><term><inline-formula id="IEq11"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{R}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq11.gif"/></alternatives></inline-formula></term><def><p id="Par23">Battery partial voltage of resistance&#x02013;capacitance network</p></def></def-item><def-item><term><inline-formula id="IEq12"><alternatives><tex-math id="M60">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{ocv}^{Bat}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq12.gif"/></alternatives></inline-formula></term><def><p id="Par24">Battery open-circuit voltage</p></def></def-item><def-item><term><inline-formula id="IEq13"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$R_{series }$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq13.gif"/></alternatives></inline-formula></term><def><p id="Par25">DC internal resistance</p></def></def-item><def-item><term><inline-formula id="IEq14"><alternatives><tex-math id="M62">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{req}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq14.gif"/></alternatives></inline-formula></term><def><p id="Par26">Demand for power</p></def></def-item><def-item><term><inline-formula id="IEq15"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$V_{cp}$$\end{document}</tex-math><inline-graphic xlink:href="41598_2024_81769_Article_IEq15.gif"/></alternatives></inline-formula></term><def><p id="Par27">Capacitor voltage</p></def></def-item></def-list></glossary><fn-group><fn><p><bold>Publisher&#x02019;s note</bold></p><p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p></fn></fn-group><notes notes-type="author-contribution"><title>Author contributions</title><p>Contribution of Seyed Mehdi Rakhtala Rostami: Ideation; design, modelling and simulation; and first draft writing.Contribution of Zeyad Al-Shibaany: Review the design, modelling and simulation; First draft writing; reviewing, editing and proofreading the final draft. Contribution of Peter Kay: First draft writing; reviewing, editing and proofreading the final draft. Contribution of Hamid Reza Karimi: Review the design, modelling and simulation; First draft writing; reviewing, editing and proofreading the final draft.</p></notes><notes notes-type="data-availability"><title>Data availability</title><p>Some or all data, models, or codes that support the findings of this study are available from the corresponding author upon reasonable request.</p></notes><notes><title>Declarations</title><notes id="FPar1" notes-type="COI-statement"><title>Competing interests</title><p id="Par170">The authors declare no competing interests.</p></notes></notes><ref-list id="Bib1"><title>References</title><ref id="CR1"><label>1.</label><citation-alternatives><element-citation id="ec-CR1" publication-type="journal"><person-group person-group-type="author"><name><surname>Sun</surname><given-names>H</given-names></name><name><surname>Zhumu</surname><given-names>Fu</given-names></name><name><surname>Tao</surname><given-names>F</given-names></name><name><surname>Zhu</surname><given-names>L</given-names></name><name><surname>Si</surname><given-names>P</given-names></name></person-group><article-title>Data-driven reinforcement-learning-based hierarchical energy management strategy for fuel cell/battery/ultracapacitor hybrid electric vehicles</article-title><source>J. Power Sources</source><year>2020</year><volume>455</volume><fpage>227964</fpage><pub-id pub-id-type="doi">10.1016/j.jpowsour.2020.227964</pub-id></element-citation><mixed-citation id="mc-CR1" publication-type="journal">Sun, H., Zhumu, Fu., Tao, F., Zhu, L. &#x00026; Si, P. Data-driven reinforcement-learning-based hierarchical energy management strategy for fuel cell/battery/ultracapacitor hybrid electric vehicles. <italic>J. Power Sources</italic><bold>455</bold>, 227964 (2020).</mixed-citation></citation-alternatives></ref><ref id="CR2"><label>2.</label><citation-alternatives><element-citation id="ec-CR2" publication-type="journal"><person-group person-group-type="author"><name><surname>Salari</surname><given-names>O</given-names></name><name><surname>Hashtrudi-Zaad</surname><given-names>K</given-names></name><name><surname>Bakhshai</surname><given-names>A</given-names></name><name><surname>Youssef</surname><given-names>MZ</given-names></name><name><surname>Jain</surname><given-names>P</given-names></name></person-group><article-title>A systematic approach for the design of the digital low-pass filters for energy storage systems in EV applications</article-title><source>IEEE J. Emerg. Sel. Top. Ind. Electron.</source><year>2020</year><volume>1</volume><issue>1</issue><fpage>67</fpage><lpage>79</lpage><pub-id pub-id-type="doi">10.1109/JESTIE.2020.2999508</pub-id></element-citation><mixed-citation id="mc-CR2" publication-type="journal">Salari, O., Hashtrudi-Zaad, K., Bakhshai, A., Youssef, M. Z. &#x00026; Jain, P. A systematic approach for the design of the digital low-pass filters for energy storage systems in EV applications. <italic>IEEE J. Emerg. Sel. Top. Ind. Electron.</italic><bold>1</bold>(1), 67&#x02013;79 (2020).</mixed-citation></citation-alternatives></ref><ref id="CR3"><label>3.</label><citation-alternatives><element-citation id="ec-CR3" publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>C</given-names></name><name><surname>Liu</surname><given-names>R</given-names></name><name><surname>Tang</surname><given-names>A</given-names></name></person-group><article-title>Energy management strategy of hybrid energy storage system for electric vehicles based on genetic algorithm optimization and temperature effect</article-title><source>J. Energy Storage</source><year>2022</year><volume>51</volume><fpage>104314</fpage><pub-id pub-id-type="doi">10.1016/j.est.2022.104314</pub-id></element-citation><mixed-citation id="mc-CR3" publication-type="journal">Wang, C., Liu, R. &#x00026; Tang, A. Energy management strategy of hybrid energy storage system for electric vehicles based on genetic algorithm optimization and temperature effect. <italic>J. Energy Storage</italic><bold>51</bold>, 104314 (2022).</mixed-citation></citation-alternatives></ref><ref id="CR4"><label>4.</label><citation-alternatives><element-citation id="ec-CR4" publication-type="journal"><person-group person-group-type="author"><name><surname>Dawei</surname><given-names>M</given-names></name><name><surname>Yu</surname><given-names>Z</given-names></name></person-group><article-title>Intelligent fuzzy energy management research for a uniaxial parallel hybrid electric vehicle</article-title><source>Comput. Electr. Eng.</source><year>2017</year><volume>58</volume><fpage>447</fpage><lpage>464</lpage><pub-id pub-id-type="doi">10.1016/j.compeleceng.2016.03.014</pub-id></element-citation><mixed-citation id="mc-CR4" publication-type="journal">Dawei, M. &#x00026; Yu, Z. Intelligent fuzzy energy management research for a uniaxial parallel hybrid electric vehicle. <italic>Comput. Electr. Eng.</italic><bold>58</bold>, 447&#x02013;464 (2017).</mixed-citation></citation-alternatives></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="other">Department of Energy US. Fuel Economy (2015).</mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="other">The Future of Nissan SUVs is Electric (2015).</mixed-citation></ref><ref id="CR7"><label>7.</label><mixed-citation publication-type="other">Hyundai ix35 FUEL CELL (Hyundai Motor Company, 2015).</mixed-citation></ref><ref id="CR8"><label>8.</label><mixed-citation publication-type="other">Toyota FCHV Hydrogen Hybrid Vehicle (2016).</mixed-citation></ref><ref id="CR9"><label>9.</label><mixed-citation publication-type="other">Kia Borrego FCEV (2015).</mixed-citation></ref><ref id="CR10"><label>10.</label><citation-alternatives><element-citation id="ec-CR10" publication-type="journal"><person-group person-group-type="author"><name><surname>Cha</surname><given-names>M</given-names></name><name><surname>Enshaei</surname><given-names>H</given-names></name><name><surname>Nguyen</surname><given-names>H</given-names></name><name><surname>Jayasinghe</surname><given-names>SG</given-names></name></person-group><article-title>Towards a future electric ferry using optimization-based power management strategy in fuel cell and battery vehicle application&#x02014;A review</article-title><source>Renew. Sustain. Energy Rev.</source><year>2023</year><volume>183</volume><fpage>113470</fpage><pub-id pub-id-type="doi">10.1016/j.rser.2023.113470</pub-id></element-citation><mixed-citation id="mc-CR10" publication-type="journal">Cha, M., Enshaei, H., Nguyen, H. &#x00026; Jayasinghe, S. G. Towards a future electric ferry using optimization-based power management strategy in fuel cell and battery vehicle application&#x02014;A review. <italic>Renew. Sustain. Energy Rev.</italic><bold>183</bold>, 113470 (2023).</mixed-citation></citation-alternatives></ref><ref id="CR11"><label>11.</label><citation-alternatives><element-citation id="ec-CR11" publication-type="journal"><person-group person-group-type="author"><name><surname>Das</surname><given-names>HS</given-names></name><name><surname>Tan</surname><given-names>CW</given-names></name><name><surname>Yatim</surname><given-names>AHM</given-names></name></person-group><article-title>Fuel cell hybrid electric vehicles: a review on power conditioning units and topologies</article-title><source>Renew. Sustain. Energy Rev.</source><year>2017</year><volume>76</volume><fpage>268e91</fpage><pub-id pub-id-type="doi">10.1016/j.rser.2017.03.056</pub-id></element-citation><mixed-citation id="mc-CR11" publication-type="journal">Das, H. S., Tan, C. W. &#x00026; Yatim, A. H. M. Fuel cell hybrid electric vehicles: a review on power conditioning units and topologies. <italic>Renew. Sustain. Energy Rev.</italic><bold>76</bold>, 268e91 (2017).</mixed-citation></citation-alternatives></ref><ref id="CR12"><label>12.</label><citation-alternatives><element-citation id="ec-CR12" publication-type="journal"><person-group person-group-type="author"><name><surname>Hemmati</surname><given-names>R</given-names></name><name><surname>Saboori</surname><given-names>H</given-names></name></person-group><article-title>Emergence of hybrid energy storage systems in renewable energy and transport applications&#x02014;a review</article-title><source>Renew. Sustain. Energy Rev.</source><year>2016</year><volume>65</volume><fpage>11</fpage><lpage>23</lpage><pub-id pub-id-type="doi">10.1016/j.rser.2016.06.029</pub-id></element-citation><mixed-citation id="mc-CR12" publication-type="journal">Hemmati, R. &#x00026; Saboori, H. Emergence of hybrid energy storage systems in renewable energy and transport applications&#x02014;a review. <italic>Renew. Sustain. Energy Rev.</italic><bold>65</bold>, 11&#x02013;23 (2016).</mixed-citation></citation-alternatives></ref><ref id="CR13"><label>13.</label><citation-alternatives><element-citation id="ec-CR13" publication-type="journal"><person-group person-group-type="author"><name><surname>Rezaei</surname><given-names>H</given-names></name><name><surname>Abdollahi</surname><given-names>SE</given-names></name><name><surname>Abdollahi</surname><given-names>SR</given-names></name><name><surname>Filizadeh</surname><given-names>S</given-names></name></person-group><article-title>Energy management strategies of battery-ultracapacitor hybrid storage systems for electric vehicles: Review, challenges, and future trends</article-title><source>J. Energy Storage</source><year>2022</year><volume>53</volume><fpage>105045</fpage><pub-id pub-id-type="doi">10.1016/j.est.2022.105045</pub-id></element-citation><mixed-citation id="mc-CR13" publication-type="journal">Rezaei, H., Abdollahi, S. E., Abdollahi, S. R. &#x00026; Filizadeh, S. Energy management strategies of battery-ultracapacitor hybrid storage systems for electric vehicles: Review, challenges, and future trends. <italic>J. Energy Storage</italic><bold>53</bold>, 105045 (2022).</mixed-citation></citation-alternatives></ref><ref id="CR14"><label>14.</label><mixed-citation publication-type="other">Wang, Y., Sun, Z. &#x00026; Chen, Z. Energy management strategy for battery/supercapacitor/fuel cell hybrid source vehicles based on finite state machine. <italic>Appl. Energy</italic><bold>254</bold> (2019).</mixed-citation></ref><ref id="CR15"><label>15.</label><citation-alternatives><element-citation id="ec-CR15" publication-type="journal"><person-group person-group-type="author"><name><surname>Han</surname><given-names>Y</given-names></name><name><surname>Li</surname><given-names>Q</given-names></name><name><surname>Wang</surname><given-names>T</given-names></name><name><surname>Chen</surname><given-names>W</given-names></name><name><surname>Ma</surname><given-names>L</given-names></name></person-group><article-title>Multisource coordination energy management strategy based on SoC consensus for a PEMFC&#x02013;battery&#x02013;supercapacitor hybrid tramway</article-title><source>IEEE Trans. Veh. Technol.</source><year>2018</year><volume>67</volume><issue>1</issue><fpage>296</fpage><lpage>305</lpage><pub-id pub-id-type="doi">10.1109/TVT.2017.2747135</pub-id></element-citation><mixed-citation id="mc-CR15" publication-type="journal">Han, Y., Li, Q., Wang, T., Chen, W. &#x00026; Ma, L. Multisource coordination energy management strategy based on SoC consensus for a PEMFC&#x02013;battery&#x02013;supercapacitor hybrid tramway. <italic>IEEE Trans. Veh. Technol.</italic><bold>67</bold>(1), 296&#x02013;305 (2018).</mixed-citation></citation-alternatives></ref><ref id="CR16"><label>16.</label><citation-alternatives><element-citation id="ec-CR16" publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>Z</given-names></name><name><surname>Zhu</surname><given-names>L</given-names></name><name><surname>Tao</surname><given-names>F</given-names></name><name><surname>Si</surname><given-names>P</given-names></name><name><surname>Sun</surname><given-names>L</given-names></name></person-group><article-title>Optimization based energy management strategy for fuel cell/battery/ultracapacitor hybrid vehicle considering fuel economy and fuel cell lifespan</article-title><source>Int. J. Hydrog. Energy</source><year>2020</year><volume>45</volume><issue>15</issue><fpage>8875</fpage><lpage>8886</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2020.01.017</pub-id></element-citation><mixed-citation id="mc-CR16" publication-type="journal">Fu, Z., Zhu, L., Tao, F., Si, P. &#x00026; Sun, L. Optimization based energy management strategy for fuel cell/battery/ultracapacitor hybrid vehicle considering fuel economy and fuel cell lifespan. <italic>Int. J. Hydrog. Energy</italic><bold>45</bold>(15), 8875&#x02013;8886 (2020).</mixed-citation></citation-alternatives></ref><ref id="CR17"><label>17.</label><citation-alternatives><element-citation id="ec-CR17" publication-type="journal"><person-group person-group-type="author"><name><surname>Ahmadi</surname><given-names>S</given-names></name><name><surname>Bathaee</surname><given-names>SMT</given-names></name><name><surname>Hosseinpour</surname><given-names>AH</given-names></name></person-group><article-title>Improving fuel economy and performance of a fuel-cell hybrid electric vehicle (fuel-cell, battery, and ultra-capacitor) using optimized energy management strategy</article-title><source>Energy Convers. Manag.</source><year>2018</year><volume>160</volume><fpage>74</fpage><lpage>84</lpage><pub-id pub-id-type="doi">10.1016/j.enconman.2018.01.020</pub-id></element-citation><mixed-citation id="mc-CR17" publication-type="journal">Ahmadi, S., Bathaee, S. M. T. &#x00026; Hosseinpour, A. H. Improving fuel economy and performance of a fuel-cell hybrid electric vehicle (fuel-cell, battery, and ultra-capacitor) using optimized energy management strategy. <italic>Energy Convers. Manag.</italic><bold>160</bold>, 74&#x02013;84 (2018).</mixed-citation></citation-alternatives></ref><ref id="CR18"><label>18.</label><citation-alternatives><element-citation id="ec-CR18" publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>W</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Xu</surname><given-names>L</given-names></name><name><surname>Ouyang</surname><given-names>M</given-names></name></person-group><article-title>Optimization for a fuel cell/battery/capacity tram with equivalent consumption minimization strategy</article-title><source>Energy Convers. Manag.</source><year>2017</year><volume>134</volume><fpage>59</fpage><lpage>69</lpage><pub-id pub-id-type="doi">10.1016/j.enconman.2016.11.007</pub-id></element-citation><mixed-citation id="mc-CR18" publication-type="journal">Zhang, W., Li, J., Xu, L. &#x00026; Ouyang, M. Optimization for a fuel cell/battery/capacity tram with equivalent consumption minimization strategy. <italic>Energy Convers. Manag.</italic><bold>134</bold>, 59&#x02013;69 (2017).</mixed-citation></citation-alternatives></ref><ref id="CR19"><label>19.</label><citation-alternatives><element-citation id="ec-CR19" publication-type="journal"><person-group person-group-type="author"><name><surname>Fu</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>Z</given-names></name><name><surname>Si</surname><given-names>P</given-names></name><name><surname>Tao</surname><given-names>F</given-names></name></person-group><article-title>A hierarchical energy management strategy for fuel cell/battery/supercapacitor hybrid electric vehicles</article-title><source>Int. J. Hydrog. Energy</source><year>2019</year><volume>44</volume><issue>39</issue><fpage>22146</fpage><lpage>22159</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2019.06.158</pub-id></element-citation><mixed-citation id="mc-CR19" publication-type="journal">Fu, Z., Li, Z., Si, P. &#x00026; Tao, F. A hierarchical energy management strategy for fuel cell/battery/supercapacitor hybrid electric vehicles. <italic>Int. J. Hydrog. Energy</italic><bold>44</bold>(39), 22146&#x02013;22159 (2019).</mixed-citation></citation-alternatives></ref><ref id="CR20"><label>20.</label><citation-alternatives><element-citation id="ec-CR20" publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Zou</surname><given-names>C</given-names></name><name><surname>Tang</surname><given-names>X</given-names></name><name><surname>Liu</surname><given-names>T</given-names></name><name><surname>Hu</surname><given-names>L</given-names></name></person-group><article-title>Cost-optimal energy management of hybrid electric vehicles using fuel cell/battery health-aware predictive control</article-title><source>IEEE Trans. Power Electron.</source><year>2020</year><volume>35</volume><issue>1</issue><fpage>382</fpage><lpage>392</lpage><pub-id pub-id-type="doi">10.1109/TPEL.2019.2915675</pub-id></element-citation><mixed-citation id="mc-CR20" publication-type="journal">Hu, X., Zou, C., Tang, X., Liu, T. &#x00026; Hu, L. Cost-optimal energy management of hybrid electric vehicles using fuel cell/battery health-aware predictive control. <italic>IEEE Trans. Power Electron.</italic><bold>35</bold>(1), 382&#x02013;392 (2020).</mixed-citation></citation-alternatives></ref><ref id="CR21"><label>21.</label><citation-alternatives><element-citation id="ec-CR21" publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name><name><surname>Advani</surname><given-names>SG</given-names></name><name><surname>Prasad</surname><given-names>AK</given-names></name></person-group><article-title>A comparison of rule-based and model predictive controller-based power management strategies for fuel cell/battery hybrid vehicles considering degradation</article-title><source>Int. J. Hydrog. Energy</source><year>2020</year><volume>45</volume><issue>58</issue><fpage>33948</fpage><lpage>33956</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2020.09.030</pub-id></element-citation><mixed-citation id="mc-CR21" publication-type="journal">Wang, Y., Advani, S. G. &#x00026; Prasad, A. K. A comparison of rule-based and model predictive controller-based power management strategies for fuel cell/battery hybrid vehicles considering degradation. <italic>Int. J. Hydrog. Energy</italic><bold>45</bold>(58), 33948&#x02013;33956 (2020).</mixed-citation></citation-alternatives></ref><ref id="CR22"><label>22.</label><mixed-citation publication-type="other">Ali, A. M. &#x00026; Yacoub, M. I. Optimal predictive power management strategy for fuel cell electric vehicles using neural networks in real-time. In <italic>2020 IEEE Vehicle Power and Propulsion Conference</italic>, 1&#x02013;6 (2020).</mixed-citation></ref><ref id="CR23"><label>23.</label><citation-alternatives><element-citation id="ec-CR23" publication-type="journal"><person-group person-group-type="author"><name><surname>Tao</surname><given-names>F</given-names></name><name><surname>Zhu</surname><given-names>L</given-names></name><name><surname>Fu</surname><given-names>Z</given-names></name><name><surname>Si</surname><given-names>P</given-names></name><name><surname>Sun</surname><given-names>L</given-names></name></person-group><article-title>Frequency decoupling-based energy management strategy for fuel cell/battery/ultracapacitor hybrid vehicle using fuzzy control method</article-title><source>IEEE Access</source><year>2020</year><volume>8</volume><fpage>166491</fpage><lpage>166502</lpage><pub-id pub-id-type="doi">10.1109/ACCESS.2020.3023470</pub-id></element-citation><mixed-citation id="mc-CR23" publication-type="journal">Tao, F., Zhu, L., Fu, Z., Si, P. &#x00026; Sun, L. Frequency decoupling-based energy management strategy for fuel cell/battery/ultracapacitor hybrid vehicle using fuzzy control method. <italic>IEEE Access</italic><bold>8</bold>, 166491&#x02013;166502 (2020).</mixed-citation></citation-alternatives></ref><ref id="CR24"><label>24.</label><mixed-citation publication-type="other">Yan, Y., Huang, W., Liu, J., Li, Q. &#x00026; Chen, W. The control strategy of fuel cell hybrid tram based on state machine control. In <italic>2019 IEEE Sustainable Power and Energy Conference</italic>, 699&#x02013;703 (2019).</mixed-citation></ref><ref id="CR25"><label>25.</label><citation-alternatives><element-citation id="ec-CR25" publication-type="journal"><person-group person-group-type="author"><name><surname>Feng</surname><given-names>Y</given-names></name><name><surname>Dong</surname><given-names>Z</given-names></name></person-group><article-title>Optimal energy management strategy of fuel-cell battery hybrid electric mining truck to achieve minimum lifecycle operation costs</article-title><source>Int. J. Energy Res.</source><year>2020</year><volume>44</volume><issue>13</issue><fpage>10797</fpage><lpage>10808</lpage><pub-id pub-id-type="doi">10.1002/er.5728</pub-id></element-citation><mixed-citation id="mc-CR25" publication-type="journal">Feng, Y. &#x00026; Dong, Z. Optimal energy management strategy of fuel-cell battery hybrid electric mining truck to achieve minimum lifecycle operation costs. <italic>Int. J. Energy Res.</italic><bold>44</bold>(13), 10797&#x02013;10808 (2020).</mixed-citation></citation-alternatives></ref><ref id="CR26"><label>26.</label><citation-alternatives><element-citation id="ec-CR26" publication-type="journal"><person-group person-group-type="author"><name><surname>Odeim</surname><given-names>F</given-names></name><name><surname>Roes</surname><given-names>J</given-names></name><name><surname>Heinzel</surname><given-names>A</given-names></name></person-group><article-title>Power management optimization of a fuel cell/battery/supercapacitor hybrid system for transit bus applications</article-title><source>IEEE Trans. Veh. Technol.</source><year>2016</year><volume>65</volume><issue>7</issue><fpage>5783</fpage><lpage>5788</lpage><pub-id pub-id-type="doi">10.1109/TVT.2015.2456232</pub-id></element-citation><mixed-citation id="mc-CR26" publication-type="journal">Odeim, F., Roes, J. &#x00026; Heinzel, A. Power management optimization of a fuel cell/battery/supercapacitor hybrid system for transit bus applications. <italic>IEEE Trans. Veh. Technol.</italic><bold>65</bold>(7), 5783&#x02013;5788 (2016).</mixed-citation></citation-alternatives></ref><ref id="CR27"><label>27.</label><citation-alternatives><element-citation id="ec-CR27" publication-type="journal"><person-group person-group-type="author"><name><surname>Hu</surname><given-names>X</given-names></name><name><surname>Johannesson</surname><given-names>L</given-names></name><name><surname>Murgovski</surname><given-names>N</given-names></name><name><surname>Egardt</surname><given-names>B</given-names></name></person-group><article-title>Longevity-conscious dimensioning and power management of the hybrid energy storage system in a fuel cell hybrid electric bus</article-title><source>Appl. Energy</source><year>2015</year><volume>137</volume><fpage>913</fpage><lpage>924</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2014.05.013</pub-id></element-citation><mixed-citation id="mc-CR27" publication-type="journal">Hu, X., Johannesson, L., Murgovski, N. &#x00026; Egardt, B. Longevity-conscious dimensioning and power management of the hybrid energy storage system in a fuel cell hybrid electric bus. <italic>Appl. Energy</italic><bold>137</bold>, 913&#x02013;924 (2015).</mixed-citation></citation-alternatives></ref><ref id="CR28"><label>28.</label><citation-alternatives><element-citation id="ec-CR28" publication-type="journal"><person-group person-group-type="author"><name><surname>Kwan</surname><given-names>TH</given-names></name><name><surname>Katsushi</surname><given-names>F</given-names></name><name><surname>Shen</surname><given-names>Y</given-names></name><name><surname>Yin</surname><given-names>S</given-names></name><name><surname>Zhang</surname><given-names>Y</given-names></name><name><surname>Kase</surname><given-names>K</given-names></name><etal/></person-group><article-title>A comprehensive review of integrating fuel cells to other energy systems for enhanced performance and enabling polygeneration</article-title><source>Renew. Sustain. Energy Rev.</source><year>2020</year><volume>128</volume><fpage>109897</fpage><pub-id pub-id-type="doi">10.1016/j.rser.2020.109897</pub-id></element-citation><mixed-citation id="mc-CR28" publication-type="journal">Kwan, T. H. et al. A comprehensive review of integrating fuel cells to other energy systems for enhanced performance and enabling polygeneration. <italic>Renew. Sustain. Energy Rev.</italic><bold>128</bold>, 109897 (2020).</mixed-citation></citation-alternatives></ref><ref id="CR29"><label>29.</label><citation-alternatives><element-citation id="ec-CR29" publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>C</given-names></name><name><surname>Liu</surname><given-names>W</given-names></name><name><surname>He</surname><given-names>H</given-names></name><name><surname>Chau</surname><given-names>KT</given-names></name></person-group><article-title>Deep reinforcement learning-based energy management strategy for fuel cell buses integrating future road information and cabin comfort control</article-title><source>Energy Convers. Manag.</source><year>2024</year><volume>321</volume><fpage>119032</fpage><pub-id pub-id-type="doi">10.1016/j.enconman.2024.119032</pub-id></element-citation><mixed-citation id="mc-CR29" publication-type="journal">Jia, C., Liu, W., He, H. &#x00026; Chau, K. T. Deep reinforcement learning-based energy management strategy for fuel cell buses integrating future road information and cabin comfort control. <italic>Energy Convers. Manag.</italic><bold>321</bold>, 119032 (2024).</mixed-citation></citation-alternatives></ref><ref id="CR30"><label>30.</label><citation-alternatives><element-citation id="ec-CR30" publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>C</given-names></name><name><surname>Zhou</surname><given-names>J</given-names></name><name><surname>He</surname><given-names>H</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Wei</surname><given-names>Z</given-names></name><name><surname>Li</surname><given-names>K</given-names></name></person-group><article-title>Health-conscious deep reinforcement learning energy management for fuel cell buses integrating environmental and look-ahead road information</article-title><source>Energy</source><year>2024</year><volume>290</volume><fpage>130146</fpage><pub-id pub-id-type="doi">10.1016/j.energy.2023.130146</pub-id></element-citation><mixed-citation id="mc-CR30" publication-type="journal">Jia, C. et al. Health-conscious deep reinforcement learning energy management for fuel cell buses integrating environmental and look-ahead road information. <italic>Energy</italic><bold>290</bold>, 130146 (2024).</mixed-citation></citation-alternatives></ref><ref id="CR31"><label>31.</label><citation-alternatives><element-citation id="ec-CR31" publication-type="journal"><person-group person-group-type="author"><name><surname>Jia</surname><given-names>C</given-names></name><name><surname>He</surname><given-names>H</given-names></name><name><surname>Zhou</surname><given-names>J</given-names></name><name><surname>Li</surname><given-names>K</given-names></name><name><surname>Li</surname><given-names>J</given-names></name><name><surname>Wei</surname><given-names>Z</given-names></name></person-group><article-title>A performance degradation prediction model for PEMFC based on bi-directional long short-term memory and multi-head self-attention mechanism</article-title><source>Int. J. Hydrog. Energy</source><year>2024</year><volume>60</volume><fpage>133</fpage><lpage>146</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2024.02.181</pub-id></element-citation><mixed-citation id="mc-CR31" publication-type="journal">Jia, C. et al. A performance degradation prediction model for PEMFC based on bi-directional long short-term memory and multi-head self-attention mechanism. <italic>Int. J. Hydrog. Energy</italic><bold>60</bold>, 133&#x02013;146 (2024).</mixed-citation></citation-alternatives></ref><ref id="CR32"><label>32.</label><mixed-citation publication-type="other">Na, W. K. &#x00026; Gou, B. Exact linearization based nonlinear control of PEM fuel cells. In <italic>IEEE Power Engineering Society</italic>, 1&#x02013;6, 24&#x02013;28 (2007).</mixed-citation></ref><ref id="CR33"><label>33.</label><citation-alternatives><element-citation id="ec-CR33" publication-type="journal"><person-group person-group-type="author"><name><surname>Na</surname><given-names>WK</given-names></name><name><surname>Gou</surname><given-names>B</given-names></name><name><surname>Diong</surname><given-names>B</given-names></name></person-group><article-title>Nonlinear control of PEM fuel cells by exact linearization</article-title><source>IEEE Trans. Ind. Appl.</source><year>2007</year><volume>43</volume><fpage>1426</fpage><lpage>1433</lpage><pub-id pub-id-type="doi">10.1109/TIA.2007.908193</pub-id></element-citation><mixed-citation id="mc-CR33" publication-type="journal">Na, W. K., Gou, B. &#x00026; Diong, B. Nonlinear control of PEM fuel cells by exact linearization. <italic>IEEE Trans. Ind. Appl.</italic><bold>43</bold>, 1426&#x02013;1433 (2007).</mixed-citation></citation-alternatives></ref><ref id="CR34"><label>34.</label><citation-alternatives><element-citation id="ec-CR34" publication-type="journal"><person-group person-group-type="author"><name><surname>RakhtAla</surname><given-names>SM</given-names></name><name><surname>Eini</surname><given-names>R</given-names></name></person-group><article-title>Nonlinear modeling of a PEM fuel cell system; a practical study with experimental validation</article-title><source>Int. J. Mechatron. Electr. Comput. Technol.</source><year>2014</year><volume>4</volume><issue>10</issue><fpage>1272</fpage><lpage>1296</lpage></element-citation><mixed-citation id="mc-CR34" publication-type="journal">RakhtAla, S. M. &#x00026; Eini, R. Nonlinear modeling of a PEM fuel cell system; a practical study with experimental validation. <italic>Int. J. Mechatron. Electr. Comput. Technol.</italic><bold>4</bold>(10), 1272&#x02013;1296 (2014).</mixed-citation></citation-alternatives></ref><ref id="CR35"><label>35.</label><mixed-citation publication-type="other">Pisano, A., Salimbeni, D., Usai, E., Rakhtala, S. M. &#x00026; Noei, A. R. <italic>European Control Conference (ECC)</italic>, 2495&#x02013;2500 (2013).</mixed-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="other">Directly URL access to data: <ext-link ext-link-type="uri" xlink:href="https://data.mendeley.com/datasets/w65jjt8v5w/draft?a=5b37947d-ea28-48cd-a5f2-d8c61c8ed8b1">https://data.mendeley.com/datasets/w65jjt8v5w/draft?a=5b37947d-ea28-48cd-a5f2-d8c61c8ed8b1</ext-link></mixed-citation></ref><ref id="CR37"><label>37.</label><citation-alternatives><element-citation id="ec-CR37" publication-type="journal"><person-group person-group-type="author"><name><surname>Rajabzadeh</surname><given-names>M</given-names></name><name><surname>Bathaee</surname><given-names>SMT</given-names></name><name><surname>Golkar</surname><given-names>MA</given-names></name></person-group><article-title>Dynamic modeling and nonlinear control of fuel cell vehicles with different hybrid power sources</article-title><source>Int. J. Hydrog. Energy</source><year>2016</year><volume>41</volume><issue>4</issue><fpage>3185</fpage><lpage>3198</lpage><pub-id pub-id-type="doi">10.1016/j.ijhydene.2015.12.046</pub-id></element-citation><mixed-citation id="mc-CR37" publication-type="journal">Rajabzadeh, M., Bathaee, S. M. T. &#x00026; Golkar, M. A. Dynamic modeling and nonlinear control of fuel cell vehicles with different hybrid power sources. <italic>Int. J. Hydrog. Energy</italic><bold>41</bold>(4), 3185&#x02013;3198 (2016).</mixed-citation></citation-alternatives></ref><ref id="CR38"><label>38.</label><mixed-citation publication-type="other">How to Determine the Appropriate Size Ultracapacitor for Your Application [Online]. <ext-link ext-link-type="uri" xlink:href="http://www.maxwell">http://www.maxwell</ext-link></mixed-citation></ref><ref id="CR39"><label>39.</label><citation-alternatives><element-citation id="ec-CR39" publication-type="journal"><person-group person-group-type="author"><name><surname>Levant</surname><given-names>A</given-names></name></person-group><article-title>Sliding order and sliding accuracy in sliding mode control</article-title><source>Int. J. Control</source><year>1993</year><volume>58</volume><issue>6</issue><fpage>1247</fpage><lpage>1263</lpage><pub-id pub-id-type="doi">10.1080/00207179308923053</pub-id></element-citation><mixed-citation id="mc-CR39" publication-type="journal">Levant, A. Sliding order and sliding accuracy in sliding mode control. <italic>Int. J. Control</italic><bold>58</bold>(6), 1247&#x02013;1263 (1993).</mixed-citation></citation-alternatives></ref><ref id="CR40"><label>40.</label><citation-alternatives><element-citation id="ec-CR40" publication-type="journal"><person-group person-group-type="author"><name><surname>Fazli</surname><given-names>E</given-names></name><name><surname>Rakhtala</surname><given-names>SM</given-names></name><name><surname>Mirrashid</surname><given-names>N</given-names></name><name><surname>Karimi</surname><given-names>HR</given-names></name></person-group><article-title>Real-time implementation of a super twisting control algorithm for an upper limb wearable robot</article-title><source>Mechatronics</source><year>2022</year><volume>84</volume><fpage>102808</fpage><pub-id pub-id-type="doi">10.1016/j.mechatronics.2022.102808</pub-id></element-citation><mixed-citation id="mc-CR40" publication-type="journal">Fazli, E., Rakhtala, S. M., Mirrashid, N. &#x00026; Karimi, H. R. Real-time implementation of a super twisting control algorithm for an upper limb wearable robot. <italic>Mechatronics</italic><bold>84</bold>, 102808 (2022).</mixed-citation></citation-alternatives></ref><ref id="CR41"><label>41.</label><citation-alternatives><element-citation id="ec-CR41" publication-type="journal"><person-group person-group-type="author"><name><surname>Rakhtala</surname><given-names>SM</given-names></name><name><surname>Casavola</surname><given-names>A</given-names></name></person-group><article-title>Real-time voltage control based on a cascaded super twisting algorithm structure for DC&#x02013;DC converters</article-title><source>IEEE Trans. Ind. Electron.</source><year>2022</year><volume>69</volume><issue>1</issue><fpage>633</fpage><lpage>641</lpage><pub-id pub-id-type="doi">10.1109/TIE.2021.3051551</pub-id></element-citation><mixed-citation id="mc-CR41" publication-type="journal">Rakhtala, S. M. &#x00026; Casavola, A. Real-time voltage control based on a cascaded super twisting algorithm structure for DC&#x02013;DC converters. <italic>IEEE Trans. Ind. Electron.</italic><bold>69</bold>(1), 633&#x02013;641 (2022).</mixed-citation></citation-alternatives></ref></ref-list></back></article>