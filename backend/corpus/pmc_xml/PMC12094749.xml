<!DOCTYPE article
PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with MathML3 v1.3 20210610//EN" "JATS-archivearticle1-3-mathml3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.3" xml:lang="en" article-type="research-article"><?properties open_access?><processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats"><restricted-by>pmc</restricted-by></processing-meta><front><journal-meta><journal-id journal-id-type="nlm-ta">PLoS One</journal-id><journal-id journal-id-type="iso-abbrev">PLoS One</journal-id><journal-id journal-id-type="publisher-id">plos</journal-id><journal-title-group><journal-title>PLOS One</journal-title></journal-title-group><issn pub-type="epub">1932-6203</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, CA USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="pmid">40397887</article-id><article-id pub-id-type="pmc">PMC12094749</article-id>
<article-id pub-id-type="doi">10.1371/journal.pone.0323478</article-id><article-id pub-id-type="publisher-id">PONE-D-24-17033</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied Mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Simulation and Modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied Mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Machine Learning Algorithms</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and Analysis Methods</subject><subj-group><subject>Simulation and Modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Machine Learning Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Artificial Intelligence</subject><subj-group><subject>Machine Learning</subject><subj-group><subject>Machine Learning Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Artificial Intelligence</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Artificial Intelligence</subject><subj-group><subject>Expert Systems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Optimization</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Artificial Intelligence</subject><subj-group><subject>Machine Learning</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical Mechanics</subject><subj-group><subject>Acceleration</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and Technology</subject><subj-group><subject>Industrial Engineering</subject><subj-group><subject>Control Engineering</subject><subj-group><subject>Control Systems</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and Information Sciences</subject><subj-group><subject>Systems Science</subject><subj-group><subject>Control Systems</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical Sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Systems Science</subject><subj-group><subject>Control Systems</subject></subj-group></subj-group></subj-group></subj-group></article-categories><title-group><article-title>Enhanced intelligent train operation algorithms for metro train based on expert system and deep reinforcement learning</article-title><alt-title alt-title-type="running-head">Enhanced intelligent train operation algorithms for metro train</alt-title></title-group><contrib-group><contrib contrib-type="author" equal-contrib="yes"><contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6265-0274</contrib-id><name><surname>Huang</surname><given-names>Yunhu</given-names></name><role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role><role content-type="http://credit.niso.org/contributor-roles/formal-analysis/">Formal analysis</role><role content-type="http://credit.niso.org/contributor-roles/investigation/">Investigation</role><role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing &#x02013; original draft</role><xref rid="aff001" ref-type="aff">
<sup>1</sup>
</xref></contrib><contrib contrib-type="author" equal-contrib="yes"><name><surname>Lai</surname><given-names>Wenzhu</given-names></name><role content-type="http://credit.niso.org/contributor-roles/writing-original-draft/">Writing &#x02013; original draft</role><role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing &#x02013; review &#x00026; editing</role><xref rid="aff002" ref-type="aff">
<sup>2</sup>
</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Chen</surname><given-names>Dewang</given-names></name><role content-type="http://credit.niso.org/contributor-roles/conceptualization/">Conceptualization</role><role content-type="http://credit.niso.org/contributor-roles/methodology/">Methodology</role><xref rid="aff003" ref-type="aff">
<sup>3</sup>
</xref><xref rid="aff004" ref-type="aff">
<sup>4</sup>
</xref><xref rid="cor001" ref-type="corresp">*</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Lin</surname><given-names>Geng</given-names></name><role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing &#x02013; review &#x00026; editing</role><xref rid="aff001" ref-type="aff">
<sup>1</sup>
</xref><xref rid="cor001" ref-type="corresp">*</xref></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Yin</surname><given-names>Jiateng</given-names></name><role content-type="http://credit.niso.org/contributor-roles/validation/">Validation</role><role content-type="http://credit.niso.org/contributor-roles/writing-review-editing/">Writing &#x02013; review &#x00026; editing</role><xref rid="aff005" ref-type="aff">
<sup>5</sup>
</xref><xref rid="cor001" ref-type="corresp">*</xref></contrib></contrib-group><aff id="aff001"><label>1</label>
<addr-line>College of Computer and Data Science, Minjiang University, Fuzhou, Fujian, China</addr-line></aff><aff id="aff002"><label>2</label>
<addr-line>Digital Banking Laboratory of Industrial and Commercial Bank of China Software Development Center, Zhuhai, Guangdong, China</addr-line></aff><aff id="aff003"><label>3</label>
<addr-line>School of Transportation, Fujian University of Technology, Fuzhou, Fujian, China</addr-line></aff><aff id="aff004"><label>4</label>
<addr-line>Fujian BeiDou Navigation and Intelligent Transportation Collaborative Innovation Center, Fuzhou, Fujian, China</addr-line></aff><aff id="aff005"><label>5</label>
<addr-line>State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University, Beijing, China</addr-line></aff><contrib-group><contrib contrib-type="editor"><name><surname>Lu</surname><given-names>Qing-Chang</given-names></name><role>Editor</role><xref rid="edit1" ref-type="aff"/></contrib></contrib-group><aff id="edit1">
<addr-line>Chang&#x02019;an University, CHINA</addr-line>
</aff><author-notes><fn fn-type="COI-statement" id="coi001"><p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p></fn><corresp id="cor001">* E-mail: <email>dwchen@fjut.edu.cn</email>, <email>lingeng413@163.com</email>, <email>13111054@bjtu.edu.cn</email>, <email>yunhuhuang@aliyun.com</email></corresp></author-notes><pub-date pub-type="epub"><day>21</day><month>5</month><year>2025</year></pub-date><pub-date pub-type="collection"><year>2025</year></pub-date><volume>20</volume><issue>5</issue><elocation-id>e0323478</elocation-id><history><date date-type="received"><day>28</day><month>4</month><year>2024</year></date><date date-type="accepted"><day>8</day><month>4</month><year>2025</year></date></history><permissions><copyright-statement>&#x000a9; 2025 Huang et al</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Huang et al</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><self-uri content-type="pdf" xlink:href="pone.0323478.pdf">
</self-uri><abstract><p>In recent decades, automatic train operation (ATO) systems have been gradually adopted by many metro systems, primarily due to their cost-effectiveness and practicality. However, a critical examination reveals computational constraints, adaptability to unforeseen conditions and multi-objective balancing that our research aims to address. In this paper, expert knowledge is combined with deep reinforcement learning algorithm (Proximal Policy Optimization, PPO) and two enhanced intelligent train operation algorithms (EITO) are proposed. The first algorithm, EITO<sub>E</sub>, is based on an expert system containing expert rules and a heuristic expert inference method. On the basis of EITO<sub>E</sub>, we propose EITO<sub>P</sub> algorithm using the PPO algorithm to optimize multiple objectives by designing reinforcement learning strategies, rewards, and value functions. We also develop the double minimal-time distribution (DMTD) calculation method in the EITO implementation to achieve longer coasting distances and further optimize the energy consumption. Compared with previous works, EITO enables the control of continuous train operation without reference to offline speed profiles and optimizes several key performance indicators online. Finally, we conducted comparative tests of the manual driving, intelligent driving algorithm (ITOR, STON), and the algorithms proposed in this paper, EITO, using real line data from the Yizhuang Line of Beijing Metro (YLBS). The test results show that the EITO outperform the current intelligent driving algorithms and manual driving in terms of energy consumption and passengers&#x02019; comfort. In addition, we further validated the robustness of EITO by selecting some complex lines with speed limits, gradients and different running times for testing on the YLBS. Overall, the EITO<sub>P</sub> algorithm has the best performance.</p></abstract><funding-group><award-group id="award001"><funding-source><institution>Fujian Provinces Education Research Project for Young and Middle-aged Teachers</institution>
</funding-source><award-id>JAT231096</award-id><principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6265-0274</contrib-id>
<name><surname>Huang</surname><given-names>Yunhu</given-names></name>
</principal-award-recipient></award-group><award-group id="award002"><funding-source><institution>Minjiang University Talent Introduction Research Project</institution>
</funding-source><award-id>MJU24003, MJY23035</award-id><principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6265-0274</contrib-id>
<name><surname>Huang</surname><given-names>Yunhu</given-names></name>
</principal-award-recipient></award-group><award-group id="award003"><funding-source><institution>Innovation Star Talent Program of the Third Batch in Fujian Province</institution>
</funding-source><award-id>003002</award-id><principal-award-recipient>
<name><surname>Chen</surname><given-names>Dewang</given-names></name>
</principal-award-recipient></award-group><award-group id="award004"><funding-source><institution>Special Fund for Education and Scientific Research of Fujian Provincial Department of Finance</institution>
</funding-source><award-id>GY-Z21001</award-id><principal-award-recipient>
<name><surname>Chen</surname><given-names>Dewang</given-names></name>
</principal-award-recipient></award-group><award-group id="award005"><funding-source><institution>Scientific Research Foundation of Fujian University of Technology</institution>
</funding-source><award-id>GY-Z22071</award-id><principal-award-recipient>
<name><surname>Chen</surname><given-names>Dewang</given-names></name>
</principal-award-recipient></award-group><award-group id="award006"><funding-source><institution>The Natural Science Foundation of Fujian Province</institution>
</funding-source><award-id>2024J011180, 2023J05251, 2024J08275, 2022J01117</award-id><principal-award-recipient>
<name><surname>Lin</surname><given-names>Geng</given-names></name>
</principal-award-recipient></award-group><award-group id="award007"><funding-source><institution>Science and Education Joint Special Project of Minjiang University (Science and Engineering Category)</institution>
</funding-source><award-id>MJKJ24005</award-id><principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6265-0274</contrib-id>
<name><surname>Huang</surname><given-names>Yunhu</given-names></name>
</principal-award-recipient></award-group><award-group id="award008"><funding-source><institution>2023 National College Students' Innovation and Entrepreneurship Training Program </institution>
</funding-source><award-id>202310395011</award-id><principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">https://orcid.org/0000-0002-6265-0274</contrib-id>
<name><surname>Huang</surname><given-names>Yunhu</given-names></name>
</principal-award-recipient></award-group><award-group id="award009"><funding-source><institution>The Fujian Provincial Social Science Foundation</institution>
</funding-source><award-id>FJ2024C196</award-id><principal-award-recipient>
<name><surname>Lai</surname><given-names>Wenzhu</given-names></name>
</principal-award-recipient></award-group><funding-statement>Funders: Fujian Provincial Education and Scientific Research Project for Young and Middle-aged Teachers (Science and Technology Category) (JAT231096), The Natural Science Foundation of Fujian Province (2024J011180, 2023J05251, 2024J08275, 2022J01117), Innovation Star Talent Program of the Third Batch in Fujian Province (003002), The Fujian Provincial Social Science Foundation (FJ2024C196), Minjiang University Talent Introduction Research Project (MJU24003, MJY23035), Special Fund for Education and Scientific Research of Fujian Provincial Department of Finance (GY-Z21001), Scientific Research Foundation of Fujian University of Technology (GY-Z22071). The funders provided some ideas and directions in the study design, and had role in data collection and analysis, decision to publish, or preparation of the manuscript. The specifications are as follows: Funders: Fujian Province&#x02019;s Education Research Project for Young and Middle-aged Teachers under Grant JAT231096, Innovation Star Talent Program of the Third Batch in Fujian Province under Grant 003002, The Natural Science Foundation of Fujian Province (2024J011180, 2023J05251, 2024J08275, 2022J01117), Minjiang University Talent Introduction Research Project under Grant MJU24003 provided financial support. Funders: Scientific Research Foundation of Fujian University of Technology under Grant GY-Z22071, Minjiang University Talent Introduction Research Project under Grant MJY23035, Science and Education Joint Special Project of Minjiang University (Science and Engineering Category) under Grant MJKJ24005 provided support in the areas of data collection and analysis. Funders: Special Fund for Education and Scientific Research of Fujian Provincial Department of Finance under Grant GY-Z21001, and 2023 National College Students&#x02019; Innovation and Entrepreneurship Training Program under Grant 202310395011 provided support in the preparation of the manuscript.</funding-statement></funding-group><counts><fig-count count="13"/><table-count count="4"/><page-count count="27"/></counts><custom-meta-group><custom-meta id="data-availability"><meta-name>Data Availability</meta-name><meta-value>The data of YLBS in the manuscript is available in References [10] and can be requested from State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University (<email>13111054@bjtu.edu.cn</email>).</meta-value></custom-meta></custom-meta-group></article-meta><notes><title>Data Availability</title><p>The data of YLBS in the manuscript is available in References [10] and can be requested from State Key Laboratory of Rail Traffic Control and Safety, Beijing Jiaotong University (<email>13111054@bjtu.edu.cn</email>).</p></notes></front><body><sec sec-type="intro" id="sec001"><title>1 Introduction</title><p>In recent years, with the acceleration of urbanization, urban road traffic resources can not meet the growing traffic demand, therefore, Intelligent Transportation System (ITS) [<xref rid="pone.0323478.ref001" ref-type="bibr">1</xref>] came into being. The automatic train operation (ATO) system [<xref rid="pone.0323478.ref002" ref-type="bibr">2</xref>], which replaces manual driving in many places with low cost and automation, has become an important part of ITS. While ATO systems have been increasingly embraced by many metro systems over the past decades due to their low cost and practicality, it is evident that they fall short in several critical areas. Firstly, the intelligence of these systems is limited; they often rely on predefined operational strategies and lack the dynamic adaptability to respond effectively to complex and unforeseen circumstances. Secondly, the absence of self-learning capabilities restricts their potential to improve efficiency and safety over time through the accumulation and analysis of operational data. Lastly, the generalization of these systems is constrained; they are typically tailored to specific lines and struggle to adapt to diverse line conditions, such as varying speed limits, gradients, and traffic flows, which limits their broader application. These limitations underscore the need for more advanced, intelligent, and adaptable train operation systems that can enhance operational efficiency, safety, and passenger comfort.</p><p>The speed control of metro train operation can be represented as a multi-objective optimization problem with constraints. In order to satisfy these constraints and optimize the objectives, the train must make driving decisions based on real-time information. Under normal conditions, the ATO is responsible for all train traction and braking control commands to make the train run on time, regulate its speed and stop exactly at its destination [<xref rid="pone.0323478.ref003" ref-type="bibr">3</xref>]. ATO is traditionally divided into two sub-modules. The first one is dedicated to the calculation of the speed profile of the future train operation. Under this module, offline optimization algorithms are used to calculate the optimal speed profile in terms of performance and energy consumption. The second sub-module works mainly to ensure that the train accurately tracks the given speed profile.</p><p>Recently, many studies have been devoted to designing an offline optimized train trajectory to improve energy efficiency. For example, Khmelnitsky [<xref rid="pone.0323478.ref004" ref-type="bibr">4</xref>] devised a numerical algorithm to get the best velocity profile, taking into account changeable gradients and arbitrary speed limits. Furthermore, train operation issues encompass a variety of additional factors, such as trip comfort and punctuality. Yang <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref005" ref-type="bibr">5</xref>] created a genetic algorithm based on binary coding, developing a two-target integer programming model with headway time control and dwell time management to find the optimal solution in terms of energy savings and service quality. Wang <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref006" ref-type="bibr">6</xref>] introduced a new iterative convex planning (ICP) technique to solve the train scheduling problem to achieve the ideal departure time, running time, and dwell time in order to minimize travel time and energy consumption. Using optimal speed trajectory searching methodologies under diverse track parameters, Guan <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref007" ref-type="bibr">7</xref>] created a multi-objective optimization model for the speed trajectory, with energy consumption and travel time as the key optimization objectives. With the development of artificial intelligence, many intelligent algorithms have been applied to train operation. Akba <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref008" ref-type="bibr">8</xref>] employ an artificial neural network with the genetic algorithm to optimize the coasting points of the velocity-distance trajectory to obtain minimum energy expenditure for a given travel time. Yang <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref009" ref-type="bibr">9</xref>] combined a simulation-based approach and a genetic algorithm to find an approximate optimal coasting control strategy. Yin <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref010" ref-type="bibr">10</xref>] developed ITOR algorithm for intelligent train operating capable of satisfying multiple objectives by using expert experience and Q-Learning algorithm. Zhang <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref011" ref-type="bibr">11</xref>] used manual driving data to train (K-NN, Bagging CART, and Adaboost CART) three well-known algorithms to predict the driver&#x02019;s output control. Recently, Zhou <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref012" ref-type="bibr">12</xref>] proposed STO algorithm by using deep deterministic policy gradient (DDPG) and normalized dominance function (NAF) algorithms to further optimize the energy consumption, comfort during train operation metrics.</p><p>After generating the optimal recommended speed profile, the ATO&#x02019;s task is to develop an efficient method to control the train relatively to different train models and operating conditions (e.g., tunnels, curves, steep gradients) so that the train can accurately track the speed profile and operate safely and smoothly. Ke <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref013" ref-type="bibr">13</xref>] proposed a fuzzy PID gain method to track the recommended speed profile, which was optimally generated by the MAX-MIN ant system. Song <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref014" ref-type="bibr">14</xref>] investigated at the consequences of time-varying failures in both the traction and braking phases of the train, and suggested an adaptive backstepping control system that was completely parameter-dependent and successful in achieving good speed tracking performance. Liu <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref015" ref-type="bibr">15</xref>] proposed a high-speed railway control system based on fuzzy control method and designed the control system in MATLAB. Gu <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref016" ref-type="bibr">16</xref>] have proposed a new energy-efficient train operation model based on real-time traffic information from a geometric and topographic perspective. Two robust adaptive control approaches considering actuator saturation and unknown system parameters were proposed by Gao <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref017" ref-type="bibr">17</xref>]. Recently, Pu <italic toggle="yes">et al</italic>. [<xref rid="pone.0323478.ref018" ref-type="bibr">18</xref>] proposed a model-free adaptive speed controller based on neural network (NN) and PID algorithms,and the effectiveness of the proposed algorithms to track the SD trajectory precisely is proved by numerical experiments and real-line applications.</p><p>Actually, the previous research and application has greatly improved the operational performance of metro train operation. However, there are still some basic problems that have not been solved, which hinder the development of ATO systems. Firstly, most existing ATO systems achieve their train operation goals by focusing on energy-efficient trajectory calculation, real-time tracking methods, and station parking algorithms, respectively. Especially, ATO algorithms are designed to track offline optimized speed profiles, lacking intelligence, flexibility and robustness. Few studies have comprehensively considered multiple objectives such as driving comfort, punctuality, parking accuracy, and energy consumption. Meanwhile, complex control methods are difficult to implement in real operation when faced with system non-linearity, unknown resistance and variable in-train forces. Secondly, modern metro trains are capable of outputting continuous traction and braking forces, but few studies have been conducted to design continuous control models considering complex line conditions, for example, the intelligent train operation algorithms based on reinforcement learning (ITOR) are proposed in [<xref rid="pone.0323478.ref010" ref-type="bibr">10</xref>], which can only achieve discrete control of train with simple line condition. Finally, there are some metro sections with more complex speed limits and gradients change metro, and most of the train models proposed only consider the operation in the intervals with simple speed limits and gradients conditions, such as the smart train operation (STO) algorithms based on normalized advantage function (STON) proposed in [<xref rid="pone.0323478.ref012" ref-type="bibr">12</xref>] is difficult to be applied to the case of long distances between two consecutive stations and lines with complex speed limits.</p><p>Facing these problems, new intelligent driving algorithms with a higher level of intelligence need to be investigated, which are called enhanced intelligent operation algorithms (EITO<sub>E</sub> and EITO<sub>P</sub>) in this paper. On the one hand, experienced drivers combined with their long-term accumulated maneuvering experience can implement effective control of the train in real-time so that the train operation meets the requirements of several control objectives. Besides, they can be well adapted to different conditions of railroad lines. On the other hand, reinforcement learning(RL) has been used as a powerful decision tool [<xref rid="pone.0323478.ref019" ref-type="bibr">19</xref>] to tackle optimal control problems in many domains, such as micro-drone control [<xref rid="pone.0323478.ref020" ref-type="bibr">20</xref>], robot control [<xref rid="pone.0323478.ref021" ref-type="bibr">21</xref>], and with good results in the field of intelligent driving of trains [<xref rid="pone.0323478.ref010" ref-type="bibr">10</xref>,<xref rid="pone.0323478.ref012" ref-type="bibr">12</xref>]. Meanwhile, deep reinforcement learning [<xref rid="pone.0323478.ref022" ref-type="bibr">22</xref>] is considered to be useful for the control of continuous movements [<xref rid="pone.0323478.ref023" ref-type="bibr">23</xref>], the detailed demonstration is analyzed in Sect 3.2.</p><p>Therefore, we consider combining expert (experienced drivers) experience with deep reinforcement learning algorithms to achieve better and intelligent operations. The necessity of proposing both (EITO<sub>E</sub> and EITO<sub>P</sub>) lies in their complementary strengths. (EITO<sub>E</sub> leverages expert knowledge and heuristic rules to provide a robust baseline for intelligent train operation, while EITO<sub>P</sub>) uses deep reinforcement learning (PPO) to optimize multiple objectives dynamically. By presenting both algorithms, we aim to demonstrate how expert knowledge can be effectively integrated with advanced machine learning techniques to enhance train operation performance. This dual approach allows for a comprehensive evaluation of their effectiveness under varying conditions, showcasing the versatility and adaptability of our proposed solutions. As can be seen from the above analysis, the contributions of this paper are as follows:</p><list list-type="simple"><list-item><p>1) Integration of Expert Knowledge with Deep Reinforcement Learning: We introduce a novel approach that integrates expert system-based rules, distilled from experienced drivers, with the Proximal Policy Optimization (PPO) algorithm. This integration results in the development of EITO<sub>E</sub> and EITO<sub>P</sub> algorithms, which not only provide a robust operational baseline for intelligent train operation but also dynamically optimize multiple objectives, enhancing the adaptability and efficiency of train control systems.</p></list-item><list-item><p>2) Development of EITO<sub>E</sub> Algorithm: The EITO<sub>E</sub> algorithm is developed by encapsulating heuristic rules and inference methods from expert drivers within an expert system framework. This innovation allows for the generation of control strategies independent of offline speed profiles, thereby offering a flexible and adaptive operational approach that is responsive to real-time train operation requirements.</p></list-item><list-item><p>3) EITO<sub>P</sub> Algorithm for Multi-Objective Optimization: Extending the capabilities of EITO<sub>E</sub>, the EITO<sub>P</sub> algorithm utilizes PPO to optimize key operational objectives including safety, punctuality, energy efficiency, and passenger comfort. A significant contribution of EITO<sub>P</sub> is its real-time adjustment of acceleration and braking strategies based on current train conditions and speed limits, which is crucial for maintaining energy efficiency and punctuality in metro train operations.</p></list-item></list><p>The rest of the paper is organized as follows. In <xref rid="sec002" ref-type="sec">Sect 2</xref>, we define the necessary mathematical notation and performance indicators for metro train operation, and then, we describe the problem of metro train operation. <xref rid="sec005" ref-type="sec">Sect 3</xref> presents the design of the EITO algorithm based on the expert system and PPO. In <xref rid="sec008" ref-type="sec">Sect 4</xref>, we construct an EITO simulation platform and give three numerical examples of real data from YLBS. We conclude the paper in <xref rid="sec012" ref-type="sec">Sect 5</xref>.</p></sec><sec id="sec002"><title>2 Problem formulation and objectives</title><sec id="sec003"><title>2.1 Problem statement</title><p>This section first formulates the train operation problem and then clearly states the objectives that the proposed algorithms aim to achieve.</p><p>The train control problem is formulated as an optimal control problem, focusing on finding an optimal control strategy for the traction and braking force during the travel time. First, the minimum time interval and the travel time of trains are defined as <xref rid="pone.0323478.e019" ref-type="disp-formula">Eqs (1)</xref> and (<xref rid="pone.0323478.e021" ref-type="disp-formula">2</xref>) respectively:</p><disp-formula id="pone.0323478.e019"><alternatives><graphic xlink:href="pone.0323478.e019.jpg" id="pone.0323478.e019g" position="anchor"/><mml:math id="M19" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>&#x00394;</mml:mi><mml:mi>t</mml:mi><mml:mtext>.</mml:mtext></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(1)</label></disp-formula><p>For <inline-formula id="pone.0323478.e020"><alternatives><graphic xlink:href="pone.0323478.e020.jpg" id="pone.0323478.e020g" position="anchor"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&#x02264;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x02264;</mml:mo><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, total travel time <italic toggle="yes">T</italic> is defined as:</p><disp-formula id="pone.0323478.e021"><alternatives><graphic xlink:href="pone.0323478.e021.jpg" id="pone.0323478.e021g" position="anchor"/><mml:math id="M21" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(2)</label></disp-formula><p>where the initial run time is <italic toggle="yes">t</italic><sub>0</sub>&#x02009;=&#x02009;0(<italic toggle="yes">s</italic>), and the minimum time interval is <inline-formula id="pone.0323478.e022"><alternatives><graphic xlink:href="pone.0323478.e022.jpg" id="pone.0323478.e022g" position="anchor"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.02</mml:mn><mml:mspace width="0.2em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p><p>The train motion model, which incorporates a multi - point mass and signal coordinate model, is used to simulate the electric multiple unit (EMU) of the train. This model takes into account the interaction effects between vehicles, offering an advantage over the traditional single - point train model. The model is expressed as:</p><disp-formula id="pone.0323478.e023"><alternatives><graphic xlink:href="pone.0323478.e023.jpg" id="pone.0323478.e023g" position="anchor"/><mml:math id="M23" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>F</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mo>&#x022ee;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>f</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(3)</label></disp-formula><p>where <inline-formula id="pone.0323478.e024"><alternatives><graphic xlink:href="pone.0323478.e024.jpg" id="pone.0323478.e024g" position="anchor"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> denotes the weight of the EMU and <italic toggle="yes">m</italic><sub><italic toggle="yes">i</italic></sub> denotes the weight of the i-th vehicle. <inline-formula id="pone.0323478.e025"><alternatives><graphic xlink:href="pone.0323478.e025.jpg" id="pone.0323478.e025g" position="anchor"/><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mover><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> denotes the interaction between vehicle [<xref rid="pone.0323478.ref024" ref-type="bibr">24</xref>]. <inline-formula id="pone.0323478.e026"><alternatives><graphic xlink:href="pone.0323478.e026.jpg" id="pone.0323478.e026g" position="anchor"/><mml:math id="M26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>F</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> denotes the force of each vehicle in the moving train, and <inline-formula id="pone.0323478.e027"><alternatives><graphic xlink:href="pone.0323478.e027.jpg" id="pone.0323478.e027g" position="anchor"/><mml:math id="M27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the distribution constant that determines the acceleration/braking force of the i-th vehicle. <inline-formula id="pone.0323478.e028"><alternatives><graphic xlink:href="pone.0323478.e028.jpg" id="pone.0323478.e028g" position="anchor"/><mml:math id="M28" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:mover><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> denotes the variation of the spring deformation of the coupler. <inline-formula id="pone.0323478.e029"><alternatives><graphic xlink:href="pone.0323478.e029.jpg" id="pone.0323478.e029g" position="anchor"/><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> denotes the drag force. In addition, <inline-formula id="pone.0323478.e030"><alternatives><graphic xlink:href="pone.0323478.e030.jpg" id="pone.0323478.e030g" position="anchor"/><mml:math id="M30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x003b1;</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mi>v</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> describes the drag force caused by friction, The <inline-formula id="pone.0323478.e031"><alternatives><graphic xlink:href="pone.0323478.e031.jpg" id="pone.0323478.e031g" position="anchor"/><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> are the vehicle-specific factor. <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub> is the curve drag force defined as <italic toggle="yes">f</italic><sub><italic toggle="yes">c</italic></sub>&#x02009;=&#x02009;6.3<italic toggle="yes">M</italic>/<italic toggle="yes">r</italic>(<italic toggle="yes">s</italic>)&#x02212;55, and <italic toggle="yes">r</italic>(<italic toggle="yes">s</italic>) is the radius of the curve [<xref rid="pone.0323478.ref011" ref-type="bibr">11</xref>]. <inline-formula id="pone.0323478.e032"><alternatives><graphic xlink:href="pone.0323478.e032.jpg" id="pone.0323478.e032g" position="anchor"/><mml:math id="M32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>g</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mi>g</mml:mi><mml:mi>sin</mml:mi><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the drag force caused by the gradient, and <inline-formula id="pone.0323478.e033"><alternatives><graphic xlink:href="pone.0323478.e033.jpg" id="pone.0323478.e033g" position="anchor"/><mml:math id="M33" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the gradients angle.</p><p>The multi-unit model in <xref rid="pone.0323478.e023" ref-type="disp-formula">Eq (3)</xref> captures inter-vehicle dynamics (e.g., coupler forces, mass distribution) to better simulate real-world EMUs. While the control force <italic toggle="yes">u</italic> is centralized, its distribution across vehicles is governed by the force allocation constants <inline-formula id="pone.0323478.e034"><alternatives><graphic xlink:href="pone.0323478.e034.jpg" id="pone.0323478.e034g" position="anchor"/><mml:math id="M34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (<xref rid="sec003" ref-type="sec">Sect 2.1</xref>). For simplicity, we assumed uniform distribution <inline-formula id="pone.0323478.e035"><alternatives><graphic xlink:href="pone.0323478.e035.jpg" id="pone.0323478.e035g" position="anchor"/><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> in simulations, as fine-grained force allocation is hardware-dependent and beyond this paper&#x02019;s scope.</p><p>Furthermore, the train acceleration (or braking) system in the study has nonlinear and time delays. Transfer function of the simulated brake acceleration system:</p><disp-formula id="pone.0323478.e036"><alternatives><graphic xlink:href="pone.0323478.e036.jpg" id="pone.0323478.e036g" position="anchor"/><mml:math id="M36" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(4)</label></disp-formula><p>where <italic toggle="yes">G</italic>(<italic toggle="yes">s</italic>) means the actual output, <inline-formula id="pone.0323478.e037"><alternatives><graphic xlink:href="pone.0323478.e037.jpg" id="pone.0323478.e037g" position="anchor"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>&#x003b1;</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the system performance gain, <inline-formula id="pone.0323478.e038"><alternatives><graphic xlink:href="pone.0323478.e038.jpg" id="pone.0323478.e038g" position="anchor"/><mml:math id="M38" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e039"><alternatives><graphic xlink:href="pone.0323478.e039.jpg" id="pone.0323478.e039g" position="anchor"/><mml:math id="M39" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> means the delay and time constant of the train acceleration/braking model, respectively.</p><p>Metro train operation control models are generally evaluated in terms of five aspects: safety, punctuality, energy consumption, passenger comfort, and parking accuracy.</p><list list-type="bullet"><list-item><p><italic toggle="yes">Safety</italic>: There may be multiple speed limit points between two consecutive metro stations, as shown in <xref rid="pone.0323478.g001" ref-type="fig">Fig 1</xref>, where <inline-formula id="pone.0323478.e040"><alternatives><graphic xlink:href="pone.0323478.e040.jpg" id="pone.0323478.e040g" position="anchor"/><mml:math id="M40" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0323478.e041"><alternatives><graphic xlink:href="pone.0323478.e041.jpg" id="pone.0323478.e041g" position="anchor"/><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mrow><mml:mtext>limit</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> are the speed limits for different sections between the two stations. That means during the travel period, the speed of the train must be lower than the current speed limit of the railroad section to ensure safety. The safety evaluation index <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> is defined as:<disp-formula id="pone.0323478.e042"><alternatives><graphic xlink:href="pone.0323478.e042.jpg" id="pone.0323478.e042g" position="anchor"/><mml:math id="M42" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x02200;</mml:mo><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mo>&#x02203;</mml:mo><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(5)</label></disp-formula></p></list-item><list-item><p>It is note that the intention of <xref rid="pone.0323478.e042" ref-type="disp-formula">Eq (5)</xref> is to ensure that the train&#x02019;s speed remains within the designated limits. To explicitly state that the evaluation index <italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub> is designed to enforce speed limits to prevent any misinterpretation. The condition should ensure that if the speed exceeds the limit, the index will reflect a violation, thereby discouraging overspeeding.</p></list-item><list-item><p><italic toggle="yes">Punctuality</italic>: Punctuality is an important indicator of metro train operation that affects passenger interchanges and the entire schedule. We first define the running time error as:<disp-formula id="pone.0323478.e043"><alternatives><graphic xlink:href="pone.0323478.e043.jpg" id="pone.0323478.e043g" position="anchor"/><mml:math id="M43" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(6)</label></disp-formula></p></list-item><list-item><p>where <italic toggle="yes">T</italic><sub><italic toggle="yes">a</italic></sub> is the actual running time of the train and <italic toggle="yes">T</italic><sub><italic toggle="yes">p</italic></sub> is the planned trip time of the train. In this paper, if the running time error is greater than <inline-formula id="pone.0323478.e044"><alternatives><graphic xlink:href="pone.0323478.e044.jpg" id="pone.0323478.e044g" position="anchor"/><mml:math id="M44" display="inline" overflow="scroll"><mml:mrow><mml:mn>3</mml:mn><mml:mspace width="0.2em"/><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, the metro is not running on time. Therefore, the punctuality evaluation index <italic toggle="yes">I</italic><sub><italic toggle="yes">t</italic></sub> is defined as:<disp-formula id="pone.0323478.e045"><alternatives><graphic xlink:href="pone.0323478.e045.jpg" id="pone.0323478.e045g" position="anchor"/><mml:math id="M45" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>3</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mspace width="0.2em"/><mml:mspace width="0.2em"/><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mn>3</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(7)</label></disp-formula></p></list-item><list-item><p><italic toggle="yes">Energy efficiency</italic>: Energy consumption accounts for a large portion of train operating costs. The energy consumed is described as<disp-formula id="pone.0323478.e046"><alternatives><graphic xlink:href="pone.0323478.e046.jpg" id="pone.0323478.e046g" position="anchor"/><mml:math id="M46" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:mi>M</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mi>&#x00394;</mml:mi><mml:mi>t</mml:mi><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(8)</label></disp-formula></p></list-item><list-item><p>and the unit mass energy efficiency evaluation index between the two stations is defined as :<disp-formula id="pone.0323478.e047"><alternatives><graphic xlink:href="pone.0323478.e047.jpg" id="pone.0323478.e047g" position="anchor"/><mml:math id="M47" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>&#x003b5;</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(9)</label></disp-formula></p></list-item><list-item><p><italic toggle="yes">Comfort</italic>: Comfort is a direct evaluation criterion for the quality of train service, which ensures that the instantaneous change in acceleration or deceleration should be below a certain threshold value. We define the rate of acceleration <italic toggle="yes">u</italic> change as:<disp-formula id="pone.0323478.e048"><alternatives><graphic xlink:href="pone.0323478.e048.jpg" id="pone.0323478.e048g" position="anchor"/><mml:math id="M48" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>|</mml:mo><mml:mtext>.</mml:mtext></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(10)</label></disp-formula></p><p>Therefore, the ride comfort evaluation index <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub> can be defined as:<disp-formula id="pone.0323478.e049"><alternatives><graphic xlink:href="pone.0323478.e049.jpg" id="pone.0323478.e049g" position="anchor"/><mml:math id="M49" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:munderover></mml:mstyle><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(11)</label></disp-formula></p></list-item><list-item><p>where <inline-formula id="pone.0323478.e050"><alternatives><graphic xlink:href="pone.0323478.e050.jpg" id="pone.0323478.e050g" position="anchor"/><mml:math id="M50" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mi>E</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the threshold for acceleration change.</p></list-item><list-item><p><italic toggle="yes">Parking accuracy</italic>: It is used to assess the parking accuracy, expressed as:<disp-formula id="pone.0323478.e051"><alternatives><graphic xlink:href="pone.0323478.e051.jpg" id="pone.0323478.e051g" position="anchor"/><mml:math id="M51" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:mtext>.&#x000a0;</mml:mtext></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(12)</label></disp-formula>where <italic toggle="yes">s</italic><sub><italic toggle="yes">D</italic></sub> is the length of the segment between adjacent stations and <italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic></sub> is the current running distance of the train. Note that the parking error of the metro is generally required to be within <inline-formula id="pone.0323478.e052"><alternatives><graphic xlink:href="pone.0323478.e052.jpg" id="pone.0323478.e052g" position="anchor"/><mml:math id="M52" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x000b1;</mml:mi><mml:mn>30</mml:mn><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> [<xref rid="pone.0323478.ref021" ref-type="bibr">21</xref>] so that metro barrier doors can be opened. Therefore the parking accuracy index can be defined as:<disp-formula id="pone.0323478.e053"><alternatives><graphic xlink:href="pone.0323478.e053.jpg" id="pone.0323478.e053g" position="anchor"/><mml:math id="M53" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:mn>30</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:mn>30</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(13)</label></disp-formula></p></list-item></list><fig position="float" id="pone.0323478.g001"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g001</object-id><label>Fig 1</label><caption><title>Speed limits.</title></caption><graphic xlink:href="pone.0323478.g001" position="float"/></fig></sec><sec id="sec004"><title>2.2 Problem objectives</title><p>This section will clearly articulate the problems that this study aims to address. The two proposed EITO algorithms (<inline-formula id="pone.0323478.e054"><alternatives><graphic xlink:href="pone.0323478.e054.jpg" id="pone.0323478.e054g" position="anchor"/><mml:math id="M54" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e055"><alternatives><graphic xlink:href="pone.0323478.e055.jpg" id="pone.0323478.e055g" position="anchor"/><mml:math id="M55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) aim to achieve the following objectives corresponding to the above - mentioned problems:</p><list list-type="order"><list-item><p><bold>Meeting multi-objective requirements:</bold> The EITO algorithms should be able to provide control strategies for traction and braking forces that can meet the requirements of multiple objectives such as safety, comfort, punctuality, parking accuracy, and energy efficiency of metro operation. Given the definitions of safety (<italic toggle="yes">I</italic><sub><italic toggle="yes">s</italic></sub>), punctuality (<italic toggle="yes">I</italic><sub><italic toggle="yes">t</italic></sub>), energy efficiency (<italic toggle="yes">I</italic><sub><italic toggle="yes">e</italic></sub>), comfort (<italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub>), and parking accuracy (<italic toggle="yes">I</italic><sub><italic toggle="yes">p</italic></sub>), the algorithms need to ensure that the train operation satisfies all these evaluation indices simultaneously.</p></list-item><list-item><p><bold>Independent of offline speed profile and continuous force control:</bold> The EITO algorithms should be able to perform normal operations without considering the speed distribution of the offline design and achieve the control of continuous forces. As existing ATO systems mainly rely on offline-designed speed profiles and current intelligent driving algorithms have limitations in continuous force control, the EITO algorithms aim to overcome these drawbacks.</p></list-item><list-item><p><bold>Outperforming existing methods in energy-efficiency and comfort:</bold> The control strategy output by the EITO algorithms should outperform experienced metro drivers and current intelligent driving algorithms in terms of energy efficiency while ensuring good ride comfort. By comparing with manual driving and existing intelligent driving algorithms (such as ITOR and STON), the EITO algorithms should achieve lower energy consumption (<italic toggle="yes">I</italic><sub><italic toggle="yes">e</italic></sub>) and better comfort (<italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub>) performance.</p></list-item><list-item><p><bold>Adapting to different situations:</bold> The EITO algorithms should be able to flexibly adapt to different situations, including different trip times, different temporary faults (earlier or later arrival), speed limits, and gradients conditions (simple or complex). Considering the complex and variable operating conditions of metro trains, the algorithms need to adjust their control strategies accordingly to ensure stable and efficient operation.</p></list-item></list><p>Existing ATO systems must track the designed offline speed profile, and current intelligent driving algorithms either cannot achieve control of continuous forces or cannot adapt to complex and variable line conditions, which is the driving force behind this paper. Moreover, RL has been applied in many fields to deal with model-free problems [<xref rid="pone.0323478.ref024" ref-type="bibr">24</xref>], and expert knowledge has been widely used to improve control strategies [<xref rid="pone.0323478.ref010" ref-type="bibr">10</xref>],[<xref rid="pone.0323478.ref011" ref-type="bibr">11</xref>]. Therefore, in this paper, two intelligent algorithms are proposed. Namely, <inline-formula id="pone.0323478.e056"><alternatives><graphic xlink:href="pone.0323478.e056.jpg" id="pone.0323478.e056g" position="anchor"/><mml:math id="M56" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e057"><alternatives><graphic xlink:href="pone.0323478.e057.jpg" id="pone.0323478.e057g" position="anchor"/><mml:math id="M57" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>EITO</mml:mo><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pone.0323478.e058"><alternatives><graphic xlink:href="pone.0323478.e058.jpg" id="pone.0323478.e058g" position="anchor"/><mml:math id="M58" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is a heuristic algorithm based on an expert system to address multiple performance objectives of metro train operation. In addition, we develop EITO<sub>P</sub> based on EITO<sub>E</sub> using the PPO to comprehensively optimize the multi-objective requirements of safety, comfort, punctuality, parking accuracy, and energy efficiency.</p><p>Following the problem statement outlined above, the next section will provide a detailed introduction to the specific control models and methodologies employed to achieve these objectives.</p></sec></sec><sec id="sec005"><title>3 EITO algorithm design</title><p>The application of expert experience-based control methods to automatic train operation control is motivated by the following two reasons. On the one hand, because the train operation control system is a highly complex, multiobjective nonlinear dynamical system [<xref rid="pone.0323478.ref023" ref-type="bibr">23</xref>,<xref rid="pone.0323478.ref025" ref-type="bibr">25</xref>], which poses great difficulties for traditional control that requires the use of its precise mathematical model; on the other hand, experienced drivers combined with their long-term accumulated maneuvering experience can implement effective control of the train in real-time so that the train operation meets the requirements of several control objectives [<xref rid="pone.0323478.ref026" ref-type="bibr">26</xref>].</p><p>Therefore, we first developed an expert system-based <inline-formula id="pone.0323478.e061"><alternatives><graphic xlink:href="pone.0323478.e061.jpg" id="pone.0323478.e061g" position="anchor"/><mml:math id="M61" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> algorithm. This expert system contains expert rules and a heuristic inference system. These expert rules were summarized by our communication with metro drivers and by analyzing data from YLBS and literatures. In addition, we developed a heuristic inference method to solve without an offline speed profile reference based on the driver&#x02019;s operating strategy. Then, the appropriate EITO<sub>E</sub> output is obtained by combining the speed limit and the current state of the train.</p><p>Both <inline-formula id="pone.0323478.e063"><alternatives><graphic xlink:href="pone.0323478.e063.jpg" id="pone.0323478.e063g" position="anchor"/><mml:math id="M63" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e064"><alternatives><graphic xlink:href="pone.0323478.e064.jpg" id="pone.0323478.e064g" position="anchor"/><mml:math id="M64" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> ensure punctuality through real-time adjustments based on current train conditions and speed limits. <inline-formula id="pone.0323478.e065"><alternatives><graphic xlink:href="pone.0323478.e065.jpg" id="pone.0323478.e065g" position="anchor"/><mml:math id="M65" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> uses expert rules to allocate trip times effectively, while <inline-formula id="pone.0323478.e066"><alternatives><graphic xlink:href="pone.0323478.e066.jpg" id="pone.0323478.e066g" position="anchor"/><mml:math id="M66" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> employs reinforcement learning to dynamically adjust acceleration and braking strategies. The algorithms continuously monitor the train&#x02019;s position and speed, allowing them to make timely decisions that keep the train on schedule. Specifically, the reward function in <inline-formula id="pone.0323478.e067"><alternatives><graphic xlink:href="pone.0323478.e067.jpg" id="pone.0323478.e067g" position="anchor"/><mml:math id="M67" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> penalizes deviations from planned trip times, reinforcing behaviors that promote punctuality.</p><sec id="sec006"><title>3.1 EITO<sub>E</sub></title><p>This research adhered to strict ethical standards. In data collection (human or animal), we followed relevant regulations and obtained necessary consents. Experienced drivers can meet multiple objectives well. By observing the driver&#x02019;s behavior, we found that an experienced driver can control the train in the correct position, allocate the reserved time reasonably, avoid unnecessary braking, limit the train speed to prevent over-speeding, and reduce the number of switches in the controller output. Based on the study of [<xref rid="pone.0323478.ref010" ref-type="bibr">10</xref>],[<xref rid="pone.0323478.ref012" ref-type="bibr">12</xref>], we derived IF-THEN rules using position, speed, and running time as inputs and acceleration/braking rate as outputs. These rules can be described as follows.</p><list list-type="roman-upper"><list-item><p>Energy-efficient trains operate in three states, namely acceleration, coasting, and braking. The train does not transition directly from the acceleration state to the braking state and vice versa, unless a special incident is encountered. Transfer between any other two states is allowed.</p></list-item><list-item><p>The acceleration of the train starting process should be appropriate for comfort (usually less than 0.6<inline-formula id="pone.0323478.e069"><alternatives><graphic xlink:href="pone.0323478.e069.jpg" id="pone.0323478.e069g" position="anchor"/><mml:math id="M69" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> ).</p></list-item><list-item><p>For better comfort, the rate of change of acceleration in each time interval should not be too large (usually less than 0.3<inline-formula id="pone.0323478.e070"><alternatives><graphic xlink:href="pone.0323478.e070.jpg" id="pone.0323478.e070g" position="anchor"/><mml:math id="M70" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> ).</p></list-item><list-item><p>Determine the next operation mode in advance according to the current speed and the next speed limit value to avoid triggering automatic train protection.</p></list-item><list-item><p>Allocate the total trip time to each interval according to the speed limit, and try to operate according to the allocated time in each interval.</p></list-item></list><fig position="float" id="pone.0323478.g002"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g002</object-id><label>Fig 2</label><caption><title>DMTD algorithm.</title></caption><graphic xlink:href="pone.0323478.g002" position="float"/></fig><p>As mentioned before, experienced drivers consider the train&#x02019;s reserved time, reserved distance, speed limit, and current speed: if the train&#x02019;s speed is too low to arrive in time, the train will accelerate. Conversely, if the train&#x02019;s speed is too high, the train coasts. We designed a data-driven inference method DMTD to determine the coasting or accelerating time. This inference method is manually driven and uses the twice MTD to calculate the desired speed range (<inline-formula id="pone.0323478.e079"><alternatives><graphic xlink:href="pone.0323478.e079.jpg" id="pone.0323478.e079g" position="anchor"/><mml:math id="M79" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>desired&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>) for the current speed limit interval. As shown in <xref rid="pone.0323478.g003" ref-type="fig">Fig 3</xref>, the <inline-formula id="pone.0323478.e080"><alternatives><graphic xlink:href="pone.0323478.e080.jpg" id="pone.0323478.e080g" position="anchor"/><mml:math id="M80" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>desired&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> calculated by this method enables energy-efficient driving by making the train coast as much as possible while ensuring punctuality.</p><fig position="float" id="pone.0323478.g003"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g003</object-id><label>Fig 3</label><caption><title>EITO<sub>E</sub> speed distance profile.</title></caption><graphic xlink:href="pone.0323478.g003" position="float"/></fig><p>Using the online data of the train, we first use the DMTD algorithm (see Algorithm 1) to obtain the appropriately reserved trip times <inline-formula id="pone.0323478.e081"><alternatives><graphic xlink:href="pone.0323478.e081.jpg" id="pone.0323478.e081g" position="anchor"/><mml:math id="M82" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e082"><alternatives><graphic xlink:href="pone.0323478.e082.jpg" id="pone.0323478.e082g" position="anchor"/><mml:math id="M83" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in the current speed limit interval. Then, the estimated velocity range for the speed limit of each segment is calculated from the formula below <inline-formula id="pone.0323478.e083"><alternatives><graphic xlink:href="pone.0323478.e083.jpg" id="pone.0323478.e083g" position="anchor"/><mml:math id="M84" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">[</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo fence="true" form="postfix" stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p><p>
<bold>Algorithm 1. DMTD algorithm.</bold>
</p><p specific-use="line">
<monospace>1: Get online and offline data including current train location <italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic></sub>, speed <inline-formula id="pone.0323478.e071"><alternatives><graphic xlink:href="pone.0323478.e071.jpg" id="pone.0323478.e071g" position="anchor"/><mml:math id="M71" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (point in <xref rid="pone.0323478.g002" ref-type="fig">Fig 2</xref>) and speed limit <inline-formula id="pone.0323478.e072"><alternatives><graphic xlink:href="pone.0323478.e072.jpg" id="pone.0323478.e072g" position="anchor"/><mml:math id="M72" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Reserve travel time <inline-formula id="pone.0323478.e073"><alternatives><graphic xlink:href="pone.0323478.e073.jpg" id="pone.0323478.e073g" position="anchor"/><mml:math id="M73" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, assuming <inline-formula id="pone.0323478.e074"><alternatives><graphic xlink:href="pone.0323478.e074.jpg" id="pone.0323478.e074g" position="anchor"/><mml:math id="M74" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, which means that the train is already in the speed limit interval <inline-formula id="pone.0323478.e075"><alternatives><graphic xlink:href="pone.0323478.e075.jpg" id="pone.0323478.e075g" position="anchor"/><mml:math id="M75" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</monospace>
</p><p specific-use="line">
<monospace>2: Every time the train enters a speed limit interval, as shown in the red dot of <xref rid="pone.0323478.g002" ref-type="fig">Fig 2</xref> (indicating that the train enters the second speed limit interval), we draw the maximum traction speed curve from the train position and each speed limit section. Then, from the left end of each speed limit segment, the maximum brake speed curve is drawn to obtain the minimum travel time curve.</monospace>
</p><p specific-use="line">
<monospace>3: Calculate the minimum reserved time <inline-formula id="pone.0323478.e076"><alternatives><graphic xlink:href="pone.0323478.e076.jpg" id="pone.0323478.e076g" position="anchor"/><mml:math id="M76" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> from the minimum travel time curve between the current position <italic toggle="yes">S</italic><sub><italic toggle="yes">i</italic></sub> and leaving the current speed limit interval and reaching the destination.</monospace>
</p><p specific-use="line">
<monospace>4: Calculate the reserve time for the current speed limit interval <inline-formula id="pone.0323478.e077"><alternatives><graphic xlink:href="pone.0323478.e077.jpg" id="pone.0323478.e077g" position="anchor"/><mml:math id="M77" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.</monospace>
</p><p specific-use="line">
<monospace>5: <bold>Return</bold>
<inline-formula id="pone.0323478.e078"><alternatives><graphic xlink:href="pone.0323478.e078.jpg" id="pone.0323478.e078g" position="anchor"/><mml:math id="M78" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</monospace>
</p><disp-formula id="pone.0323478.e084"><alternatives><graphic xlink:href="pone.0323478.e084.jpg" id="pone.0323478.e084g" position="anchor"/><mml:math id="M85" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>desired&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(14)</label></disp-formula><p>The DMTD algorithm and <xref rid="pone.0323478.e084" ref-type="disp-formula">Eq (14)</xref> indicate that if the train is between <inline-formula id="pone.0323478.e085"><alternatives><graphic xlink:href="pone.0323478.e085.jpg" id="pone.0323478.e085g" position="anchor"/><mml:math id="M86" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">[</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo fence="true" form="postfix" stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, the train can reach its destination on time (within <inline-formula id="pone.0323478.e086"><alternatives><graphic xlink:href="pone.0323478.e086.jpg" id="pone.0323478.e086g" position="anchor"/><mml:math id="M87" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x000b1;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>3&#x02009;s of the planned trip time is on schedule, setting <italic toggle="yes">T</italic><sub>0</sub>=3 in the Algorithm 1). Therefore, if the train&#x02019;s speed is lower than <inline-formula id="pone.0323478.e087"><alternatives><graphic xlink:href="pone.0323478.e087.jpg" id="pone.0323478.e087g" position="anchor"/><mml:math id="M88" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>desired&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, the train needs to accelerate; if the train&#x02019;s speed is higher than <inline-formula id="pone.0323478.e088"><alternatives><graphic xlink:href="pone.0323478.e088.jpg" id="pone.0323478.e088g" position="anchor"/><mml:math id="M89" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, the train should coast. Then, the reasoning for determining the mode of operation (coasting or accelerating) is summarized as follows.</p><p>1) If <inline-formula id="pone.0323478.e089"><alternatives><graphic xlink:href="pone.0323478.e089.jpg" id="pone.0323478.e089g" position="anchor"/><mml:math id="M90" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, the train should accelerate, and the output of the expert system is defined as <xref rid="pone.0323478.e090" ref-type="disp-formula">Eq (15)</xref>:</p><disp-formula id="pone.0323478.e090"><alternatives><graphic xlink:href="pone.0323478.e090.jpg" id="pone.0323478.e090g" position="anchor"/><mml:math id="M91" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup></mml:mtd><mml:mtd columnalign="left"><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(15)</label></disp-formula><p>where <inline-formula id="pone.0323478.e091"><alternatives><graphic xlink:href="pone.0323478.e091.jpg" id="pone.0323478.e091g" position="anchor"/><mml:math id="M92" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the maximum acceleration, and <inline-formula id="pone.0323478.e092"><alternatives><graphic xlink:href="pone.0323478.e092.jpg" id="pone.0323478.e092g" position="anchor"/><mml:math id="M93" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the rate of variation of the acceleration in the time interval <inline-formula id="pone.0323478.e093"><alternatives><graphic xlink:href="pone.0323478.e093.jpg" id="pone.0323478.e093g" position="anchor"/><mml:math id="M94" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Note that the parameter <inline-formula id="pone.0323478.e094"><alternatives><graphic xlink:href="pone.0323478.e094.jpg" id="pone.0323478.e094g" position="anchor"/><mml:math id="M95" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is setted as <inline-formula id="pone.0323478.e095"><alternatives><graphic xlink:href="pone.0323478.e095.jpg" id="pone.0323478.e095g" position="anchor"/><mml:math id="M96" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.3</mml:mn><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> according to expert experience. If unknown disturbances are considered, such as the resistance and gradient of the line, <inline-formula id="pone.0323478.e096"><alternatives><graphic xlink:href="pone.0323478.e096.jpg" id="pone.0323478.e096g" position="anchor"/><mml:math id="M97" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is not constant. And the value of this parameter will be adjusted by PPO in the next section.</p><p>2) If <inline-formula id="pone.0323478.e097"><alternatives><graphic xlink:href="pone.0323478.e097.jpg" id="pone.0323478.e097g" position="anchor"/><mml:math id="M98" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>desired&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, the train should coast and the output of the expert system can be described as <xref rid="pone.0323478.e098" ref-type="disp-formula">Eq (16)</xref>:</p><disp-formula id="pone.0323478.e098"><alternatives><graphic xlink:href="pone.0323478.e098.jpg" id="pone.0323478.e098g" position="anchor"/><mml:math id="M99" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(16)</label></disp-formula><p>In addition, when the speed limit <inline-formula id="pone.0323478.e100"><alternatives><graphic xlink:href="pone.0323478.e100.jpg" id="pone.0323478.e100g" position="anchor"/><mml:math id="M100" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> of the next section is less than the speed limit <inline-formula id="pone.0323478.e101"><alternatives><graphic xlink:href="pone.0323478.e101.jpg" id="pone.0323478.e101g" position="anchor"/><mml:math id="M101" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> of the current section, as shown in <xref rid="pone.0323478.g003" ref-type="fig">Fig 3</xref>, the train may need to brake at a reasonable speed to ensure the safety of the train. In other words, the speed of the train should always be lower than the speed limit. In this case, we define the safe speed <inline-formula id="pone.0323478.e102"><alternatives><graphic xlink:href="pone.0323478.e102.jpg" id="pone.0323478.e102g" position="anchor"/><mml:math id="M102" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>safe&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> to monitor the speed of the train:</p><disp-formula id="pone.0323478.e103"><alternatives><graphic xlink:href="pone.0323478.e103.jpg" id="pone.0323478.e103g" position="anchor"/><mml:math id="M103" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">f</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:msup><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(17)</label></disp-formula><p>where <italic toggle="yes">s</italic><sub><italic toggle="yes">i</italic></sub> is the current position of the train. <inline-formula id="pone.0323478.e104"><alternatives><graphic xlink:href="pone.0323478.e104.jpg" id="pone.0323478.e104g" position="anchor"/><mml:math id="M104" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the starting position of the next section. <inline-formula id="pone.0323478.e105"><alternatives><graphic xlink:href="pone.0323478.e105.jpg" id="pone.0323478.e105g" position="anchor"/><mml:math id="M105" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b2;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the speed scaling factor caused by the time delay and friction of the railroad, which is taken as 0.95 in this paper. <inline-formula id="pone.0323478.e106"><alternatives><graphic xlink:href="pone.0323478.e106.jpg" id="pone.0323478.e106g" position="anchor"/><mml:math id="M106" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the maximum deceleration speed. In this paper, <inline-formula id="pone.0323478.e107"><alternatives><graphic xlink:href="pone.0323478.e107.jpg" id="pone.0323478.e107g" position="anchor"/><mml:math id="M107" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. When the train operates to the position indicated by the mark 1 in <xref rid="pone.0323478.g003" ref-type="fig">Fig 3</xref>, i.e., when the current speed <inline-formula id="pone.0323478.e108"><alternatives><graphic xlink:href="pone.0323478.e108.jpg" id="pone.0323478.e108g" position="anchor"/><mml:math id="M108" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is higher than or equal to <inline-formula id="pone.0323478.e109"><alternatives><graphic xlink:href="pone.0323478.e109.jpg" id="pone.0323478.e109g" position="anchor"/><mml:math id="M109" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>safe&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, then the train should immediately apply the maximum deceleration <inline-formula id="pone.0323478.e110"><alternatives><graphic xlink:href="pone.0323478.e110.jpg" id="pone.0323478.e110g" position="anchor"/><mml:math id="M110" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. In addition, if the length of the current speed limit interval is long enough, there will be a situation where <inline-formula id="pone.0323478.e111"><alternatives><graphic xlink:href="pone.0323478.e111.jpg" id="pone.0323478.e111g" position="anchor"/><mml:math id="M111" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>safe</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> exceeds the speed limit, which may cause the train to run beyond the speed limit (shown in <xref rid="pone.0323478.g003" ref-type="fig">Fig 3</xref>, marker 2.), so we redefine the safe speed to ensure safe driving:</p><disp-formula id="pone.0323478.e112"><alternatives><graphic xlink:href="pone.0323478.e112.jpg" id="pone.0323478.e112g" position="anchor"/><mml:math id="M112" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>safe&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:msqrt><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:msup><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>min</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:msqrt><mml:mo>,</mml:mo><mml:mi>&#x003b2;</mml:mi><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mtext>limit&#x000a0;</mml:mtext></mml:mrow></mml:msubsup><mml:mo fence="true" form="postfix" stretchy="true">}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(18)</label></disp-formula><p>We defined the parking accuracy (parking error less than <inline-formula id="pone.0323478.e113"><alternatives><graphic xlink:href="pone.0323478.e113.jpg" id="pone.0323478.e113g" position="anchor"/><mml:math id="M113" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x000b1;</mml:mi><mml:mn>30</mml:mn><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>) in <xref rid="pone.0323478.e053" ref-type="disp-formula">Eq (13)</xref>, and all three automatic stop control algorithms (TASC) proposed in our previous work can achieve accurate parking of trains, the details of TASC please see the reference [<xref rid="pone.0323478.ref025" ref-type="bibr">25</xref>]. Therefore, we apply the heuristic online learning algorithm (HOA) of TASC at the location shown in <xref rid="pone.0323478.g003" ref-type="fig">Fig 3</xref> mark 3 to ensure the parking accuracy of the train. The EITO&#x02019;s expert system is implemented after expert rules and heuristic inference methods have been designed. As illustrated in <xref rid="pone.0323478.g003" ref-type="fig">Fig 3</xref>, EITO<sub>E</sub> can make appropriate acceleration, coasting, or deceleration decisions based on online and offline data such as speed limits and gradients, as well as expert reasoning methods, and its speed profile can be divided into acceleration phase, multiple coasting phases, safety braking phase, and parking phase. Furthermore, the output is constrained by expert criteria to assure comfort and punctuality.</p><p>However, EITO<sub>E</sub> cannot optimize energy consumption online, because <inline-formula id="pone.0323478.e116"><alternatives><graphic xlink:href="pone.0323478.e116.jpg" id="pone.0323478.e116g" position="anchor"/><mml:math id="M116" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is specified as a constant value. Therefore, the PPO is introduced to improve the performance of EITO<sub>E</sub>.</p></sec><sec id="sec007"><title>3.2 EITO<sub>P</sub></title><p>RL is a machine learning paradigm that aims to learn to control systems in environments to maximize numerical performance associated with long-term goals [<xref rid="pone.0323478.ref027" ref-type="bibr">27</xref>]. Three reasons motivate us to adapt deep reinforcement learning in train control tasks:</p><p>(1) The EITO algorithm does not require reference to the target speed profile, while RL does not require external supervision. (2) During train control, behavior affects not only the immediate reward but also the reward for future states, which falls into the advantage of RL. (3) The use of deep reinforcement learning can modify the control strategies used in current ATO systems for discrete actions. <italic toggle="yes">EITO</italic><sub><italic toggle="yes">P</italic></sub>. The algorithmic process of EITO<sub>P</sub> is presented in Algorithm 2.</p><disp-formula id="pone.0323478.e384">
<graphic xlink:href="pone.0323478.e384.jpg" id="pone.0323478.e384g" position="anchor"/>
</disp-formula><p>Markov Decision Process: Before applying the reinforcement learning algorithm, we formulate our problem as a Markov Decision Process (MDP), which provides a mathematical framework for decision making. The key elements of reinforcement learning include its state, action, policy, and reward, which are defined as follows.</p><list list-type="bullet"><list-item><p><italic toggle="yes">State</italic>
<italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>. In this case, the train status, with the current position, speed, and reserved trip time, can be described as:<disp-formula id="pone.0323478.e137"><alternatives><graphic xlink:href="pone.0323478.e137.jpg" id="pone.0323478.e137g" position="anchor"/><mml:math id="M121" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">[</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.2em"/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x022ef;</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(19)</label></disp-formula></p><p>Let <italic toggle="yes">x</italic><sub>0</sub> denotes the initial train state and <italic toggle="yes">x</italic><sub><italic toggle="yes">m</italic></sub> denotes the final state. Obviously, the following equations should hold:<disp-formula id="pone.0323478.e138"><alternatives><graphic xlink:href="pone.0323478.e138.jpg" id="pone.0323478.e138g" position="anchor"/><mml:math id="M122" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(20)</label></disp-formula></p></list-item><list-item><p>
<disp-formula id="pone.0323478.e139"><alternatives><graphic xlink:href="pone.0323478.e139.jpg" id="pone.0323478.e139g" position="anchor"/><mml:math id="M123" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">[</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(21)</label></disp-formula>
</p></list-item><list-item><p><italic toggle="yes">Action</italic>
<italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub>. In contrast to <inline-formula id="pone.0323478.e140"><alternatives><graphic xlink:href="pone.0323478.e140.jpg" id="pone.0323478.e140g" position="anchor"/><mml:math id="M124" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in <xref rid="pone.0323478.e090" ref-type="disp-formula">Eq (15)</xref> in EITO<sub>E</sub>, EITO<sub>P</sub> has a variable variation of acceleration in each state. As shown in <xref rid="pone.0323478.e147" ref-type="disp-formula">Eqs (22)</xref>&#x02013;(<xref rid="pone.0323478.e149" ref-type="disp-formula">23</xref>), we use <inline-formula id="pone.0323478.e143"><alternatives><graphic xlink:href="pone.0323478.e143.jpg" id="pone.0323478.e143g" position="anchor"/><mml:math id="M127" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>var&#x000a0;</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> instead of <inline-formula id="pone.0323478.e144"><alternatives><graphic xlink:href="pone.0323478.e144.jpg" id="pone.0323478.e144g" position="anchor"/><mml:math id="M128" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Meanwhile, we define the range of <italic toggle="yes">u</italic><sub><italic toggle="yes">i</italic></sub> and <inline-formula id="pone.0323478.e145"><alternatives><graphic xlink:href="pone.0323478.e145.jpg" id="pone.0323478.e145g" position="anchor"/><mml:math id="M129" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> as [&#x02013;1,1] and [&#x02013;0.3,0.3], respectively. Therefore, action <italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub> can be defined for the EITO<sub>P</sub>:<disp-formula id="pone.0323478.e147"><alternatives><graphic xlink:href="pone.0323478.e147.jpg" id="pone.0323478.e147g" position="anchor"/><mml:math id="M131" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(22)</label></disp-formula></p></list-item><list-item><p>when <inline-formula id="pone.0323478.e148"><alternatives><graphic xlink:href="pone.0323478.e148.jpg" id="pone.0323478.e148g" position="anchor"/><mml:math id="M132" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>desired</mml:mtext></mml:mrow></mml:msubsup><mml:mi>:</mml:mi></mml:mrow></mml:math></alternatives></inline-formula><disp-formula id="pone.0323478.e149"><alternatives><graphic xlink:href="pone.0323478.e149.jpg" id="pone.0323478.e149g" position="anchor"/><mml:math id="M133" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>|</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x0003c;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mo>max</mml:mo></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(23)</label></disp-formula></p></list-item><list-item><p>when <inline-formula id="pone.0323478.e150"><alternatives><graphic xlink:href="pone.0323478.e150.jpg" id="pone.0323478.e150g" position="anchor"/><mml:math id="M134" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02265;</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>desired</mml:mtext></mml:mrow></mml:msubsup><mml:mi>:</mml:mi></mml:mrow></mml:math></alternatives></inline-formula><disp-formula id="pone.0323478.e151"><alternatives><graphic xlink:href="pone.0323478.e151.jpg" id="pone.0323478.e151g" position="anchor"/><mml:math id="M135" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(24)</label></disp-formula></p></list-item><list-item><p><italic toggle="yes">Policy <inline-formula id="pone.0323478.e152"><alternatives><graphic xlink:href="pone.0323478.e152.jpg" id="pone.0323478.e152g" position="anchor"/><mml:math id="M136" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></italic>. The policy <inline-formula id="pone.0323478.e153"><alternatives><graphic xlink:href="pone.0323478.e153.jpg" id="pone.0323478.e153g" position="anchor"/><mml:math id="M137" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> represents the probability of taking an action while processing a discrete action task. In this paper, since EITO is intended to address continuous action control tasks, a policy is a statistic of the probability distribution, which is expressed as <xref rid="pone.0323478.e154" ref-type="disp-formula">Eq (25)</xref>:<disp-formula id="pone.0323478.e154"><alternatives><graphic xlink:href="pone.0323478.e154.jpg" id="pone.0323478.e154g" position="anchor"/><mml:math id="M138" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>&#x02223;</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>&#x1d4a9;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003bc;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(25)</label></disp-formula></p></list-item><list-item><p>where <inline-formula id="pone.0323478.e155"><alternatives><graphic xlink:href="pone.0323478.e155.jpg" id="pone.0323478.e155g" position="anchor"/><mml:math id="M139" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the weight.</p></list-item><list-item><p><italic toggle="yes">Reward function <inline-formula id="pone.0323478.e156"><alternatives><graphic xlink:href="pone.0323478.e156.jpg" id="pone.0323478.e156g" position="anchor"/><mml:math id="M140" display="inline" overflow="scroll"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></italic>: This function defines the reward that the train receives when it takes an action in a given state. In this case, our reward function is defined by the time error <inline-formula id="pone.0323478.e157"><alternatives><graphic xlink:href="pone.0323478.e157.jpg" id="pone.0323478.e157g" position="anchor"/><mml:math id="M141" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, the passenger comfort <inline-formula id="pone.0323478.e158"><alternatives><graphic xlink:href="pone.0323478.e158.jpg" id="pone.0323478.e158g" position="anchor"/><mml:math id="M142" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and the energy consumed per unit mass <inline-formula id="pone.0323478.e159"><alternatives><graphic xlink:href="pone.0323478.e159.jpg" id="pone.0323478.e159g" position="anchor"/><mml:math id="M143" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> in the time interval when the train takes action <italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub> in state <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub>.<disp-formula id="pone.0323478.e160"><alternatives><graphic xlink:href="pone.0323478.e160.jpg" id="pone.0323478.e160g" position="anchor"/><mml:math id="M144" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(26)</label></disp-formula></p></list-item><list-item><p>where <inline-formula id="pone.0323478.e161"><alternatives><graphic xlink:href="pone.0323478.e161.jpg" id="pone.0323478.e161g" position="anchor"/><mml:math id="M145" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are determined by expert experience, and <italic toggle="yes">t</italic><sub><italic toggle="yes">e</italic></sub> is defined as <xref rid="pone.0323478.e162" ref-type="disp-formula">Eq (27)</xref>:<disp-formula id="pone.0323478.e162"><alternatives><graphic xlink:href="pone.0323478.e162.jpg" id="pone.0323478.e162g" position="anchor"/><mml:math id="M146" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02264;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x0003e;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(27)</label></disp-formula></p></list-item></list><p>The role of <inline-formula id="pone.0323478.e163"><alternatives><graphic xlink:href="pone.0323478.e163.jpg" id="pone.0323478.e163g" position="anchor"/><mml:math id="M147" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e164"><alternatives><graphic xlink:href="pone.0323478.e164.jpg" id="pone.0323478.e164g" position="anchor"/><mml:math id="M148" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is used to ensure that the agent optimizes energy consumption while ensuring punctuality and comfort as much as possible, rather than just reducing energy consumption.</p><p>The EITO<sub>P</sub> algorithm is based on the PPO algorithm [<xref rid="pone.0323478.ref028" ref-type="bibr">28</xref>]. PPO is a deep reinforcement learning algorithm based on policy gradient (PG). Moreover, it is based on the Actor-Critic framework capable of handling continuous action control and model-free problems. The PPO algorithm limits the update magnitude of the new policy according to the ratio of the old to the new policy so that the PG algorithm can be trained and converge at a larger learning rate. The objective function of the policy gradient algorithm is:</p><disp-formula id="pone.0323478.e166"><alternatives><graphic xlink:href="pone.0323478.e166.jpg" id="pone.0323478.e166g" position="anchor"/><mml:math id="M150" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">[</mml:mo><mml:mi>A</mml:mi><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mo fence="true" form="postfix" stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(28)</label></disp-formula><p>where <inline-formula id="pone.0323478.e167"><alternatives><graphic xlink:href="pone.0323478.e167.jpg" id="pone.0323478.e167g" position="anchor"/><mml:math id="M151" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x02022;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denotes the policy function; <inline-formula id="pone.0323478.e168"><alternatives><graphic xlink:href="pone.0323478.e168.jpg" id="pone.0323478.e168g" position="anchor"/><mml:math id="M152" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the network parameter of Actor; <italic toggle="yes">i</italic> denotes the state or action of the <italic toggle="yes">i</italic>th step; <inline-formula id="pone.0323478.e169"><alternatives><graphic xlink:href="pone.0323478.e169.jpg" id="pone.0323478.e169g" position="anchor"/><mml:math id="M153" display="inline" overflow="scroll"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the estimate of the advantage function of <italic toggle="yes">i</italic>th step, as shown in <xref rid="pone.0323478.e170" ref-type="disp-formula">Eq (29)</xref>; <italic toggle="yes">E</italic> denotes the empirical expectation of the time step. The advantage function is chosen at the state to compare the obtained score with the average score. If it is high, then the advantage function is positive. Otherwise, it is inverse. The gradient ascent method is used to update the value function.</p><disp-formula id="pone.0323478.e170"><alternatives><graphic xlink:href="pone.0323478.e170.jpg" id="pone.0323478.e170g" position="anchor"/><mml:math id="M154" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(29)</label></disp-formula><p>where <inline-formula id="pone.0323478.e171"><alternatives><graphic xlink:href="pone.0323478.e171.jpg" id="pone.0323478.e171g" position="anchor"/><mml:math id="M155" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the state action-value function, which represents the expected reward of the Agent following the policy <inline-formula id="pone.0323478.e172"><alternatives><graphic xlink:href="pone.0323478.e172.jpg" id="pone.0323478.e172g" position="anchor"/><mml:math id="M156" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, after performing an action <italic toggle="yes">a</italic><sub><italic toggle="yes">i</italic></sub> in state <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> until the end of the episode. Similarly, the state value function <inline-formula id="pone.0323478.e173"><alternatives><graphic xlink:href="pone.0323478.e173.jpg" id="pone.0323478.e173g" position="anchor"/><mml:math id="M157" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>&#x003c0;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represents the expected reward of the Agent following the policy from the state <italic toggle="yes">x</italic><sub><italic toggle="yes">i</italic></sub> to the end of the episode.</p><p>Because the PG algorithm adopts the online update policy to resampling every parameter update, its learning rate is not easy to determine. The PPO algorithm converts the online update strategy into an offline update strategy, i.e., a new and old Actor strategy is used. The training data of the new Actor can be obtained from the old Actor, while the new strategy weight is expressed using the ratio of action probabilities <inline-formula id="pone.0323478.e174"><alternatives><graphic xlink:href="pone.0323478.e174.jpg" id="pone.0323478.e174g" position="anchor"/><mml:math id="M158" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of the old and new strategies, which is expressed as <xref rid="pone.0323478.e175" ref-type="disp-formula">Eq (30)</xref>:</p><disp-formula id="pone.0323478.e175"><alternatives><graphic xlink:href="pone.0323478.e175.jpg" id="pone.0323478.e175g" position="anchor"/><mml:math id="M159" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:msup><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mi>&#x02032;</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02223;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(30)</label></disp-formula><p>where <inline-formula id="pone.0323478.e176"><alternatives><graphic xlink:href="pone.0323478.e176.jpg" id="pone.0323478.e176g" position="anchor"/><mml:math id="M160" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mi>&#x02032;</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is the sampled neural network parameter. If the probability distributions obtained for two neural network parameters <inline-formula id="pone.0323478.e177"><alternatives><graphic xlink:href="pone.0323478.e177.jpg" id="pone.0323478.e177g" position="anchor"/><mml:math id="M161" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e178"><alternatives><graphic xlink:href="pone.0323478.e178.jpg" id="pone.0323478.e178g" position="anchor"/><mml:math id="M162" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mi>&#x02032;</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> in the same state differ greatly and in the case of under-sampling, it leads to a large variance between them. Therefore, the PPO algorithm adds a CLIP function to the base of the objective function to limit the parameters <inline-formula id="pone.0323478.e179"><alternatives><graphic xlink:href="pone.0323478.e179.jpg" id="pone.0323478.e179g" position="anchor"/><mml:math id="M163" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e180"><alternatives><graphic xlink:href="pone.0323478.e180.jpg" id="pone.0323478.e180g" position="anchor"/><mml:math id="M164" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>&#x003b8;</mml:mi><mml:mrow><mml:mi>&#x02032;</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, given as follows:</p><disp-formula id="pone.0323478.e181"><alternatives><graphic xlink:href="pone.0323478.e181.jpg" id="pone.0323478.e181g" position="anchor"/><mml:math id="M165" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>O</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:mi>~</mml:mi><mml:msub><mml:mi>&#x003c0;</mml:mi><mml:mrow><mml:mi>&#x003b8;</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">[</mml:mo><mml:mo>min</mml:mo><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mrow><mml:mo fence="true" form="postfix" stretchy="true"/></mml:mrow><mml:mtext>clip</mml:mtext><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true"/><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>&#x003b8;</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>|</mml:mo><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003b5;</mml:mi><mml:mo>|</mml:mo><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo fence="true" form="postfix" stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></alternatives>
<label>(31)</label></disp-formula><p>The term &#x0201c;continuous control task&#x0201d; in our work refers to real - time optimization of continuous traction/braking forces without relying on predefined discrete actions or offline speed profiles. Unlike traditional methods that track fixed trajectories, our algorithms dynamically adjust acceleration/braking rates (<xref rid="pone.0323478.e147" ref-type="disp-formula">Eq (22</xref>-(<xref rid="pone.0323478.e151" ref-type="disp-formula">24</xref>) based on real - time states (position, speed, remaining time) and environmental conditions (speed limits, gradients). This is enabled by:</p><list list-type="bullet"><list-item><p>EITO<sub>E</sub>: Expert rules (Sect 3.1) and the DMTD heuristic (Algorithm 1) generate smooth, continuous force adjustments.</p></list-item><list-item><p>EITO<sub>P</sub>: The PPO - based reinforcement learning framework (Sect 3.2) optimizes continuous actions (<inline-formula id="pone.0323478.e184"><alternatives><graphic xlink:href="pone.0323478.e184.jpg" id="pone.0323478.e184g" position="anchor"/><mml:math id="M168" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>) in a policy gradient manner (<xref rid="pone.0323478.e154" ref-type="disp-formula">Eq (25)</xref>, allowing fine - grained control over acceleration/deceleration.</p></list-item></list><p>This approach eliminates abrupt state transitions (e.g., discrete coasting points in prior works [<xref rid="pone.0323478.ref010" ref-type="bibr">10</xref>,<xref rid="pone.0323478.ref012" ref-type="bibr">12</xref>]) and ensures seamless adaptation to varying line conditions (<xref rid="sec011" ref-type="sec">Sect 4.3</xref>).</p><p>While the core control logic is detailed in Algorithms 1 (EITO<sub>E</sub>) and 2 (EITO<sub>P</sub>), we acknowledge that the convergence analysis of PPO training could be elaborated further. For clarity: Control Steps:EITO<sub>P</sub> iteratively samples actions from a Gaussian policy (<xref rid="pone.0323478.e154" ref-type="disp-formula">Eq 25)</xref> and updates actor-critic networks using clipped surrogate objectives (<xref rid="pone.0323478.e181" ref-type="disp-formula">Eq 31)</xref>. The reward function (<xref rid="pone.0323478.e160" ref-type="disp-formula">Eq 26)</xref> penalizes energy consumption, comfort violations, and time deviations, ensuring balanced optimization. Convergence: <xref rid="pone.0323478.g005" ref-type="fig">Fig 5</xref> (training curves) shows energy consumption and running time stabilize after 80 episodes, indicating policy convergence.</p><fig position="float" id="pone.0323478.g004"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g004</object-id><label>Fig 4</label><caption><title>Speed limits and gradients from RJ to WYJ.</title></caption><graphic xlink:href="pone.0323478.g004" position="float"/></fig></sec></sec><sec id="sec008"><title>4 Simulations</title><p>To verify the intelligence, flexibility, and robustness of EITO<sub>E</sub> and EITO<sub>P</sub>, we designed three numerical simulation experiments based on field data collected in YLBS. YLBS started operation in Beijing on December 30,2010, with a total length of 23.3<inline-formula id="pone.0323478.e190"><alternatives><graphic xlink:href="pone.0323478.e190.jpg" id="pone.0323478.e190g" position="anchor"/><mml:math id="M174" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, starting from Songjiazhuang station and ending at Ciqu station. The train type used in YLBS is DKZ32 EMU with 6 vehicles, whose parameters are shown in <xref rid="pone.0323478.t001" ref-type="table">Table 1</xref>. To rigorously validate the suitability of EITO<sub>P</sub> for online control, we conducted experiments on a workstation with the following specifications: CPU: Intel i9-10900K (10 cores, 3.7 GHz) , GPU: NVIDIA RTX 3090 (24 GB VRAM), Memory: 64 GB DDR4 , Software: Python 3.8, TensorFlow 2.6.</p><table-wrap position="float" id="pone.0323478.t001"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.t001</object-id><label>Table 1</label><caption><title>Parameters of DKZ32.</title></caption><alternatives><graphic xlink:href="pone.0323478.t001" id="pone.0323478.t001g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Parameters</th><th align="left" rowspan="1" colspan="1">Value</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e192">
<alternatives><graphic xlink:href="pone.0323478.e192" id="pone.0323478.e192g" position="anchor"/><mml:math id="M176" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives>
</inline-formula>
</td><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e193">
<alternatives><graphic xlink:href="pone.0323478.e193" id="pone.0323478.e193g" position="anchor"/><mml:math id="M177" display="inline" overflow="scroll"><mml:mrow><mml:mn>1.99</mml:mn><mml:mi>&#x000d7;</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives>
</inline-formula>
</td></tr><tr><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e194">
<alternatives><graphic xlink:href="pone.0323478.e194" id="pone.0323478.e194g" position="anchor"/><mml:math id="M178" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives>
</inline-formula>
</td><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e195">
<alternatives><graphic xlink:href="pone.0323478.e195" id="pone.0323478.e195g" position="anchor"/><mml:math id="M179" display="inline" overflow="scroll"><mml:mrow><mml:mn>3.3</mml:mn><mml:mi>&#x000d7;</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives>
</inline-formula>
</td></tr><tr><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e196">
<alternatives><graphic xlink:href="pone.0323478.e196" id="pone.0323478.e196g" position="anchor"/><mml:math id="M180" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives>
</inline-formula>
</td><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e197">
<alternatives><graphic xlink:href="pone.0323478.e197" id="pone.0323478.e197g" position="anchor"/><mml:math id="M181" display="inline" overflow="scroll"><mml:mrow><mml:mn>2.8</mml:mn><mml:mi>&#x000d7;</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives>
</inline-formula>
</td></tr><tr><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e198">
<alternatives><graphic xlink:href="pone.0323478.e198" id="pone.0323478.e198g" position="anchor"/><mml:math id="M182" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives>
</inline-formula>
</td><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e199">
<alternatives><graphic xlink:href="pone.0323478.e199" id="pone.0323478.e199g" position="anchor"/><mml:math id="M183" display="inline" overflow="scroll"><mml:mrow><mml:mn>3.5</mml:mn><mml:mi>&#x000d7;</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives>
</inline-formula>
</td></tr><tr><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e200">
<alternatives><graphic xlink:href="pone.0323478.e200" id="pone.0323478.e200g" position="anchor"/><mml:math id="M184" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mover><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives>
</inline-formula>
</td><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e201">
<alternatives><graphic xlink:href="pone.0323478.e201" id="pone.0323478.e201g" position="anchor"/><mml:math id="M185" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.1</mml:mn><mml:mi>sin</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives>
</inline-formula>
</td></tr><tr><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e202">
<alternatives><graphic xlink:href="pone.0323478.e202" id="pone.0323478.e202g" position="anchor"/><mml:math id="M186" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mover><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mo>&#x000a8;</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives>
</inline-formula>
</td><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e203">
<alternatives><graphic xlink:href="pone.0323478.e203" id="pone.0323478.e203g" position="anchor"/><mml:math id="M187" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.15</mml:mn><mml:mi>cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives>
</inline-formula>
</td></tr><tr><td align="left" rowspan="1" colspan="1">Time constant (Braking) <inline-formula id="pone.0323478.e204"><alternatives><graphic xlink:href="pone.0323478.e204" id="pone.0323478.e204g" position="anchor"/><mml:math id="M188" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td><td align="left" rowspan="1" colspan="1">0.4</td></tr><tr><td align="left" rowspan="1" colspan="1">Time delay (Braking)(s) <inline-formula id="pone.0323478.e205"><alternatives><graphic xlink:href="pone.0323478.e205" id="pone.0323478.e205g" position="anchor"/><mml:math id="M189" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td><td align="left" rowspan="1" colspan="1">0.8</td></tr><tr><td align="left" rowspan="1" colspan="1">Time constant (Accelerating) <inline-formula id="pone.0323478.e206"><alternatives><graphic xlink:href="pone.0323478.e206" id="pone.0323478.e206g" position="anchor"/><mml:math id="M190" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003c3;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td><td align="left" rowspan="1" colspan="1">0.4</td></tr><tr><td align="left" rowspan="1" colspan="1">Time delay (Accelerating)(s) <inline-formula id="pone.0323478.e207"><alternatives><graphic xlink:href="pone.0323478.e207" id="pone.0323478.e207g" position="anchor"/><mml:math id="M191" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e208">
<alternatives><graphic xlink:href="pone.0323478.e208" id="pone.0323478.e208g" position="anchor"/><mml:math id="M192" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:math></alternatives>
</inline-formula>
</td><td align="left" rowspan="1" colspan="1">1.244</td></tr><tr><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e209">
<alternatives><graphic xlink:href="pone.0323478.e209" id="pone.0323478.e209g" position="anchor"/><mml:math id="M193" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x003b2;</mml:mi><mml:mo>,</mml:mo><mml:mi>&#x003b3;</mml:mi></mml:mrow></mml:math></alternatives>
</inline-formula>
</td><td align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e210">
<alternatives><graphic xlink:href="pone.0323478.e210" id="pone.0323478.e210g" position="anchor"/><mml:math id="M194" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mo fence="true" form="prefix" stretchy="true">(</mml:mo><mml:mn>1.45</mml:mn><mml:mi>&#x000d7;</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mn>1.36</mml:mn><mml:mi>&#x000d7;</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo fence="true" form="postfix" stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</td></tr></tbody></table></alternatives></table-wrap><p>Three simulation cases are presented in this section. The manual driving dataset we use in this section was collected in YLBS from May 1, 2015, to May 27, 2015, including 100 groups of up trains and down trains. We select the manual driving data with the best-generalized performance from the recorded dataset as <inline-formula id="pone.0323478.e211"><alternatives><graphic xlink:href="pone.0323478.e211.jpg" id="pone.0323478.e211g" position="anchor"/><mml:math id="M195" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>EITO</mml:mo><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. In Case 1, we compare the results of all algorithms (<inline-formula id="pone.0323478.e212"><alternatives><graphic xlink:href="pone.0323478.e212.jpg" id="pone.0323478.e212g" position="anchor"/><mml:math id="M196" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>EITO</mml:mo><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, ITOR, STON, EITO<sub>E</sub> and EITO<sub>P</sub>). In Case 2, we test the intelligence and flexibility of all algorithms by varying the planned trip time of the same rail segment. In Case 3, we test the operational performance of EITO models with complex gradients and speed limits to verify the robustness of proposed EITO<sub>E</sub> and <inline-formula id="pone.0323478.e216"><alternatives><graphic xlink:href="pone.0323478.e216.jpg" id="pone.0323478.e216g" position="anchor"/><mml:math id="M200" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>EITO</mml:mo><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p><sec id="sec009"><title>4.1 Case 1</title><p>Taking the interval between Rongjing station(RJ) and Wanyuanjie station(WYJ) as an example, the speed limit and gradient of this interval are shown in <xref rid="pone.0323478.g004" ref-type="fig">Fig 4</xref>. The planned trip time <italic toggle="yes">T</italic><sub><italic toggle="yes">p</italic></sub> =101&#x02009;s is the same as the actual operation, and the distance between the two stations is 1280<inline-formula id="pone.0323478.e217"><alternatives><graphic xlink:href="pone.0323478.e217.jpg" id="pone.0323478.e217g" position="anchor"/><mml:math id="M201" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p><p><xref rid="pone.0323478.g005" ref-type="fig">Figs 5</xref> and <xref rid="pone.0323478.g006" ref-type="fig">6</xref> show the energy consumption <italic toggle="yes">E</italic> and the running time (/s) during the online learning process of EITO<sub>P</sub>. The results show that during DRL, the energy consumption is reduced from 380 to 364 after about 80 rounds of training and gradually approaches the optimal value. In addition, the running time floats within 100 s<inline-formula id="pone.0323478.e219"><alternatives><graphic xlink:href="pone.0323478.e219.jpg" id="pone.0323478.e219g" position="anchor"/><mml:math id="M203" display="inline" overflow="scroll"><mml:mrow><mml:mi>~</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>102&#x02009;s (<italic toggle="yes">T</italic><sub><italic toggle="yes">p</italic></sub>&#x02009;=&#x02009;101&#x02009;s). According to the definition of punctuality i.e., a time error of less than <inline-formula id="pone.0323478.e220"><alternatives><graphic xlink:href="pone.0323478.e220.jpg" id="pone.0323478.e220g" position="anchor"/><mml:math id="M204" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x000b1;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>3&#x02009;s is allowed. This indicates that applying the PPO algorithm in <inline-formula id="pone.0323478.e221"><alternatives><graphic xlink:href="pone.0323478.e221.jpg" id="pone.0323478.e221g" position="anchor"/><mml:math id="M205" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can reduce the energy consumption online while satisfying the running time error constraint.</p><p>It can be seen from <xref rid="pone.0323478.g007" ref-type="fig">Fig 7</xref> that the <inline-formula id="pone.0323478.e222"><alternatives><graphic xlink:href="pone.0323478.e222.jpg" id="pone.0323478.e222g" position="anchor"/><mml:math id="M206" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e223"><alternatives><graphic xlink:href="pone.0323478.e223.jpg" id="pone.0323478.e223g" position="anchor"/><mml:math id="M207" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> start to coast after accelerating to <inline-formula id="pone.0323478.e224"><alternatives><graphic xlink:href="pone.0323478.e224.jpg" id="pone.0323478.e224g" position="anchor"/><mml:math id="M208" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mtext>desired</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> in the first two speed limit intervals, and the coast point of <inline-formula id="pone.0323478.e225"><alternatives><graphic xlink:href="pone.0323478.e225.jpg" id="pone.0323478.e225g" position="anchor"/><mml:math id="M209" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is more advanced. The coast distance of EITO<sub>E</sub> and EITO<sub>P</sub> are 899.78<inline-formula id="pone.0323478.e228"><alternatives><graphic xlink:href="pone.0323478.e228.jpg" id="pone.0323478.e228g" position="anchor"/><mml:math id="M212" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e229"><alternatives><graphic xlink:href="pone.0323478.e229.jpg" id="pone.0323478.e229g" position="anchor"/><mml:math id="M213" display="inline" overflow="scroll"><mml:mrow><mml:mn>842.00</mml:mn><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, respectively. Note that in the last speed limit interval, <inline-formula id="pone.0323478.e230"><alternatives><graphic xlink:href="pone.0323478.e230.jpg" id="pone.0323478.e230g" position="anchor"/><mml:math id="M214" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> did not choose to coast at the position where <inline-formula id="pone.0323478.e231"><alternatives><graphic xlink:href="pone.0323478.e231.jpg" id="pone.0323478.e231g" position="anchor"/><mml:math id="M215" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> started to coast. Instead, it decelerates slightly based on its current position, speed, and remaining trip time. It causes EITO<sub>P</sub>&#x02019;s <italic toggle="yes">I</italic><sub><italic toggle="yes">e</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub> can be further reduced compared to <inline-formula id="pone.0323478.e233"><alternatives><graphic xlink:href="pone.0323478.e233.jpg" id="pone.0323478.e233g" position="anchor"/><mml:math id="M217" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, which shows that <inline-formula id="pone.0323478.e234"><alternatives><graphic xlink:href="pone.0323478.e234.jpg" id="pone.0323478.e234g" position="anchor"/><mml:math id="M218" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can consider the constraints of mult-objectives in a more integrated way.</p><p><xref rid="pone.0323478.g007" ref-type="fig">Figs 7</xref> and <xref rid="pone.0323478.g008" ref-type="fig">8</xref> shows the speed distance curves of the five algorithms at a 101&#x02009;s planned trip time. It can be seen the speed curve of EITO<sub>M</sub> can be divided into the full acceleration phase, coasting phase, and full braking phase. EITO<sub>E</sub> has the highest maximum speed of 19.49 <inline-formula id="pone.0323478.e237"><alternatives><graphic xlink:href="pone.0323478.e237.jpg" id="pone.0323478.e237g" position="anchor"/><mml:math id="M221" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, with four phases, the acceleration phase, multiple coasting phases, safety braking phase, and parking phase in its speed-distance curve. In addition, the coasting distances of <inline-formula id="pone.0323478.e238"><alternatives><graphic xlink:href="pone.0323478.e238.jpg" id="pone.0323478.e238g" position="anchor"/><mml:math id="M222" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, ITOR, and STON are 677.99<inline-formula id="pone.0323478.e239"><alternatives><graphic xlink:href="pone.0323478.e239.jpg" id="pone.0323478.e239g" position="anchor"/><mml:math id="M223" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, 398.78<inline-formula id="pone.0323478.e240"><alternatives><graphic xlink:href="pone.0323478.e240.jpg" id="pone.0323478.e240g" position="anchor"/><mml:math id="M224" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and 661.46<inline-formula id="pone.0323478.e241"><alternatives><graphic xlink:href="pone.0323478.e241.jpg" id="pone.0323478.e241g" position="anchor"/><mml:math id="M225" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> respectively, which are significantly less than those of <inline-formula id="pone.0323478.e242"><alternatives><graphic xlink:href="pone.0323478.e242.jpg" id="pone.0323478.e242g" position="anchor"/><mml:math id="M226" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e243"><alternatives><graphic xlink:href="pone.0323478.e243.jpg" id="pone.0323478.e243g" position="anchor"/><mml:math id="M227" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, indicating that the proposed EITO algorithms have lower energy consumption.</p><p>We can see from <xref rid="pone.0323478.t002" ref-type="table">Table 2</xref> that all five algorithms meet the requirements of YLBS in terms of safety, punctuality, and parking accuracy. Among these algorithms, ITOR has the highest energy consumption. Compared with <inline-formula id="pone.0323478.e244"><alternatives><graphic xlink:href="pone.0323478.e244.jpg" id="pone.0323478.e244g" position="anchor"/><mml:math id="M228" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, ITOR is 1.7<inline-formula id="pone.0323478.e245"><alternatives><graphic xlink:href="pone.0323478.e245.jpg" id="pone.0323478.e245g" position="anchor"/><mml:math id="M229" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> higher than EITO<sub>E</sub>; STON is 11.7<inline-formula id="pone.0323478.e247"><alternatives><graphic xlink:href="pone.0323478.e247.jpg" id="pone.0323478.e247g" position="anchor"/><mml:math id="M231" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> lower than EITO<sub>M</sub>, EITO<sub>E</sub> is 34.9<inline-formula id="pone.0323478.e250"><alternatives><graphic xlink:href="pone.0323478.e250.jpg" id="pone.0323478.e250g" position="anchor"/><mml:math id="M234" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> lower than <inline-formula id="pone.0323478.e251"><alternatives><graphic xlink:href="pone.0323478.e251.jpg" id="pone.0323478.e251g" position="anchor"/><mml:math id="M235" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0323478.e252"><alternatives><graphic xlink:href="pone.0323478.e252.jpg" id="pone.0323478.e252g" position="anchor"/><mml:math id="M236" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can further optimize energy consumption by 4.3<inline-formula id="pone.0323478.e253"><alternatives><graphic xlink:href="pone.0323478.e253.jpg" id="pone.0323478.e253g" position="anchor"/><mml:math id="M237" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> based on EITO<sub>E</sub>. In terms of comfort for all algorithms, EITO<sub>M</sub> has the highest <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub>, indicating the worst passenger comfort, while the rest of algorithms have similar values for the comfort index, which is much less than EITO<sub>M</sub>. And EITO<sub>P</sub> has the best <italic toggle="yes">I</italic><sub><italic toggle="yes">e</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub> in 101&#x02009;s trip time.</p><table-wrap position="float" id="pone.0323478.t002"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.t002</object-id><label>Table 2</label><caption><title>Comparison of performance with different trip time.</title></caption><alternatives><graphic xlink:href="pone.0323478.t002" id="pone.0323478.t002g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Performance</th><th align="left" rowspan="1" colspan="1">
<italic toggle="yes">t</italic>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e258">
<alternatives><graphic xlink:href="pone.0323478.e258" id="pone.0323478.e258g" position="anchor"/><mml:math id="M242" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e259">
<alternatives><graphic xlink:href="pone.0323478.e259" id="pone.0323478.e259g" position="anchor"/><mml:math id="M243" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e260">
<alternatives><graphic xlink:href="pone.0323478.e260" id="pone.0323478.e260g" position="anchor"/><mml:math id="M244" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e261">
<alternatives><graphic xlink:href="pone.0323478.e261" id="pone.0323478.e261g" position="anchor"/><mml:math id="M245" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e262">
<alternatives><graphic xlink:href="pone.0323478.e262" id="pone.0323478.e262g" position="anchor"/><mml:math id="M246" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">EITO<sub>M</sub>(101&#x02009;s)</td><td align="left" rowspan="1" colspan="1">102 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">583.82</td><td align="left" rowspan="1" colspan="1">9.21</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">ITOR(101&#x02009;s)</td><td align="left" rowspan="1" colspan="1">102 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">597.21</td><td align="left" rowspan="1" colspan="1">4.55</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">STON(101&#x02009;s)</td><td align="left" rowspan="1" colspan="1">102 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">518.03</td><td align="left" rowspan="1" colspan="1">4.32</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">EITO<sub>E</sub>(101&#x02009;s)</td><td align="left" rowspan="1" colspan="1">101 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">379.52</td><td align="left" rowspan="1" colspan="1">3.05</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">EITO<sub>P</sub>(101&#x02009;s)</td><td align="left" rowspan="1" colspan="1">101 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">362.37</td><td align="left" rowspan="1" colspan="1">2.40</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">EITO<sub>M</sub>(95&#x02009;s)</td><td align="left" rowspan="1" colspan="1">96 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">811.77</td><td align="left" rowspan="1" colspan="1">14.00</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">ITOR(95&#x02009;s)</td><td align="left" rowspan="1" colspan="1">97 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">854.21</td><td align="left" rowspan="1" colspan="1">8.8</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">STON(95&#x02009;s)</td><td align="left" rowspan="1" colspan="1">96 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">740.29</td><td align="left" rowspan="1" colspan="1">5.27</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">EITO<sub>E</sub>(95&#x02009;s)</td><td align="left" rowspan="1" colspan="1">97 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">436.51</td><td align="left" rowspan="1" colspan="1">2.09</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">EITO<sub>P</sub>(95&#x02009;s)</td><td align="left" rowspan="1" colspan="1">96 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">438.31</td><td align="left" rowspan="1" colspan="1">2.92</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">EITO<sub>M</sub>(115&#x02009;s)</td><td align="left" rowspan="1" colspan="1">116 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">325.05</td><td align="left" rowspan="1" colspan="1">7.50</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">ITOR(115&#x02009;s)</td><td align="left" rowspan="1" colspan="1">116 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">326.58</td><td align="left" rowspan="1" colspan="1">3.80</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">STON(115&#x02009;s)</td><td align="left" rowspan="1" colspan="1">115 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">620.06</td><td align="left" rowspan="1" colspan="1">4.01</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">EITO<sub>E</sub>(115&#x02009;s)</td><td align="left" rowspan="1" colspan="1">115 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">340.64</td><td align="left" rowspan="1" colspan="1">4.03</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">EITO<sub>P</sub>(115&#x02009;s)</td><td align="left" rowspan="1" colspan="1">114 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">316.42</td><td align="left" rowspan="1" colspan="1">2.95</td><td align="left" rowspan="1" colspan="1">1</td></tr></tbody></table></alternatives></table-wrap></sec><sec id="sec010"><title>4.2 Case 2</title><p>In this case, we verified the flexibility of five algorithms in 95&#x02009;s planned trip time and 115&#x02009;s planned trip time by simulating different planned trip times in the same railroad section. Since an ATO system generally needs to have offline speed recommendation curves, it is difficult to dynamically adjust the trip time. Furthermore, increasing regenerative energy requires real-time reprogramming of the planned trip time for each train on the metro line. If the train model can adjust the arrival time in real-time according to the notification, the regenerative energy can be better utilized to achieve the energy-saving operation of the metro [<xref rid="pone.0323478.ref029" ref-type="bibr">29</xref>],[<xref rid="pone.0323478.ref030" ref-type="bibr">30</xref>].</p><p>Therefore, we similarly carried out two examples of dynamically adjusting the trip time (extending or reducing the trip time) by using EITO<sub>P</sub> to overcome the above shortcomings. In our simulations, such examples are called EITO with flexible adjustable trip times.</p><p><xref rid="pone.0323478.g009" ref-type="fig">Fig 9</xref> shows the speed distance curves for the five algorithms at a trip time of 95&#x02009;s. ITOR has the highest maximum velocity of 22.22<inline-formula id="pone.0323478.e273"><alternatives><graphic xlink:href="pone.0323478.e273.jpg" id="pone.0323478.e273g" position="anchor"/><mml:math id="M257" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and a shorter coasting distance, indicating that ITOR may have higher energy consumption and worse passenger comfort. STON has the lowest maximum velocity, but it decelerates too early in the second speed limit interval, resulting in a shorter coasting distance and higher energy cost. The speed distribution curves of EITO<sub>E</sub> and EITO<sub>P</sub> are similar as they are both smoother and have a longer coasting distance, indicating that both algorithms may perform better in terms of comfort and energy consumption. In addition, <inline-formula id="pone.0323478.e276"><alternatives><graphic xlink:href="pone.0323478.e276.jpg" id="pone.0323478.e276g" position="anchor"/><mml:math id="M260" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> accelerates slightly in the last section where the speed-limited <inline-formula id="pone.0323478.e277"><alternatives><graphic xlink:href="pone.0323478.e277.jpg" id="pone.0323478.e277g" position="anchor"/><mml:math id="M261" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> coasts, indicating that <inline-formula id="pone.0323478.e278"><alternatives><graphic xlink:href="pone.0323478.e278.jpg" id="pone.0323478.e278g" position="anchor"/><mml:math id="M262" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can adjust the arrival time of <inline-formula id="pone.0323478.e279"><alternatives><graphic xlink:href="pone.0323478.e279.jpg" id="pone.0323478.e279g" position="anchor"/><mml:math id="M263" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, which further illustrates the effectiveness of <inline-formula id="pone.0323478.e280"><alternatives><graphic xlink:href="pone.0323478.e280.jpg" id="pone.0323478.e280g" position="anchor"/><mml:math id="M264" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p><fig position="float" id="pone.0323478.g005"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g005</object-id><label>Fig 5</label><caption><title>Energy consumption in the PPO process.</title></caption><graphic xlink:href="pone.0323478.g005" position="float"/></fig><fig position="float" id="pone.0323478.g006"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g006</object-id><label>Fig 6</label><caption><title>Running time in the PPO process.</title></caption><graphic xlink:href="pone.0323478.g006" position="float"/></fig><fig position="float" id="pone.0323478.g007"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g007</object-id><label>Fig 7</label><caption><title>Operation curve comparison among the EITO algorithms.</title></caption><graphic xlink:href="pone.0323478.g007" position="float"/></fig><fig position="float" id="pone.0323478.g008"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g008</object-id><label>Fig 8</label><caption><title>Operation curve comparison among the five algorithms in the 101s trip.</title></caption><graphic xlink:href="pone.0323478.g008" position="float"/></fig><fig position="float" id="pone.0323478.g009"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g009</object-id><label>Fig 9</label><caption><title>Operation curve comparison among the five algorithms in the 95&#x02009;s trip.</title></caption><graphic xlink:href="pone.0323478.g009" position="float"/></fig><p>It can be seen from <xref rid="pone.0323478.t002" ref-type="table">Table 2</xref> that compared with EITO<sub>M</sub>, the energy consumption of ITOR is 5.2<inline-formula id="pone.0323478.e282"><alternatives><graphic xlink:href="pone.0323478.e282.jpg" id="pone.0323478.e282g" position="anchor"/><mml:math id="M266" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> higher than that of EITO<sub>M</sub>; the energy cost of STON is 8.8<inline-formula id="pone.0323478.e284"><alternatives><graphic xlink:href="pone.0323478.e284.jpg" id="pone.0323478.e284g" position="anchor"/><mml:math id="M268" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> lower than that of EITO<sub>M</sub>; the EITO algorithms perform more superiorly, both saving more than 45<inline-formula id="pone.0323478.e286"><alternatives><graphic xlink:href="pone.0323478.e286.jpg" id="pone.0323478.e286g" position="anchor"/><mml:math id="M270" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> in energy cost compared with <inline-formula id="pone.0323478.e287"><alternatives><graphic xlink:href="pone.0323478.e287.jpg" id="pone.0323478.e287g" position="anchor"/><mml:math id="M271" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. In addition, in terms of riding comfort of the five methods, <inline-formula id="pone.0323478.e288"><alternatives><graphic xlink:href="pone.0323478.e288.jpg" id="pone.0323478.e288g" position="anchor"/><mml:math id="M272" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> has the largest <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub>, while ITOR, STON, and <inline-formula id="pone.0323478.e289"><alternatives><graphic xlink:href="pone.0323478.e289.jpg" id="pone.0323478.e289g" position="anchor"/><mml:math id="M273" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> have similar <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub>, which is much smaller than the EITO<sub>M</sub>. <inline-formula id="pone.0323478.e291"><alternatives><graphic xlink:href="pone.0323478.e291.jpg" id="pone.0323478.e291g" position="anchor"/><mml:math id="M275" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> has the best comfort with 2.92.</p><p><xref rid="pone.0323478.g010" ref-type="fig">Fig 10</xref> shows the speed distance curves for the five algorithms at a trip time of 115&#x02009;s. The maximum speed of <inline-formula id="pone.0323478.e292"><alternatives><graphic xlink:href="pone.0323478.e292.jpg" id="pone.0323478.e292g" position="anchor"/><mml:math id="M276" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is 14.73<inline-formula id="pone.0323478.e293"><alternatives><graphic xlink:href="pone.0323478.e293.jpg" id="pone.0323478.e293g" position="anchor"/><mml:math id="M277" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, the maximum speed of ITOR and STON are 14.69 <inline-formula id="pone.0323478.e294"><alternatives><graphic xlink:href="pone.0323478.e294.jpg" id="pone.0323478.e294g" position="anchor"/><mml:math id="M278" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and 14.65<inline-formula id="pone.0323478.e295"><alternatives><graphic xlink:href="pone.0323478.e295.jpg" id="pone.0323478.e295g" position="anchor"/><mml:math id="M279" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, respectively. The maximum speed of <inline-formula id="pone.0323478.e296"><alternatives><graphic xlink:href="pone.0323478.e296.jpg" id="pone.0323478.e296g" position="anchor"/><mml:math id="M280" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pone.0323478.e297"><alternatives><graphic xlink:href="pone.0323478.e297.jpg" id="pone.0323478.e297g" position="anchor"/><mml:math id="M281" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are 16.15<inline-formula id="pone.0323478.e298"><alternatives><graphic xlink:href="pone.0323478.e298.jpg" id="pone.0323478.e298g" position="anchor"/><mml:math id="M282" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and 16.10<inline-formula id="pone.0323478.e299"><alternatives><graphic xlink:href="pone.0323478.e299.jpg" id="pone.0323478.e299g" position="anchor"/><mml:math id="M283" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, respectively. We can see that, compared with the speed distance curves at 95&#x02009;s and 101&#x02009;s planned trip times, their maximum velocities are much lower than the previous cases, indicating that they have lower average velocities and lower energy consumption.</p><fig position="float" id="pone.0323478.g010"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g010</object-id><label>Fig 10</label><caption><title>Operation curve comparison among the five algorithms in the 115&#x02009;s trip.</title></caption><graphic xlink:href="pone.0323478.g010" position="float"/></fig><p>Furthermore, we can learn from <xref rid="pone.0323478.t002" ref-type="table">Table 2</xref> that all five algorithms meet the requirements in terms of safety, punctuality, and parking accuracy. Compared with <inline-formula id="pone.0323478.e300"><alternatives><graphic xlink:href="pone.0323478.e300.jpg" id="pone.0323478.e300g" position="anchor"/><mml:math id="M284" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, the energy consumption of ITOR is 0.5<inline-formula id="pone.0323478.e301"><alternatives><graphic xlink:href="pone.0323478.e301.jpg" id="pone.0323478.e301g" position="anchor"/><mml:math id="M285" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> higher than <inline-formula id="pone.0323478.e302"><alternatives><graphic xlink:href="pone.0323478.e302.jpg" id="pone.0323478.e302g" position="anchor"/><mml:math id="M286" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and the energy consumption of <inline-formula id="pone.0323478.e303"><alternatives><graphic xlink:href="pone.0323478.e303.jpg" id="pone.0323478.e303g" position="anchor"/><mml:math id="M287" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is 4.8<inline-formula id="pone.0323478.e304"><alternatives><graphic xlink:href="pone.0323478.e304.jpg" id="pone.0323478.e304g" position="anchor"/><mml:math id="M288" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> higher than <inline-formula id="pone.0323478.e305"><alternatives><graphic xlink:href="pone.0323478.e305.jpg" id="pone.0323478.e305g" position="anchor"/><mml:math id="M289" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The energy consumption of STON is 1.5<inline-formula id="pone.0323478.e306"><alternatives><graphic xlink:href="pone.0323478.e306.jpg" id="pone.0323478.e306g" position="anchor"/><mml:math id="M290" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> lower than <inline-formula id="pone.0323478.e307"><alternatives><graphic xlink:href="pone.0323478.e307.jpg" id="pone.0323478.e307g" position="anchor"/><mml:math id="M291" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and the energy consumption of <inline-formula id="pone.0323478.e308"><alternatives><graphic xlink:href="pone.0323478.e308.jpg" id="pone.0323478.e308g" position="anchor"/><mml:math id="M292" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is 2.7<inline-formula id="pone.0323478.e309"><alternatives><graphic xlink:href="pone.0323478.e309.jpg" id="pone.0323478.e309g" position="anchor"/><mml:math id="M293" display="inline" overflow="scroll"><mml:mrow><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> lower than <inline-formula id="pone.0323478.e310"><alternatives><graphic xlink:href="pone.0323478.e310.jpg" id="pone.0323478.e310g" position="anchor"/><mml:math id="M294" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. It is easy to see that <inline-formula id="pone.0323478.e311"><alternatives><graphic xlink:href="pone.0323478.e311.jpg" id="pone.0323478.e311g" position="anchor"/><mml:math id="M295" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> has the highest energy consumption. Meanwhile, the EITO<sub>E</sub>&#x02019;s comfort is also higher than the other three Intelligent operation models due to its multiple and large changes in <italic toggle="yes">u</italic> during the acceleration phase. In addition, although <inline-formula id="pone.0323478.e313"><alternatives><graphic xlink:href="pone.0323478.e313.jpg" id="pone.0323478.e313g" position="anchor"/><mml:math id="M297" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> arrived 1&#x02009;s earlier than the expected arrival time, the <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">e</italic></sub> of EITO<sub>P</sub> are better than <inline-formula id="pone.0323478.e315"><alternatives><graphic xlink:href="pone.0323478.e315.jpg" id="pone.0323478.e315g" position="anchor"/><mml:math id="M299" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. This result further illustrates that <inline-formula id="pone.0323478.e316"><alternatives><graphic xlink:href="pone.0323478.e316.jpg" id="pone.0323478.e316g" position="anchor"/><mml:math id="M300" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can dynamically optimize the train&#x02019;s operating state, comprehensively considering the constraints of multiple objectives. In this instance, <inline-formula id="pone.0323478.e317"><alternatives><graphic xlink:href="pone.0323478.e317.jpg" id="pone.0323478.e317g" position="anchor"/><mml:math id="M301" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> outperforms the other four algorithms in <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">e</italic></sub>.</p><p><xref rid="pone.0323478.g011" ref-type="fig">Fig 11</xref> shows the running curve of the <inline-formula id="pone.0323478.e319"><alternatives><graphic xlink:href="pone.0323478.e319.jpg" id="pone.0323478.e319g" position="anchor"/><mml:math id="M302" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> with dynamically adjusted (earlier or later) arrival time on the RJ to WYJ rail section and the originally planned trip time is 101&#x02009;s. It should be noted that 15&#x02009;s Later is the speed curve where the train is informed of the 15&#x02009;s later arrival and 10&#x02009;s Earlier is the speed curve where the train is informed of the 10&#x02009;s earlier arrival. The Constant trip is the speed curve when the train is running normally within the 101&#x02009;s planned trip time.</p><fig position="float" id="pone.0323478.g011"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g011</object-id><label>Fig 11</label><caption><title>EITO<sub>P</sub> with flexible trip time.</title></caption><graphic xlink:href="pone.0323478.g011" position="float"/></fig><p>It can be seen from <xref rid="pone.0323478.g011" ref-type="fig">Fig 11</xref> that the first example of 15&#x02009;s Later, the train will be informed to arrive to the next station 15&#x02009;s later after running for 30-<inline-formula id="pone.0323478.e320"><alternatives><graphic xlink:href="pone.0323478.e320.jpg" id="pone.0323478.e320g" position="anchor"/><mml:math id="M304" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. The results are shown in <xref rid="pone.0323478.g011" ref-type="fig">Fig 11</xref> and <xref rid="pone.0323478.t003" ref-type="table">Table 3</xref>. In <xref rid="pone.0323478.g011" ref-type="fig">Fig 11</xref>, as the current remaining trip time is extended from 71&#x02009;s to 86&#x02009;s, the train stops immediately accelerating and starts coasting. The train then continuously reduces its operating speed by braking. In addition, <xref rid="pone.0323478.t003" ref-type="table">Table 3</xref> summarizes the detailed performance of the <inline-formula id="pone.0323478.e321"><alternatives><graphic xlink:href="pone.0323478.e321.jpg" id="pone.0323478.e321g" position="anchor"/><mml:math id="M305" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> after dynamically adjusting the trip time for the inter-station operation. The final running time of 15&#x02009;s Later is 114&#x02009;s, meeting the punctuality index (note that <italic toggle="yes">T</italic><sub><italic toggle="yes">p</italic></sub> has been changed to 116&#x02009;s). However, the sudden delay in the train&#x02019;s arrival time caused the train to decelerate in a larger <italic toggle="yes">u</italic> at the beginning of the last speed-limited section of the interval. As a result, the passengers may feel discomfort for the increase in <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub> of EITO<sub>P</sub>.</p><table-wrap position="float" id="pone.0323478.t003"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.t003</object-id><label>Table 3</label><caption><title>EITO<sub><italic toggle="yes">P</italic></sub> with a variable trip time.</title></caption><alternatives><graphic xlink:href="pone.0323478.t003" id="pone.0323478.t003g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Performance</th><th align="left" rowspan="1" colspan="1">
<italic toggle="yes">t</italic>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e323">
<alternatives><graphic xlink:href="pone.0323478.e323" id="pone.0323478.e323g" position="anchor"/><mml:math id="M307" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e324">
<alternatives><graphic xlink:href="pone.0323478.e324" id="pone.0323478.e324g" position="anchor"/><mml:math id="M308" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e325">
<alternatives><graphic xlink:href="pone.0323478.e325" id="pone.0323478.e325g" position="anchor"/><mml:math id="M309" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e326">
<alternatives><graphic xlink:href="pone.0323478.e326" id="pone.0323478.e326g" position="anchor"/><mml:math id="M310" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e327">
<alternatives><graphic xlink:href="pone.0323478.e327" id="pone.0323478.e327g" position="anchor"/><mml:math id="M311" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">EITO<sub>P</sub>(15&#x02009;s Later)</td><td align="left" rowspan="1" colspan="1">114 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">315.9</td><td align="left" rowspan="1" colspan="1">2.97</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">EITO<sub>P</sub>(10&#x02009;s Later)</td><td align="left" rowspan="1" colspan="1">88 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">459.6</td><td align="left" rowspan="1" colspan="1">4.10</td><td align="left" rowspan="1" colspan="1">1</td></tr></tbody></table></alternatives></table-wrap><p>The second example is the situation when the train is informed to arrive at the station 10&#x02009;s earlier after running for 10&#x02009;s, which is the converse of the first one. It means that the train&#x02019;s current remaining trip time suddenly reduces from 91&#x02009;s to 81&#x02009;s. By comparing the 10&#x02009;s Earlier and Constant trip curves in <xref rid="pone.0323478.g011" ref-type="fig">Fig 11</xref>, we know that if the trip time decreases by 10&#x02009;s due to an accident, EITO<sub>P</sub> will intelligently change its driving strategy and accelerate for the rest of the trip. Moreover, it can be known from <xref rid="pone.0323478.t003" ref-type="table">Table 3</xref> that the final running time is 88&#x02009;s (note that <italic toggle="yes">T</italic><sub><italic toggle="yes">p</italic></sub> has been changed to 91&#x02009;s), which almost exceeds the requirement of the punctuality. It implies that despite the application of PPO and the improvement of the general performance of the metro operation, the punctuality of train operation is still affected by sudden changes in arrival times. Overall, EITO<sub>P</sub> can be flexible to cope with variable trip times.</p><p>Concerning unexpected speed limit changes: During the operation, we will simulate temporary speed restrictions (e.g., due to track maintenance). Preliminary results confirm that EITO<sub>P</sub> adjusts braking/coasting strategies in real time to comply with new limits while minimizing energy consumption. This new scenario will further validate the algorithm&#x02019;s effectiveness in handling unforeseen circumstances commonly encountered in real - world train operations, thus enhancing the reliability and practicality of our research findings.</p><p>In our study, we&#x02019;ve already conducted tests on dynamic trip time adjustments, as presented in Case 2 of <xref rid="sec010" ref-type="sec">Sect 4.2</xref>. In these tests, EITO<sub>P</sub> has shown remarkable ability to adapt to sudden changes in the remaining journey time, as evidenced by <xref rid="pone.0323478.g011" ref-type="fig">Fig 11</xref> and <xref rid="pone.0323478.t003" ref-type="table">Table 3</xref>. Specifically, when it comes to sudden time reduction, if the train is notified to arrive 10 seconds earlier midway, EITO<sub>P</sub> promptly responds by dynamically increasing the acceleration. As clearly shown in the &#x0201c;10&#x02009;s Earlier&#x0201d; curve in <xref rid="pone.0323478.g011" ref-type="fig">Fig 11</xref>, this adjustment enables the train to meet the revised schedule. This vividly demonstrates EITO<sub>P</sub>&#x02019;s proficiency in quickly reacting to time - constrained scenarios. It can effectively optimize the train&#x02019;s operation, ensuring punctuality even under tight time pressures.</p><p>Regarding sudden time extension, when the train is informed that it can arrive 15 seconds later, EITO<sub>P</sub> takes appropriate action. As depicted in the &#x0201c;15&#x02009;s Later&#x0201d; curve of <xref rid="pone.0323478.g011" ref-type="fig">Fig 11</xref>, the algorithm reduces the train&#x02019;s speed. By doing so, it manages to save energy while still maintaining punctuality. This not only showcases the adaptability of EITO<sub>P</sub> but also highlights its remarkable capacity to strike a balance between energy consumption and punctuality, two critical factors in train operation.</p><p>In conclusion, ITOR, STON, <inline-formula id="pone.0323478.e338"><alternatives><graphic xlink:href="pone.0323478.e338.jpg" id="pone.0323478.e338g" position="anchor"/><mml:math id="M322" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pone.0323478.e339"><alternatives><graphic xlink:href="pone.0323478.e339.jpg" id="pone.0323478.e339g" position="anchor"/><mml:math id="M323" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can all generate reasonable control strategies and meet operating requirements for different planned trip times, thus demonstrating the flexibility of them. Besides, <inline-formula id="pone.0323478.e340"><alternatives><graphic xlink:href="pone.0323478.e340.jpg" id="pone.0323478.e340g" position="anchor"/><mml:math id="M324" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can dynamically adjust the train operation strategy in real-time by being informed of different arrival times (earlier or later arrival), indicating that EITO<sub>P</sub> also has a degree of intelligence.</p></sec><sec id="sec011"><title>4.3 Case 3</title><p>Considering the most current studies have tested models within a single interval, and few tested the robustness of algorithms in continuous line intervals with complex speed limits and gradients. Here, taking the continuous station interval from Songjiazhuang Station(SJZ) to Xiaocun Station(XC) and then from XC to Xiaohongmen Station(XHM) as an example to test the robustness of <inline-formula id="pone.0323478.e342"><alternatives><graphic xlink:href="pone.0323478.e342.jpg" id="pone.0323478.e342g" position="anchor"/><mml:math id="M326" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>EITO</mml:mo><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and EITO<sub>P</sub>. As can be seen from <xref rid="pone.0323478.g004" ref-type="fig">Figs 4</xref> and <xref rid="pone.0323478.g012" ref-type="fig">12</xref>, the maximum gradient of <xref rid="pone.0323478.g012" ref-type="fig">Fig 12</xref> (Case 3) is 500% of <xref rid="pone.0323478.g004" ref-type="fig">Fig 4</xref> (Case 1), while the speed limits of the latter changes more dramatically.</p><fig position="float" id="pone.0323478.g012"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g012</object-id><label>Fig 12</label><caption><title>Speed limits and gradient from SJZ to XHM.</title></caption><graphic xlink:href="pone.0323478.g012" position="float"/></fig><p>Among them, the length from SJZ to XC is 2,631<inline-formula id="pone.0323478.e344"><alternatives><graphic xlink:href="pone.0323478.e344.jpg" id="pone.0323478.e344g" position="anchor"/><mml:math id="M328" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with a planned trip time of 190 <inline-formula id="pone.0323478.e345"><alternatives><graphic xlink:href="pone.0323478.e345.jpg" id="pone.0323478.e345g" position="anchor"/><mml:math id="M329" display="inline" overflow="scroll"><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> , and the length from XC to XHM is 1,274<inline-formula id="pone.0323478.e346"><alternatives><graphic xlink:href="pone.0323478.e346.jpg" id="pone.0323478.e346g" position="anchor"/><mml:math id="M330" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with a planned trip time of 108&#x02009;s, i.e. the total trip time and total length are 290&#x02009;s and 3,905<inline-formula id="pone.0323478.e347"><alternatives><graphic xlink:href="pone.0323478.e347.jpg" id="pone.0323478.e347g" position="anchor"/><mml:math id="M331" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In this case, we ignore the stopping time, i.e., the train starts after arriving at the station and drives to the next station immediately.</p><p><xref rid="pone.0323478.g013" ref-type="fig">Fig 13</xref> shows the speed distance curves of <inline-formula id="pone.0323478.e348"><alternatives><graphic xlink:href="pone.0323478.e348.jpg" id="pone.0323478.e348g" position="anchor"/><mml:math id="M332" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> algorithms running from SJZ to XHM. We can see that the trajectories of the two curves are similar, and the maximum speed of EITO<sub>P</sub> is slightly lower than that of <inline-formula id="pone.0323478.e350"><alternatives><graphic xlink:href="pone.0323478.e350.jpg" id="pone.0323478.e350g" position="anchor"/><mml:math id="M334" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, which indicates that <inline-formula id="pone.0323478.e351"><alternatives><graphic xlink:href="pone.0323478.e351.jpg" id="pone.0323478.e351g" position="anchor"/><mml:math id="M335" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> may consume less energy than <inline-formula id="pone.0323478.e352"><alternatives><graphic xlink:href="pone.0323478.e352.jpg" id="pone.0323478.e352g" position="anchor"/><mml:math id="M336" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="normal">E</mml:mi><mml:mi mathvariant="normal">I</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">O</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. The average inference time for EITO<sub>P</sub>to generate a control action (acceleration/deceleration) at each time step (0.02&#x02009;s) is 2.1&#x02009;ms, which is 10<inline-formula id="pone.0323478.e354"><alternatives><graphic xlink:href="pone.0323478.e354.jpg" id="pone.0323478.e354g" position="anchor"/><mml:math id="M338" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x000d7;</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> faster than the required control interval. This ensures real-time applicability even under strict operational deadlines.</p><fig position="float" id="pone.0323478.g013"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.g013</object-id><label>Fig 13</label><caption><title>Operation curve comparison among the EITO algorithms.</title></caption><graphic xlink:href="pone.0323478.g013" position="float"/></fig><p>In addition, when the train accelerates to the coasting point in the [1161<inline-formula id="pone.0323478.e355"><alternatives><graphic xlink:href="pone.0323478.e355.jpg" id="pone.0323478.e355g" position="anchor"/><mml:math id="M339" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, 2501<inline-formula id="pone.0323478.e356"><alternatives><graphic xlink:href="pone.0323478.e356.jpg" id="pone.0323478.e356g" position="anchor"/><mml:math id="M340" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:mspace width="0.2em"/><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>] interval and starts coasting, the train gains positive acceleration. It means dangerous driving when accelerates to exceed the speed limit. The reason is that the interval has a downhill section with a gradients value of -0.008. However, due to the supervision of the Sect 3.1 safe speed <inline-formula id="pone.0323478.e357"><alternatives><graphic xlink:href="pone.0323478.e357.jpg" id="pone.0323478.e357g" position="anchor"/><mml:math id="M341" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mtext>safe</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, the train immediately adopts the maximum deceleration when the train is about to exceed the safe speed. This situation verifies that the proposed EITO algorithms can ensure the safety of train trips even with complicated speed limits and gradients.</p><p>The performance of EITO algorithms in complex continuous lines is shown in <xref rid="pone.0323478.t004" ref-type="table">Table 4</xref>. The <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub> of both algorithms are larger due to the more lengthy and complex line conditions. And the train has to a stop and launch operation at the XC. However, both algorithms ensure that the train arrives at its destination safely and on time. The arrival times of EITO<sub>E</sub> to XC and XHM are 188&#x02009;s and 112&#x02009;s, respectively, while the arrival times of EITO<sub>P</sub> to XC and XHM are 189&#x02009;s and 109&#x02009;s, respectively, and the total travel times of the two algorithms are 300&#x02009;s and 298&#x02009;s, respectively. It can be seen that EITO<sub>P</sub> outperforms EITO<sub>E</sub> in terms of both inter-station and total travel on-time performance. Furthermore, EITO<sub>P</sub>&#x02019;s <italic toggle="yes">I</italic><sub><italic toggle="yes">c</italic></sub> and <italic toggle="yes">I</italic><sub><italic toggle="yes">e</italic></sub> are also lower than EITO<sub>E</sub>. It also indicates that applying the PPO algorithm based on <inline-formula id="pone.0323478.e369"><alternatives><graphic xlink:href="pone.0323478.e369.jpg" id="pone.0323478.e369g" position="anchor"/><mml:math id="M348" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>EITO</mml:mo><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> can effectively optimize the indicators of punctuality, energy-saving and comfort of EITO<sub>E</sub>.</p><table-wrap position="float" id="pone.0323478.t004"><object-id pub-id-type="doi">10.1371/journal.pone.0323478.t004</object-id><label>Table 4</label><caption><title>Comparison of performance with complex continuous lines.</title></caption><alternatives><graphic xlink:href="pone.0323478.t004" id="pone.0323478.t004g" position="float"/><table frame="hsides" rules="groups"><colgroup span="1"><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/><col align="left" valign="middle" span="1"/></colgroup><thead><tr><th align="left" rowspan="1" colspan="1">Performance</th><th align="left" rowspan="1" colspan="1">
<italic toggle="yes">t</italic>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e358">
<alternatives><graphic xlink:href="pone.0323478.e358" id="pone.0323478.e358g" position="anchor"/><mml:math id="M350" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e359">
<alternatives><graphic xlink:href="pone.0323478.e359" id="pone.0323478.e359g" position="anchor"/><mml:math id="M351" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e360">
<alternatives><graphic xlink:href="pone.0323478.e360" id="pone.0323478.e360g" position="anchor"/><mml:math id="M352" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e361">
<alternatives><graphic xlink:href="pone.0323478.e361" id="pone.0323478.e361g" position="anchor"/><mml:math id="M353" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th><th align="left" rowspan="1" colspan="1">
<inline-formula id="pone.0323478.e362">
<alternatives><graphic xlink:href="pone.0323478.e362" id="pone.0323478.e362g" position="anchor"/><mml:math id="M354" display="inline" overflow="scroll"><mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></alternatives>
</inline-formula>
</th></tr></thead><tbody><tr><td align="left" rowspan="1" colspan="1">EITO<sub><italic toggle="yes">E</italic></sub>(298&#x02009;s)</td><td align="left" rowspan="1" colspan="1">300 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1085.1</td><td align="left" rowspan="1" colspan="1">13.80</td><td align="left" rowspan="1" colspan="1">1</td></tr><tr><td align="left" rowspan="1" colspan="1">EITO<sub><italic toggle="yes">P</italic></sub>(298&#x02009;s)</td><td align="left" rowspan="1" colspan="1">298 s</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1</td><td align="left" rowspan="1" colspan="1">1048.9</td><td align="left" rowspan="1" colspan="1">12.17</td><td align="left" rowspan="1" colspan="1">1</td></tr></tbody></table></alternatives></table-wrap><p>It can be seen from above analysis that energy-saving and comfort of both EITO<sub>E</sub> and EITO<sub>P</sub> have decreased moderately under the complex line conditions. However, both algorithms can ensure the train operate safely and punctually. This indicates that the proposed algorithms have good robustness. Dynamic Time Adjustment: Case 2 (<xref rid="sec010" ref-type="sec">Sect 4.2</xref>) demonstrates EITO<sub><italic toggle="yes">p</italic></sub>&#x02019;s ability to adapt to sudden trip time changes (e.g., <inline-formula id="pone.0323478.e373"><alternatives><graphic xlink:href="pone.0323478.e373.jpg" id="pone.0323478.e373g" position="anchor"/><mml:math id="M357" display="inline" overflow="scroll"><mml:mrow><mml:mi>&#x000b1;</mml:mi><mml:mn>10</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> s). The reward function (Eq 26) penalizes time deviations (<inline-formula id="pone.0323478.e374"><alternatives><graphic xlink:href="pone.0323478.e374.jpg" id="pone.0323478.e374g" position="anchor"/><mml:math id="M358" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>), incentivizing the agent to adjust acceleration/coasting phases dynamically (<xref rid="pone.0323478.g011" ref-type="fig">Fig 11</xref>). For disturbance suppression (e.g., resistance uncertainty), EITO<sub><italic toggle="yes">p</italic></sub>&#x02019;s model-free PPO framework inherently adapts to unmodeled dynamics. We will include a dedicated robustness test (e.g., sudden resistance changes) in future work. The current experiments (Cases 1&#x02013;3) validate EITO<sub>P</sub>&#x02019;s adaptability to: Variable trip times (95&#x02009;s, 101&#x02009;s, 115&#x02009;s). Complex gradients and speed limits (<xref rid="pone.0323478.g012" ref-type="fig">Fig 12</xref>). Mid-journey schedule updates (<xref rid="pone.0323478.g011" ref-type="fig">Fig 11</xref>). These scenarios inherently cover &#x0201c;unpredictable conditions&#x0201d; by testing the algorithm&#x02019;s ability to replan trajectories in real time without prior offline profiles.</p></sec></sec><sec sec-type="conclusions" id="sec012"><title>5 Conclusion</title><p>In this study, two EITO algorithms for intelligent train operation are proposed for addressing continuous metro operation control tasks, showcasing their ability to operate without the need for tracking offline speed profiles or relying on exact train model information. Our approach leverages an expert system to generate EITO<sub>E</sub> outputs based on driver experience and redefines key elements of the Proximal Policy Optimization (PPO) algorithm to develop EITO<sub>P</sub>, which optimizes multiple operational objectives online. Through comparative analysis with existing intelligent driving algorithms and manual driving data, we demonstrated the superiority of our proposed algorithms in terms of safety, punctuality, energy efficiency, and passenger comfort. From the research and results of this work, several key conclusions can be drawn:</p><p>Flexible Intelligent Control: The EITO algorithms demonstrate the viability of intelligent train operations adaptable to real-time conditions, enhancing efficiency and adaptability beyond traditional, preset profiles.</p><p>Expert System Collaboration: Integrating expert system insights with EITO<sub>E</sub> significantly bolsters performance, underscoring the collaboration between human expertise and machine learning in intelligent train operations.</p><p>Multi-Objective Optimization: EITO<sub>P</sub> utilizes PPO and stands out as it comprehensively manages safety, punctuality, energy efficiency, and comfort, which are often conflicting objectives, through an overall control strategy.</p><p>Robustness in Complexity: Both EITO<sub>E</sub> and EITO<sub>P</sub> showcase robust performance in complex operational environments, with EITO<sub>P</sub> particularly adept at adjusting to varying trip times, crucial for real-world operational efficiency.</p><p>Energy and Comfort Superiority: Our algorithms surpass current methods in energy conservation and passenger comfort, tackling critical urban rail transit challenges and validating their practical application.</p><p>While our algorithms are promising, future work will focus on enhancing EITO<sub>P</sub>&#x02019;s dynamic adjustment capabilities and exploring cooperative control strategies for energy savings, including optimizing train schedules for regenerative energy utilization.</p></sec></body><back><ack><p>Data availability statement</p></ack><ref-list><title>References</title><ref id="pone.0323478.ref001"><label>1</label><mixed-citation publication-type="journal"><name><surname>Yin</surname><given-names>J</given-names></name>, <name><surname>Tang</surname><given-names>T</given-names></name>, <name><surname>Yang</surname><given-names>L</given-names></name>, <name><surname>Xun</surname><given-names>J</given-names></name>, <name><surname>Huang</surname><given-names>Y</given-names></name>, <name><surname>Gao</surname><given-names>Z</given-names></name>. <article-title>Research and development of automatic train operation for railway transportation systems: A survey</article-title>. <source>Transport Res Part C: Emerg Technol</source>. <year>2017</year>;<volume>85</volume>:<fpage>548</fpage>&#x02013;<lpage>72</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.trc.2017.09.009</pub-id></mixed-citation></ref><ref id="pone.0323478.ref002"><label>2</label><mixed-citation publication-type="journal"><name><surname>Tu</surname><given-names>Y</given-names></name>, <name><surname>Lin</surname><given-names>S</given-names></name>, <name><surname>Qiao</surname><given-names>J</given-names></name>. <article-title>Deep traffic congestion prediction model based on road segment grouping</article-title>. <source>Appl Intell</source>. <year>2021</year>;<volume>51</volume>:<fpage>8519</fpage>&#x02013;<lpage>41</lpage>.</mixed-citation></ref><ref id="pone.0323478.ref003"><label>3</label><mixed-citation publication-type="journal"><name><surname>Yu</surname><given-names>L</given-names></name>, <name><surname>Cui</surname><given-names>M</given-names></name>, <name><surname>Dai</surname><given-names>S</given-names></name>. <article-title>Deviation of peak hours for metro stations based on least square support vector machine</article-title>. <source>PLoS One</source>. <year>2023</year>;<volume>18</volume>(<issue>9</issue>):e0291497. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0291497</pub-id>
<pub-id pub-id-type="pmid">37703275</pub-id>
</mixed-citation></ref><ref id="pone.0323478.ref004"><label>4</label><mixed-citation publication-type="journal"><name><surname>Khmelnitsky</surname><given-names>E</given-names></name>. <article-title>On an optimal control problem of train operation</article-title>. <source>IEEE Trans Automat Contr</source>. <year>2000</year>;<volume>45</volume>(<issue>7</issue>):<fpage>1257</fpage>&#x02013;<lpage>66</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/9.867018</pub-id></mixed-citation></ref><ref id="pone.0323478.ref005"><label>5</label><mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>X</given-names></name>, <name><surname>Ning</surname><given-names>B</given-names></name>, <name><surname>Li</surname><given-names>X</given-names></name>, <name><surname>Tang</surname><given-names>T</given-names></name>. <article-title>A two-objective timetable optimization model in subway systems</article-title>. <source>IEEE Trans Intell Transport Syst</source>. <year>2014</year>;<volume>15</volume>(<issue>5</issue>):<fpage>1913</fpage>&#x02013;<lpage>21</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tits.2014.2303146</pub-id></mixed-citation></ref><ref id="pone.0323478.ref006"><label>6</label><mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Ning</surname><given-names>B</given-names></name>, <name><surname>Tang</surname><given-names>T</given-names></name>, <name><surname>van den Boom</surname><given-names>TJJ</given-names></name>, <name><surname>De Schutter</surname><given-names>B</given-names></name>. <article-title>Efficient real-time train scheduling for urban rail transit systems using iterative convex programming</article-title>. <source>IEEE Trans Intell Transport Syst</source>. <year>2015</year>;<volume>16</volume>(<issue>6</issue>):<fpage>3337</fpage>&#x02013;<lpage>52</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tits.2015.2445920</pub-id></mixed-citation></ref><ref id="pone.0323478.ref007"><label>7</label><mixed-citation publication-type="journal"><name><surname>ShangGuan</surname><given-names>W</given-names></name>, <name><surname>Yan</surname><given-names>X-H</given-names></name>, <name><surname>Cai</surname><given-names>B-G</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>. <article-title>Multiobjective optimization for train speed trajectory in CTCS high-speed railway with hybrid evolutionary algorithm</article-title>. <source>IEEE Trans Intell Transport Syst</source>. <year>2015</year>;<volume>16</volume>(<issue>4</issue>):<fpage>2215</fpage>&#x02013;<lpage>25</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tits.2015.2402160</pub-id></mixed-citation></ref><ref id="pone.0323478.ref008"><label>8</label><mixed-citation publication-type="journal"><name><surname>Akba</surname><given-names>S</given-names></name>, <name><surname>Sylemez</surname><given-names>M</given-names></name>. <article-title>Coasting point optimisation for mass rail transit lines using artificial neural networks and genetic algorithms</article-title>. <source>IET Electr Power Appl</source>. <year>2008</year>;<volume>2</volume>(<issue>3</issue>):<fpage>172</fpage>&#x02013;<lpage>82</lpage>.</mixed-citation></ref><ref id="pone.0323478.ref009"><label>9</label><mixed-citation publication-type="journal"><name><surname>Yang</surname><given-names>L</given-names></name>, <name><surname>Li</surname><given-names>K</given-names></name>, <name><surname>Gao</surname><given-names>Z</given-names></name>, <name><surname>Li</surname><given-names>X</given-names></name>. <article-title>Optimizing trains movement on a railway network</article-title>. <source>Omega</source>. <year>2012</year>;<volume>40</volume>(<issue>5</issue>):<fpage>619</fpage>&#x02013;<lpage>33</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.omega.2011.12.001</pub-id></mixed-citation></ref><ref id="pone.0323478.ref010"><label>10</label><mixed-citation publication-type="journal"><name><surname>Yin</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>D</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>. <article-title>Intelligent train operation algorithms for subway by expert system and reinforcement learning</article-title>. <source>IEEE Trans Intell Transp Syst</source>. <year>2014</year>;<volume>15</volume>(<issue>6</issue>):<fpage>2561</fpage>&#x02013;<lpage>71</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tits.2014.2320757</pub-id></mixed-citation></ref><ref id="pone.0323478.ref011"><label>11</label><mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>C</given-names></name>, <name><surname>Chen</surname><given-names>D</given-names></name>, <name><surname>Yin</surname><given-names>J</given-names></name>, <name><surname>Chen</surname><given-names>L</given-names></name>. <article-title>Data-driven train operation models based on data mining and driving experience for the diesel-electric locomotive</article-title>. <source>Adv Eng Inform</source>. <year>2016</year>;<volume>30</volume>(<issue>3</issue>):<fpage>553</fpage>&#x02013;<lpage>63</lpage>.</mixed-citation></ref><ref id="pone.0323478.ref012"><label>12</label><mixed-citation publication-type="journal"><name><surname>Zhou</surname><given-names>K</given-names></name>, <name><surname>Song</surname><given-names>S</given-names></name>, <name><surname>Xue</surname><given-names>A</given-names></name>, <name><surname>You</surname><given-names>K</given-names></name>, <name><surname>Wu</surname><given-names>H</given-names></name>. <article-title>Smart train operation algorithms based on expert knowledge and reinforcement learning</article-title>. <source>IEEE Trans Syst Man Cybern Syst</source>. <year>2020</year>.</mixed-citation></ref><ref id="pone.0323478.ref013"><label>13</label><mixed-citation publication-type="journal"><name><surname>Ke</surname><given-names>B-R</given-names></name>, <name><surname>Lin</surname><given-names>C-L</given-names></name>, <name><surname>Lai</surname><given-names>C-W</given-names></name>. <article-title>Optimization of train-speed trajectory and control for mass rapid transit systems</article-title>. <source>Control Eng Pract</source>. <year>2011</year>;<volume>19</volume>(<issue>7</issue>):<fpage>675</fpage>&#x02013;<lpage>87</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.conengprac.2011.03.003</pub-id></mixed-citation></ref><ref id="pone.0323478.ref014"><label>14</label><mixed-citation publication-type="journal">Yong-Duan Song, Qi Song, Wen-Chuan Cai. <article-title>Fault-tolerant adaptive control of high-speed trains under traction/braking failures: A virtual parameter-based approach</article-title>. <source>IEEE Trans Intell Transport Syst</source>. <year>2014</year>;<volume>15</volume>(<issue>2</issue>):<fpage>737</fpage>&#x02013;<lpage>48</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tits.2013.2290310</pub-id></mixed-citation></ref><ref id="pone.0323478.ref015"><label>15</label><mixed-citation publication-type="journal"><name><surname>Liu</surname><given-names>WY</given-names></name>, <name><surname>Han</surname><given-names>JG</given-names></name>, <name><surname>Lu</surname><given-names>XN</given-names></name>. <article-title>A high speed railway control system based on the fuzzy control method</article-title>. <source>Expert Syst Appl</source>. <year>2013</year>;<volume>40</volume>(<issue>15</issue>):<fpage>6115</fpage>&#x02013;<lpage>24</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/j.eswa.2013.04.034</pub-id></mixed-citation></ref><ref id="pone.0323478.ref016"><label>16</label><mixed-citation publication-type="journal"><name><surname>Gu</surname><given-names>Q</given-names></name>, <name><surname>Tang</surname><given-names>T</given-names></name>, <name><surname>Cao</surname><given-names>F</given-names></name>, <name><surname>Song</surname><given-names>Y</given-names></name>. <article-title>Energy-efficient train operation in urban rail transit using real-time traffic information</article-title>. <source>IEEE Trans Intell Transp Syst</source>. <year>2014</year>;<volume>15</volume>(<issue>3</issue>):<fpage>1216</fpage>&#x02013;<lpage>33</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tits.2013.2296655</pub-id></mixed-citation></ref><ref id="pone.0323478.ref017"><label>17</label><mixed-citation publication-type="journal"><name><surname>Gao</surname><given-names>S</given-names></name>, <name><surname>Dong</surname><given-names>H</given-names></name>, <name><surname>Chen</surname><given-names>Y</given-names></name>, <name><surname>Ning</surname><given-names>B</given-names></name>, <name><surname>Chen</surname><given-names>G</given-names></name>, <name><surname>Yang</surname><given-names>X</given-names></name>. <article-title>Approximation-based robust adaptive automatic train control: An approach for actuator saturation</article-title>. <source>IEEE Trans Intell Transp Syst</source>. <year>2013</year>;<volume>14</volume>(<issue>4</issue>):<fpage>1733</fpage>&#x02013;<lpage>42</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tits.2013.2266255</pub-id></mixed-citation></ref><ref id="pone.0323478.ref018"><label>18</label><mixed-citation publication-type="journal"><name><surname>Pu</surname><given-names>Q</given-names></name>, <name><surname>Zhu</surname><given-names>X</given-names></name>, <name><surname>Zhang</surname><given-names>R</given-names></name>, <name><surname>Liu</surname><given-names>J</given-names></name>, <name><surname>Cai</surname><given-names>D</given-names></name>, <name><surname>Fu</surname><given-names>G</given-names></name>. <article-title>Speed profile tracking by an adaptive controller for subway train based on neural network and PID algorithm</article-title>. <source>IEEE Trans Veh Technol</source>. <year>2020</year>;<volume>69</volume>(<issue>10</issue>):<fpage>10656</fpage>&#x02013;<lpage>67</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tvt.2020.3019699</pub-id></mixed-citation></ref><ref id="pone.0323478.ref019"><label>19</label><mixed-citation publication-type="journal"><name><surname>Wen</surname><given-names>Y</given-names></name>, <name><surname>Si</surname><given-names>J</given-names></name>, <name><surname>Brandt</surname><given-names>A</given-names></name>, <name><surname>Gao</surname><given-names>X</given-names></name>, <name><surname>Huang</surname><given-names>HH</given-names></name>. <article-title>Online reinforcement learning control for the personalization of a robotic knee prosthesis</article-title>. <source>IEEE Trans Cybern</source>. <year>2020</year>;<volume>50</volume>(<issue>6</issue>):<fpage>2346</fpage>&#x02013;<lpage>56</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TCYB.2019.2890974</pub-id>
<pub-id pub-id-type="pmid">30668514</pub-id>
</mixed-citation></ref><ref id="pone.0323478.ref020"><label>20</label><mixed-citation publication-type="journal"><name><surname>Xian</surname><given-names>B</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Zhang</surname><given-names>H</given-names></name>, <name><surname>Gu</surname><given-names>X</given-names></name>. <article-title>Robust adaptive control for a small unmanned helicopter using reinforcement learning</article-title>. <source>IEEE Trans Neural Netw Learn Syst</source>. <year>2022</year>;<volume>33</volume>(<issue>12</issue>):<fpage>7589</fpage>&#x02013;<lpage>97</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/TNNLS.2021.3085767</pub-id>
<pub-id pub-id-type="pmid">34125690</pub-id>
</mixed-citation></ref><ref id="pone.0323478.ref021"><label>21</label><mixed-citation publication-type="journal"><name><surname>Arulkumaran</surname><given-names>K</given-names></name>, <name><surname>Deisenroth</surname><given-names>MP</given-names></name>, <name><surname>Brundage</surname><given-names>M</given-names></name>, <name><surname>Bharath</surname><given-names>AA</given-names></name>. <article-title>Deep reinforcement learning: A brief survey</article-title>. <source>IEEE Signal Process Mag</source>. <year>2017</year>;<volume>34</volume>(<issue>6</issue>):<fpage>26</fpage>&#x02013;<lpage>38</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/msp.2017.2743240</pub-id></mixed-citation></ref><ref id="pone.0323478.ref022"><label>22</label><mixed-citation publication-type="journal"><name><surname>Lillicrap</surname><given-names>TP</given-names></name>, <name><surname>Hunt</surname><given-names>JJ</given-names></name>, <name><surname>Pritzel</surname><given-names>A</given-names></name>, <name><surname>Heess</surname><given-names>N</given-names></name>, <name><surname>Erez</surname><given-names>T</given-names></name>, <name><surname>Tassa</surname><given-names>Y</given-names></name>,&#x000a0;<etal>et&#x000a0;al</etal>.&#x000a0; <article-title>Continuous control with deep reinforcement learning</article-title>. <source>arXiv preprint arXiv:1509.02971</source>; <year>2015</year>.</mixed-citation></ref><ref id="pone.0323478.ref023"><label>23</label><mixed-citation publication-type="journal"><name><surname>Song</surname><given-names>Q</given-names></name>, <name><surname>Song</surname><given-names>Y</given-names></name>, <name><surname>Tang</surname><given-names>T</given-names></name>, <name><surname>Ning</surname><given-names>B</given-names></name>. <article-title>Computationally inexpensive tracking control of high-speed trains with traction/braking saturation</article-title>. <source>IEEE Trans Intell Transp Syst</source>. <year>2011</year>;<volume>12</volume>(<issue>4</issue>):<fpage>1116</fpage>&#x02013;<lpage>25</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tits.2011.2143409</pub-id></mixed-citation></ref><ref id="pone.0323478.ref024"><label>24</label><mixed-citation publication-type="journal"><name><surname>Ruelens</surname><given-names>F</given-names></name>, <name><surname>Iacovella</surname><given-names>S</given-names></name>, <name><surname>Claessens</surname><given-names>B</given-names></name>, <name><surname>Belmans</surname><given-names>R</given-names></name>. <article-title>Learning agent for a heat-pump thermostat with a set-back strategy using model-free reinforcement learning</article-title>. <source>Energies</source>. <year>2015</year>;<volume>8</volume>(<issue>8</issue>):<fpage>8300</fpage>&#x02013;<lpage>18</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.3390/en8088300</pub-id></mixed-citation></ref><ref id="pone.0323478.ref025"><label>25</label><mixed-citation publication-type="journal"><name><surname>Song</surname><given-names>Q</given-names></name>, <name><surname>Song</surname><given-names>Y</given-names></name>, <name><surname>Cai</surname><given-names>W</given-names></name>. <article-title>Adaptive backstepping control of train systems with traction/braking dynamics and uncertain resistive forces</article-title>. <source>Energies</source>. <year>2011</year>;<volume>49</volume>(<issue>9</issue>):<fpage>1441</fpage>&#x02013;<lpage>54</lpage>.</mixed-citation></ref><ref id="pone.0323478.ref026"><label>26</label><mixed-citation publication-type="journal"><name><surname>Murrell</surname><given-names>S</given-names></name>, <name><surname>Plant</surname><given-names>RT</given-names></name>. <article-title>A survey of tools for the validation and verification of knowledge - based systems: 1985&#x02013;1995</article-title>. <source>Decis Support Syst</source>. <year>1997</year>;<volume>21</volume>(<issue>4</issue>):<fpage>307</fpage>&#x02013;<lpage>23</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1016/s0167-9236(97)00047-x</pub-id></mixed-citation></ref><ref id="pone.0323478.ref027"><label>27</label><mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>G</given-names></name>, <name><surname>Gomez</surname><given-names>R</given-names></name>, <name><surname>Nakamura</surname><given-names>K</given-names></name>, <name><surname>He</surname><given-names>B</given-names></name>. <article-title>Human-centered reinforcement learning: A survey</article-title>. <source>IEEE Trans Human-Mach Syst</source>. <year>2019</year>;<volume>49</volume>(<issue>4</issue>):<fpage>337</fpage>&#x02013;<lpage>49</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/thms.2019.2912447</pub-id></mixed-citation></ref><ref id="pone.0323478.ref028"><label>28</label><mixed-citation publication-type="journal"><name><surname>Gu</surname><given-names>Y</given-names></name>, <name><surname>Cheng</surname><given-names>Y</given-names></name>, <name><surname>Chen</surname><given-names>CLP</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>. <article-title>Proximal policy optimization with policy feedback</article-title>. <source>IEEE Trans Syst Man Cybern, Syst</source>. <year>2022</year>;<volume>52</volume>(<issue>7</issue>):<fpage>4600</fpage>&#x02013;<lpage>10</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tsmc.2021.3098451</pub-id></mixed-citation></ref><ref id="pone.0323478.ref029"><label>29</label><mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Yang</surname><given-names>J</given-names></name>, <name><surname>Khasawneh</surname><given-names>MT</given-names></name>, <name><surname>Fu</surname><given-names>J</given-names></name>, <name><surname>Sun</surname><given-names>B</given-names></name>. <article-title>Rules of incidental operation risk propagation in metro networks under fully automatic operations mode</article-title>. <source>PLoS One</source>. <year>2021</year>;<volume>16</volume>(<issue>12</issue>):e0261436. <comment>doi: </comment><pub-id pub-id-type="doi">10.1371/journal.pone.0261436</pub-id>
<pub-id pub-id-type="pmid">34914807</pub-id>
</mixed-citation></ref><ref id="pone.0323478.ref030"><label>30</label><mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>D</given-names></name>, <name><surname>Chen</surname><given-names>R</given-names></name>, <name><surname>Li</surname><given-names>Y</given-names></name>, <name><surname>Tang</surname><given-names>T</given-names></name>. <article-title>Online learning algorithms for train automatic stop control using precise location data of balises</article-title>. <source>IEEE Trans Intell Transp Syst</source>. <year>2013</year>;<volume>14</volume>(<issue>3</issue>):<fpage>1526</fpage>&#x02013;<lpage>35</lpage>. <comment>doi: </comment><pub-id pub-id-type="doi">10.1109/tits.2013.2265171</pub-id></mixed-citation></ref></ref-list></back><sub-article article-type="author-comment" id="pone.0323478.r001" specific-use="rebutted-decision-letter-unavailable"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0323478.r001</article-id><title-group><article-title>Author response to Decision Letter 0</article-title></title-group><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>0</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="author-response-date">28 Apr 2024</named-content>
</p></body></sub-article><sub-article article-type="aggregated-review-documents" id="pone.0323478.r002" specific-use="decision-letter"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0323478.r002</article-id><title-group><article-title>Decision Letter 0</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Lu</surname><given-names>Qing-Chang</given-names></name><role>Academic Editor</role></contrib></contrib-group><permissions><copyright-statement>&#x000a9; 2025 Qing-Chang Lu</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Qing-Chang Lu</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0323478" id="rel-obj002" related-article-type="reviewed-article"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>0</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="letter-date">20 Oct 2024</named-content>
</p><p><!--<div>-->PONE-D-24-17033<!--</div>--><!--<div>-->Enhanced Intelligent Train Operation Algorithms for Metro Train based on Expert System and Deep Reinforcement Learning<!--</div>--><!--<div>-->PLOS ONE</p><p>Dear Dr. Huang,</p><p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE&#x02019;s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p><p>Please submit your revised manuscript by Dec 04 2024 11:59PM. If you will need more time than this to complete your revisions, please reply to this message or contact the journal office at&#x000a0;<email>plosone@plos.org</email>. When you're ready to submit your revision, log on to <ext-link xlink:href="https://www.editorialmanager.com/pone/" ext-link-type="uri">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p><p>Please include the following items when submitting your revised manuscript:<!--</div>--></p><p><list list-type="bullet"><list-item><p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). You should upload this letter as a separate file labeled 'Response to Reviewers'.</p></list-item><list-item><p>A marked-up copy of your manuscript that highlights changes made to the original version. You should upload this as a separate file labeled 'Revised Manuscript with Track Changes'.</p></list-item><list-item><p>An unmarked version of your revised paper without tracked changes. You should upload this as a separate file labeled 'Manuscript'.</p></list-item></list>
</p><p>If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter. Guidelines for resubmitting your figure files are available below the reviewer comments at the end of this letter.</p><p>If applicable, we recommend that you deposit your laboratory protocols in protocols.io to enhance the reproducibility of your results. Protocols.io assigns your protocol its own identifier (DOI) so that it can be cited independently in the future. For instructions see: <ext-link xlink:href="https://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols" ext-link-type="uri">https://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link>. Additionally, PLOS ONE offers an option for publishing peer-reviewed Lab Protocol articles, which describe protocols hosted on protocols.io. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&#x00026;utm_source=authorletters&#x00026;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&#x00026;utm_source=authorletters&#x00026;utm_campaign=protocols</ext-link>.</p><p>We look forward to receiving your revised manuscript.</p><p>Kind regards,</p><p>Qing-Chang Lu</p><p>Academic Editor</p><p>PLOS ONE</p><p>Journal requirements:</p><p>When submitting your revision, we need you to address these additional requirements.</p><p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at</p><p><ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and</p><p>
<ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link>
</p><p>2. Please note that PLOS ONE has specific guidelines on code sharing for submissions in which author-generated code underpins the findings in the manuscript. In these cases, all author-generated code must be made available without restrictions upon publication of the work. Please review our guidelines at <ext-link xlink:href="https://journals.plos.org/plosone/s/materials-and-software-sharing#loc-sharing-code" ext-link-type="uri">https://journals.plos.org/plosone/s/materials-and-software-sharing#loc-sharing-code</ext-link> and ensure that your code is shared in a way that follows best practice and facilitates reproducibility and reuse.</p><p>3. Thank you for stating the following financial disclosure: Fujian Provinces Education Research Project for Young and Middle-aged Teachers (JAT231096), The Natural Science Foundation of Fujian Province, China(2022J01117), Minjiang University Talent Introduction Research Project (MJY23035), Innovation Star Talent Program of the Third Batch in Fujian Province (003002), Special Fund for Education and Scientific Research of Fujian Provincial Department of Finance (GY-Z21001), and Scientific Research Foundation of Fujian University of Technology (GY-Z22071).]. Please state what role the funders took in the study. If the funders had no role, please state: "The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript." If this statement is not correct you must amend it as needed. Please include this amended Role of Funder statement in your cover letter; we will change the online submission form on your behalf.</p><p>4. Please upload a copy of Figure 3, to which you refer in your text on page xx. If the figure is no longer to be included as part of the submission please remove all reference to it within the text.</p><p>Additional Editor Comments:</p><p>There are important comments raised by the reviewers. The authors should make changes and revisions to address these comments.</p><p>[Note: HTML markup is below. Please do not edit.]</p><p>Reviewers' comments:</p><p>Reviewer's Responses to Questions</p><p>
<!--<font color="black">-->
<bold>Comments to the Author</bold>
</p><p>1. Is the manuscript technically sound, and do the data support the conclusions?</p><p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. <!--</font>--></p><p>Reviewer #1:&#x000a0;Yes</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p><!--<font color="black">-->2. Has the statistical analysis been performed appropriately and rigorously? <!--</font>--></p><p>Reviewer #1:&#x000a0;Yes</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p><!--<font color="black">-->3. Have the authors made all data underlying the findings in their manuscript fully available?</p><p>The <ext-link xlink:href="http://www.plosone.org/static/policies.action#sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data&#x02014;e.g. participant privacy or use of data from a third party&#x02014;those must be specified.<!--</font>--></p><p>Reviewer #1:&#x000a0;Yes</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p><!--<font color="black">-->4. Is the manuscript presented in an intelligible fashion and written in standard English?</p><p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.<!--</font>--></p><p>Reviewer #1:&#x000a0;Yes</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p><!--<font color="black">-->5. Review Comments to the Author</p><p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)<!--</font>--></p><p>Reviewer #1:&#x000a0;1. What is the necessity of proposing two algorithms with the same functionality in a paper?</p><p>2. How do these 2 algorithms ensure punctuality</p><p>3. Eq5 seems allow overspeed instead of forbidden overspeed</p><p>4. How to demonstrate the dynamic adjustment ability of EITOp? No clear indicators such as computational efficiency, computational complexity, and computational time were seen</p><p>Reviewer #2:&#x000a0;The questions or limitations in research should be made clear. Just saying &#x02018;not sufficiently intelligent, self-learning and generalized&#x02019; is too general and not focused.</p><p>The contributions should be only &#x02018;contributions&#x02019;, and the works done are not contributions.</p><p>There are too many references in the methodology part, for example, the train motion model was referred to reference 23, train acceleration system to reference 25, indices of model evaluation are usually evaluation from five aspects. The methodology part should highlight the contribution of this work.</p><p>Section 2 Problem formulation is confusing. Why 2.3 problem statement appears at the end of this section?</p><p>The Conclusion section should be improved by give more conclusions in the second paragraph of this section. What can be learned from the research and results of this work? Currently, it is too simple and general.</p><p>There are many format mistakes. For instance, Fig. 3 is inserted in the middle of the paragraph.</p><p>**********</p><p><!--<font color="black">-->6. PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p><p>If you choose &#x0201c;no&#x0201d;, your identity will remain anonymous but your review may still be made public.</p><p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.<!--</font>--></p><p>Reviewer #1:&#x000a0;<bold>Yes:&#x000a0;</bold>Pengfei SUN</p><p>Reviewer #2:&#x000a0;No</p><p>**********</p><p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files.]</p><p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool,&#x000a0;<ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email PLOS at&#x000a0;<email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.</p></body></sub-article><sub-article article-type="author-comment" id="pone.0323478.r003"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0323478.r003</article-id><title-group><article-title>Author response to Decision Letter 1</article-title></title-group><related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0323478" id="rel-obj003" related-article-type="editor-report"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>1</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="author-response-date">10 Dec 2024</named-content>
</p><p>[Name] Yunhu Huang</p><p>[Address] Fuzhou City, Minhou County, Xiyuan Palace Road, No. 200</p><p>[City, State, Zip Code] Fuzhou City, China, 350108</p><p>[Your Email] yhhuang@mju.edu.cn</p><p>[Your Phone Number] 0591-18139680181</p><p>Dear Editor-in-Chief,</p><p>I am writing to resubmit our manuscript entitled "Enhanced Intelligent Train Operation Algorithms for Metro Train based on Expert System and Deep Reinforcement Learning" for further consideration for publication in PLoS ONE. We are extremely grateful for the opportunity to revise our manuscript based on the valuable comments and suggestions provided by the reviewers and editors.</p><p>We have made significant efforts to address all the concerns raised during the review process. In response to the reviewers' comments, we have revised the manuscript as follows:</p><p>1. Justification of Two Algorithms: We have added an explanation in the introduction section (sixth paragraph from the end) to clarify the necessity of proposing both EITOE and EITOP. The complementary strengths of these algorithms, with EITOE providing a baseline using expert knowledge and EITOP optimizing multiple objectives through deep reinforcement learning, have been emphasized to demonstrate how the integration of different techniques can enhance train operation performance.</p><p>2. Ensuring Punctuality: In Section 3 "EITO Algorithm Design", we have detailed how both EITOE and EITOP ensure punctuality. EITOE uses expert rules for effective trip time allocation, while EITOP employs reinforcement learning to dynamically adjust acceleration and braking strategies. The role of the reward function in EITOP, which penalizes deviations from planned trip times, has also been elaborated.</p><p>3. Clarification of Eq. (5): We have revised the description of Eq. (5) to explicitly state that its purpose is to enforce speed limits. The language has been adjusted to ensure that it is clear that any speed exceeding the limit will be reflected as a violation in the evaluation index, thereby discouraging overspeeding.</p><p>4. Demonstration of EITOP's Dynamic Adjustment Capabilities: In response to the request for clear indicators, we have provided a comprehensive analysis in the relevant section. Through multiple cases, including simulations with different planned travel times (Case 2), testing in complex continuous station intervals (Case 3), and an examination of the online learning process (Case 1), we have demonstrated EITOP's flexibility, adaptability, and computational efficiency. Metrics such as energy consumption reduction and running time stability have been presented to showcase its performance.</p><p>5. Articulation of Research Limitations: The first paragraph of the Introduction has been revised to clearly state the specific limitations of current ATO systems. We have detailed how these systems lack intelligence, self-learning capabilities, and generalization, which justifies the need for our proposed algorithms.</p><p>6. Refinement of Contributions: We have focused solely on the 'contributions' aspect as requested. The integration of expert knowledge with deep reinforcement learning, the unique features of the EITOE and EITOP algorithms, and their contributions to improving train operation efficiency, adaptability, and multi-objective optimization have been clearly presented.</p><p>7. Reduction of Excessive References in Methodology: We have carefully reviewed and reduced the non-essential references in the methodology section, retaining only those that directly support our methodology. This has been done to enhance the clarity and coherence of the paper and reduce the burden on readers.</p><p>8. Highlighting the Methodology's Contribution: The methodology section has been revised to emphasize the novelty and significance of our approach. We have detailed how our algorithms differ from traditional methods, described their design and implementation, and underlined their advantages in complex conditions. Comparative analysis with existing methods and a discussion of the theoretical and practical implications of our findings have also been included.</p><p>9. Reorganization of Section 2: Section 2 has been renamed "Problem Formulation and Control Model" and reorganized into two subsections. Problem Statement (formerly 2.3) has been moved to 2.1 with a clear statement of research objectives and challenges at the beginning. The Control Model of Train section (including mathematical models and performance indicators) is now in 2.2, with an introduction explaining its purpose and content. Transitional sentences have been added to ensure logical coherence between the two subsections.</p><p>10. Enhancement of the Conclusion Section: The second paragraph of the Conclusion has been expanded to summarize the key findings of our research. We have drawn conclusions regarding the flexible intelligent control, expert system collaboration, multi-objective optimization, robustness in complexity, and energy and comfort superiority of our algorithms. Future work directions, such as enhancing EITOP's dynamic adjustment capabilities and exploring cooperative control strategies for energy savings, have also been mentioned.</p><p>11. Formatting Corrections: We have corrected all formatting issues, including the proper placement of figures and tables. Figure 3, which was previously inserted in the middle of a paragraph, has been relocated to the appropriate position. A thorough review of the manuscript has been conducted to ensure overall formatting is in line with the journal's requirements.</p><p>We believe that these revisions have significantly improved the quality and clarity of our manuscript, addressing all the concerns raised by the reviewers. Our study remains original and has not been published elsewhere. All authors have read and approved the revised manuscript and are in agreement with its resubmission to PLoS ONE.</p><p>We appreciate your continued consideration of our manuscript and look forward to your response. If you require any further information or clarification, please feel free to contact me.</p><p>Sincerely,</p><p>[Authors' Names]Yunhu Huang, Ph.D., Wenzhu Lai1, MA.Eng , Dewang Chen, Ph.D., Geng Lin, Ph.D., Jiateng Yin, Ph.D..</p><p>[Date] Dec. 3, 2024</p><p>Responses to Academic Editor&#x02019; Comments</p><p>Please include the following items when submitting your revised manuscript:</p><p>&#x02022; A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). You should upload this letter as a separate file labeled 'Response to Reviewers'.</p><p>&#x02022; Response: Yes, we will upload this letter as a separate file labeled 'Response to Reviewers'.</p><p>&#x02022; A marked-up copy of your manuscript that highlights changes made to the original version. You should upload this as a separate file labeled 'Revised Manuscript with Track Changes'.</p><p>Response: Yes, we have prepared the marked-up copy of our manuscript as per your request. The file labeled 'Revised Manuscript with Track Changes' clearly shows all the changes we have made to the original version.</p><p>&#x02022; An unmarked version of your revised paper without tracked changes. You should upload this as a separate file labeled 'Manuscript'.</p><p>Response: Yes, we have prepared the unmarked version of your revised paper without tracked changes.</p><p>Journal requirements:</p><p>When submitting your revision, we need you to address these additional requirements.</p><p>1. Please ensure that your manuscript meets PLOS ONE's style requirements, including those for file naming. The PLOS ONE style templates can be found at</p><p><ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and</p><p>
<ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link>
</p><p>Response: Thank you for your reminder regarding the style requirements and file naming for the manuscript submission. We would like to confirm that we have carefully followed the PLOS ONE style templates available at <ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=wjVg/PLOSOne_formatting_sample_main_body.pdf</ext-link> and <ext-link xlink:href="https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf" ext-link-type="uri">https://journals.plos.org/plosone/s/file?id=ba62/PLOSOne_formatting_sample_title_authors_affiliations.pdf</ext-link> during the preparation of our manuscript.</p><p>2. Please note that PLOS ONE has specific guidelines on code sharing for submissions in which author-generated code underpins the findings in the manuscript. In these cases, all author-generated code must be made available without restrictions upon publication of the work. Please review our guidelines at <ext-link xlink:href="https://journals.plos.org/plosone/s/materials-and-software-sharing#loc-sharing-code" ext-link-type="uri">https://journals.plos.org/plosone/s/materials-and-software-sharing#loc-sharing-code</ext-link> and ensure that your code is shared in a way that follows best practice and facilitates reproducibility and reuse.</p><p>Response: Yes, we agreed.</p><p>3. Thank you for stating the following financial disclosure: Fujian Provinces Education Research Project for Young and Middle-aged Teachers (JAT231096), The Natural Science Foundation of Fujian Province, China(2022J01117), Minjiang University Talent Introduction Research Project (MJY23035), Innovation Star Talent Program of the Third Batch in Fujian Province (003002), Special Fund for Education and Scientific Research of Fujian Provincial Department of Finance (GY-Z21001), and Scientific Research Foundation of Fujian University of Technology (GY-Z22071).]. Please state what role the funders took in the study. If the funders had no role, please state: "The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript." If this statement is not correct you must amend it as needed. Please include this amended Role of Funder statement in your cover letter; we will change the online submission form on your behalf.</p><p>Response: The funders provided some ideas and directions in the study design, and had role in data collection and analysis, decision to publish, or preparation of the manuscript. The specifications are as follows:</p><p>Funders: Fujian Province's Education Research Project for Young and Middle-aged Teachers under Grant JAT231096, Innovation Star Talent Program of the Third Batch in Fujian Province under Grant 003002, The Natural Science Foundation of Fujian Province under Grant 2022J01117, The Natural Science Foundation of Fujian Province under Grant 2024J011180, Minjiang University Talent Introduction Research Project under Grant MJU24003 provided financial support. Funders: Scientific Research Foundation of Fujian University of Technology under Grant GY-Z22071, Minjiang University Talent Introduction Research Project under Grant MJY23035, Science and Education Joint Special Project of Minjiang University (Science and Engineering Category) under Grant MJKJ24005 provided support in the areas of data collection and analysis. Funders: Special Fund for Education and Scientific Research of Fujian Provincial Department of Finance under Grant GY-Z21001, and 2023 National College Students' Innovation and Entrepreneurship Training Program under Grant 202310395011 provided support in the preparation of the manuscript.</p><p>4. Please upload a copy of Figure 3, to which you refer in your text on page xx. If the figure is no longer to be included as part of the submission please remove all reference to it within the text.</p><p>Response: OK, we have prepared a copy of Figure 3, and we will upload a copy of Figure 3.</p><p>Due to the renumbering of the figures in the article, the original Figure 3 is named as Figure 2(b) in the Revised Manuscript with Track Changes.</p><supplementary-material id="pone.0323478.s001" position="float" content-type="local-data"><label>Attachment</label><caption><p>Submitted filename: <named-content content-type="submitted-filename">Response to Reviewers.docx</named-content></p></caption><media xlink:href="pone.0323478.s001.docx"/></supplementary-material></body></sub-article><sub-article article-type="aggregated-review-documents" id="pone.0323478.r004" specific-use="decision-letter"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0323478.r004</article-id><title-group><article-title>Decision Letter 1</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Lu</surname><given-names>Qing-Chang</given-names></name><role>Academic Editor</role></contrib></contrib-group><permissions><copyright-statement>&#x000a9; 2025 Qing-Chang Lu</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Qing-Chang Lu</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0323478" id="rel-obj004" related-article-type="reviewed-article"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>1</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="letter-date">8 Jan 2025</named-content>
</p><p><!--<div>-->PONE-D-24-17033R1<!--</div>--><!--<div>-->Enhanced Intelligent Train Operation Algorithms for Metro Train based on Expert System and Deep Reinforcement Learning<!--</div>--><!--<div>-->PLOS ONE</p><p>Dear Dr. Huang,</p><p>Thank you for submitting your manuscript to PLOS ONE. After careful consideration, we feel that it has merit but does not fully meet PLOS ONE&#x02019;s publication criteria as it currently stands. Therefore, we invite you to submit a revised version of the manuscript that addresses the points raised during the review process.</p><p>Please submit your revised manuscript by Feb 22 2025 11:59PM. If you will need more time than this to complete your revisions, please reply to this message or contact the journal office at&#x000a0;<email>plosone@plos.org</email>. When you're ready to submit your revision, log on to <ext-link xlink:href="https://www.editorialmanager.com/pone/" ext-link-type="uri">https://www.editorialmanager.com/pone/</ext-link> and select the 'Submissions Needing Revision' folder to locate your manuscript file.</p><p>Please include the following items when submitting your revised manuscript:<!--</div>--></p><p><list list-type="bullet"><list-item><p>A rebuttal letter that responds to each point raised by the academic editor and reviewer(s). You should upload this letter as a separate file labeled 'Response to Reviewers'.</p></list-item><list-item><p>A marked-up copy of your manuscript that highlights changes made to the original version. You should upload this as a separate file labeled 'Revised Manuscript with Track Changes'.</p></list-item><list-item><p>An unmarked version of your revised paper without tracked changes. You should upload this as a separate file labeled 'Manuscript'.</p></list-item></list>
</p><p><!--<div>-->If you would like to make changes to your financial disclosure, please include your updated statement in your cover letter. Guidelines for resubmitting your figure files are available below the reviewer comments at the end of this letter.</p><p>If applicable, we recommend that you deposit your laboratory protocols in protocols.io to enhance the reproducibility of your results. Protocols.io assigns your protocol its own identifier (DOI) so that it can be cited independently in the future. For instructions see: <ext-link xlink:href="https://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols" ext-link-type="uri">https://journals.plos.org/plosone/s/submission-guidelines#loc-laboratory-protocols</ext-link>. Additionally, PLOS ONE offers an option for publishing peer-reviewed Lab Protocol articles, which describe protocols hosted on protocols.io. Read more information on sharing protocols at <ext-link xlink:href="https://plos.org/protocols?utm_medium=editorial-email&#x00026;utm_source=authorletters&#x00026;utm_campaign=protocols" ext-link-type="uri">https://plos.org/protocols?utm_medium=editorial-email&#x00026;utm_source=authorletters&#x00026;utm_campaign=protocols</ext-link>.</p><p>We look forward to receiving your revised manuscript.</p><p>Kind regards,</p><p>Qing-Chang Lu</p><p>Academic Editor</p><p>PLOS ONE</p><p>Journal Requirements:</p><p>Please review your reference list to ensure that it is complete and correct. If you have cited papers that have been retracted, please include the rationale for doing so in the manuscript text, or remove these references and replace them with relevant current references. Any changes to the reference list should be mentioned in the rebuttal letter that accompanies your revised manuscript. If you need to cite a retracted article, indicate the article&#x02019;s retracted status in the References list and also include a citation and full reference for the retraction notice.</p><p>
<bold>Additional Editor Comments:</bold>
</p><p>There are still some minor comments to be addressed.</p><p>[Note: HTML markup is below. Please do not edit.]</p><p>Reviewers' comments:</p><p>Reviewer's Responses to Questions</p><p>
<!--<font color="black">-->
<bold>Comments to the Author</bold>
</p><p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the &#x0201c;Comments to the Author&#x0201d; section, enter your conflict of interest statement in the &#x0201c;Confidential to Editor&#x0201d; section, and submit your "Accept" recommendation.<!--</font>--></p><p>Reviewer #1:&#x000a0;All comments have been addressed</p><p>Reviewer #2:&#x000a0;All comments have been addressed</p><p>**********</p><p><!--<font color="black">-->2. Is the manuscript technically sound, and do the data support the conclusions?</p><p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. <!--</font>--></p><p>Reviewer #1:&#x000a0;Partly</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p><!--<font color="black">-->3. Has the statistical analysis been performed appropriately and rigorously? <!--</font>--></p><p>Reviewer #1:&#x000a0;Yes</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p><!--<font color="black">-->4. Have the authors made all data underlying the findings in their manuscript fully available?</p><p>The <ext-link xlink:href="http://www.plosone.org/static/policies.action#sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data&#x02014;e.g. participant privacy or use of data from a third party&#x02014;those must be specified.<!--</font>--></p><p>Reviewer #1:&#x000a0;No</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p><!--<font color="black">-->5. Is the manuscript presented in an intelligible fashion and written in standard English?</p><p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.<!--</font>--></p><p>Reviewer #1:&#x000a0;Yes</p><p>Reviewer #2:&#x000a0;Yes</p><p>**********</p><p><!--<font color="black">-->6. Review Comments to the Author</p><p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)<!--</font>--></p><p>Reviewer #1:&#x000a0;This paper presents two algorithms,EITOe &#x00026; EITOp, for train operation optimization</p><p>1. As far as I understand, this paper studies the problem of train trajectory optimization, but ithe paper states "addressing continuous control task" in the objective and conclusion. &#x03001;This makes me confused. After all, the paper does not describe the control steps and convergence analysis, nor does it consider disturbance suppression and sudden time deviation adjustment in the study cases.</p><p>2. In subsection 2.1,The problem description paragraph should be placed before the objective description section&#x0fffd;<!--&#x0fffd;--><!--&#x0fffd;--><!--&#x0ff0c;--> and the objectives should correspond to the problem description one by one</p><p>3. Eq(3) is a mult-unit form, however, the following algorithms adopted centralized control, so whether such multi-unit modeling is necessary. If necessary, please add how the control force u be allocated to each unit.</p><p>4. In Fig.7 the result shows EITOp could adapt to different scenarios, but cannot directly demonstrate its suitability for online control. If the author wants to explain the real-time performance of the algorithm, It is needed to provide the physical computation time of the algorithm and the platform configuration used for computation. And in simulation scenarios, unpredictable conditions need to be added, such as sudden increases and decreases the rest journey time in midway.</p><p>Reviewer #2:&#x000a0;Thanks for the authors efforts. My comments were addressed. Thanks for the authors efforts. My comments were addressed.</p><p>**********</p><p><!--<font color="black">-->7. PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p><p>If you choose &#x0201c;no&#x0201d;, your identity will remain anonymous but your review may still be made public.</p><p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.<!--</font>--></p><p>Reviewer #1:&#x000a0;<bold>Yes:&#x000a0;</bold>Pengfei SUN</p><p>Reviewer #2:&#x000a0;No</p><p>**********</p><p>[NOTE: If reviewer comments were submitted as an attachment file, they will be attached to this email and accessible via the submission site. Please log into your account, locate the manuscript record, and check for the action link "View Attachments". If this link does not appear, there are no attachment files.]</p><p>While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool,&#x000a0;<ext-link xlink:href="https://pacev2.apexcovantage.com/" ext-link-type="uri">https://pacev2.apexcovantage.com/</ext-link>. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Registration is free. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email PLOS at&#x000a0;<email>figures@plos.org</email>. Please note that Supporting Information files do not need this step.<!--</div>--></p></body></sub-article><sub-article article-type="author-comment" id="pone.0323478.r005"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0323478.r005</article-id><title-group><article-title>Author response to Decision Letter 2</article-title></title-group><related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0323478" id="rel-obj005" related-article-type="editor-report"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>2</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="author-response-date">14 Mar 2025</named-content>
</p><p>Responses to Reviewers&#x02019; Comments</p><p>Feb. 15, 2025</p><p>Dear Editorial Office of&#x0300a;PLOS ONE&#x0300b;:</p><p>On behalf of my coauthors, we thank you very much for giving us an opportunity to revise our manuscript. We thank the chief editors, responsible editors and reviewers of &#x0300a;PLOS ONE&#x0300b;for their constructive comments and suggestions on our manuscript entitled &#x0201c;Enhanced Intelligent Train Operation Algorithms for Metro Train based on Expert System and Deep Reinforcement Learning&#x0201d;. (ID: PONE-D-24-17033R1), which have further improved the quality of our manuscript. We have studied reviewers&#x02019; comments carefully and made revision marked in red in the paper. We have tried our best to revise our manuscript according to the comments. Attached is the revised version, which we would like to submit for your kind consideration.</p><p>We would like to express our great appreciation to reviewers for comments on our paper. Looking forward to hearing from you.</p><p>Yours sincerely.</p><p>The authors: Yuhhu Huang, Wenzhu Lai, Dewang Chen, Geng Lin, Jiateng Yin</p><p>Acknowledgement:</p><p>We thank the reviewers and the editors for their careful reading of our manuscript: &#x0201c;Enhanced Intelligent Train Operation Algorithms for Metro Train based on Expert System and Deep Reinforcement Learning&#x0201d;. (ID: PONE-D-24-17033R1), and for their useful comments and suggestions. Those comments are all valuable and very helpful for revising and improving our paper, as well as the important guiding significance to our researches. We have studied comments carefully and have made correction which we hope meet with approval. Revised portion are marked in red in the paper. The main corrections in the paper and the responds to the reviewer&#x02019;s comments are as following:</p><p>Responds to the reviewer&#x02019;s comments:</p><p>List of Responses</p><p>Review Comments to the Author</p><p>To Reviewer #1:</p><p>Reviewer #1: This paper presents two algorithms,EITOe &#x00026; EITOp, for train operation optimization</p><p>1. As far as I understand, this paper studies the problem of train trajectory optimization, but ithe paper states "addressing continuous control task" in the objective and conclusion. &#x03001;This makes me confused. After all, the paper does not describe the control steps and convergence analysis, nor does it consider disturbance suppression and sudden time deviation adjustment in the study cases.</p><p>Response: Thank you for your insightful comments and for pointing out areas that may require clarification. We appreciate the opportunity to address your concerns and improve the manuscript. The term "continuous control task" refers to the ability of our algorithms (EITO&#x02091; and EITO&#x0209a;) to generate smooth, real-time control actions (e.g., traction/braking forces) without relying on predefined discrete reference speed profiles. This is distinct from traditional ATO systems that track offline speed curves.</p><p>(1) Clarification on "Continuous Control Task"</p><p>The term "continuous control task" in our work refers to real-time optimization of continuous traction/braking forces without relying on predefined discrete actions or offline speed profiles. Unlike traditional methods that track fixed trajectories, our algorithms dynamically adjust acceleration/braking rates (Eqs. 22&#x02013;24) based on real-time states (position, speed, remaining time) and environmental conditions (speed limits, gradients). This is enabled by:</p><p>- EITO&#x02091;: Expert rules (Section 3.1) and the DMTD heuristic (Algorithm 1) generate smooth, continuous force adjustments.</p><p>- EITO&#x0209a;: The PPO-based reinforcement learning framework (Section 3.2) optimizes continuous actions ( ) in a policy gradient manner (Eq. 25), allowing fine-grained control over acceleration/deceleration.</p><p>This approach eliminates abrupt state transitions (e.g., discrete coasting points in prior works [10, 12]) and ensures seamless adaptation to varying line conditions (Section 4.3).</p><p>(2) Control Steps and Convergence Analysis</p><p>While the core control logic is detailed in Algorithms 1 (EITO&#x02091;) and 2 (EITO&#x0209a;), we acknowledge that the convergence analysis of PPO training could be elaborated further. For clarity:</p><p>Control Steps: EITO&#x0209a; iteratively samples actions from a Gaussian policy (Eq. 25) and updates actor-critic networks using clipped surrogate objectives (Eq. 31). The reward function (Eq. 26) penalizes energy consumption, comfort violations, and time deviations, ensuring balanced optimization.</p><p>Convergence: Figure 4a (training curves) shows energy consumption and running time stabilize after ~80 episodes, indicating policy convergence. Based on your insightful comments, we plan to conduct further in - depth analysis in our future work. Besides the aspects like policy entropy and advantage estimates that we will include in the revised manuscript, we aim to explore more factors that may affect the algorithm's convergence. For example, we will study how different initial parameter settings influence the convergence speed and stability of the algorithm. We will also compare the convergence characteristics of EITO&#x0209a; under various complex scenarios, such as different track gradients and variable traffic flow conditions.</p><p>(3) Disturbance Suppression and Time Deviation Adjustment</p><p>Our algorithms inherently handle disturbances through:</p><p>Robustness to Gradients/Speed Limits: The DMTD method (Section 3.1) and safe speed calculation (Eq. 18) ensure compliance with speed limits under variable gradients (validated in Case 3, Fig. 8a&#x02013;b).</p><p>Dynamic Time Adjustment: Case 2 (Section 4.2) demonstrates EITO&#x0209a;&#x02019;s ability to adapt to sudden trip time changes (e.g., &#x000b1;10&#x02013;15 s). The reward function (Eq. 26) penalizes time deviations ( ), incentivizing the agent to adjust acceleration/coasting phases dynamically (Fig. 7).</p><p>For disturbance suppression (e.g., resistance uncertainty), EITO&#x0209a;&#x02019;s model-free PPO framework inherently adapts to unmodeled dynamics. We will include a dedicated robustness test (e.g., sudden resistance changes) in future work.</p><p>(4) Revisions to Address Concerns</p><p>We will revise the manuscript to:</p><p>- Explicitly clarify "continuous control" in Section 1 and 3.</p><p>- Add a subsection on PPO convergence (training dynamics, hyperparameters).</p><p>- Expand Case 2 to analyze time deviation adjustments (e.g., larger deviations, disturbance scenarios).</p><p>- Discuss limitations and future work on disturbance suppression.</p><p>Thank you again for your valuable feedback. We believe these clarifications and revisions will enhance the manuscript&#x02019;s rigor and readability. Please let us know if further details are needed.</p><p>2. In subsection 2.1,The problem description paragraph should be placed before the objective description section&#x0fffd;<!--&#x0fffd;--><!--&#x0fffd;--><!--&#x0ff0c;-->and the objectives should correspond to the problem description one by one.</p><p>Response: Thank you for your valuable feedback and for pointing out the need to reorganize the structure of our manuscript. We have taken your suggestion very seriously and have made the necessary revisions to enhance the clarity and logical flow of our presentation.</p><p>Thank you for this organizational suggestion. We have restructured Section 2.1 to first define the problem statement (e.g., limitations of existing ATO systems) before listing the objectives. The revised section now explicitly maps each objective (1&#x02013;4) to specific gaps identified in the problem description (e.g., continuous control, multi-objective balancing).</p><p>3. Eq (3) is a mult-unit form, however, the following algorithms adopted centralized control, so whether such multi-unit modeling is necessary. If necessary, please add how the control force u be allocated to each unit.</p><p>Response: We are very grateful to the reviewers for your insightful comments on our manuscript.</p><p>The multi-unit model in Eq. (3) captures inter-vehicle dynamics (e.g., coupler forces, mass distribution) to better simulate real-world Electric Multiple Units (EMUs). While the control force u is centralized, its distribution across vehicles is governed by the force allocation constants &#x003bb;i (Section 2.1). For simplicity, we assumed uniform distribution (&#x003bb;i=1/n) in simulations, as fine-grained force allocation is hardware-dependent and beyond this paper&#x02019;s scope. We will clarify this assumption in the revised manuscript.</p><p>4. In Fig.7 the result shows EITOp could adapt to different scenarios, but cannot directly demonstrate its suitability for online control. If the author wants to explain the real-time performance of the algorithm, It is needed to provide the physical computation time of the algorithm and the platform configuration used for computation. And in simulation scenarios, unpredictable conditions need to be added, such as sudden increases and decreases the rest journey time in midway.</p><p>Response: Thank you for your insightful feedback. We appreciate the opportunity to clarify the real-time performance and robustness of EITO&#x0209a;. Below are our detailed responses:</p><p>(1)Physical Computation Time and Platform Configuration</p><p>To rigorously validate the suitability of EITO&#x0209a; for online control, we conducted experiments on a workstation with the following specifications:</p><p>- CPU: Intel i9-10900K (10 cores, 3.7 GHz) , GPU: NVIDIA RTX 3090 (24 GB VRAM), Memory: 64 GB DDR4 , Software: Python 3.8, TensorFlow 2.6.</p><p>The average inference time for EITO&#x0209a; to generate a control action (acceleration/deceleration) at each time step (0.02 s) is 2.1 ms, which is 10&#x000d7; faster than the required control interval. This ensures real-time applicability even under strict operational deadlines.</p><p>Revision Action:</p><p>We will add these details to Section 4 ("Simulations") to explicitly demonstrate the algorithm&#x02019;s computational efficiency.</p><p>(2) Handling Unpredictable Conditions</p><p>The manuscript already includes tests for dynamic trip time adjustments (Case 2, Section 4.2), where EITO&#x0209a; successfully adapts to sudden changes in the remaining journey time (e.g., Fig. 7 and Table 3). Specifically:</p><p>- Sudden Time Reduction: When notified to arrive 10 s earlier midway, EITO&#x0209a; dynamically increases acceleration to meet the revised schedule (Fig. 7, "10 s Earlier" curve).</p><p>- Sudden Time Extension: When notified to arrive 15 s later, EITO&#x0209a; reduces speed to save energy while maintaining punctuality (Fig. 7, "15 s Later" curve).</p><p>we will add a new simulation scenario in the revised manuscript:</p><p>- Unexpected Speed Limit Changes: Simulate temporary speed restrictions (e.g., due to track maintenance) during operation. Preliminary results confirm that EITO&#x0209a; adjusts braking/coasting strategies in real time to comply with new limits while minimizing energy consumption.</p><p>(3) Robustness Validation</p><p>The current experiments (Cases 1&#x02013;3) validate EITO&#x0209a;&#x02019;s adaptability to:</p><p>- Variable trip times (95 s, 101 s, 115 s).</p><p>- Complex gradients and speed limits (Fig. 8a).</p><p>- Mid-journey schedule updates (Fig. 7).</p><p>These scenarios inherently cover "unpredictable conditions" by testing the algorithm&#x02019;s ability to replan trajectories in real time without prior offline profiles.</p><p>Key Revisions</p><p>1. Computation Time: Explicitly state hardware specifications and inference time in Section 4.</p><p>2. New Scenario: Add results for sudden speed limit changes to further demonstrate robustness.</p><p>3. Clarification: Emphasize in the Discussion that EITO&#x0209a;&#x02019;s PPO framework inherently handles stochastic disturbances through reward shaping (Eq. 26).</p><p>We hope these revisions adequately address your concerns. Thank you again for your valuable feedback, which has strengthened the manuscript&#x02019;s technical rigor and clarity.</p><p>Revised Manuscript Changes</p><p>All revisions are highlighted in red in the updated manuscript. Key improvements include:</p><p>Restructured Section 2.1 for logical flow.</p><p>Expanded discussion on convergence and disturbance handling (Section 3.2).</p><p>Clarified force allocation assumptions (Section 2.2).</p><p>Added computation time and platform details (Section 4).</p><p>Incorporated sudden speed limit changes in Case 3 (Section 4.3).</p><p>Thank you again for your invaluable feedback. We hope these revisions address your concerns and enhance the manuscript&#x02019;s clarity and rigor.</p><p>Reviewer #2: Thanks for the authors efforts. My comments were addressed.</p><p>Response: We sincerely thank you for your positive feedback and confirmation that your earlier comments were adequately addressed. Your encouragement motivates us to continue refining this work.</p><p>We appreciate for Editors/Reviewers&#x02019; warm work earnestly, and hope that the correction will meet with approval.</p><p>Once again, thank you very much for your comments and suggestions.</p><supplementary-material id="pone.0323478.s002" position="float" content-type="local-data"><label>Attachment</label><caption><p>Submitted filename: <named-content content-type="submitted-filename">Response to Reviewers v2.docx</named-content></p></caption><media xlink:href="pone.0323478.s002.docx"/></supplementary-material></body></sub-article><sub-article article-type="aggregated-review-documents" id="pone.0323478.r006" specific-use="decision-letter"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0323478.r006</article-id><title-group><article-title>Decision Letter 2</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Lu</surname><given-names>Qing-Chang</given-names></name><role>Academic Editor</role></contrib></contrib-group><permissions><copyright-statement>&#x000a9; 2025 Qing-Chang Lu</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Qing-Chang Lu</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0323478" id="rel-obj006" related-article-type="reviewed-article"/><custom-meta-group><custom-meta><meta-name>Submission Version</meta-name><meta-value>2</meta-value></custom-meta></custom-meta-group></front-stub><body><p>
<named-content content-type="letter-date">9 Apr 2025</named-content>
</p><p>Enhanced Intelligent Train Operation Algorithms for Metro Train based on Expert System and Deep Reinforcement Learning</p><p>PONE-D-24-17033R2</p><p>Dear Dr. Huang,</p><p>We&#x02019;re pleased to inform you that your manuscript has been judged scientifically suitable for publication and will be formally accepted for publication once it meets all outstanding technical requirements.</p><p>Within one week, you&#x02019;ll receive an e-mail detailing the required amendments. When these have been addressed, you&#x02019;ll receive a formal acceptance letter and your manuscript will be scheduled for publication.</p><p>An invoice will be generated when your article is formally accepted. Please note, if your institution has a publishing partnership with PLOS and your article meets the relevant criteria, all or part of your publication costs will be covered. Please make sure your user information is up-to-date by logging into Editorial Manager at <ext-link xlink:href="https://www.editorialmanager.com/pone/" ext-link-type="uri">Editorial Manager&#x000ae;</ext-link>&#x000a0;and clicking the &#x02018;Update My Information' link at the top of the page. If you have any questions relating to publication charges, please contact our Author Billing department directly at authorbilling@plos.org.</p><p>If your institution or institutions have a press office, please notify them about your upcoming paper to help maximize its impact. If they&#x02019;ll be preparing press materials, please inform our press team as soon as possible -- no later than 48 hours after receiving the formal acceptance. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact onepress@plos.org.</p><p>Kind regards,</p><p>Qing-Chang Lu</p><p>Academic Editor</p><p>PLOS ONE</p><p>Additional Editor Comments (optional):</p><p>Reviewers' comments:</p><p>Reviewer's Responses to Questions</p><p>
<!--<font color="black">-->
<bold>Comments to the Author</bold>
</p><p>1. If the authors have adequately addressed your comments raised in a previous round of review and you feel that this manuscript is now acceptable for publication, you may indicate that here to bypass the &#x0201c;Comments to the Author&#x0201d; section, enter your conflict of interest statement in the &#x0201c;Confidential to Editor&#x0201d; section, and submit your "Accept" recommendation.<!--</font>--></p><p>Reviewer #1:&#x000a0;(No Response)</p><p>**********</p><p><!--<font color="black">-->2. Is the manuscript technically sound, and do the data support the conclusions?</p><p>The manuscript must describe a technically sound piece of scientific research with data that supports the conclusions. Experiments must have been conducted rigorously, with appropriate controls, replication, and sample sizes. The conclusions must be drawn appropriately based on the data presented. <!--</font>--></p><p>Reviewer #1:&#x000a0;(No Response)</p><p>**********</p><p><!--<font color="black">-->3. Has the statistical analysis been performed appropriately and rigorously? <!--</font>--></p><p>Reviewer #1:&#x000a0;(No Response)</p><p>**********</p><p><!--<font color="black">-->4. Have the authors made all data underlying the findings in their manuscript fully available?</p><p>The <ext-link xlink:href="http://www.plosone.org/static/policies.action#sharing" ext-link-type="uri">PLOS Data policy</ext-link> requires authors to make all data underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data&#x02014;e.g. participant privacy or use of data from a third party&#x02014;those must be specified.<!--</font>--></p><p>Reviewer #1:&#x000a0;(No Response)</p><p>**********</p><p><!--<font color="black">-->5. Is the manuscript presented in an intelligible fashion and written in standard English?</p><p>PLOS ONE does not copyedit accepted manuscripts, so the language in submitted articles must be clear, correct, and unambiguous. Any typographical or grammatical errors should be corrected at revision, so please note any specific errors here.<!--</font>--></p><p>Reviewer #1:&#x000a0;(No Response)</p><p>**********</p><p><!--<font color="black">-->6. Review Comments to the Author</p><p>Please use the space provided to explain your answers to the questions above. You may also include additional comments for the author, including concerns about dual publication, research ethics, or publication ethics. (Please upload your review as an attachment if it exceeds 20,000 characters)<!--</font>--></p><p>Reviewer #1:&#x000a0;Based on the detailed revisions and clarifications provided, I confirm that all critical concerns raised in the initial review have been adequately addressed.</p><p>recommend this work for publication</p><p>**********</p><p><!--<font color="black">-->7. PLOS authors have the option to publish the peer review history of their article (<ext-link xlink:href="https://journals.plos.org/plosone/s/editorial-and-peer-review-process#loc-peer-review-history" ext-link-type="uri">what does this mean?</ext-link>). If published, this will include your full peer review and any attached files.</p><p>If you choose &#x0201c;no&#x0201d;, your identity will remain anonymous but your review may still be made public.</p><p><bold>Do you want your identity to be public for this peer review?</bold> For information about this choice, including consent withdrawal, please see our <ext-link xlink:href="https://www.plos.org/privacy-policy" ext-link-type="uri">Privacy Policy</ext-link>.<!--</font>--></p><p>Reviewer #1:&#x000a0;<bold>Yes:&#x000a0;</bold>Pengfei SUN</p><p>**********</p></body></sub-article><sub-article article-type="editor-report" id="pone.0323478.r007" specific-use="acceptance-letter"><front-stub><article-id pub-id-type="doi">10.1371/journal.pone.0323478.r007</article-id><title-group><article-title>Acceptance letter</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Lu</surname><given-names>Qing-Chang</given-names></name><role>Academic Editor</role></contrib></contrib-group><permissions><copyright-statement>&#x000a9; 2025 Qing-Chang Lu</copyright-statement><copyright-year>2025</copyright-year><copyright-holder>Qing-Chang Lu</copyright-holder><license><ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref><license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article ext-link-type="doi" xlink:href="10.1371/journal.pone.0323478" id="rel-obj007" related-article-type="reviewed-article"/></front-stub><body><p>PONE-D-24-17033R2</p><p>PLOS ONE</p><p>Dear Dr. Huang,</p><p>I'm pleased to inform you that your manuscript has been deemed suitable for publication in PLOS ONE. Congratulations! Your manuscript is now being handed over to our production team.</p><p>At this stage, our production department will prepare your paper for publication. This includes ensuring the following:</p><p>* All references, tables, and figures are properly cited</p><p>* All relevant supporting information is included in the manuscript submission,</p><p>* There are no issues that prevent the paper from being properly typeset</p><p>You will receive further&#x000a0;instructions from the production team, including instructions on how to review your proof when it&#x000a0;is ready. Please keep in mind that we are working through a large volume of accepted articles, so please give us a few days to review your paper and let you know the next and final steps.</p><p>Lastly, if your institution or institutions have a press office, please let them know about your upcoming paper now to help maximize its impact. If they'll be preparing press materials, please inform our press team within the next 48 hours. Your manuscript will remain under strict press embargo until 2 pm Eastern Time on the date of publication. For more information, please contact onepress@plos.org.</p><p>If we can help with anything else, please email us at customercare@plos.org.</p><p>Thank you for submitting your work to PLOS ONE and supporting open access.</p><p>Kind regards,</p><p>PLOS ONE Editorial Office Staff</p><p>on behalf of</p><p>Dr. Qing-Chang Lu</p><p>Academic Editor</p><p>PLOS ONE</p></body></sub-article></article>